const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/traces-B7H4Y5qr.js","assets/traces-B3dI40fp.css"])))=>i.map(i=>d[i]);
(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&t(o)}).observe(document,{childList:!0,subtree:!0});function i(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(e){if(e.ep)return;e.ep=!0;const r=i(e);fetch(e.href,r)}})();/**
* @vue/shared v3.5.12
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function ao(n){const s=Object.create(null);for(const i of n.split(","))s[i]=1;return i=>i in s}const Ue={},an=[],Gt=()=>{},nf=()=>!1,Ur=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),uo=n=>n.startsWith("onUpdate:"),Ye=Object.assign,lo=(n,s)=>{const i=n.indexOf(s);i>-1&&n.splice(i,1)},rf=Object.prototype.hasOwnProperty,Re=(n,s)=>rf.call(n,s),Ee=Array.isArray,xn=n=>Hr(n)==="[object Map]",sf=n=>Hr(n)==="[object Set]",Se=n=>typeof n=="function",$e=n=>typeof n=="string",vn=n=>typeof n=="symbol",We=n=>n!==null&&typeof n=="object",Gu=n=>(We(n)||Se(n))&&Se(n.then)&&Se(n.catch),of=Object.prototype.toString,Hr=n=>of.call(n),af=n=>Hr(n).slice(8,-1),uf=n=>Hr(n)==="[object Object]",co=n=>$e(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,Rn=ao(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),jr=n=>{const s=Object.create(null);return i=>s[i]||(s[i]=n(i))},lf=/-(\w)/g,Ei=jr(n=>n.replace(lf,(s,i)=>i?i.toUpperCase():"")),cf=/\B([A-Z])/g,ji=jr(n=>n.replace(cf,"-$1").toLowerCase()),Ku=jr(n=>n.charAt(0).toUpperCase()+n.slice(1)),es=jr(n=>n?`on${Ku(n)}`:""),bi=(n,s)=>!Object.is(n,s),ts=(n,...s)=>{for(let i=0;i<n.length;i++)n[i](...s)},Yu=(n,s,i,t=!1)=>{Object.defineProperty(n,s,{configurable:!0,enumerable:!1,writable:t,value:i})},ff=n=>{const s=parseFloat(n);return isNaN(s)?n:s};let Jo;const Vr=()=>Jo||(Jo=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function fo(n){if(Ee(n)){const s={};for(let i=0;i<n.length;i++){const t=n[i],e=$e(t)?pf(t):fo(t);if(e)for(const r in e)s[r]=e[r]}return s}else if($e(n)||We(n))return n}const hf=/;(?![^(]*\))/g,df=/:([^]+)/,gf=/\/\*[^]*?\*\//g;function pf(n){const s={};return n.replace(gf,"").split(hf).forEach(i=>{if(i){const t=i.split(df);t.length>1&&(s[t[0].trim()]=t[1].trim())}}),s}function ho(n){let s="";if($e(n))s=n;else if(Ee(n))for(let i=0;i<n.length;i++){const t=ho(n[i]);t&&(s+=t+" ")}else if(We(n))for(const i in n)n[i]&&(s+=i+" ");return s.trim()}const vf="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",mf=ao(vf);function $u(n){return!!n||n===""}/**
* @vue/reactivity v3.5.12
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let vt;class qu{constructor(s=!1){this.detached=s,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=vt,!s&&vt&&(this.index=(vt.scopes||(vt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let s,i;if(this.scopes)for(s=0,i=this.scopes.length;s<i;s++)this.scopes[s].pause();for(s=0,i=this.effects.length;s<i;s++)this.effects[s].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let s,i;if(this.scopes)for(s=0,i=this.scopes.length;s<i;s++)this.scopes[s].resume();for(s=0,i=this.effects.length;s<i;s++)this.effects[s].resume()}}run(s){if(this._active){const i=vt;try{return vt=this,s()}finally{vt=i}}}on(){vt=this}off(){vt=this.parent}stop(s){if(this._active){let i,t;for(i=0,t=this.effects.length;i<t;i++)this.effects[i].stop();for(i=0,t=this.cleanups.length;i<t;i++)this.cleanups[i]();if(this.scopes)for(i=0,t=this.scopes.length;i<t;i++)this.scopes[i].stop(!0);if(!this.detached&&this.parent&&!s){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.parent=void 0,this._active=!1}}}function yf(n){return new qu(n)}function _f(){return vt}let Be;const is=new WeakSet;class Xu{constructor(s){this.fn=s,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,vt&&vt.active&&vt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,is.has(this)&&(is.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Qu(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Qo(this),Zu(this);const s=Be,i=At;Be=this,At=!0;try{return this.fn()}finally{el(this),Be=s,At=i,this.flags&=-3}}stop(){if(this.flags&1){for(let s=this.deps;s;s=s.nextDep)vo(s);this.deps=this.depsTail=void 0,Qo(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?is.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Os(this)&&this.run()}get dirty(){return Os(this)}}let Ju=0,In,An;function Qu(n,s=!1){if(n.flags|=8,s){n.next=An,An=n;return}n.next=In,In=n}function go(){Ju++}function po(){if(--Ju>0)return;if(An){let s=An;for(An=void 0;s;){const i=s.next;s.next=void 0,s.flags&=-9,s=i}}let n;for(;In;){let s=In;for(In=void 0;s;){const i=s.next;if(s.next=void 0,s.flags&=-9,s.flags&1)try{s.trigger()}catch(t){n||(n=t)}s=i}}if(n)throw n}function Zu(n){for(let s=n.deps;s;s=s.nextDep)s.version=-1,s.prevActiveLink=s.dep.activeLink,s.dep.activeLink=s}function el(n){let s,i=n.depsTail,t=i;for(;t;){const e=t.prevDep;t.version===-1?(t===i&&(i=e),vo(t),bf(t)):s=t,t.dep.activeLink=t.prevActiveLink,t.prevActiveLink=void 0,t=e}n.deps=s,n.depsTail=i}function Os(n){for(let s=n.deps;s;s=s.nextDep)if(s.dep.version!==s.version||s.dep.computed&&(tl(s.dep.computed)||s.dep.version!==s.version))return!0;return!!n._dirty}function tl(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===Bn))return;n.globalVersion=Bn;const s=n.dep;if(n.flags|=2,s.version>0&&!n.isSSR&&n.deps&&!Os(n)){n.flags&=-3;return}const i=Be,t=At;Be=n,At=!0;try{Zu(n);const e=n.fn(n._value);(s.version===0||bi(e,n._value))&&(n._value=e,s.version++)}catch(e){throw s.version++,e}finally{Be=i,At=t,el(n),n.flags&=-3}}function vo(n,s=!1){const{dep:i,prevSub:t,nextSub:e}=n;if(t&&(t.nextSub=e,n.prevSub=void 0),e&&(e.prevSub=t,n.nextSub=void 0),i.subs===n&&(i.subs=t,!t&&i.computed)){i.computed.flags&=-5;for(let r=i.computed.deps;r;r=r.nextDep)vo(r,!0)}!s&&!--i.sc&&i.map&&i.map.delete(i.key)}function bf(n){const{prevDep:s,nextDep:i}=n;s&&(s.nextDep=i,n.prevDep=void 0),i&&(i.prevDep=s,n.nextDep=void 0)}let At=!0;const il=[];function Si(){il.push(At),At=!1}function wi(){const n=il.pop();At=n===void 0?!0:n}function Qo(n){const{cleanup:s}=n;if(n.cleanup=void 0,s){const i=Be;Be=void 0;try{s()}finally{Be=i}}}let Bn=0;class Ef{constructor(s,i){this.sub=s,this.dep=i,this.version=i.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class mo{constructor(s){this.computed=s,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(s){if(!Be||!At||Be===this.computed)return;let i=this.activeLink;if(i===void 0||i.sub!==Be)i=this.activeLink=new Ef(Be,this),Be.deps?(i.prevDep=Be.depsTail,Be.depsTail.nextDep=i,Be.depsTail=i):Be.deps=Be.depsTail=i,nl(i);else if(i.version===-1&&(i.version=this.version,i.nextDep)){const t=i.nextDep;t.prevDep=i.prevDep,i.prevDep&&(i.prevDep.nextDep=t),i.prevDep=Be.depsTail,i.nextDep=void 0,Be.depsTail.nextDep=i,Be.depsTail=i,Be.deps===i&&(Be.deps=t)}return i}trigger(s){this.version++,Bn++,this.notify(s)}notify(s){go();try{for(let i=this.subs;i;i=i.prevSub)i.sub.notify()&&i.sub.dep.notify()}finally{po()}}}function nl(n){if(n.dep.sc++,n.sub.flags&4){const s=n.dep.computed;if(s&&!n.dep.subs){s.flags|=20;for(let t=s.deps;t;t=t.nextDep)nl(t)}const i=n.dep.subs;i!==n&&(n.prevSub=i,i&&(i.nextSub=n)),n.dep.subs=n}}const Ds=new WeakMap,Li=Symbol(""),Ms=Symbol(""),Un=Symbol("");function Ze(n,s,i){if(At&&Be){let t=Ds.get(n);t||Ds.set(n,t=new Map);let e=t.get(i);e||(t.set(i,e=new mo),e.map=t,e.key=i),e.track()}}function ei(n,s,i,t,e,r){const o=Ds.get(n);if(!o){Bn++;return}const a=u=>{u&&u.trigger()};if(go(),s==="clear")o.forEach(a);else{const u=Ee(n),l=u&&co(i);if(u&&i==="length"){const c=Number(t);o.forEach((f,h)=>{(h==="length"||h===Un||!vn(h)&&h>=c)&&a(f)})}else switch((i!==void 0||o.has(void 0))&&a(o.get(i)),l&&a(o.get(Un)),s){case"add":u?l&&a(o.get("length")):(a(o.get(Li)),xn(n)&&a(o.get(Ms)));break;case"delete":u||(a(o.get(Li)),xn(n)&&a(o.get(Ms)));break;case"set":xn(n)&&a(o.get(Li));break}}po()}function Ki(n){const s=xe(n);return s===n?s:(Ze(s,"iterate",Un),Lt(n)?s:s.map(nt))}function yo(n){return Ze(n=xe(n),"iterate",Un),n}const Tf={__proto__:null,[Symbol.iterator](){return ns(this,Symbol.iterator,nt)},concat(...n){return Ki(this).concat(...n.map(s=>Ee(s)?Ki(s):s))},entries(){return ns(this,"entries",n=>(n[1]=nt(n[1]),n))},every(n,s){return $t(this,"every",n,s,void 0,arguments)},filter(n,s){return $t(this,"filter",n,s,i=>i.map(nt),arguments)},find(n,s){return $t(this,"find",n,s,nt,arguments)},findIndex(n,s){return $t(this,"findIndex",n,s,void 0,arguments)},findLast(n,s){return $t(this,"findLast",n,s,nt,arguments)},findLastIndex(n,s){return $t(this,"findLastIndex",n,s,void 0,arguments)},forEach(n,s){return $t(this,"forEach",n,s,void 0,arguments)},includes(...n){return rs(this,"includes",n)},indexOf(...n){return rs(this,"indexOf",n)},join(n){return Ki(this).join(n)},lastIndexOf(...n){return rs(this,"lastIndexOf",n)},map(n,s){return $t(this,"map",n,s,void 0,arguments)},pop(){return _n(this,"pop")},push(...n){return _n(this,"push",n)},reduce(n,...s){return Zo(this,"reduce",n,s)},reduceRight(n,...s){return Zo(this,"reduceRight",n,s)},shift(){return _n(this,"shift")},some(n,s){return $t(this,"some",n,s,void 0,arguments)},splice(...n){return _n(this,"splice",n)},toReversed(){return Ki(this).toReversed()},toSorted(n){return Ki(this).toSorted(n)},toSpliced(...n){return Ki(this).toSpliced(...n)},unshift(...n){return _n(this,"unshift",n)},values(){return ns(this,"values",nt)}};function ns(n,s,i){const t=yo(n),e=t[s]();return t!==n&&!Lt(n)&&(e._next=e.next,e.next=()=>{const r=e._next();return r.value&&(r.value=i(r.value)),r}),e}const Sf=Array.prototype;function $t(n,s,i,t,e,r){const o=yo(n),a=o!==n&&!Lt(n),u=o[s];if(u!==Sf[s]){const f=u.apply(n,r);return a?nt(f):f}let l=i;o!==n&&(a?l=function(f,h){return i.call(this,nt(f),h,n)}:i.length>2&&(l=function(f,h){return i.call(this,f,h,n)}));const c=u.call(o,l,t);return a&&e?e(c):c}function Zo(n,s,i,t){const e=yo(n);let r=i;return e!==n&&(Lt(n)?i.length>3&&(r=function(o,a,u){return i.call(this,o,a,u,n)}):r=function(o,a,u){return i.call(this,o,nt(a),u,n)}),e[s](r,...t)}function rs(n,s,i){const t=xe(n);Ze(t,"iterate",Un);const e=t[s](...i);return(e===-1||e===!1)&&Eo(i[0])?(i[0]=xe(i[0]),t[s](...i)):e}function _n(n,s,i=[]){Si(),go();const t=xe(n)[s].apply(n,i);return po(),wi(),t}const wf=ao("__proto__,__v_isRef,__isVue"),rl=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(vn));function Cf(n){vn(n)||(n=String(n));const s=xe(this);return Ze(s,"has",n),s.hasOwnProperty(n)}class sl{constructor(s=!1,i=!1){this._isReadonly=s,this._isShallow=i}get(s,i,t){const e=this._isReadonly,r=this._isShallow;if(i==="__v_isReactive")return!e;if(i==="__v_isReadonly")return e;if(i==="__v_isShallow")return r;if(i==="__v_raw")return t===(e?r?Mf:ll:r?ul:al).get(s)||Object.getPrototypeOf(s)===Object.getPrototypeOf(t)?s:void 0;const o=Ee(s);if(!e){let u;if(o&&(u=Tf[i]))return u;if(i==="hasOwnProperty")return Cf}const a=Reflect.get(s,i,et(s)?s:t);return(vn(i)?rl.has(i):wf(i))||(e||Ze(s,"get",i),r)?a:et(a)?o&&co(i)?a:a.value:We(a)?e?fl(a):zr(a):a}}class ol extends sl{constructor(s=!1){super(!1,s)}set(s,i,t,e){let r=s[i];if(!this._isShallow){const u=Fi(r);if(!Lt(t)&&!Fi(t)&&(r=xe(r),t=xe(t)),!Ee(s)&&et(r)&&!et(t))return u?!1:(r.value=t,!0)}const o=Ee(s)&&co(i)?Number(i)<s.length:Re(s,i),a=Reflect.set(s,i,t,et(s)?s:e);return s===xe(e)&&(o?bi(t,r)&&ei(s,"set",i,t):ei(s,"add",i,t)),a}deleteProperty(s,i){const t=Re(s,i);s[i];const e=Reflect.deleteProperty(s,i);return e&&t&&ei(s,"delete",i,void 0),e}has(s,i){const t=Reflect.has(s,i);return(!vn(i)||!rl.has(i))&&Ze(s,"has",i),t}ownKeys(s){return Ze(s,"iterate",Ee(s)?"length":Li),Reflect.ownKeys(s)}}class kf extends sl{constructor(s=!1){super(!0,s)}set(s,i){return!0}deleteProperty(s,i){return!0}}const Pf=new ol,xf=new kf,Rf=new ol(!0);const Ns=n=>n,er=n=>Reflect.getPrototypeOf(n);function If(n,s,i){return function(...t){const e=this.__v_raw,r=xe(e),o=xn(r),a=n==="entries"||n===Symbol.iterator&&o,u=n==="keys"&&o,l=e[n](...t),c=i?Ns:s?Fs:nt;return!s&&Ze(r,"iterate",u?Ms:Li),{next(){const{value:f,done:h}=l.next();return h?{value:f,done:h}:{value:a?[c(f[0]),c(f[1])]:c(f),done:h}},[Symbol.iterator](){return this}}}}function tr(n){return function(...s){return n==="delete"?!1:n==="clear"?void 0:this}}function Af(n,s){const i={get(e){const r=this.__v_raw,o=xe(r),a=xe(e);n||(bi(e,a)&&Ze(o,"get",e),Ze(o,"get",a));const{has:u}=er(o),l=s?Ns:n?Fs:nt;if(u.call(o,e))return l(r.get(e));if(u.call(o,a))return l(r.get(a));r!==o&&r.get(e)},get size(){const e=this.__v_raw;return!n&&Ze(xe(e),"iterate",Li),Reflect.get(e,"size",e)},has(e){const r=this.__v_raw,o=xe(r),a=xe(e);return n||(bi(e,a)&&Ze(o,"has",e),Ze(o,"has",a)),e===a?r.has(e):r.has(e)||r.has(a)},forEach(e,r){const o=this,a=o.__v_raw,u=xe(a),l=s?Ns:n?Fs:nt;return!n&&Ze(u,"iterate",Li),a.forEach((c,f)=>e.call(r,l(c),l(f),o))}};return Ye(i,n?{add:tr("add"),set:tr("set"),delete:tr("delete"),clear:tr("clear")}:{add(e){!s&&!Lt(e)&&!Fi(e)&&(e=xe(e));const r=xe(this);return er(r).has.call(r,e)||(r.add(e),ei(r,"add",e,e)),this},set(e,r){!s&&!Lt(r)&&!Fi(r)&&(r=xe(r));const o=xe(this),{has:a,get:u}=er(o);let l=a.call(o,e);l||(e=xe(e),l=a.call(o,e));const c=u.call(o,e);return o.set(e,r),l?bi(r,c)&&ei(o,"set",e,r):ei(o,"add",e,r),this},delete(e){const r=xe(this),{has:o,get:a}=er(r);let u=o.call(r,e);u||(e=xe(e),u=o.call(r,e)),a&&a.call(r,e);const l=r.delete(e);return u&&ei(r,"delete",e,void 0),l},clear(){const e=xe(this),r=e.size!==0,o=e.clear();return r&&ei(e,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(e=>{i[e]=If(e,n,s)}),i}function _o(n,s){const i=Af(n,s);return(t,e,r)=>e==="__v_isReactive"?!n:e==="__v_isReadonly"?n:e==="__v_raw"?t:Reflect.get(Re(i,e)&&e in t?i:t,e,r)}const Lf={get:_o(!1,!1)},Of={get:_o(!1,!0)},Df={get:_o(!0,!1)};const al=new WeakMap,ul=new WeakMap,ll=new WeakMap,Mf=new WeakMap;function Nf(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Ff(n){return n.__v_skip||!Object.isExtensible(n)?0:Nf(af(n))}function zr(n){return Fi(n)?n:bo(n,!1,Pf,Lf,al)}function cl(n){return bo(n,!1,Rf,Of,ul)}function fl(n){return bo(n,!0,xf,Df,ll)}function bo(n,s,i,t,e){if(!We(n)||n.__v_raw&&!(s&&n.__v_isReactive))return n;const r=e.get(n);if(r)return r;const o=Ff(n);if(o===0)return n;const a=new Proxy(n,o===2?t:i);return e.set(n,a),a}function Ln(n){return Fi(n)?Ln(n.__v_raw):!!(n&&n.__v_isReactive)}function Fi(n){return!!(n&&n.__v_isReadonly)}function Lt(n){return!!(n&&n.__v_isShallow)}function Eo(n){return n?!!n.__v_raw:!1}function xe(n){const s=n&&n.__v_raw;return s?xe(s):n}function hl(n){return!Re(n,"__v_skip")&&Object.isExtensible(n)&&Yu(n,"__v_skip",!0),n}const nt=n=>We(n)?zr(n):n,Fs=n=>We(n)?fl(n):n;function et(n){return n?n.__v_isRef===!0:!1}function dl(n){return gl(n,!1)}function Bf(n){return gl(n,!0)}function gl(n,s){return et(n)?n:new Uf(n,s)}class Uf{constructor(s,i){this.dep=new mo,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=i?s:xe(s),this._value=i?s:nt(s),this.__v_isShallow=i}get value(){return this.dep.track(),this._value}set value(s){const i=this._rawValue,t=this.__v_isShallow||Lt(s)||Fi(s);s=t?s:xe(s),bi(s,i)&&(this._rawValue=s,this._value=t?s:nt(s),this.dep.trigger())}}function Oi(n){return et(n)?n.value:n}const Hf={get:(n,s,i)=>s==="__v_raw"?n:Oi(Reflect.get(n,s,i)),set:(n,s,i,t)=>{const e=n[s];return et(e)&&!et(i)?(e.value=i,!0):Reflect.set(n,s,i,t)}};function pl(n){return Ln(n)?n:new Proxy(n,Hf)}class jf{constructor(s,i,t){this.fn=s,this.setter=i,this._value=void 0,this.dep=new mo(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Bn-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!i,this.isSSR=t}notify(){if(this.flags|=16,!(this.flags&8)&&Be!==this)return Qu(this,!0),!0}get value(){const s=this.dep.track();return tl(this),s&&(s.version=this.dep.version),this._value}set value(s){this.setter&&this.setter(s)}}function Vf(n,s,i=!1){let t,e;return Se(n)?t=n:(t=n.get,e=n.set),new jf(t,e,i)}const ir={},_r=new WeakMap;let Ri;function zf(n,s=!1,i=Ri){if(i){let t=_r.get(i);t||_r.set(i,t=[]),t.push(n)}}function Wf(n,s,i=Ue){const{immediate:t,deep:e,once:r,scheduler:o,augmentJob:a,call:u}=i,l=P=>e?P:Lt(P)||e===!1||e===0?_i(P,1):_i(P);let c,f,h,d,g=!1,v=!1;if(et(n)?(f=()=>n.value,g=Lt(n)):Ln(n)?(f=()=>l(n),g=!0):Ee(n)?(v=!0,g=n.some(P=>Ln(P)||Lt(P)),f=()=>n.map(P=>{if(et(P))return P.value;if(Ln(P))return l(P);if(Se(P))return u?u(P,2):P()})):Se(n)?s?f=u?()=>u(n,2):n:f=()=>{if(h){Si();try{h()}finally{wi()}}const P=Ri;Ri=c;try{return u?u(n,3,[d]):n(d)}finally{Ri=P}}:f=Gt,s&&e){const P=f,I=e===!0?1/0:e;f=()=>_i(P(),I)}const m=_f(),S=()=>{c.stop(),m&&lo(m.effects,c)};if(r&&s){const P=s;s=(...I)=>{P(...I),S()}}let w=v?new Array(n.length).fill(ir):ir;const _=P=>{if(!(!(c.flags&1)||!c.dirty&&!P))if(s){const I=c.run();if(e||g||(v?I.some((j,O)=>bi(j,w[O])):bi(I,w))){h&&h();const j=Ri;Ri=c;try{const O=[I,w===ir?void 0:v&&w[0]===ir?[]:w,d];u?u(s,3,O):s(...O),w=I}finally{Ri=j}}}else c.run()};return a&&a(_),c=new Xu(f),c.scheduler=o?()=>o(_,!1):_,d=P=>zf(P,!1,c),h=c.onStop=()=>{const P=_r.get(c);if(P){if(u)u(P,4);else for(const I of P)I();_r.delete(c)}},s?t?_(!0):w=c.run():o?o(_.bind(null,!0),!0):c.run(),S.pause=c.pause.bind(c),S.resume=c.resume.bind(c),S.stop=S,S}function _i(n,s=1/0,i){if(s<=0||!We(n)||n.__v_skip||(i=i||new Set,i.has(n)))return n;if(i.add(n),s--,et(n))_i(n.value,s,i);else if(Ee(n))for(let t=0;t<n.length;t++)_i(n[t],s,i);else if(sf(n)||xn(n))n.forEach(t=>{_i(t,s,i)});else if(uf(n)){for(const t in n)_i(n[t],s,i);for(const t of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,t)&&_i(n[t],s,i)}return n}/**
* @vue/runtime-core v3.5.12
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function qn(n,s,i,t){try{return t?n(...t):n()}catch(e){Wr(e,s,i)}}function Kt(n,s,i,t){if(Se(n)){const e=qn(n,s,i,t);return e&&Gu(e)&&e.catch(r=>{Wr(r,s,i)}),e}if(Ee(n)){const e=[];for(let r=0;r<n.length;r++)e.push(Kt(n[r],s,i,t));return e}}function Wr(n,s,i,t=!0){const e=s?s.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:o}=s&&s.appContext.config||Ue;if(s){let a=s.parent;const u=s.proxy,l=`https://vuejs.org/error-reference/#runtime-${i}`;for(;a;){const c=a.ec;if(c){for(let f=0;f<c.length;f++)if(c[f](n,u,l)===!1)return}a=a.parent}if(r){Si(),qn(r,null,10,[n,u,l]),wi();return}}Gf(n,i,e,t,o)}function Gf(n,s,i,t=!0,e=!1){if(e)throw n;console.error(n)}const rt=[];let Ut=-1;const un=[];let vi=null,tn=0;const vl=Promise.resolve();let br=null;function ml(n){const s=br||vl;return n?s.then(this?n.bind(this):n):s}function Kf(n){let s=Ut+1,i=rt.length;for(;s<i;){const t=s+i>>>1,e=rt[t],r=Hn(e);r<n||r===n&&e.flags&2?s=t+1:i=t}return s}function To(n){if(!(n.flags&1)){const s=Hn(n),i=rt[rt.length-1];!i||!(n.flags&2)&&s>=Hn(i)?rt.push(n):rt.splice(Kf(s),0,n),n.flags|=1,yl()}}function yl(){br||(br=vl.then(bl))}function Yf(n){Ee(n)?un.push(...n):vi&&n.id===-1?vi.splice(tn+1,0,n):n.flags&1||(un.push(n),n.flags|=1),yl()}function ea(n,s,i=Ut+1){for(;i<rt.length;i++){const t=rt[i];if(t&&t.flags&2){if(n&&t.id!==n.uid)continue;rt.splice(i,1),i--,t.flags&4&&(t.flags&=-2),t(),t.flags&4||(t.flags&=-2)}}}function _l(n){if(un.length){const s=[...new Set(un)].sort((i,t)=>Hn(i)-Hn(t));if(un.length=0,vi){vi.push(...s);return}for(vi=s,tn=0;tn<vi.length;tn++){const i=vi[tn];i.flags&4&&(i.flags&=-2),i.flags&8||i(),i.flags&=-2}vi=null,tn=0}}const Hn=n=>n.id==null?n.flags&2?-1:1/0:n.id;function bl(n){try{for(Ut=0;Ut<rt.length;Ut++){const s=rt[Ut];s&&!(s.flags&8)&&(s.flags&4&&(s.flags&=-2),qn(s,s.i,s.i?15:14),s.flags&4||(s.flags&=-2))}}finally{for(;Ut<rt.length;Ut++){const s=rt[Ut];s&&(s.flags&=-2)}Ut=-1,rt.length=0,_l(),br=null,(rt.length||un.length)&&bl()}}let Wt=null,El=null;function Er(n){const s=Wt;return Wt=n,El=n&&n.type.__scopeId||null,s}function $f(n,s=Wt,i){if(!s||n._n)return n;const t=(...e)=>{t._d&&ua(-1);const r=Er(s);let o;try{o=n(...e)}finally{Er(r),t._d&&ua(1)}return o};return t._n=!0,t._c=!0,t._d=!0,t}function Pi(n,s,i,t){const e=n.dirs,r=s&&s.dirs;for(let o=0;o<e.length;o++){const a=e[o];r&&(a.oldValue=r[o].value);let u=a.dir[t];u&&(Si(),Kt(u,i,8,[n.el,a,n,s]),wi())}}const qf=Symbol("_vte"),Xf=n=>n.__isTeleport;function So(n,s){n.shapeFlag&6&&n.component?(n.transition=s,So(n.component.subTree,s)):n.shapeFlag&128?(n.ssContent.transition=s.clone(n.ssContent),n.ssFallback.transition=s.clone(n.ssFallback)):n.transition=s}/*! #__NO_SIDE_EFFECTS__ */function Tl(n,s){return Se(n)?Ye({name:n.name},s,{setup:n}):n}function Sl(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function Bs(n,s,i,t,e=!1){if(Ee(n)){n.forEach((g,v)=>Bs(g,s&&(Ee(s)?s[v]:s),i,t,e));return}if(On(t)&&!e)return;const r=t.shapeFlag&4?xo(t.component):t.el,o=e?null:r,{i:a,r:u}=n,l=s&&s.r,c=a.refs===Ue?a.refs={}:a.refs,f=a.setupState,h=xe(f),d=f===Ue?()=>!1:g=>Re(h,g);if(l!=null&&l!==u&&($e(l)?(c[l]=null,d(l)&&(f[l]=null)):et(l)&&(l.value=null)),Se(u))qn(u,a,12,[o,c]);else{const g=$e(u),v=et(u);if(g||v){const m=()=>{if(n.f){const S=g?d(u)?f[u]:c[u]:u.value;e?Ee(S)&&lo(S,r):Ee(S)?S.includes(r)||S.push(r):g?(c[u]=[r],d(u)&&(f[u]=c[u])):(u.value=[r],n.k&&(c[n.k]=u.value))}else g?(c[u]=o,d(u)&&(f[u]=o)):v&&(u.value=o,n.k&&(c[n.k]=o))};o?(m.id=-1,pt(m,i)):m()}}}Vr().requestIdleCallback;Vr().cancelIdleCallback;const On=n=>!!n.type.__asyncLoader,wl=n=>n.type.__isKeepAlive;function Jf(n,s){Cl(n,"a",s)}function Qf(n,s){Cl(n,"da",s)}function Cl(n,s,i=st){const t=n.__wdc||(n.__wdc=()=>{let e=i;for(;e;){if(e.isDeactivated)return;e=e.parent}return n()});if(Gr(s,t,i),i){let e=i.parent;for(;e&&e.parent;)wl(e.parent.vnode)&&Zf(t,s,i,e),e=e.parent}}function Zf(n,s,i,t){const e=Gr(s,n,t,!0);Pl(()=>{lo(t[s],e)},i)}function Gr(n,s,i=st,t=!1){if(i){const e=i[n]||(i[n]=[]),r=s.__weh||(s.__weh=(...o)=>{Si();const a=Xn(i),u=Kt(s,i,n,o);return a(),wi(),u});return t?e.unshift(r):e.push(r),r}}const ui=n=>(s,i=st)=>{(!zn||n==="sp")&&Gr(n,(...t)=>s(...t),i)},eh=ui("bm"),kl=ui("m"),th=ui("bu"),ih=ui("u"),nh=ui("bum"),Pl=ui("um"),rh=ui("sp"),sh=ui("rtg"),oh=ui("rtc");function ah(n,s=st){Gr("ec",n,s)}const uh=Symbol.for("v-ndc"),Us=n=>n?$l(n)?xo(n):Us(n.parent):null,Dn=Ye(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>Us(n.parent),$root:n=>Us(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>wo(n),$forceUpdate:n=>n.f||(n.f=()=>{To(n.update)}),$nextTick:n=>n.n||(n.n=ml.bind(n.proxy)),$watch:n=>Rh.bind(n)}),ss=(n,s)=>n!==Ue&&!n.__isScriptSetup&&Re(n,s),lh={get({_:n},s){if(s==="__v_skip")return!0;const{ctx:i,setupState:t,data:e,props:r,accessCache:o,type:a,appContext:u}=n;let l;if(s[0]!=="$"){const d=o[s];if(d!==void 0)switch(d){case 1:return t[s];case 2:return e[s];case 4:return i[s];case 3:return r[s]}else{if(ss(t,s))return o[s]=1,t[s];if(e!==Ue&&Re(e,s))return o[s]=2,e[s];if((l=n.propsOptions[0])&&Re(l,s))return o[s]=3,r[s];if(i!==Ue&&Re(i,s))return o[s]=4,i[s];Hs&&(o[s]=0)}}const c=Dn[s];let f,h;if(c)return s==="$attrs"&&Ze(n.attrs,"get",""),c(n);if((f=a.__cssModules)&&(f=f[s]))return f;if(i!==Ue&&Re(i,s))return o[s]=4,i[s];if(h=u.config.globalProperties,Re(h,s))return h[s]},set({_:n},s,i){const{data:t,setupState:e,ctx:r}=n;return ss(e,s)?(e[s]=i,!0):t!==Ue&&Re(t,s)?(t[s]=i,!0):Re(n.props,s)||s[0]==="$"&&s.slice(1)in n?!1:(r[s]=i,!0)},has({_:{data:n,setupState:s,accessCache:i,ctx:t,appContext:e,propsOptions:r}},o){let a;return!!i[o]||n!==Ue&&Re(n,o)||ss(s,o)||(a=r[0])&&Re(a,o)||Re(t,o)||Re(Dn,o)||Re(e.config.globalProperties,o)},defineProperty(n,s,i){return i.get!=null?n._.accessCache[s]=0:Re(i,"value")&&this.set(n,s,i.value,null),Reflect.defineProperty(n,s,i)}};function ta(n){return Ee(n)?n.reduce((s,i)=>(s[i]=null,s),{}):n}let Hs=!0;function ch(n){const s=wo(n),i=n.proxy,t=n.ctx;Hs=!1,s.beforeCreate&&ia(s.beforeCreate,n,"bc");const{data:e,computed:r,methods:o,watch:a,provide:u,inject:l,created:c,beforeMount:f,mounted:h,beforeUpdate:d,updated:g,activated:v,deactivated:m,beforeDestroy:S,beforeUnmount:w,destroyed:_,unmounted:P,render:I,renderTracked:j,renderTriggered:O,errorCaptured:Z,serverPrefetch:te,expose:F,inheritAttrs:re,components:E,directives:b,filters:C}=s;if(l&&fh(l,t,null),o)for(const M in o){const G=o[M];Se(G)&&(t[M]=G.bind(i))}if(e){const M=e.call(i,i);We(M)&&(n.data=zr(M))}if(Hs=!0,r)for(const M in r){const G=r[M],ce=Se(G)?G.bind(i,i):Se(G.get)?G.get.bind(i,i):Gt,he=!Se(G)&&Se(G.set)?G.set.bind(i):Gt,K=It({get:ce,set:he});Object.defineProperty(t,M,{enumerable:!0,configurable:!0,get:()=>K.value,set:me=>K.value=me})}if(a)for(const M in a)xl(a[M],t,i,M);if(u){const M=Se(u)?u.call(i):u;Reflect.ownKeys(M).forEach(G=>{hr(G,M[G])})}c&&ia(c,n,"c");function k(M,G){Ee(G)?G.forEach(ce=>M(ce.bind(i))):G&&M(G.bind(i))}if(k(eh,f),k(kl,h),k(th,d),k(ih,g),k(Jf,v),k(Qf,m),k(ah,Z),k(oh,j),k(sh,O),k(nh,w),k(Pl,P),k(rh,te),Ee(F))if(F.length){const M=n.exposed||(n.exposed={});F.forEach(G=>{Object.defineProperty(M,G,{get:()=>i[G],set:ce=>i[G]=ce})})}else n.exposed||(n.exposed={});I&&n.render===Gt&&(n.render=I),re!=null&&(n.inheritAttrs=re),E&&(n.components=E),b&&(n.directives=b),te&&Sl(n)}function fh(n,s,i=Gt){Ee(n)&&(n=js(n));for(const t in n){const e=n[t];let r;We(e)?"default"in e?r=ri(e.from||t,e.default,!0):r=ri(e.from||t):r=ri(e),et(r)?Object.defineProperty(s,t,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):s[t]=r}}function ia(n,s,i){Kt(Ee(n)?n.map(t=>t.bind(s.proxy)):n.bind(s.proxy),s,i)}function xl(n,s,i,t){let e=t.includes(".")?Vl(i,t):()=>i[t];if($e(n)){const r=s[n];Se(r)&&dr(e,r)}else if(Se(n))dr(e,n.bind(i));else if(We(n))if(Ee(n))n.forEach(r=>xl(r,s,i,t));else{const r=Se(n.handler)?n.handler.bind(i):s[n.handler];Se(r)&&dr(e,r,n)}}function wo(n){const s=n.type,{mixins:i,extends:t}=s,{mixins:e,optionsCache:r,config:{optionMergeStrategies:o}}=n.appContext,a=r.get(s);let u;return a?u=a:!e.length&&!i&&!t?u=s:(u={},e.length&&e.forEach(l=>Tr(u,l,o,!0)),Tr(u,s,o)),We(s)&&r.set(s,u),u}function Tr(n,s,i,t=!1){const{mixins:e,extends:r}=s;r&&Tr(n,r,i,!0),e&&e.forEach(o=>Tr(n,o,i,!0));for(const o in s)if(!(t&&o==="expose")){const a=hh[o]||i&&i[o];n[o]=a?a(n[o],s[o]):s[o]}return n}const hh={data:na,props:ra,emits:ra,methods:Cn,computed:Cn,beforeCreate:it,created:it,beforeMount:it,mounted:it,beforeUpdate:it,updated:it,beforeDestroy:it,beforeUnmount:it,destroyed:it,unmounted:it,activated:it,deactivated:it,errorCaptured:it,serverPrefetch:it,components:Cn,directives:Cn,watch:gh,provide:na,inject:dh};function na(n,s){return s?n?function(){return Ye(Se(n)?n.call(this,this):n,Se(s)?s.call(this,this):s)}:s:n}function dh(n,s){return Cn(js(n),js(s))}function js(n){if(Ee(n)){const s={};for(let i=0;i<n.length;i++)s[n[i]]=n[i];return s}return n}function it(n,s){return n?[...new Set([].concat(n,s))]:s}function Cn(n,s){return n?Ye(Object.create(null),n,s):s}function ra(n,s){return n?Ee(n)&&Ee(s)?[...new Set([...n,...s])]:Ye(Object.create(null),ta(n),ta(s??{})):s}function gh(n,s){if(!n)return s;if(!s)return n;const i=Ye(Object.create(null),n);for(const t in s)i[t]=it(n[t],s[t]);return i}function Rl(){return{app:null,config:{isNativeTag:nf,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let ph=0;function vh(n,s){return function(t,e=null){Se(t)||(t=Ye({},t)),e!=null&&!We(e)&&(e=null);const r=Rl(),o=new WeakSet,a=[];let u=!1;const l=r.app={_uid:ph++,_component:t,_props:e,_container:null,_context:r,_instance:null,version:Qh,get config(){return r.config},set config(c){},use(c,...f){return o.has(c)||(c&&Se(c.install)?(o.add(c),c.install(l,...f)):Se(c)&&(o.add(c),c(l,...f))),l},mixin(c){return r.mixins.includes(c)||r.mixins.push(c),l},component(c,f){return f?(r.components[c]=f,l):r.components[c]},directive(c,f){return f?(r.directives[c]=f,l):r.directives[c]},mount(c,f,h){if(!u){const d=l._ceVNode||Tt(t,e);return d.appContext=r,h===!0?h="svg":h===!1&&(h=void 0),f&&s?s(d,c):n(d,c,h),u=!0,l._container=c,c.__vue_app__=l,xo(d.component)}},onUnmount(c){a.push(c)},unmount(){u&&(Kt(a,l._instance,16),n(null,l._container),delete l._container.__vue_app__)},provide(c,f){return r.provides[c]=f,l},runWithContext(c){const f=ln;ln=l;try{return c()}finally{ln=f}}};return l}}let ln=null;function hr(n,s){if(st){let i=st.provides;const t=st.parent&&st.parent.provides;t===i&&(i=st.provides=Object.create(t)),i[n]=s}}function ri(n,s,i=!1){const t=st||Wt;if(t||ln){const e=ln?ln._context.provides:t?t.parent==null?t.vnode.appContext&&t.vnode.appContext.provides:t.parent.provides:void 0;if(e&&n in e)return e[n];if(arguments.length>1)return i&&Se(s)?s.call(t&&t.proxy):s}}const Il={},Al=()=>Object.create(Il),Ll=n=>Object.getPrototypeOf(n)===Il;function mh(n,s,i,t=!1){const e={},r=Al();n.propsDefaults=Object.create(null),Ol(n,s,e,r);for(const o in n.propsOptions[0])o in e||(e[o]=void 0);i?n.props=t?e:cl(e):n.type.props?n.props=e:n.props=r,n.attrs=r}function yh(n,s,i,t){const{props:e,attrs:r,vnode:{patchFlag:o}}=n,a=xe(e),[u]=n.propsOptions;let l=!1;if((t||o>0)&&!(o&16)){if(o&8){const c=n.vnode.dynamicProps;for(let f=0;f<c.length;f++){let h=c[f];if(Kr(n.emitsOptions,h))continue;const d=s[h];if(u)if(Re(r,h))d!==r[h]&&(r[h]=d,l=!0);else{const g=Ei(h);e[g]=Vs(u,a,g,d,n,!1)}else d!==r[h]&&(r[h]=d,l=!0)}}}else{Ol(n,s,e,r)&&(l=!0);let c;for(const f in a)(!s||!Re(s,f)&&((c=ji(f))===f||!Re(s,c)))&&(u?i&&(i[f]!==void 0||i[c]!==void 0)&&(e[f]=Vs(u,a,f,void 0,n,!0)):delete e[f]);if(r!==a)for(const f in r)(!s||!Re(s,f))&&(delete r[f],l=!0)}l&&ei(n.attrs,"set","")}function Ol(n,s,i,t){const[e,r]=n.propsOptions;let o=!1,a;if(s)for(let u in s){if(Rn(u))continue;const l=s[u];let c;e&&Re(e,c=Ei(u))?!r||!r.includes(c)?i[c]=l:(a||(a={}))[c]=l:Kr(n.emitsOptions,u)||(!(u in t)||l!==t[u])&&(t[u]=l,o=!0)}if(r){const u=xe(i),l=a||Ue;for(let c=0;c<r.length;c++){const f=r[c];i[f]=Vs(e,u,f,l[f],n,!Re(l,f))}}return o}function Vs(n,s,i,t,e,r){const o=n[i];if(o!=null){const a=Re(o,"default");if(a&&t===void 0){const u=o.default;if(o.type!==Function&&!o.skipFactory&&Se(u)){const{propsDefaults:l}=e;if(i in l)t=l[i];else{const c=Xn(e);t=l[i]=u.call(null,s),c()}}else t=u;e.ce&&e.ce._setProp(i,t)}o[0]&&(r&&!a?t=!1:o[1]&&(t===""||t===ji(i))&&(t=!0))}return t}const _h=new WeakMap;function Dl(n,s,i=!1){const t=i?_h:s.propsCache,e=t.get(n);if(e)return e;const r=n.props,o={},a=[];let u=!1;if(!Se(n)){const c=f=>{u=!0;const[h,d]=Dl(f,s,!0);Ye(o,h),d&&a.push(...d)};!i&&s.mixins.length&&s.mixins.forEach(c),n.extends&&c(n.extends),n.mixins&&n.mixins.forEach(c)}if(!r&&!u)return We(n)&&t.set(n,an),an;if(Ee(r))for(let c=0;c<r.length;c++){const f=Ei(r[c]);sa(f)&&(o[f]=Ue)}else if(r)for(const c in r){const f=Ei(c);if(sa(f)){const h=r[c],d=o[f]=Ee(h)||Se(h)?{type:h}:Ye({},h),g=d.type;let v=!1,m=!0;if(Ee(g))for(let S=0;S<g.length;++S){const w=g[S],_=Se(w)&&w.name;if(_==="Boolean"){v=!0;break}else _==="String"&&(m=!1)}else v=Se(g)&&g.name==="Boolean";d[0]=v,d[1]=m,(v||Re(d,"default"))&&a.push(f)}}const l=[o,a];return We(n)&&t.set(n,l),l}function sa(n){return n[0]!=="$"&&!Rn(n)}const Ml=n=>n[0]==="_"||n==="$stable",Co=n=>Ee(n)?n.map(jt):[jt(n)],bh=(n,s,i)=>{if(s._n)return s;const t=$f((...e)=>Co(s(...e)),i);return t._c=!1,t},Nl=(n,s,i)=>{const t=n._ctx;for(const e in n){if(Ml(e))continue;const r=n[e];if(Se(r))s[e]=bh(e,r,t);else if(r!=null){const o=Co(r);s[e]=()=>o}}},Fl=(n,s)=>{const i=Co(s);n.slots.default=()=>i},Bl=(n,s,i)=>{for(const t in s)(i||t!=="_")&&(n[t]=s[t])},Eh=(n,s,i)=>{const t=n.slots=Al();if(n.vnode.shapeFlag&32){const e=s._;e?(Bl(t,s,i),i&&Yu(t,"_",e,!0)):Nl(s,t)}else s&&Fl(n,s)},Th=(n,s,i)=>{const{vnode:t,slots:e}=n;let r=!0,o=Ue;if(t.shapeFlag&32){const a=s._;a?i&&a===1?r=!1:Bl(e,s,i):(r=!s.$stable,Nl(s,e)),o=s}else s&&(Fl(n,s),o={default:1});if(r)for(const a in e)!Ml(a)&&o[a]==null&&delete e[a]},pt=Nh;function Sh(n){return wh(n)}function wh(n,s){const i=Vr();i.__VUE__=!0;const{insert:t,remove:e,patchProp:r,createElement:o,createText:a,createComment:u,setText:l,setElementText:c,parentNode:f,nextSibling:h,setScopeId:d=Gt,insertStaticContent:g}=n,v=(y,T,x,H=null,L=null,B=null,$=void 0,J=null,X=!!T.dynamicChildren)=>{if(y===T)return;y&&!bn(y,T)&&(H=A(y),me(y,L,B,!0),y=null),T.patchFlag===-2&&(X=!1,T.dynamicChildren=null);const{type:V,ref:fe,shapeFlag:ie}=T;switch(V){case Yr:m(y,T,x,H);break;case jn:S(y,T,x,H);break;case us:y==null&&w(T,x,H,$);break;case Qt:E(y,T,x,H,L,B,$,J,X);break;default:ie&1?I(y,T,x,H,L,B,$,J,X):ie&6?b(y,T,x,H,L,B,$,J,X):(ie&64||ie&128)&&V.process(y,T,x,H,L,B,$,J,X,ee)}fe!=null&&L&&Bs(fe,y&&y.ref,B,T||y,!T)},m=(y,T,x,H)=>{if(y==null)t(T.el=a(T.children),x,H);else{const L=T.el=y.el;T.children!==y.children&&l(L,T.children)}},S=(y,T,x,H)=>{y==null?t(T.el=u(T.children||""),x,H):T.el=y.el},w=(y,T,x,H)=>{[y.el,y.anchor]=g(y.children,T,x,H,y.el,y.anchor)},_=({el:y,anchor:T},x,H)=>{let L;for(;y&&y!==T;)L=h(y),t(y,x,H),y=L;t(T,x,H)},P=({el:y,anchor:T})=>{let x;for(;y&&y!==T;)x=h(y),e(y),y=x;e(T)},I=(y,T,x,H,L,B,$,J,X)=>{T.type==="svg"?$="svg":T.type==="math"&&($="mathml"),y==null?j(T,x,H,L,B,$,J,X):te(y,T,L,B,$,J,X)},j=(y,T,x,H,L,B,$,J)=>{let X,V;const{props:fe,shapeFlag:ie,transition:oe,dirs:pe}=y;if(X=y.el=o(y.type,B,fe&&fe.is,fe),ie&8?c(X,y.children):ie&16&&Z(y.children,X,null,H,L,os(y,B),$,J),pe&&Pi(y,null,H,"created"),O(X,y,y.scopeId,$,H),fe){for(const Ne in fe)Ne!=="value"&&!Rn(Ne)&&r(X,Ne,null,fe[Ne],B,H);"value"in fe&&r(X,"value",null,fe.value,B),(V=fe.onVnodeBeforeMount)&&Ft(V,H,y)}pe&&Pi(y,null,H,"beforeMount");const Ce=Ch(L,oe);Ce&&oe.beforeEnter(X),t(X,T,x),((V=fe&&fe.onVnodeMounted)||Ce||pe)&&pt(()=>{V&&Ft(V,H,y),Ce&&oe.enter(X),pe&&Pi(y,null,H,"mounted")},L)},O=(y,T,x,H,L)=>{if(x&&d(y,x),H)for(let B=0;B<H.length;B++)d(y,H[B]);if(L){let B=L.subTree;if(T===B||Wl(B.type)&&(B.ssContent===T||B.ssFallback===T)){const $=L.vnode;O(y,$,$.scopeId,$.slotScopeIds,L.parent)}}},Z=(y,T,x,H,L,B,$,J,X=0)=>{for(let V=X;V<y.length;V++){const fe=y[V]=J?mi(y[V]):jt(y[V]);v(null,fe,T,x,H,L,B,$,J)}},te=(y,T,x,H,L,B,$)=>{const J=T.el=y.el;let{patchFlag:X,dynamicChildren:V,dirs:fe}=T;X|=y.patchFlag&16;const ie=y.props||Ue,oe=T.props||Ue;let pe;if(x&&xi(x,!1),(pe=oe.onVnodeBeforeUpdate)&&Ft(pe,x,T,y),fe&&Pi(T,y,x,"beforeUpdate"),x&&xi(x,!0),(ie.innerHTML&&oe.innerHTML==null||ie.textContent&&oe.textContent==null)&&c(J,""),V?F(y.dynamicChildren,V,J,x,H,os(T,L),B):$||G(y,T,J,null,x,H,os(T,L),B,!1),X>0){if(X&16)re(J,ie,oe,x,L);else if(X&2&&ie.class!==oe.class&&r(J,"class",null,oe.class,L),X&4&&r(J,"style",ie.style,oe.style,L),X&8){const Ce=T.dynamicProps;for(let Ne=0;Ne<Ce.length;Ne++){const Ae=Ce[Ne],ct=ie[Ae],Xe=oe[Ae];(Xe!==ct||Ae==="value")&&r(J,Ae,ct,Xe,L,x)}}X&1&&y.children!==T.children&&c(J,T.children)}else!$&&V==null&&re(J,ie,oe,x,L);((pe=oe.onVnodeUpdated)||fe)&&pt(()=>{pe&&Ft(pe,x,T,y),fe&&Pi(T,y,x,"updated")},H)},F=(y,T,x,H,L,B,$)=>{for(let J=0;J<T.length;J++){const X=y[J],V=T[J],fe=X.el&&(X.type===Qt||!bn(X,V)||X.shapeFlag&70)?f(X.el):x;v(X,V,fe,null,H,L,B,$,!0)}},re=(y,T,x,H,L)=>{if(T!==x){if(T!==Ue)for(const B in T)!Rn(B)&&!(B in x)&&r(y,B,T[B],null,L,H);for(const B in x){if(Rn(B))continue;const $=x[B],J=T[B];$!==J&&B!=="value"&&r(y,B,J,$,L,H)}"value"in x&&r(y,"value",T.value,x.value,L)}},E=(y,T,x,H,L,B,$,J,X)=>{const V=T.el=y?y.el:a(""),fe=T.anchor=y?y.anchor:a("");let{patchFlag:ie,dynamicChildren:oe,slotScopeIds:pe}=T;pe&&(J=J?J.concat(pe):pe),y==null?(t(V,x,H),t(fe,x,H),Z(T.children||[],x,fe,L,B,$,J,X)):ie>0&&ie&64&&oe&&y.dynamicChildren?(F(y.dynamicChildren,oe,x,L,B,$,J),(T.key!=null||L&&T===L.subTree)&&Ul(y,T,!0)):G(y,T,x,fe,L,B,$,J,X)},b=(y,T,x,H,L,B,$,J,X)=>{T.slotScopeIds=J,y==null?T.shapeFlag&512?L.ctx.activate(T,x,H,$,X):C(T,x,H,L,B,$,X):N(y,T,X)},C=(y,T,x,H,L,B,$)=>{const J=y.component=Kh(y,H,L);if(wl(y)&&(J.ctx.renderer=ee),Yh(J,!1,$),J.asyncDep){if(L&&L.registerDep(J,k,$),!y.el){const X=J.subTree=Tt(jn);S(null,X,T,x)}}else k(J,y,T,x,L,B,$)},N=(y,T,x)=>{const H=T.component=y.component;if(Dh(y,T,x))if(H.asyncDep&&!H.asyncResolved){M(H,T,x);return}else H.next=T,H.update();else T.el=y.el,H.vnode=T},k=(y,T,x,H,L,B,$)=>{const J=()=>{if(y.isMounted){let{next:ie,bu:oe,u:pe,parent:Ce,vnode:Ne}=y;{const ft=Hl(y);if(ft){ie&&(ie.el=Ne.el,M(y,ie,$)),ft.asyncDep.then(()=>{y.isUnmounted||J()});return}}let Ae=ie,ct;xi(y,!1),ie?(ie.el=Ne.el,M(y,ie,$)):ie=Ne,oe&&ts(oe),(ct=ie.props&&ie.props.onVnodeBeforeUpdate)&&Ft(ct,Ce,ie,Ne),xi(y,!0);const Xe=as(y),Ct=y.subTree;y.subTree=Xe,v(Ct,Xe,f(Ct.el),A(Ct),y,L,B),ie.el=Xe.el,Ae===null&&Mh(y,Xe.el),pe&&pt(pe,L),(ct=ie.props&&ie.props.onVnodeUpdated)&&pt(()=>Ft(ct,Ce,ie,Ne),L)}else{let ie;const{el:oe,props:pe}=T,{bm:Ce,m:Ne,parent:Ae,root:ct,type:Xe}=y,Ct=On(T);if(xi(y,!1),Ce&&ts(Ce),!Ct&&(ie=pe&&pe.onVnodeBeforeMount)&&Ft(ie,Ae,T),xi(y,!0),oe&&Oe){const ft=()=>{y.subTree=as(y),Oe(oe,y.subTree,y,L,null)};Ct&&Xe.__asyncHydrate?Xe.__asyncHydrate(oe,y,ft):ft()}else{ct.ce&&ct.ce._injectChildStyle(Xe);const ft=y.subTree=as(y);v(null,ft,x,H,y,L,B),T.el=ft.el}if(Ne&&pt(Ne,L),!Ct&&(ie=pe&&pe.onVnodeMounted)){const ft=T;pt(()=>Ft(ie,Ae,ft),L)}(T.shapeFlag&256||Ae&&On(Ae.vnode)&&Ae.vnode.shapeFlag&256)&&y.a&&pt(y.a,L),y.isMounted=!0,T=x=H=null}};y.scope.on();const X=y.effect=new Xu(J);y.scope.off();const V=y.update=X.run.bind(X),fe=y.job=X.runIfDirty.bind(X);fe.i=y,fe.id=y.uid,X.scheduler=()=>To(fe),xi(y,!0),V()},M=(y,T,x)=>{T.component=y;const H=y.vnode.props;y.vnode=T,y.next=null,yh(y,T.props,H,x),Th(y,T.children,x),Si(),ea(y),wi()},G=(y,T,x,H,L,B,$,J,X=!1)=>{const V=y&&y.children,fe=y?y.shapeFlag:0,ie=T.children,{patchFlag:oe,shapeFlag:pe}=T;if(oe>0){if(oe&128){he(V,ie,x,H,L,B,$,J,X);return}else if(oe&256){ce(V,ie,x,H,L,B,$,J,X);return}}pe&8?(fe&16&&Me(V,L,B),ie!==V&&c(x,ie)):fe&16?pe&16?he(V,ie,x,H,L,B,$,J,X):Me(V,L,B,!0):(fe&8&&c(x,""),pe&16&&Z(ie,x,H,L,B,$,J,X))},ce=(y,T,x,H,L,B,$,J,X)=>{y=y||an,T=T||an;const V=y.length,fe=T.length,ie=Math.min(V,fe);let oe;for(oe=0;oe<ie;oe++){const pe=T[oe]=X?mi(T[oe]):jt(T[oe]);v(y[oe],pe,x,null,L,B,$,J,X)}V>fe?Me(y,L,B,!0,!1,ie):Z(T,x,H,L,B,$,J,X,ie)},he=(y,T,x,H,L,B,$,J,X)=>{let V=0;const fe=T.length;let ie=y.length-1,oe=fe-1;for(;V<=ie&&V<=oe;){const pe=y[V],Ce=T[V]=X?mi(T[V]):jt(T[V]);if(bn(pe,Ce))v(pe,Ce,x,null,L,B,$,J,X);else break;V++}for(;V<=ie&&V<=oe;){const pe=y[ie],Ce=T[oe]=X?mi(T[oe]):jt(T[oe]);if(bn(pe,Ce))v(pe,Ce,x,null,L,B,$,J,X);else break;ie--,oe--}if(V>ie){if(V<=oe){const pe=oe+1,Ce=pe<fe?T[pe].el:H;for(;V<=oe;)v(null,T[V]=X?mi(T[V]):jt(T[V]),x,Ce,L,B,$,J,X),V++}}else if(V>oe)for(;V<=ie;)me(y[V],L,B,!0),V++;else{const pe=V,Ce=V,Ne=new Map;for(V=Ce;V<=oe;V++){const ht=T[V]=X?mi(T[V]):jt(T[V]);ht.key!=null&&Ne.set(ht.key,V)}let Ae,ct=0;const Xe=oe-Ce+1;let Ct=!1,ft=0;const yn=new Array(Xe);for(V=0;V<Xe;V++)yn[V]=0;for(V=pe;V<=ie;V++){const ht=y[V];if(ct>=Xe){me(ht,L,B,!0);continue}let Nt;if(ht.key!=null)Nt=Ne.get(ht.key);else for(Ae=Ce;Ae<=oe;Ae++)if(yn[Ae-Ce]===0&&bn(ht,T[Ae])){Nt=Ae;break}Nt===void 0?me(ht,L,B,!0):(yn[Nt-Ce]=V+1,Nt>=ft?ft=Nt:Ct=!0,v(ht,T[Nt],x,null,L,B,$,J,X),ct++)}const qo=Ct?kh(yn):an;for(Ae=qo.length-1,V=Xe-1;V>=0;V--){const ht=Ce+V,Nt=T[ht],Xo=ht+1<fe?T[ht+1].el:H;yn[V]===0?v(null,Nt,x,Xo,L,B,$,J,X):Ct&&(Ae<0||V!==qo[Ae]?K(Nt,x,Xo,2):Ae--)}}},K=(y,T,x,H,L=null)=>{const{el:B,type:$,transition:J,children:X,shapeFlag:V}=y;if(V&6){K(y.component.subTree,T,x,H);return}if(V&128){y.suspense.move(T,x,H);return}if(V&64){$.move(y,T,x,ee);return}if($===Qt){t(B,T,x);for(let ie=0;ie<X.length;ie++)K(X[ie],T,x,H);t(y.anchor,T,x);return}if($===us){_(y,T,x);return}if(H!==2&&V&1&&J)if(H===0)J.beforeEnter(B),t(B,T,x),pt(()=>J.enter(B),L);else{const{leave:ie,delayLeave:oe,afterLeave:pe}=J,Ce=()=>t(B,T,x),Ne=()=>{ie(B,()=>{Ce(),pe&&pe()})};oe?oe(B,Ce,Ne):Ne()}else t(B,T,x)},me=(y,T,x,H=!1,L=!1)=>{const{type:B,props:$,ref:J,children:X,dynamicChildren:V,shapeFlag:fe,patchFlag:ie,dirs:oe,cacheIndex:pe}=y;if(ie===-2&&(L=!1),J!=null&&Bs(J,null,x,y,!0),pe!=null&&(T.renderCache[pe]=void 0),fe&256){T.ctx.deactivate(y);return}const Ce=fe&1&&oe,Ne=!On(y);let Ae;if(Ne&&(Ae=$&&$.onVnodeBeforeUnmount)&&Ft(Ae,T,y),fe&6)Ve(y.component,x,H);else{if(fe&128){y.suspense.unmount(x,H);return}Ce&&Pi(y,null,T,"beforeUnmount"),fe&64?y.type.remove(y,T,x,ee,H):V&&!V.hasOnce&&(B!==Qt||ie>0&&ie&64)?Me(V,T,x,!1,!0):(B===Qt&&ie&384||!L&&fe&16)&&Me(X,T,x),H&&ne(y)}(Ne&&(Ae=$&&$.onVnodeUnmounted)||Ce)&&pt(()=>{Ae&&Ft(Ae,T,y),Ce&&Pi(y,null,T,"unmounted")},x)},ne=y=>{const{type:T,el:x,anchor:H,transition:L}=y;if(T===Qt){qe(x,H);return}if(T===us){P(y);return}const B=()=>{e(x),L&&!L.persisted&&L.afterLeave&&L.afterLeave()};if(y.shapeFlag&1&&L&&!L.persisted){const{leave:$,delayLeave:J}=L,X=()=>$(x,B);J?J(y.el,B,X):X()}else B()},qe=(y,T)=>{let x;for(;y!==T;)x=h(y),e(y),y=x;e(T)},Ve=(y,T,x)=>{const{bum:H,scope:L,job:B,subTree:$,um:J,m:X,a:V}=y;oa(X),oa(V),H&&ts(H),L.stop(),B&&(B.flags|=8,me($,y,T,x)),J&&pt(J,T),pt(()=>{y.isUnmounted=!0},T),T&&T.pendingBranch&&!T.isUnmounted&&y.asyncDep&&!y.asyncResolved&&y.suspenseId===T.pendingId&&(T.deps--,T.deps===0&&T.resolve())},Me=(y,T,x,H=!1,L=!1,B=0)=>{for(let $=B;$<y.length;$++)me(y[$],T,x,H,L)},A=y=>{if(y.shapeFlag&6)return A(y.component.subTree);if(y.shapeFlag&128)return y.suspense.next();const T=h(y.anchor||y.el),x=T&&T[qf];return x?h(x):T};let q=!1;const U=(y,T,x)=>{y==null?T._vnode&&me(T._vnode,null,null,!0):v(T._vnode||null,y,T,null,null,null,x),T._vnode=y,q||(q=!0,ea(),_l(),q=!1)},ee={p:v,um:me,m:K,r:ne,mt:C,mc:Z,pc:G,pbc:F,n:A,o:n};let we,Oe;return{render:U,hydrate:we,createApp:vh(U,we)}}function os({type:n,props:s},i){return i==="svg"&&n==="foreignObject"||i==="mathml"&&n==="annotation-xml"&&s&&s.encoding&&s.encoding.includes("html")?void 0:i}function xi({effect:n,job:s},i){i?(n.flags|=32,s.flags|=4):(n.flags&=-33,s.flags&=-5)}function Ch(n,s){return(!n||n&&!n.pendingBranch)&&s&&!s.persisted}function Ul(n,s,i=!1){const t=n.children,e=s.children;if(Ee(t)&&Ee(e))for(let r=0;r<t.length;r++){const o=t[r];let a=e[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=e[r]=mi(e[r]),a.el=o.el),!i&&a.patchFlag!==-2&&Ul(o,a)),a.type===Yr&&(a.el=o.el)}}function kh(n){const s=n.slice(),i=[0];let t,e,r,o,a;const u=n.length;for(t=0;t<u;t++){const l=n[t];if(l!==0){if(e=i[i.length-1],n[e]<l){s[t]=e,i.push(t);continue}for(r=0,o=i.length-1;r<o;)a=r+o>>1,n[i[a]]<l?r=a+1:o=a;l<n[i[r]]&&(r>0&&(s[t]=i[r-1]),i[r]=t)}}for(r=i.length,o=i[r-1];r-- >0;)i[r]=o,o=s[o];return i}function Hl(n){const s=n.subTree.component;if(s)return s.asyncDep&&!s.asyncResolved?s:Hl(s)}function oa(n){if(n)for(let s=0;s<n.length;s++)n[s].flags|=8}const Ph=Symbol.for("v-scx"),xh=()=>ri(Ph);function dr(n,s,i){return jl(n,s,i)}function jl(n,s,i=Ue){const{immediate:t,deep:e,flush:r,once:o}=i,a=Ye({},i),u=s&&t||!s&&r!=="post";let l;if(zn){if(r==="sync"){const d=xh();l=d.__watcherHandles||(d.__watcherHandles=[])}else if(!u){const d=()=>{};return d.stop=Gt,d.resume=Gt,d.pause=Gt,d}}const c=st;a.call=(d,g,v)=>Kt(d,c,g,v);let f=!1;r==="post"?a.scheduler=d=>{pt(d,c&&c.suspense)}:r!=="sync"&&(f=!0,a.scheduler=(d,g)=>{g?d():To(d)}),a.augmentJob=d=>{s&&(d.flags|=4),f&&(d.flags|=2,c&&(d.id=c.uid,d.i=c))};const h=Wf(n,s,a);return zn&&(l?l.push(h):u&&h()),h}function Rh(n,s,i){const t=this.proxy,e=$e(n)?n.includes(".")?Vl(t,n):()=>t[n]:n.bind(t,t);let r;Se(s)?r=s:(r=s.handler,i=s);const o=Xn(this),a=jl(e,r.bind(t),i);return o(),a}function Vl(n,s){const i=s.split(".");return()=>{let t=n;for(let e=0;e<i.length&&t;e++)t=t[i[e]];return t}}const Ih=(n,s)=>s==="modelValue"||s==="model-value"?n.modelModifiers:n[`${s}Modifiers`]||n[`${Ei(s)}Modifiers`]||n[`${ji(s)}Modifiers`];function Ah(n,s,...i){if(n.isUnmounted)return;const t=n.vnode.props||Ue;let e=i;const r=s.startsWith("update:"),o=r&&Ih(t,s.slice(7));o&&(o.trim&&(e=i.map(c=>$e(c)?c.trim():c)),o.number&&(e=i.map(ff)));let a,u=t[a=es(s)]||t[a=es(Ei(s))];!u&&r&&(u=t[a=es(ji(s))]),u&&Kt(u,n,6,e);const l=t[a+"Once"];if(l){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,Kt(l,n,6,e)}}function zl(n,s,i=!1){const t=s.emitsCache,e=t.get(n);if(e!==void 0)return e;const r=n.emits;let o={},a=!1;if(!Se(n)){const u=l=>{const c=zl(l,s,!0);c&&(a=!0,Ye(o,c))};!i&&s.mixins.length&&s.mixins.forEach(u),n.extends&&u(n.extends),n.mixins&&n.mixins.forEach(u)}return!r&&!a?(We(n)&&t.set(n,null),null):(Ee(r)?r.forEach(u=>o[u]=null):Ye(o,r),We(n)&&t.set(n,o),o)}function Kr(n,s){return!n||!Ur(s)?!1:(s=s.slice(2).replace(/Once$/,""),Re(n,s[0].toLowerCase()+s.slice(1))||Re(n,ji(s))||Re(n,s))}function as(n){const{type:s,vnode:i,proxy:t,withProxy:e,propsOptions:[r],slots:o,attrs:a,emit:u,render:l,renderCache:c,props:f,data:h,setupState:d,ctx:g,inheritAttrs:v}=n,m=Er(n);let S,w;try{if(i.shapeFlag&4){const P=e||t,I=P;S=jt(l.call(I,P,c,f,d,h,g)),w=a}else{const P=s;S=jt(P.length>1?P(f,{attrs:a,slots:o,emit:u}):P(f,null)),w=s.props?a:Lh(a)}}catch(P){Mn.length=0,Wr(P,n,1),S=Tt(jn)}let _=S;if(w&&v!==!1){const P=Object.keys(w),{shapeFlag:I}=_;P.length&&I&7&&(r&&P.some(uo)&&(w=Oh(w,r)),_=fn(_,w,!1,!0))}return i.dirs&&(_=fn(_,null,!1,!0),_.dirs=_.dirs?_.dirs.concat(i.dirs):i.dirs),i.transition&&So(_,i.transition),S=_,Er(m),S}const Lh=n=>{let s;for(const i in n)(i==="class"||i==="style"||Ur(i))&&((s||(s={}))[i]=n[i]);return s},Oh=(n,s)=>{const i={};for(const t in n)(!uo(t)||!(t.slice(9)in s))&&(i[t]=n[t]);return i};function Dh(n,s,i){const{props:t,children:e,component:r}=n,{props:o,children:a,patchFlag:u}=s,l=r.emitsOptions;if(s.dirs||s.transition)return!0;if(i&&u>=0){if(u&1024)return!0;if(u&16)return t?aa(t,o,l):!!o;if(u&8){const c=s.dynamicProps;for(let f=0;f<c.length;f++){const h=c[f];if(o[h]!==t[h]&&!Kr(l,h))return!0}}}else return(e||a)&&(!a||!a.$stable)?!0:t===o?!1:t?o?aa(t,o,l):!0:!!o;return!1}function aa(n,s,i){const t=Object.keys(s);if(t.length!==Object.keys(n).length)return!0;for(let e=0;e<t.length;e++){const r=t[e];if(s[r]!==n[r]&&!Kr(i,r))return!0}return!1}function Mh({vnode:n,parent:s},i){for(;s;){const t=s.subTree;if(t.suspense&&t.suspense.activeBranch===n&&(t.el=n.el),t===n)(n=s.vnode).el=i,s=s.parent;else break}}const Wl=n=>n.__isSuspense;function Nh(n,s){s&&s.pendingBranch?Ee(n)?s.effects.push(...n):s.effects.push(n):Yf(n)}const Qt=Symbol.for("v-fgt"),Yr=Symbol.for("v-txt"),jn=Symbol.for("v-cmt"),us=Symbol.for("v-stc"),Mn=[];let yt=null;function Gl(n=!1){Mn.push(yt=n?null:[])}function Fh(){Mn.pop(),yt=Mn[Mn.length-1]||null}let Vn=1;function ua(n){Vn+=n,n<0&&yt&&(yt.hasOnce=!0)}function Kl(n){return n.dynamicChildren=Vn>0?yt||an:null,Fh(),Vn>0&&yt&&yt.push(n),n}function Bh(n,s,i,t,e,r){return Kl(ko(n,s,i,t,e,r,!0))}function Uh(n,s,i,t,e){return Kl(Tt(n,s,i,t,e,!0))}function Sr(n){return n?n.__v_isVNode===!0:!1}function bn(n,s){return n.type===s.type&&n.key===s.key}const Yl=({key:n})=>n??null,gr=({ref:n,ref_key:s,ref_for:i})=>(typeof n=="number"&&(n=""+n),n!=null?$e(n)||et(n)||Se(n)?{i:Wt,r:n,k:s,f:!!i}:n:null);function ko(n,s=null,i=null,t=0,e=null,r=n===Qt?0:1,o=!1,a=!1){const u={__v_isVNode:!0,__v_skip:!0,type:n,props:s,key:s&&Yl(s),ref:s&&gr(s),scopeId:El,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:t,dynamicProps:e,dynamicChildren:null,appContext:null,ctx:Wt};return a?(Po(u,i),r&128&&n.normalize(u)):i&&(u.shapeFlag|=$e(i)?8:16),Vn>0&&!o&&yt&&(u.patchFlag>0||r&6)&&u.patchFlag!==32&&yt.push(u),u}const Tt=Hh;function Hh(n,s=null,i=null,t=0,e=null,r=!1){if((!n||n===uh)&&(n=jn),Sr(n)){const a=fn(n,s,!0);return i&&Po(a,i),Vn>0&&!r&&yt&&(a.shapeFlag&6?yt[yt.indexOf(n)]=a:yt.push(a)),a.patchFlag=-2,a}if(Jh(n)&&(n=n.__vccOpts),s){s=jh(s);let{class:a,style:u}=s;a&&!$e(a)&&(s.class=ho(a)),We(u)&&(Eo(u)&&!Ee(u)&&(u=Ye({},u)),s.style=fo(u))}const o=$e(n)?1:Wl(n)?128:Xf(n)?64:We(n)?4:Se(n)?2:0;return ko(n,s,i,t,e,o,r,!0)}function jh(n){return n?Eo(n)||Ll(n)?Ye({},n):n:null}function fn(n,s,i=!1,t=!1){const{props:e,ref:r,patchFlag:o,children:a,transition:u}=n,l=s?zh(e||{},s):e,c={__v_isVNode:!0,__v_skip:!0,type:n.type,props:l,key:l&&Yl(l),ref:s&&s.ref?i&&r?Ee(r)?r.concat(gr(s)):[r,gr(s)]:gr(s):r,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:s&&n.type!==Qt?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:u,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&fn(n.ssContent),ssFallback:n.ssFallback&&fn(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return u&&t&&So(c,u.clone(c)),c}function Vh(n=" ",s=0){return Tt(Yr,null,n,s)}function jt(n){return n==null||typeof n=="boolean"?Tt(jn):Ee(n)?Tt(Qt,null,n.slice()):Sr(n)?mi(n):Tt(Yr,null,String(n))}function mi(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:fn(n)}function Po(n,s){let i=0;const{shapeFlag:t}=n;if(s==null)s=null;else if(Ee(s))i=16;else if(typeof s=="object")if(t&65){const e=s.default;e&&(e._c&&(e._d=!1),Po(n,e()),e._c&&(e._d=!0));return}else{i=32;const e=s._;!e&&!Ll(s)?s._ctx=Wt:e===3&&Wt&&(Wt.slots._===1?s._=1:(s._=2,n.patchFlag|=1024))}else Se(s)?(s={default:s,_ctx:Wt},i=32):(s=String(s),t&64?(i=16,s=[Vh(s)]):i=8);n.children=s,n.shapeFlag|=i}function zh(...n){const s={};for(let i=0;i<n.length;i++){const t=n[i];for(const e in t)if(e==="class")s.class!==t.class&&(s.class=ho([s.class,t.class]));else if(e==="style")s.style=fo([s.style,t.style]);else if(Ur(e)){const r=s[e],o=t[e];o&&r!==o&&!(Ee(r)&&r.includes(o))&&(s[e]=r?[].concat(r,o):o)}else e!==""&&(s[e]=t[e])}return s}function Ft(n,s,i,t=null){Kt(n,s,7,[i,t])}const Wh=Rl();let Gh=0;function Kh(n,s,i){const t=n.type,e=(s?s.appContext:n.appContext)||Wh,r={uid:Gh++,vnode:n,type:t,parent:s,appContext:e,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new qu(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:s?s.provides:Object.create(e.provides),ids:s?s.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Dl(t,e),emitsOptions:zl(t,e),emit:null,emitted:null,propsDefaults:Ue,inheritAttrs:t.inheritAttrs,ctx:Ue,data:Ue,props:Ue,attrs:Ue,slots:Ue,refs:Ue,setupState:Ue,setupContext:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=s?s.root:r,r.emit=Ah.bind(null,r),n.ce&&n.ce(r),r}let st=null,wr,zs;{const n=Vr(),s=(i,t)=>{let e;return(e=n[i])||(e=n[i]=[]),e.push(t),r=>{e.length>1?e.forEach(o=>o(r)):e[0](r)}};wr=s("__VUE_INSTANCE_SETTERS__",i=>st=i),zs=s("__VUE_SSR_SETTERS__",i=>zn=i)}const Xn=n=>{const s=st;return wr(n),n.scope.on(),()=>{n.scope.off(),wr(s)}},la=()=>{st&&st.scope.off(),wr(null)};function $l(n){return n.vnode.shapeFlag&4}let zn=!1;function Yh(n,s=!1,i=!1){s&&zs(s);const{props:t,children:e}=n.vnode,r=$l(n);mh(n,t,r,s),Eh(n,e,i);const o=r?$h(n,s):void 0;return s&&zs(!1),o}function $h(n,s){const i=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,lh);const{setup:t}=i;if(t){Si();const e=n.setupContext=t.length>1?Xh(n):null,r=Xn(n),o=qn(t,n,0,[n.props,e]),a=Gu(o);if(wi(),r(),(a||n.sp)&&!On(n)&&Sl(n),a){if(o.then(la,la),s)return o.then(u=>{ca(n,u,s)}).catch(u=>{Wr(u,n,0)});n.asyncDep=o}else ca(n,o,s)}else ql(n,s)}function ca(n,s,i){Se(s)?n.type.__ssrInlineRender?n.ssrRender=s:n.render=s:We(s)&&(n.setupState=pl(s)),ql(n,i)}let fa;function ql(n,s,i){const t=n.type;if(!n.render){if(!s&&fa&&!t.render){const e=t.template||wo(n).template;if(e){const{isCustomElement:r,compilerOptions:o}=n.appContext.config,{delimiters:a,compilerOptions:u}=t,l=Ye(Ye({isCustomElement:r,delimiters:a},o),u);t.render=fa(e,l)}}n.render=t.render||Gt}{const e=Xn(n);Si();try{ch(n)}finally{wi(),e()}}}const qh={get(n,s){return Ze(n,"get",""),n[s]}};function Xh(n){const s=i=>{n.exposed=i||{}};return{attrs:new Proxy(n.attrs,qh),slots:n.slots,emit:n.emit,expose:s}}function xo(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(pl(hl(n.exposed)),{get(s,i){if(i in s)return s[i];if(i in Dn)return Dn[i](n)},has(s,i){return i in s||i in Dn}})):n.proxy}function Jh(n){return Se(n)&&"__vccOpts"in n}const It=(n,s)=>Vf(n,s,zn);function Xl(n,s,i){const t=arguments.length;return t===2?We(s)&&!Ee(s)?Sr(s)?Tt(n,null,[s]):Tt(n,s):Tt(n,null,s):(t>3?i=Array.prototype.slice.call(arguments,2):t===3&&Sr(i)&&(i=[i]),Tt(n,s,i))}const Qh="3.5.12";/**
* @vue/runtime-dom v3.5.12
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ws;const ha=typeof window<"u"&&window.trustedTypes;if(ha)try{Ws=ha.createPolicy("vue",{createHTML:n=>n})}catch{}const Jl=Ws?n=>Ws.createHTML(n):n=>n,Zh="http://www.w3.org/2000/svg",ed="http://www.w3.org/1998/Math/MathML",Xt=typeof document<"u"?document:null,da=Xt&&Xt.createElement("template"),td={insert:(n,s,i)=>{s.insertBefore(n,i||null)},remove:n=>{const s=n.parentNode;s&&s.removeChild(n)},createElement:(n,s,i,t)=>{const e=s==="svg"?Xt.createElementNS(Zh,n):s==="mathml"?Xt.createElementNS(ed,n):i?Xt.createElement(n,{is:i}):Xt.createElement(n);return n==="select"&&t&&t.multiple!=null&&e.setAttribute("multiple",t.multiple),e},createText:n=>Xt.createTextNode(n),createComment:n=>Xt.createComment(n),setText:(n,s)=>{n.nodeValue=s},setElementText:(n,s)=>{n.textContent=s},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>Xt.querySelector(n),setScopeId(n,s){n.setAttribute(s,"")},insertStaticContent(n,s,i,t,e,r){const o=i?i.previousSibling:s.lastChild;if(e&&(e===r||e.nextSibling))for(;s.insertBefore(e.cloneNode(!0),i),!(e===r||!(e=e.nextSibling)););else{da.innerHTML=Jl(t==="svg"?`<svg>${n}</svg>`:t==="mathml"?`<math>${n}</math>`:n);const a=da.content;if(t==="svg"||t==="mathml"){const u=a.firstChild;for(;u.firstChild;)a.appendChild(u.firstChild);a.removeChild(u)}s.insertBefore(a,i)}return[o?o.nextSibling:s.firstChild,i?i.previousSibling:s.lastChild]}},id=Symbol("_vtc");function nd(n,s,i){const t=n[id];t&&(s=(s?[s,...t]:[...t]).join(" ")),s==null?n.removeAttribute("class"):i?n.setAttribute("class",s):n.className=s}const ga=Symbol("_vod"),rd=Symbol("_vsh"),sd=Symbol(""),od=/(^|;)\s*display\s*:/;function ad(n,s,i){const t=n.style,e=$e(i);let r=!1;if(i&&!e){if(s)if($e(s))for(const o of s.split(";")){const a=o.slice(0,o.indexOf(":")).trim();i[a]==null&&pr(t,a,"")}else for(const o in s)i[o]==null&&pr(t,o,"");for(const o in i)o==="display"&&(r=!0),pr(t,o,i[o])}else if(e){if(s!==i){const o=t[sd];o&&(i+=";"+o),t.cssText=i,r=od.test(i)}}else s&&n.removeAttribute("style");ga in n&&(n[ga]=r?t.display:"",n[rd]&&(t.display="none"))}const pa=/\s*!important$/;function pr(n,s,i){if(Ee(i))i.forEach(t=>pr(n,s,t));else if(i==null&&(i=""),s.startsWith("--"))n.setProperty(s,i);else{const t=ud(n,s);pa.test(i)?n.setProperty(ji(t),i.replace(pa,""),"important"):n[t]=i}}const va=["Webkit","Moz","ms"],ls={};function ud(n,s){const i=ls[s];if(i)return i;let t=Ei(s);if(t!=="filter"&&t in n)return ls[s]=t;t=Ku(t);for(let e=0;e<va.length;e++){const r=va[e]+t;if(r in n)return ls[s]=r}return s}const ma="http://www.w3.org/1999/xlink";function ya(n,s,i,t,e,r=mf(s)){t&&s.startsWith("xlink:")?i==null?n.removeAttributeNS(ma,s.slice(6,s.length)):n.setAttributeNS(ma,s,i):i==null||r&&!$u(i)?n.removeAttribute(s):n.setAttribute(s,r?"":vn(i)?String(i):i)}function _a(n,s,i,t,e){if(s==="innerHTML"||s==="textContent"){i!=null&&(n[s]=s==="innerHTML"?Jl(i):i);return}const r=n.tagName;if(s==="value"&&r!=="PROGRESS"&&!r.includes("-")){const a=r==="OPTION"?n.getAttribute("value")||"":n.value,u=i==null?n.type==="checkbox"?"on":"":String(i);(a!==u||!("_value"in n))&&(n.value=u),i==null&&n.removeAttribute(s),n._value=i;return}let o=!1;if(i===""||i==null){const a=typeof n[s];a==="boolean"?i=$u(i):i==null&&a==="string"?(i="",o=!0):a==="number"&&(i=0,o=!0)}try{n[s]=i}catch{}o&&n.removeAttribute(e||s)}function ld(n,s,i,t){n.addEventListener(s,i,t)}function cd(n,s,i,t){n.removeEventListener(s,i,t)}const ba=Symbol("_vei");function fd(n,s,i,t,e=null){const r=n[ba]||(n[ba]={}),o=r[s];if(t&&o)o.value=t;else{const[a,u]=hd(s);if(t){const l=r[s]=pd(t,e);ld(n,a,l,u)}else o&&(cd(n,a,o,u),r[s]=void 0)}}const Ea=/(?:Once|Passive|Capture)$/;function hd(n){let s;if(Ea.test(n)){s={};let t;for(;t=n.match(Ea);)n=n.slice(0,n.length-t[0].length),s[t[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):ji(n.slice(2)),s]}let cs=0;const dd=Promise.resolve(),gd=()=>cs||(dd.then(()=>cs=0),cs=Date.now());function pd(n,s){const i=t=>{if(!t._vts)t._vts=Date.now();else if(t._vts<=i.attached)return;Kt(vd(t,i.value),s,5,[t])};return i.value=n,i.attached=gd(),i}function vd(n,s){if(Ee(s)){const i=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{i.call(n),n._stopped=!0},s.map(t=>e=>!e._stopped&&t&&t(e))}else return s}const Ta=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,md=(n,s,i,t,e,r)=>{const o=e==="svg";s==="class"?nd(n,t,o):s==="style"?ad(n,i,t):Ur(s)?uo(s)||fd(n,s,i,t,r):(s[0]==="."?(s=s.slice(1),!0):s[0]==="^"?(s=s.slice(1),!1):yd(n,s,t,o))?(_a(n,s,t),!n.tagName.includes("-")&&(s==="value"||s==="checked"||s==="selected")&&ya(n,s,t,o,r,s!=="value")):n._isVueCE&&(/[A-Z]/.test(s)||!$e(t))?_a(n,Ei(s),t,r,s):(s==="true-value"?n._trueValue=t:s==="false-value"&&(n._falseValue=t),ya(n,s,t,o))};function yd(n,s,i,t){if(t)return!!(s==="innerHTML"||s==="textContent"||s in n&&Ta(s)&&Se(i));if(s==="spellcheck"||s==="draggable"||s==="translate"||s==="form"||s==="list"&&n.tagName==="INPUT"||s==="type"&&n.tagName==="TEXTAREA")return!1;if(s==="width"||s==="height"){const e=n.tagName;if(e==="IMG"||e==="VIDEO"||e==="CANVAS"||e==="SOURCE")return!1}return Ta(s)&&$e(i)?!1:s in n}const _d=Ye({patchProp:md},td);let Sa;function bd(){return Sa||(Sa=Sh(_d))}const Ed=(...n)=>{const s=bd().createApp(...n),{mount:i}=s;return s.mount=t=>{const e=Sd(t);if(!e)return;const r=s._component;!Se(r)&&!r.render&&!r.template&&(r.template=e.innerHTML),e.nodeType===1&&(e.textContent="");const o=i(e,!1,Td(e));return e instanceof Element&&(e.removeAttribute("v-cloak"),e.setAttribute("data-v-app","")),o},s};function Td(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function Sd(n){return $e(n)?document.querySelector(n):n}var wd=!1;/*!
 * pinia v2.2.6
 * (c) 2024 Eduardo San Martin Morote
 * @license MIT
 */const Cd=Symbol();var wa;(function(n){n.direct="direct",n.patchObject="patch object",n.patchFunction="patch function"})(wa||(wa={}));function kd(){const n=yf(!0),s=n.run(()=>dl({}));let i=[],t=[];const e=hl({install(r){e._a=r,r.provide(Cd,e),r.config.globalProperties.$pinia=e,t.forEach(o=>i.push(o)),t=[]},use(r){return!this._a&&!wd?t.push(r):i.push(r),this},_p:i,_a:null,_e:n,_s:new Map,state:s});return e}/*!
  * vue-router v4.4.5
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const nn=typeof document<"u";function Ql(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function Pd(n){return n.__esModule||n[Symbol.toStringTag]==="Module"||n.default&&Ql(n.default)}const Le=Object.assign;function fs(n,s){const i={};for(const t in s){const e=s[t];i[t]=Dt(e)?e.map(n):n(e)}return i}const Nn=()=>{},Dt=Array.isArray,Zl=/#/g,xd=/&/g,Rd=/\//g,Id=/=/g,Ad=/\?/g,ec=/\+/g,Ld=/%5B/g,Od=/%5D/g,tc=/%5E/g,Dd=/%60/g,ic=/%7B/g,Md=/%7C/g,nc=/%7D/g,Nd=/%20/g;function Ro(n){return encodeURI(""+n).replace(Md,"|").replace(Ld,"[").replace(Od,"]")}function Fd(n){return Ro(n).replace(ic,"{").replace(nc,"}").replace(tc,"^")}function Gs(n){return Ro(n).replace(ec,"%2B").replace(Nd,"+").replace(Zl,"%23").replace(xd,"%26").replace(Dd,"`").replace(ic,"{").replace(nc,"}").replace(tc,"^")}function Bd(n){return Gs(n).replace(Id,"%3D")}function Ud(n){return Ro(n).replace(Zl,"%23").replace(Ad,"%3F")}function Hd(n){return n==null?"":Ud(n).replace(Rd,"%2F")}function Wn(n){try{return decodeURIComponent(""+n)}catch{}return""+n}const jd=/\/$/,Vd=n=>n.replace(jd,"");function hs(n,s,i="/"){let t,e={},r="",o="";const a=s.indexOf("#");let u=s.indexOf("?");return a<u&&a>=0&&(u=-1),u>-1&&(t=s.slice(0,u),r=s.slice(u+1,a>-1?a:s.length),e=n(r)),a>-1&&(t=t||s.slice(0,a),o=s.slice(a,s.length)),t=Kd(t??s,i),{fullPath:t+(r&&"?")+r+o,path:t,query:e,hash:Wn(o)}}function zd(n,s){const i=s.query?n(s.query):"";return s.path+(i&&"?")+i+(s.hash||"")}function Ca(n,s){return!s||!n.toLowerCase().startsWith(s.toLowerCase())?n:n.slice(s.length)||"/"}function Wd(n,s,i){const t=s.matched.length-1,e=i.matched.length-1;return t>-1&&t===e&&hn(s.matched[t],i.matched[e])&&rc(s.params,i.params)&&n(s.query)===n(i.query)&&s.hash===i.hash}function hn(n,s){return(n.aliasOf||n)===(s.aliasOf||s)}function rc(n,s){if(Object.keys(n).length!==Object.keys(s).length)return!1;for(const i in n)if(!Gd(n[i],s[i]))return!1;return!0}function Gd(n,s){return Dt(n)?ka(n,s):Dt(s)?ka(s,n):n===s}function ka(n,s){return Dt(s)?n.length===s.length&&n.every((i,t)=>i===s[t]):n.length===1&&n[0]===s}function Kd(n,s){if(n.startsWith("/"))return n;if(!n)return s;const i=s.split("/"),t=n.split("/"),e=t[t.length-1];(e===".."||e===".")&&t.push("");let r=i.length-1,o,a;for(o=0;o<t.length;o++)if(a=t[o],a!==".")if(a==="..")r>1&&r--;else break;return i.slice(0,r).join("/")+"/"+t.slice(o).join("/")}const fi={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Gn;(function(n){n.pop="pop",n.push="push"})(Gn||(Gn={}));var Fn;(function(n){n.back="back",n.forward="forward",n.unknown=""})(Fn||(Fn={}));function Yd(n){if(!n)if(nn){const s=document.querySelector("base");n=s&&s.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),Vd(n)}const $d=/^[^#]+#/;function qd(n,s){return n.replace($d,"#")+s}function Xd(n,s){const i=document.documentElement.getBoundingClientRect(),t=n.getBoundingClientRect();return{behavior:s.behavior,left:t.left-i.left-(s.left||0),top:t.top-i.top-(s.top||0)}}const $r=()=>({left:window.scrollX,top:window.scrollY});function Jd(n){let s;if("el"in n){const i=n.el,t=typeof i=="string"&&i.startsWith("#"),e=typeof i=="string"?t?document.getElementById(i.slice(1)):document.querySelector(i):i;if(!e)return;s=Xd(e,n)}else s=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(s):window.scrollTo(s.left!=null?s.left:window.scrollX,s.top!=null?s.top:window.scrollY)}function Pa(n,s){return(history.state?history.state.position-s:-1)+n}const Ks=new Map;function Qd(n,s){Ks.set(n,s)}function Zd(n){const s=Ks.get(n);return Ks.delete(n),s}let eg=()=>location.protocol+"//"+location.host;function sc(n,s){const{pathname:i,search:t,hash:e}=s,r=n.indexOf("#");if(r>-1){let a=e.includes(n.slice(r))?n.slice(r).length:1,u=e.slice(a);return u[0]!=="/"&&(u="/"+u),Ca(u,"")}return Ca(i,n)+t+e}function tg(n,s,i,t){let e=[],r=[],o=null;const a=({state:h})=>{const d=sc(n,location),g=i.value,v=s.value;let m=0;if(h){if(i.value=d,s.value=h,o&&o===g){o=null;return}m=v?h.position-v.position:0}else t(d);e.forEach(S=>{S(i.value,g,{delta:m,type:Gn.pop,direction:m?m>0?Fn.forward:Fn.back:Fn.unknown})})};function u(){o=i.value}function l(h){e.push(h);const d=()=>{const g=e.indexOf(h);g>-1&&e.splice(g,1)};return r.push(d),d}function c(){const{history:h}=window;h.state&&h.replaceState(Le({},h.state,{scroll:$r()}),"")}function f(){for(const h of r)h();r=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",c)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",c,{passive:!0}),{pauseListeners:u,listen:l,destroy:f}}function xa(n,s,i,t=!1,e=!1){return{back:n,current:s,forward:i,replaced:t,position:window.history.length,scroll:e?$r():null}}function ig(n){const{history:s,location:i}=window,t={value:sc(n,i)},e={value:s.state};e.value||r(t.value,{back:null,current:t.value,forward:null,position:s.length-1,replaced:!0,scroll:null},!0);function r(u,l,c){const f=n.indexOf("#"),h=f>-1?(i.host&&document.querySelector("base")?n:n.slice(f))+u:eg()+n+u;try{s[c?"replaceState":"pushState"](l,"",h),e.value=l}catch(d){console.error(d),i[c?"replace":"assign"](h)}}function o(u,l){const c=Le({},s.state,xa(e.value.back,u,e.value.forward,!0),l,{position:e.value.position});r(u,c,!0),t.value=u}function a(u,l){const c=Le({},e.value,s.state,{forward:u,scroll:$r()});r(c.current,c,!0);const f=Le({},xa(t.value,u,null),{position:c.position+1},l);r(u,f,!1),t.value=u}return{location:t,state:e,push:a,replace:o}}function ng(n){n=Yd(n);const s=ig(n),i=tg(n,s.state,s.location,s.replace);function t(r,o=!0){o||i.pauseListeners(),history.go(r)}const e=Le({location:"",base:n,go:t,createHref:qd.bind(null,n)},s,i);return Object.defineProperty(e,"location",{enumerable:!0,get:()=>s.location.value}),Object.defineProperty(e,"state",{enumerable:!0,get:()=>s.state.value}),e}function rg(n){return typeof n=="string"||n&&typeof n=="object"}function oc(n){return typeof n=="string"||typeof n=="symbol"}const ac=Symbol("");var Ra;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(Ra||(Ra={}));function dn(n,s){return Le(new Error,{type:n,[ac]:!0},s)}function qt(n,s){return n instanceof Error&&ac in n&&(s==null||!!(n.type&s))}const Ia="[^/]+?",sg={sensitive:!1,strict:!1,start:!0,end:!0},og=/[.+*?^${}()[\]/\\]/g;function ag(n,s){const i=Le({},sg,s),t=[];let e=i.start?"^":"";const r=[];for(const l of n){const c=l.length?[]:[90];i.strict&&!l.length&&(e+="/");for(let f=0;f<l.length;f++){const h=l[f];let d=40+(i.sensitive?.25:0);if(h.type===0)f||(e+="/"),e+=h.value.replace(og,"\\$&"),d+=40;else if(h.type===1){const{value:g,repeatable:v,optional:m,regexp:S}=h;r.push({name:g,repeatable:v,optional:m});const w=S||Ia;if(w!==Ia){d+=10;try{new RegExp(`(${w})`)}catch(P){throw new Error(`Invalid custom RegExp for param "${g}" (${w}): `+P.message)}}let _=v?`((?:${w})(?:/(?:${w}))*)`:`(${w})`;f||(_=m&&l.length<2?`(?:/${_})`:"/"+_),m&&(_+="?"),e+=_,d+=20,m&&(d+=-8),v&&(d+=-20),w===".*"&&(d+=-50)}c.push(d)}t.push(c)}if(i.strict&&i.end){const l=t.length-1;t[l][t[l].length-1]+=.7000000000000001}i.strict||(e+="/?"),i.end?e+="$":i.strict&&(e+="(?:/|$)");const o=new RegExp(e,i.sensitive?"":"i");function a(l){const c=l.match(o),f={};if(!c)return null;for(let h=1;h<c.length;h++){const d=c[h]||"",g=r[h-1];f[g.name]=d&&g.repeatable?d.split("/"):d}return f}function u(l){let c="",f=!1;for(const h of n){(!f||!c.endsWith("/"))&&(c+="/"),f=!1;for(const d of h)if(d.type===0)c+=d.value;else if(d.type===1){const{value:g,repeatable:v,optional:m}=d,S=g in l?l[g]:"";if(Dt(S)&&!v)throw new Error(`Provided param "${g}" is an array but it is not repeatable (* or + modifiers)`);const w=Dt(S)?S.join("/"):S;if(!w)if(m)h.length<2&&(c.endsWith("/")?c=c.slice(0,-1):f=!0);else throw new Error(`Missing required param "${g}"`);c+=w}}return c||"/"}return{re:o,score:t,keys:r,parse:a,stringify:u}}function ug(n,s){let i=0;for(;i<n.length&&i<s.length;){const t=s[i]-n[i];if(t)return t;i++}return n.length<s.length?n.length===1&&n[0]===80?-1:1:n.length>s.length?s.length===1&&s[0]===80?1:-1:0}function uc(n,s){let i=0;const t=n.score,e=s.score;for(;i<t.length&&i<e.length;){const r=ug(t[i],e[i]);if(r)return r;i++}if(Math.abs(e.length-t.length)===1){if(Aa(t))return 1;if(Aa(e))return-1}return e.length-t.length}function Aa(n){const s=n[n.length-1];return n.length>0&&s[s.length-1]<0}const lg={type:0,value:""},cg=/[a-zA-Z0-9_]/;function fg(n){if(!n)return[[]];if(n==="/")return[[lg]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function s(d){throw new Error(`ERR (${i})/"${l}": ${d}`)}let i=0,t=i;const e=[];let r;function o(){r&&e.push(r),r=[]}let a=0,u,l="",c="";function f(){l&&(i===0?r.push({type:0,value:l}):i===1||i===2||i===3?(r.length>1&&(u==="*"||u==="+")&&s(`A repeatable param (${l}) must be alone in its segment. eg: '/:ids+.`),r.push({type:1,value:l,regexp:c,repeatable:u==="*"||u==="+",optional:u==="*"||u==="?"})):s("Invalid state to consume buffer"),l="")}function h(){l+=u}for(;a<n.length;){if(u=n[a++],u==="\\"&&i!==2){t=i,i=4;continue}switch(i){case 0:u==="/"?(l&&f(),o()):u===":"?(f(),i=1):h();break;case 4:h(),i=t;break;case 1:u==="("?i=2:cg.test(u)?h():(f(),i=0,u!=="*"&&u!=="?"&&u!=="+"&&a--);break;case 2:u===")"?c[c.length-1]=="\\"?c=c.slice(0,-1)+u:i=3:c+=u;break;case 3:f(),i=0,u!=="*"&&u!=="?"&&u!=="+"&&a--,c="";break;default:s("Unknown state");break}}return i===2&&s(`Unfinished custom RegExp for param "${l}"`),f(),o(),e}function hg(n,s,i){const t=ag(fg(n.path),i),e=Le(t,{record:n,parent:s,children:[],alias:[]});return s&&!e.record.aliasOf==!s.record.aliasOf&&s.children.push(e),e}function dg(n,s){const i=[],t=new Map;s=Ma({strict:!1,end:!0,sensitive:!1},s);function e(f){return t.get(f)}function r(f,h,d){const g=!d,v=Oa(f);v.aliasOf=d&&d.record;const m=Ma(s,f),S=[v];if("alias"in f){const P=typeof f.alias=="string"?[f.alias]:f.alias;for(const I of P)S.push(Oa(Le({},v,{components:d?d.record.components:v.components,path:I,aliasOf:d?d.record:v})))}let w,_;for(const P of S){const{path:I}=P;if(h&&I[0]!=="/"){const j=h.record.path,O=j[j.length-1]==="/"?"":"/";P.path=h.record.path+(I&&O+I)}if(w=hg(P,h,m),d?d.alias.push(w):(_=_||w,_!==w&&_.alias.push(w),g&&f.name&&!Da(w)&&o(f.name)),lc(w)&&u(w),v.children){const j=v.children;for(let O=0;O<j.length;O++)r(j[O],w,d&&d.children[O])}d=d||w}return _?()=>{o(_)}:Nn}function o(f){if(oc(f)){const h=t.get(f);h&&(t.delete(f),i.splice(i.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=i.indexOf(f);h>-1&&(i.splice(h,1),f.record.name&&t.delete(f.record.name),f.children.forEach(o),f.alias.forEach(o))}}function a(){return i}function u(f){const h=vg(f,i);i.splice(h,0,f),f.record.name&&!Da(f)&&t.set(f.record.name,f)}function l(f,h){let d,g={},v,m;if("name"in f&&f.name){if(d=t.get(f.name),!d)throw dn(1,{location:f});m=d.record.name,g=Le(La(h.params,d.keys.filter(_=>!_.optional).concat(d.parent?d.parent.keys.filter(_=>_.optional):[]).map(_=>_.name)),f.params&&La(f.params,d.keys.map(_=>_.name))),v=d.stringify(g)}else if(f.path!=null)v=f.path,d=i.find(_=>_.re.test(v)),d&&(g=d.parse(v),m=d.record.name);else{if(d=h.name?t.get(h.name):i.find(_=>_.re.test(h.path)),!d)throw dn(1,{location:f,currentLocation:h});m=d.record.name,g=Le({},h.params,f.params),v=d.stringify(g)}const S=[];let w=d;for(;w;)S.unshift(w.record),w=w.parent;return{name:m,path:v,params:g,matched:S,meta:pg(S)}}n.forEach(f=>r(f));function c(){i.length=0,t.clear()}return{addRoute:r,resolve:l,removeRoute:o,clearRoutes:c,getRoutes:a,getRecordMatcher:e}}function La(n,s){const i={};for(const t of s)t in n&&(i[t]=n[t]);return i}function Oa(n){const s={path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:n.aliasOf,beforeEnter:n.beforeEnter,props:gg(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}};return Object.defineProperty(s,"mods",{value:{}}),s}function gg(n){const s={},i=n.props||!1;if("component"in n)s.default=i;else for(const t in n.components)s[t]=typeof i=="object"?i[t]:i;return s}function Da(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function pg(n){return n.reduce((s,i)=>Le(s,i.meta),{})}function Ma(n,s){const i={};for(const t in n)i[t]=t in s?s[t]:n[t];return i}function vg(n,s){let i=0,t=s.length;for(;i!==t;){const r=i+t>>1;uc(n,s[r])<0?t=r:i=r+1}const e=mg(n);return e&&(t=s.lastIndexOf(e,t-1)),t}function mg(n){let s=n;for(;s=s.parent;)if(lc(s)&&uc(n,s)===0)return s}function lc({record:n}){return!!(n.name||n.components&&Object.keys(n.components).length||n.redirect)}function yg(n){const s={};if(n===""||n==="?")return s;const t=(n[0]==="?"?n.slice(1):n).split("&");for(let e=0;e<t.length;++e){const r=t[e].replace(ec," "),o=r.indexOf("="),a=Wn(o<0?r:r.slice(0,o)),u=o<0?null:Wn(r.slice(o+1));if(a in s){let l=s[a];Dt(l)||(l=s[a]=[l]),l.push(u)}else s[a]=u}return s}function Na(n){let s="";for(let i in n){const t=n[i];if(i=Bd(i),t==null){t!==void 0&&(s+=(s.length?"&":"")+i);continue}(Dt(t)?t.map(r=>r&&Gs(r)):[t&&Gs(t)]).forEach(r=>{r!==void 0&&(s+=(s.length?"&":"")+i,r!=null&&(s+="="+r))})}return s}function _g(n){const s={};for(const i in n){const t=n[i];t!==void 0&&(s[i]=Dt(t)?t.map(e=>e==null?null:""+e):t==null?t:""+t)}return s}const bg=Symbol(""),Fa=Symbol(""),Io=Symbol(""),cc=Symbol(""),Ys=Symbol("");function En(){let n=[];function s(t){return n.push(t),()=>{const e=n.indexOf(t);e>-1&&n.splice(e,1)}}function i(){n=[]}return{add:s,list:()=>n.slice(),reset:i}}function yi(n,s,i,t,e,r=o=>o()){const o=t&&(t.enterCallbacks[e]=t.enterCallbacks[e]||[]);return()=>new Promise((a,u)=>{const l=h=>{h===!1?u(dn(4,{from:i,to:s})):h instanceof Error?u(h):rg(h)?u(dn(2,{from:s,to:h})):(o&&t.enterCallbacks[e]===o&&typeof h=="function"&&o.push(h),a())},c=r(()=>n.call(t&&t.instances[e],s,i,l));let f=Promise.resolve(c);n.length<3&&(f=f.then(l)),f.catch(h=>u(h))})}function ds(n,s,i,t,e=r=>r()){const r=[];for(const o of n)for(const a in o.components){let u=o.components[a];if(!(s!=="beforeRouteEnter"&&!o.instances[a]))if(Ql(u)){const c=(u.__vccOpts||u)[s];c&&r.push(yi(c,i,t,o,a,e))}else{let l=u();r.push(()=>l.then(c=>{if(!c)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const f=Pd(c)?c.default:c;o.mods[a]=c,o.components[a]=f;const d=(f.__vccOpts||f)[s];return d&&yi(d,i,t,o,a,e)()}))}}return r}function Ba(n){const s=ri(Io),i=ri(cc),t=It(()=>{const u=Oi(n.to);return s.resolve(u)}),e=It(()=>{const{matched:u}=t.value,{length:l}=u,c=u[l-1],f=i.matched;if(!c||!f.length)return-1;const h=f.findIndex(hn.bind(null,c));if(h>-1)return h;const d=Ua(u[l-2]);return l>1&&Ua(c)===d&&f[f.length-1].path!==d?f.findIndex(hn.bind(null,u[l-2])):h}),r=It(()=>e.value>-1&&wg(i.params,t.value.params)),o=It(()=>e.value>-1&&e.value===i.matched.length-1&&rc(i.params,t.value.params));function a(u={}){return Sg(u)?s[Oi(n.replace)?"replace":"push"](Oi(n.to)).catch(Nn):Promise.resolve()}return{route:t,href:It(()=>t.value.href),isActive:r,isExactActive:o,navigate:a}}const Eg=Tl({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Ba,setup(n,{slots:s}){const i=zr(Ba(n)),{options:t}=ri(Io),e=It(()=>({[Ha(n.activeClass,t.linkActiveClass,"router-link-active")]:i.isActive,[Ha(n.exactActiveClass,t.linkExactActiveClass,"router-link-exact-active")]:i.isExactActive}));return()=>{const r=s.default&&s.default(i);return n.custom?r:Xl("a",{"aria-current":i.isExactActive?n.ariaCurrentValue:null,href:i.href,onClick:i.navigate,class:e.value},r)}}}),Tg=Eg;function Sg(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const s=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(s))return}return n.preventDefault&&n.preventDefault(),!0}}function wg(n,s){for(const i in s){const t=s[i],e=n[i];if(typeof t=="string"){if(t!==e)return!1}else if(!Dt(e)||e.length!==t.length||t.some((r,o)=>r!==e[o]))return!1}return!0}function Ua(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const Ha=(n,s,i)=>n??s??i,Cg=Tl({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:s,slots:i}){const t=ri(Ys),e=It(()=>n.route||t.value),r=ri(Fa,0),o=It(()=>{let l=Oi(r);const{matched:c}=e.value;let f;for(;(f=c[l])&&!f.components;)l++;return l}),a=It(()=>e.value.matched[o.value]);hr(Fa,It(()=>o.value+1)),hr(bg,a),hr(Ys,e);const u=dl();return dr(()=>[u.value,a.value,n.name],([l,c,f],[h,d,g])=>{c&&(c.instances[f]=l,d&&d!==c&&l&&l===h&&(c.leaveGuards.size||(c.leaveGuards=d.leaveGuards),c.updateGuards.size||(c.updateGuards=d.updateGuards))),l&&c&&(!d||!hn(c,d)||!h)&&(c.enterCallbacks[f]||[]).forEach(v=>v(l))},{flush:"post"}),()=>{const l=e.value,c=n.name,f=a.value,h=f&&f.components[c];if(!h)return ja(i.default,{Component:h,route:l});const d=f.props[c],g=d?d===!0?l.params:typeof d=="function"?d(l):d:null,m=Xl(h,Le({},g,s,{onVnodeUnmounted:S=>{S.component.isUnmounted&&(f.instances[c]=null)},ref:u}));return ja(i.default,{Component:m,route:l})||m}}});function ja(n,s){if(!n)return null;const i=n(s);return i.length===1?i[0]:i}const fc=Cg;function kg(n){const s=dg(n.routes,n),i=n.parseQuery||yg,t=n.stringifyQuery||Na,e=n.history,r=En(),o=En(),a=En(),u=Bf(fi);let l=fi;nn&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const c=fs.bind(null,A=>""+A),f=fs.bind(null,Hd),h=fs.bind(null,Wn);function d(A,q){let U,ee;return oc(A)?(U=s.getRecordMatcher(A),ee=q):ee=A,s.addRoute(ee,U)}function g(A){const q=s.getRecordMatcher(A);q&&s.removeRoute(q)}function v(){return s.getRoutes().map(A=>A.record)}function m(A){return!!s.getRecordMatcher(A)}function S(A,q){if(q=Le({},q||u.value),typeof A=="string"){const T=hs(i,A,q.path),x=s.resolve({path:T.path},q),H=e.createHref(T.fullPath);return Le(T,x,{params:h(x.params),hash:Wn(T.hash),redirectedFrom:void 0,href:H})}let U;if(A.path!=null)U=Le({},A,{path:hs(i,A.path,q.path).path});else{const T=Le({},A.params);for(const x in T)T[x]==null&&delete T[x];U=Le({},A,{params:f(T)}),q.params=f(q.params)}const ee=s.resolve(U,q),we=A.hash||"";ee.params=c(h(ee.params));const Oe=zd(t,Le({},A,{hash:Fd(we),path:ee.path})),y=e.createHref(Oe);return Le({fullPath:Oe,hash:we,query:t===Na?_g(A.query):A.query||{}},ee,{redirectedFrom:void 0,href:y})}function w(A){return typeof A=="string"?hs(i,A,u.value.path):Le({},A)}function _(A,q){if(l!==A)return dn(8,{from:q,to:A})}function P(A){return O(A)}function I(A){return P(Le(w(A),{replace:!0}))}function j(A){const q=A.matched[A.matched.length-1];if(q&&q.redirect){const{redirect:U}=q;let ee=typeof U=="function"?U(A):U;return typeof ee=="string"&&(ee=ee.includes("?")||ee.includes("#")?ee=w(ee):{path:ee},ee.params={}),Le({query:A.query,hash:A.hash,params:ee.path!=null?{}:A.params},ee)}}function O(A,q){const U=l=S(A),ee=u.value,we=A.state,Oe=A.force,y=A.replace===!0,T=j(U);if(T)return O(Le(w(T),{state:typeof T=="object"?Le({},we,T.state):we,force:Oe,replace:y}),q||U);const x=U;x.redirectedFrom=q;let H;return!Oe&&Wd(t,ee,U)&&(H=dn(16,{to:x,from:ee}),K(ee,ee,!0,!1)),(H?Promise.resolve(H):F(x,ee)).catch(L=>qt(L)?qt(L,2)?L:he(L):G(L,x,ee)).then(L=>{if(L){if(qt(L,2))return O(Le({replace:y},w(L.to),{state:typeof L.to=="object"?Le({},we,L.to.state):we,force:Oe}),q||x)}else L=E(x,ee,!0,y,we);return re(x,ee,L),L})}function Z(A,q){const U=_(A,q);return U?Promise.reject(U):Promise.resolve()}function te(A){const q=qe.values().next().value;return q&&typeof q.runWithContext=="function"?q.runWithContext(A):A()}function F(A,q){let U;const[ee,we,Oe]=Pg(A,q);U=ds(ee.reverse(),"beforeRouteLeave",A,q);for(const T of ee)T.leaveGuards.forEach(x=>{U.push(yi(x,A,q))});const y=Z.bind(null,A,q);return U.push(y),Me(U).then(()=>{U=[];for(const T of r.list())U.push(yi(T,A,q));return U.push(y),Me(U)}).then(()=>{U=ds(we,"beforeRouteUpdate",A,q);for(const T of we)T.updateGuards.forEach(x=>{U.push(yi(x,A,q))});return U.push(y),Me(U)}).then(()=>{U=[];for(const T of Oe)if(T.beforeEnter)if(Dt(T.beforeEnter))for(const x of T.beforeEnter)U.push(yi(x,A,q));else U.push(yi(T.beforeEnter,A,q));return U.push(y),Me(U)}).then(()=>(A.matched.forEach(T=>T.enterCallbacks={}),U=ds(Oe,"beforeRouteEnter",A,q,te),U.push(y),Me(U))).then(()=>{U=[];for(const T of o.list())U.push(yi(T,A,q));return U.push(y),Me(U)}).catch(T=>qt(T,8)?T:Promise.reject(T))}function re(A,q,U){a.list().forEach(ee=>te(()=>ee(A,q,U)))}function E(A,q,U,ee,we){const Oe=_(A,q);if(Oe)return Oe;const y=q===fi,T=nn?history.state:{};U&&(ee||y?e.replace(A.fullPath,Le({scroll:y&&T&&T.scroll},we)):e.push(A.fullPath,we)),u.value=A,K(A,q,U,y),he()}let b;function C(){b||(b=e.listen((A,q,U)=>{if(!Ve.listening)return;const ee=S(A),we=j(ee);if(we){O(Le(we,{replace:!0}),ee).catch(Nn);return}l=ee;const Oe=u.value;nn&&Qd(Pa(Oe.fullPath,U.delta),$r()),F(ee,Oe).catch(y=>qt(y,12)?y:qt(y,2)?(O(y.to,ee).then(T=>{qt(T,20)&&!U.delta&&U.type===Gn.pop&&e.go(-1,!1)}).catch(Nn),Promise.reject()):(U.delta&&e.go(-U.delta,!1),G(y,ee,Oe))).then(y=>{y=y||E(ee,Oe,!1),y&&(U.delta&&!qt(y,8)?e.go(-U.delta,!1):U.type===Gn.pop&&qt(y,20)&&e.go(-1,!1)),re(ee,Oe,y)}).catch(Nn)}))}let N=En(),k=En(),M;function G(A,q,U){he(A);const ee=k.list();return ee.length?ee.forEach(we=>we(A,q,U)):console.error(A),Promise.reject(A)}function ce(){return M&&u.value!==fi?Promise.resolve():new Promise((A,q)=>{N.add([A,q])})}function he(A){return M||(M=!A,C(),N.list().forEach(([q,U])=>A?U(A):q()),N.reset()),A}function K(A,q,U,ee){const{scrollBehavior:we}=n;if(!nn||!we)return Promise.resolve();const Oe=!U&&Zd(Pa(A.fullPath,0))||(ee||!U)&&history.state&&history.state.scroll||null;return ml().then(()=>we(A,q,Oe)).then(y=>y&&Jd(y)).catch(y=>G(y,A,q))}const me=A=>e.go(A);let ne;const qe=new Set,Ve={currentRoute:u,listening:!0,addRoute:d,removeRoute:g,clearRoutes:s.clearRoutes,hasRoute:m,getRoutes:v,resolve:S,options:n,push:P,replace:I,go:me,back:()=>me(-1),forward:()=>me(1),beforeEach:r.add,beforeResolve:o.add,afterEach:a.add,onError:k.add,isReady:ce,install(A){const q=this;A.component("RouterLink",Tg),A.component("RouterView",fc),A.config.globalProperties.$router=q,Object.defineProperty(A.config.globalProperties,"$route",{enumerable:!0,get:()=>Oi(u)}),nn&&!ne&&u.value===fi&&(ne=!0,P(e.location).catch(we=>{}));const U={};for(const we in fi)Object.defineProperty(U,we,{get:()=>u.value[we],enumerable:!0});A.provide(Io,q),A.provide(cc,cl(U)),A.provide(Ys,u);const ee=A.unmount;qe.add(A),A.unmount=function(){qe.delete(A),qe.size<1&&(l=fi,b&&b(),b=null,u.value=fi,ne=!1,M=!1),ee()}}};function Me(A){return A.reduce((q,U)=>q.then(()=>te(U)),Promise.resolve())}return Ve}function Pg(n,s){const i=[],t=[],e=[],r=Math.max(s.matched.length,n.matched.length);for(let o=0;o<r;o++){const a=s.matched[o];a&&(n.matched.find(l=>hn(l,a))?t.push(a):i.push(a));const u=n.matched[o];u&&(s.matched.find(l=>hn(l,u))||e.push(u))}return[i,t,e]}const hc=(n,s)=>{const i=n.__vccOpts||n;for(const[t,e]of s)i[t]=e;return i},xg={__name:"App",setup(n){return(s,i)=>(Gl(),Uh(Oi(fc)))}},Rg=hc(xg,[["__scopeId","data-v-5d9d88c2"]]),Ig="modulepreload",Ag=function(n){return"/"+n},Va={},Lg=function(s,i,t){let e=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));e=Promise.allSettled(i.map(u=>{if(u=Ag(u),u in Va)return;Va[u]=!0;const l=u.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${c}`))return;const f=document.createElement("link");if(f.rel=l?"stylesheet":Ig,l||(f.as="script"),f.crossOrigin="",f.href=u,a&&f.setAttribute("nonce",a),document.head.appendChild(f),l)return new Promise((h,d)=>{f.addEventListener("load",h),f.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${u}`)))})}))}function r(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return e.then(o=>{for(const a of o||[])a.status==="rejected"&&r(a.reason);return s().catch(r)})};function za(n,s){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);s&&(t=t.filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),i.push.apply(i,t)}return i}function ze(n){for(var s=1;s<arguments.length;s++){var i=arguments[s]!=null?arguments[s]:{};s%2?za(Object(i),!0).forEach(function(t){D(n,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):za(Object(i)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(i,t))})}return n}function ot(n){"@babel/helpers - typeof";return ot=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},ot(n)}function ae(n,s){if(!(n instanceof s))throw new TypeError("Cannot call a class as a function")}function Wa(n,s){for(var i=0;i<s.length;i++){var t=s[i];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(n,dc(t.key),t)}}function ue(n,s,i){return s&&Wa(n.prototype,s),i&&Wa(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n}function D(n,s,i){return s=dc(s),s in n?Object.defineProperty(n,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[s]=i,n}function de(n,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(s&&s.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),s&&$s(n,s)}function ve(n){return ve=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},ve(n)}function $s(n,s){return $s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},$s(n,s)}function Og(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function R(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Ao(n,s){if(s&&(typeof s=="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return R(n)}function ge(n){var s=Og();return function(){var t=ve(n),e;if(s){var r=ve(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Ao(this,e)}}function Dg(n,s){for(;!Object.prototype.hasOwnProperty.call(n,s)&&(n=ve(n),n!==null););return n}function _e(){return typeof Reflect<"u"&&Reflect.get?_e=Reflect.get.bind():_e=function(s,i,t){var e=Dg(s,i);if(e){var r=Object.getOwnPropertyDescriptor(e,i);return r.get?r.get.call(arguments.length<3?s:t):r.value}},_e.apply(this,arguments)}function Ot(n){return Mg(n)||Ng(n)||Fg(n)||Bg()}function Mg(n){if(Array.isArray(n))return qs(n)}function Ng(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function Fg(n,s){if(n){if(typeof n=="string")return qs(n,s);var i=Object.prototype.toString.call(n).slice(8,-1);if(i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set")return Array.from(n);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return qs(n,s)}}function qs(n,s){(s==null||s>n.length)&&(s=n.length);for(var i=0,t=new Array(s);i<s;i++)t[i]=n[i];return t}function Bg(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ug(n,s){if(typeof n!="object"||n===null)return n;var i=n[Symbol.toPrimitive];if(i!==void 0){var t=i.call(n,s||"default");if(typeof t!="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}function dc(n){var s=Ug(n,"string");return typeof s=="symbol"?s:String(s)}var Hg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qr(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var gc={exports:{}};(function(n){var s=Object.prototype.hasOwnProperty,i="~";function t(){}Object.create&&(t.prototype=Object.create(null),new t().__proto__||(i=!1));function e(u,l,c){this.fn=u,this.context=l,this.once=c||!1}function r(u,l,c,f,h){if(typeof c!="function")throw new TypeError("The listener must be a function");var d=new e(c,f||u,h),g=i?i+l:l;return u._events[g]?u._events[g].fn?u._events[g]=[u._events[g],d]:u._events[g].push(d):(u._events[g]=d,u._eventsCount++),u}function o(u,l){--u._eventsCount===0?u._events=new t:delete u._events[l]}function a(){this._events=new t,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],c,f;if(this._eventsCount===0)return l;for(f in c=this._events)s.call(c,f)&&l.push(i?f.slice(1):f);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},a.prototype.listeners=function(l){var c=i?i+l:l,f=this._events[c];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,d=f.length,g=new Array(d);h<d;h++)g[h]=f[h].fn;return g},a.prototype.listenerCount=function(l){var c=i?i+l:l,f=this._events[c];return f?f.fn?1:f.length:0},a.prototype.emit=function(l,c,f,h,d,g){var v=i?i+l:l;if(!this._events[v])return!1;var m=this._events[v],S=arguments.length,w,_;if(m.fn){switch(m.once&&this.removeListener(l,m.fn,void 0,!0),S){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,c),!0;case 3:return m.fn.call(m.context,c,f),!0;case 4:return m.fn.call(m.context,c,f,h),!0;case 5:return m.fn.call(m.context,c,f,h,d),!0;case 6:return m.fn.call(m.context,c,f,h,d,g),!0}for(_=1,w=new Array(S-1);_<S;_++)w[_-1]=arguments[_];m.fn.apply(m.context,w)}else{var P=m.length,I;for(_=0;_<P;_++)switch(m[_].once&&this.removeListener(l,m[_].fn,void 0,!0),S){case 1:m[_].fn.call(m[_].context);break;case 2:m[_].fn.call(m[_].context,c);break;case 3:m[_].fn.call(m[_].context,c,f);break;case 4:m[_].fn.call(m[_].context,c,f,h);break;default:if(!w)for(I=1,w=new Array(S-1);I<S;I++)w[I-1]=arguments[I];m[_].fn.apply(m[_].context,w)}}return!0},a.prototype.on=function(l,c,f){return r(this,l,c,f,!1)},a.prototype.once=function(l,c,f){return r(this,l,c,f,!0)},a.prototype.removeListener=function(l,c,f,h){var d=i?i+l:l;if(!this._events[d])return this;if(!c)return o(this,d),this;var g=this._events[d];if(g.fn)g.fn===c&&(!h||g.once)&&(!f||g.context===f)&&o(this,d);else{for(var v=0,m=[],S=g.length;v<S;v++)(g[v].fn!==c||h&&!g[v].once||f&&g[v].context!==f)&&m.push(g[v]);m.length?this._events[d]=m.length===1?m[0]:m:o(this,d)}return this},a.prototype.removeAllListeners=function(l){var c;return l?(c=i?i+l:l,this._events[c]&&o(this,c)):(this._events=new t,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=i,a.EventEmitter=a,n.exports=a})(gc);var pc=gc.exports;const Vi=qr(pc);var jg=typeof window<"u"&&window.location&&window.location.href.indexOf("xgplayerdebugger=1")>-1,gs={info:"color: #525252; background-color: #90ee90;",error:"color: #525252; background-color: red;",warn:"color: #525252; background-color: yellow; "},ps="%c[xgplayer]",ke={config:{debug:jg?3:0},logInfo:function(s){for(var i,t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];this.config.debug>=3&&(i=console).log.apply(i,[ps,gs.info,s].concat(e))},logWarn:function(s){for(var i,t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];this.config.debug>=1&&(i=console).warn.apply(i,[ps,gs.warn,s].concat(e))},logError:function(s){var i;if(!(this.config.debug<1)){for(var t=this.config.debug>=2?"trace":"error",e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];(i=console)[t].apply(i,[ps,gs.error,s].concat(r))}}};function Vg(n){n.logInfo=ke.logInfo.bind(n),n.logWarn=ke.logWarn.bind(n),n.logError=ke.logError.bind(n)}var zg=function(){function n(s){ae(this,n),this.bufferedList=s}return ue(n,[{key:"start",value:function(i){return this.bufferedList[i].start}},{key:"end",value:function(i){return this.bufferedList[i].end}},{key:"length",get:function(){return this.bufferedList.length}}]),n}(),p={};p.createDom=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"div",s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",e=document.createElement(n);return e.className=t,e.innerHTML=s,Object.keys(i).forEach(function(r){var o=r,a=i[r];n==="video"||n==="audio"||n==="live-video"?a&&e.setAttribute(o,a):e.setAttribute(o,a)}),e};p.createDomFromHtml=function(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";try{var t=document.createElement("div");t.innerHTML=n;var e=t.children;return t=null,e.length>0?(e=e[0],i&&p.addClass(e,i),s&&Object.keys(s).forEach(function(r){e.setAttribute(r,s[r])}),e):null}catch(r){return ke.logError("util.createDomFromHtml",r),null}};p.hasClass=function(n,s){if(!n||!s)return!1;try{return Array.prototype.some.call(n.classList,function(t){return t===s})}catch{var i=n.className&&ot(n.className)==="object"?n.getAttribute("class"):n.className;return i&&!!i.match(new RegExp("(\\s|^)"+s+"(\\s|$)"))}};p.addClass=function(n,s){if(!(!n||!s))try{s.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(i){i&&n.classList.add(i)})}catch{p.hasClass(n,s)||(n.className&&ot(n.className)==="object"?n.setAttribute("class",n.getAttribute("class")+" "+s):n.className+=" "+s)}};p.removeClass=function(n,s){if(!(!n||!s))try{s.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(i){i&&n.classList.remove(i)})}catch{p.hasClass(n,s)&&s.split(/\s+/g).forEach(function(t){var e=new RegExp("(\\s|^)"+t+"(\\s|$)");n.className&&ot(n.className)==="object"?n.setAttribute("class",n.getAttribute("class").replace(e," ")):n.className=n.className.replace(e," ")})}};p.toggleClass=function(n,s){n&&s.split(/\s+/g).forEach(function(i){p.hasClass(n,i)?p.removeClass(n,i):p.addClass(n,i)})};p.classNames=function(){for(var n=arguments,s=[],i=function(r){p.typeOf(n[r])==="String"?s.push(n[r]):p.typeOf(n[r])==="Object"&&Object.keys(n[r]).map(function(o){n[r][o]&&s.push(o)})},t=0;t<arguments.length;t++)i(t);return s.join(" ")};p.findDom=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,s=arguments.length>1?arguments[1]:void 0,i;try{i=n.querySelector(s)}catch(t){ke.logError("util.findDom",t),s.indexOf("#")===0&&(i=n.getElementById(s.slice(1)))}return i};p.getCss=function(n,s){return n.currentStyle?n.currentStyle[s]:document.defaultView.getComputedStyle(n,!1)[s]};p.padStart=function(n,s,i){for(var t=String(i),e=s>>0,r=Math.ceil(e/t.length),o=[],a=String(n);r--;)o.push(t);return o.join("").substring(0,e-a.length)+a};p.format=function(n){if(window.isNaN(n))return"";n=Math.round(n);var s=p.padStart(Math.floor(n/3600),2,0),i=p.padStart(Math.floor((n-s*3600)/60),2,0),t=p.padStart(Math.floor(n-s*3600-i*60),2,0);return(s==="00"?[i,t]:[s,i,t]).join(":")};p.event=function(n){if(n.touches){var s=n.touches[0]||n.changedTouches[0];n.clientX=s.clientX||0,n.clientY=s.clientY||0,n.offsetX=s.pageX-s.target.offsetLeft,n.offsetY=s.pageY-s.target.offsetTop}n._target=n.target||n.srcElement};p.typeOf=function(n){return Object.prototype.toString.call(n).match(/([^\s.*]+)(?=]$)/g)[0]};p.deepCopy=function(n,s){if(p.typeOf(s)==="Object"&&p.typeOf(n)==="Object")return Object.keys(s).forEach(function(i){p.typeOf(s[i])==="Object"&&!(s[i]instanceof Node)?n[i]===void 0||n[i]===void 0?n[i]=s[i]:p.deepCopy(n[i],s[i]):p.typeOf(s[i])==="Array"?n[i]=p.typeOf(n[i])==="Array"?n[i].concat(s[i]):s[i]:n[i]=s[i]}),n};p.deepMerge=function(n,s){return Object.keys(s).map(function(i){if(p.typeOf(s[i])==="Array"&&p.typeOf(n[i])==="Array"){if(p.typeOf(n[i])==="Array"){var t;(t=n[i]).push.apply(t,Ot(s[i]))}}else p.typeOf(n[i])===p.typeOf(s[i])&&n[i]!==null&&p.typeOf(n[i])==="Object"&&!(s[i]instanceof window.Node)?p.deepMerge(n[i],s[i]):s[i]!==null&&(n[i]=s[i])}),n};p.getBgImage=function(n){var s=(n.currentStyle||window.getComputedStyle(n,null)).backgroundImage;if(!s||s==="none")return"";var i=document.createElement("a");return i.href=s.replace(/url\("|"\)/g,""),i.href};p.copyDom=function(n){if(n&&n.nodeType===1){var s=document.createElement(n.tagName);return Array.prototype.forEach.call(n.attributes,function(i){s.setAttribute(i.name,i.value)}),n.innerHTML&&(s.innerHTML=n.innerHTML),s}else return""};p.setInterval=function(n,s,i,t){n._interval[s]||(n._interval[s]=window.setInterval(i.bind(n),t))};p.clearInterval=function(n,s){clearInterval(n._interval[s]),n._interval[s]=null};p.setTimeout=function(n,s,i){n._timers||(n._timers=[]);var t=setTimeout(function(){s(),p.clearTimeout(n,t)},i);return n._timers.push(t),t};p.clearTimeout=function(n,s){var i=n._timers;if(p.typeOf(i)==="Array"){for(var t=0;t<i.length;t++)if(i[t]===s){i.splice(t,1),clearTimeout(s);break}}else clearTimeout(s)};p.clearAllTimers=function(n){var s=n._timers;p.typeOf(s)==="Array"&&(s.map(function(i){clearTimeout(i)}),n._timerIds=[])};p.createImgBtn=function(n,s,i,t){var e=p.createDom("xg-".concat(n),"",{},"xgplayer-".concat(n,"-img"));if(e.style.backgroundImage='url("'.concat(s,'")'),i&&t){var r,o,a;["px","rem","em","pt","dp","vw","vh","vm","%"].every(function(u){return i.indexOf(u)>-1&&t.indexOf(u)>-1?(r=parseFloat(i.slice(0,i.indexOf(u)).trim()),o=parseFloat(t.slice(0,t.indexOf(u)).trim()),a=u,!1):!0}),e.style.width="".concat(r).concat(a),e.style.height="".concat(o).concat(a),e.style.backgroundSize="".concat(r).concat(a," ").concat(o).concat(a),n==="start"?e.style.margin="-".concat(o/2).concat(a," auto auto -").concat(r/2).concat(a):e.style.margin="auto 5px auto 5px"}return e};p.Hex2RGBA=function(n,s){var i=[];if(/^\#[0-9A-F]{3}$/i.test(n)){var t="#";n.replace(/[0-9A-F]/ig,function(e){t+=e+e}),n=t}return/^#[0-9A-F]{6}$/i.test(n)?(n.replace(/[0-9A-F]{2}/ig,function(e){i.push(parseInt(e,16))}),"rgba(".concat(i.join(","),", ").concat(s,")")):"rgba(255, 255, 255, 0.1)"};p.getFullScreenEl=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement};p.checkIsFunction=function(n){return n&&typeof n=="function"};p.checkIsObject=function(n){return n!==null&&ot(n)==="object"};p.hide=function(n){n.style.display="none"};p.show=function(n,s){n.style.display=s||"block"};p.isUndefined=function(n){if(typeof n>"u"||n===null)return!0};p.isNotNull=function(n){return n!=null};p.setStyleFromCsstext=function(n,s){if(s)if(p.typeOf(s)==="String"){var i=s.replace(/\s+/g,"").split(";");i.map(function(t){if(t){var e=t.split(":");e.length>1&&(n.style[e[0]]=e[1])}})}else Object.keys(s).map(function(t){n.style[t]=s[t]})};function Wg(n,s){for(var i=0,t=s.length;i<t;i++)if(n.indexOf(s[i])>-1)return!0;return!1}p.filterStyleFromText=function(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["width","height","top","left","bottom","right","position","z-index","padding","margin","transform"],i=n.style.cssText;if(!i)return{};var t=i.replace(/\s+/g,"").split(";"),e={},r={};return t.map(function(o){if(o){var a=o.split(":");a.length>1&&(Wg(a[0],s)?e[a[0]]=a[1]:r[a[0]]=a[1])}}),n.setAttribute("style",""),Object.keys(r).map(function(o){n.style[o]=r[o]}),e};p.getStyleFromCsstext=function(n){var s=n.style.cssText;if(!s)return{};var i=s.replace(/\s+/g,"").split(";"),t={};return i.map(function(e){if(e){var r=e.split(":");r.length>1&&(t[r[0]]=r[1])}}),t};p.preloadImg=function(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){};if(n){var t=new window.Image;t.onload=function(e){t=null,s&&s(e)},t.onerror=function(e){t=null,i&&i(e)},t.src=n}};p.stopPropagation=function(n){n&&n.stopPropagation()};p.scrollTop=function(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0};p.scrollLeft=function(){return window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0};p.checkTouchSupport=function(){return"ontouchstart"in window};p.getBuffered2=function(n){for(var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5,i=[],t=0;t<n.length;t++)i.push({start:n.start(t)<.5?0:n.start(t),end:n.end(t)});i.sort(function(u,l){var c=u.start-l.start;return c||l.end-u.end});var e=[];if(s)for(var r=0;r<i.length;r++){var o=e.length;if(o){var a=e[o-1].end;i[r].start-a<s?i[r].end>a&&(e[o-1].end=i[r].end):e.push(i[r])}else e.push(i[r])}else e=i;return new zg(e)};p.getEventPos=function(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return n.touches&&n.touches.length>0&&(n=n.touches[0]),{x:n.x/s,y:n.y/s,clientX:n.clientX/s,clientY:n.clientY/s,offsetX:n.offsetX/s,offsetY:n.offsetY/s,pageX:n.pageX/s,pageY:n.pageY/s}};p.requestAnimationFrame=function(n){var s=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;if(s)return s(n)};p.getHostFromUrl=function(n){if(p.typeOf(n)!=="String")return"";var s=n.split("/"),i="";return s.length>3&&s[2]&&(i=s[2]),i};p.cancelAnimationFrame=function(n){var s=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.cancelRequestAnimationFrame;s&&s(n)};p.isMSE=function(n){return n.media&&(n=n.media),!n||!(n instanceof HTMLMediaElement)?!1:/^blob/.test(n.currentSrc)||/^blob/.test(n.src)};p.isBlob=function(n){return typeof n=="string"&&/^blob/.test(n)};p.generateSessionId=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,s=new Date().getTime();try{n=parseInt(n)}catch{n=0}s+=n,window.performance&&typeof window.performance.now=="function"&&(s+=parseInt(window.performance.now()));var i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=(s+Math.random()*16)%16|0;return s=Math.floor(s/16),(t==="x"?e:e&3|8).toString(16)});return i};p.createEvent=function(n){var s;return typeof window.Event=="function"?s=new Event(n):(s=document.createEvent("Event"),s.initEvent(n,!0,!0)),s};p.adjustTimeByDuration=function(n,s,i){return!s||!n?n:n>s||i&&n<s?s:n};p.createPositionBar=function(n,s){var i=p.createDom("xg-bar","",{"data-index":-1},n);return s.appendChild(i),i};p.getTransformStyle=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{x:0,y:0,scale:1,rotate:0},s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",i={scale:"".concat(n.scale||1),translate:"".concat(n.x||0,"%, ").concat(n.y||0,"%"),rotate:"".concat(n.rotate||0,"deg")},t=Object.keys(i);return t.forEach(function(e){var r=new RegExp("".concat(e,"\\([^\\(]+\\)"),"g"),o="".concat(e,"(").concat(i[e],")");r.test(s)?(r.lastIndex=-1,s=s.replace(r,o)):s+="".concat(o," ")}),s};p.convertDeg=function(n){return Math.abs(n)<=1?n*360:n%360};p.getIndexByTime=function(n,s){var i=s.length,t=-1;if(i<1)return t;if(n<=s[0].end||i<2)t=0;else if(n>s[i-1].end)t=i-1;else for(var e=1;e<i;e++)if(n>s[e-1].end&&n<=s[e].end){t=e;break}return t};p.getOffsetCurrentTime=function(n,s){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,t=-1;if(i>=0&&i<s.length?t=i:t=p.getIndexByTime(n,s),t<0)return-1;var e=s.length,r=s[t],o=r.start,a=r.end,u=r.cTime,l=r.offset;return n<o?u:n>=o&&n<=a?n-l:n>a&&t>=e-1?a:-1};p.getCurrentTimeByOffset=function(n,s){var i=-1;if(!s||s.length<0)return n;for(var t=0;t<s.length;t++)if(n<=s[t].duration){i=t;break}if(i!==-1){var e=s[i].start;return i-1<0?e+n:e+(n-s[i-1].duration)}return n};function vc(n){var s=ot(n);return n!==null&&(s==="object"||s==="function")}function Gg(n,s,i){var t,e,r,o,a,u,l=0,c=!1,f=!1,h=!0,d=!s&&s!==0&&typeof window.requestAnimationFrame=="function";if(typeof n!="function")throw new TypeError("Expected a function");s=+s||0,vc(i)&&(c=!!i.leading,f="maxWait"in i,r=f?Math.max(+i.maxWait||0,s):r,h="trailing"in i?!!i.trailing:h);function g(F){var re=t,E=e;return t=e=void 0,l=F,o=n.apply(E,re),o}function v(F,re){return d?(window.cancelAnimationFrame(a),window.requestAnimationFrame(F)):setTimeout(F,re)}function m(F){if(d)return window.cancelAnimationFrame(F);clearTimeout(F)}function S(F){return l=F,a=v(P,s),c?g(F):o}function w(F){var re=F-u,E=F-l,b=s-re;return f?Math.min(b,r-E):b}function _(F){var re=F-u,E=F-l;return u===void 0||re>=s||re<0||f&&E>=r}function P(){var F=Date.now();if(_(F))return I(F);a=v(P,w(F))}function I(F){return a=void 0,h&&t?g(F):(t=e=void 0,o)}function j(){a!==void 0&&m(a),l=0,t=u=e=a=void 0}function O(){return a===void 0?o:I(Date.now())}function Z(){return a!==void 0}function te(){for(var F=Date.now(),re=_(F),E=arguments.length,b=new Array(E),C=0;C<E;C++)b[C]=arguments[C];if(t=b,e=this,u=F,re){if(a===void 0)return S(u);if(f)return a=v(P,s),g(u)}return a===void 0&&(a=v(P,s)),o}return te.cancel=j,te.flush=O,te.pending=Z,te}function Kg(n,s,i){var t=!0,e=!0;if(typeof n!="function")throw new TypeError("Expected a function");return vc(i)&&(t="leading"in i?!!i.leading:t,e="trailing"in i?!!i.trailing:e),Gg(n,s,{leading:t,trailing:e,maxWait:s})}function Yg(){var n=(document.documentElement.getAttribute("lang")||navigator.language||"zh-cn").toLocaleLowerCase();return n==="zh-cn"&&(n="zh"),n}function $g(n,s,i){if(n){var t=n.getAttribute(i);return!!(t&&t===s&&(n.tagName==="VIDEO"||n.tagName==="AUDIO"))}}var Ga={android:/(Android)\s([\d.]+)/,ios:/(Version)\/([\d.]+)/},qg=["avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","avc1.42E01E","mp4v.20.8","avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","mp4v.20.8, mp4a.40.2","mp4v.20.240, mp4a.40.2"],Te={get device(){var n=Te.os;return n.isPc?"pc":"mobile"},get browser(){if(typeof navigator>"u")return"";var n=navigator.userAgent.toLowerCase(),s={ie:/rv:([\d.]+)\) like gecko/,firefox:/firefox\/([\d.]+)/,chrome:/chrome\/([\d.]+)/,opera:/opera.([\d.]+)/,safari:/version\/([\d.]+).*safari/};return[].concat(Object.keys(s).filter(function(i){return s[i].test(n)}))[0]},get os(){if(typeof navigator>"u")return{};var n=navigator.userAgent,s=/(?:Windows Phone)/.test(n),i=/(?:SymbianOS)/.test(n)||s,t=/(?:Android)/.test(n),e=/(?:Firefox)/.test(n),r=/(?:iPad|PlayBook)/.test(n)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,o=r||t&&!/(?:Mobile)/.test(n)||e&&/(?:Tablet)/.test(n),a=/(?:iPhone)/.test(n)&&!o,u=!a&&!t&&!i&&!o;return{isTablet:o,isPhone:a,isIpad:r,isIos:a||r,isAndroid:t,isPc:u,isSymbian:i,isWindowsPhone:s,isFireFox:e}},get osVersion(){if(typeof navigator>"u")return 0;var n=navigator.userAgent,s="";/(?:iPhone)|(?:iPad|PlayBook)/.test(n)?s=Ga.ios:s=Ga.android;var i=s?s.exec(n):[];if(i&&i.length>=3){var t=i[2].split(".");return t.length>0?parseInt(t[0]):0}return 0},get isWeixin(){if(typeof navigator>"u")return!1;var n=/(micromessenger)\/([\d.]+)/,s=n.exec(navigator.userAgent.toLocaleLowerCase());return!!s},isSupportMP4:function(){var s={isSupport:!1,mime:""};if(typeof document>"u")return s;if(this.supportResult)return this.supportResult;var i=document.createElement("video");return typeof i.canPlayType=="function"&&qg.map(function(t){i.canPlayType('video/mp4; codecs="'.concat(t,'"'))==="probably"&&(s.isSupport=!0,s.mime+="||".concat(t))}),this.supportResult=s,i=null,s},isMSESupport:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:'video/mp4; codecs="avc1.42E01E,mp4a.40.2"';if(typeof MediaSource>"u"||!MediaSource)return!1;try{return MediaSource.isTypeSupported(s)}catch(i){return this._logger.error(s,i),!1}},isHevcSupported:function(){return typeof MediaSource>"u"||!MediaSource.isTypeSupported?!1:MediaSource.isTypeSupported('video/mp4;codecs="hev1.1.6.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.2.4.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.3.E.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.4.10.L120.90"')},probeConfigSupported:function(s){var i={supported:!1,smooth:!1,powerEfficient:!1};if(!s||typeof navigator>"u")return Promise.resolve(i);if(navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo)return navigator.mediaCapabilities.decodingInfo(s);var t=s.video||{},e=s.audio||{};try{var r=MediaSource.isTypeSupported(t.contentType),o=MediaSource.isTypeSupported(e.contentType);return Promise.resolve({supported:r&&o,smooth:!1,powerEfficient:!1})}catch{return Promise.resolve(i)}}},Xs="3.0.17",Ka={1:"media",2:"media",3:"media",4:"media",5:"media",6:"media"},Ya={1:5101,2:5102,3:5103,4:5104,5:5105,6:5106},ti=ue(function n(s){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{errorType:"",errorCode:0,errorMessage:"",originError:"",ext:{},mediaError:null};ae(this,n);var t=s&&s.i18n?s.i18n.ERROR_TYPES:null;if(s.media){var e=i.mediaError?i.mediaError:s.media.error||{},r=s.duration,o=s.currentTime,a=s.ended,u=s.src,l=s.currentSrc,c=s.media,f=c.readyState,h=c.networkState,d=i.errorCode||e.code;Ya[d]&&(d=Ya[d]);var g={playerVersion:Xs,currentTime:o,duration:r,ended:a,readyState:f,networkState:h,src:u||l,errorType:i.errorType,errorCode:d,message:i.errorMessage||e.message,mediaError:e,originError:i.originError?i.originError.stack:"",host:p.getHostFromUrl(u||l)};return i.ext&&Object.keys(i.ext).map(function(w){g[w]=i.ext[w]}),g}else if(arguments.length>1){for(var v={playerVersion:Xs,domain:document.domain},m=["errorType","currentTime","duration","networkState","readyState","src","currentSrc","ended","errd","errorCode","mediaError"],S=0;S<arguments.length;S++)v[m[S]]=arguments[S];return v.ex=t?(t[arguments[0]]||{}).msg:"",v}}),bt="play",Lo="playing",zi="ended",mn="pause",Jn="error",Di="seeking",si="seeked",_t="timeupdate",Bi="waiting",ni="canplay",Xg="canplaythrough",Ci="durationchange",mc="volumechange",ai="loadeddata",Jg="loadedmetadata",yc="ratechange",_c="progress",Oo="loadstart",Wi="emptied",Qg="stalled",Zg="suspend",ep="abort",tp="bufferedChange",Do="focus",bc="blur",Mo="ready",Ec="urlNull",Mi="autoplay_started",No="autoplay_was_prevented",Xr="complete",Cr="replay",Fo="destroy",Ni="urlchange",Js="download_speed_change",Tc="leaveplayer",Sc="enterplayer",wc="loading",Zt="fullscreen_change",kr="cssFullscreen_change",Pr="mini_state_change",Jr="definition_change",ip="before_definition_change",xr="after_definition_change",np="SEI_PARSED",rp="retry",Ti="video_resize",Qs="pip_change",Cc="rotate",kc="screenShot",Rr="playnext",Pc="shortcut",xc="xglog",Ir="user_action",Qr="reset",Rc="source_error",Ic="source_success",sp="switch_subtitle",Ac=["play","playing","ended","pause","error","seeking","seeked","timeupdate","waiting","canplay","canplaythrough","durationchange","volumechange","loadeddata","loadedmetadata","ratechange","progress","loadstart","emptied","stalled","suspend","abort","lowdecode"],Lc={STATS_INFO:"stats_info",STATS_DOWNLOAD:"stats_download",STATS_RESET:"stats_reset"},Oc="fps_stuck";const op=Object.freeze(Object.defineProperty({__proto__:null,ABORT:ep,AFTER_DEFINITION_CHANGE:xr,AUTOPLAY_PREVENTED:No,AUTOPLAY_STARTED:Mi,BEFORE_DEFINITION_CHANGE:ip,BUFFER_CHANGE:tp,CANPLAY:ni,CANPLAY_THROUGH:Xg,COMPLETE:Xr,CSS_FULLSCREEN_CHANGE:kr,DEFINITION_CHANGE:Jr,DESTROY:Fo,DOWNLOAD_SPEED_CHANGE:Js,DURATION_CHANGE:Ci,EMPTIED:Wi,ENDED:zi,ENTER_PLAYER:Sc,ERROR:Jn,FPS_STUCK:Oc,FULLSCREEN_CHANGE:Zt,LEAVE_PLAYER:Tc,LOADED_DATA:ai,LOADED_METADATA:Jg,LOADING:wc,LOAD_START:Oo,MINI_STATE_CHANGE:Pr,PAUSE:mn,PIP_CHANGE:Qs,PLAY:bt,PLAYER_BLUR:bc,PLAYER_FOCUS:Do,PLAYING:Lo,PLAYNEXT:Rr,PROGRESS:_c,RATE_CHANGE:yc,READY:Mo,REPLAY:Cr,RESET:Qr,RETRY:rp,ROTATE:Cc,SCREEN_SHOT:kc,SEEKED:si,SEEKING:Di,SEI_PARSED:np,SHORTCUT:Pc,SOURCE_ERROR:Rc,SOURCE_SUCCESS:Ic,STALLED:Qg,STATS_EVENTS:Lc,SUSPEND:Zg,SWITCH_SUBTITLE:sp,TIME_UPDATE:_t,URL_CHANGE:Ni,URL_NULL:Ec,USER_ACTION:Ir,VIDEO_EVENTS:Ac,VIDEO_RESIZE:Ti,VOLUME_CHANGE:mc,WAITING:Bi,XGLOG:xc},Symbol.toStringTag,{value:"Module"}));function vs(n,s){!this||!this.emit||(n==="error"?this.errorHandler(n,s.error):this.emit(n,s))}function ap(n,s){return function(i,t){var e={player:s,eventName:n,originalEvent:i,detail:i.detail||{},timeStamp:i.timeStamp,currentTime:s.currentTime,duration:s.duration,paused:s.paused,ended:s.ended,isInternalOp:!!s._internalOp[i.type],muted:s.muted,volume:s.volume,host:p.getHostFromUrl(s.currentSrc),vtype:s.vtype};if(s.removeInnerOP(i.type),n==="timeupdate"&&(s._currentTime=s.media&&s.media.currentTime),n==="ratechange"){var r=s.media?s.media.playbackRate:0;if(r&&s._rate===r)return;s._rate=s.media&&s.media.playbackRate}if(n==="durationchange"&&(s._duration=s.media.duration),n==="volumechange"&&(e.isMutedChange=s._lastMuted!==s.muted,s._lastMuted=s.muted),n==="error"&&(e.error=t||s.video.error),s.mediaEventMiddleware[n]){var o=vs.bind(s,n,e);try{s.mediaEventMiddleware[n].call(s,e,o)}catch(a){throw vs.call(s,n,e),a}}else vs.call(s,n,e)}}var up=function(n){de(i,n);var s=ge(i);function i(t){var e;ae(this,i),e=s.call(this,t),e._hasStart=!1,e._currentTime=0,e._duration=0,e._internalOp={},e._lastMuted=!1,e.vtype="MP4",e._rate=-1,e.mediaConfig=Object.assign({},{controls:!1,autoplay:t.autoplay,playsinline:t.playsinline,"x5-playsinline":t.playsinline,"webkit-playsinline":t.playsinline,"x5-video-player-fullscreen":t["x5-video-player-fullscreen"]||t.x5VideoPlayerFullscreen,"x5-video-orientation":t["x5-video-orientation"]||t.x5VideoOrientation,airplay:t.airplay,"webkit-airplay":t.airplay,tabindex:t.tabindex|0,mediaType:t.mediaType||"video","data-index":-1},t.videoConfig,t.videoAttributes);var r=t["x5-video-player-type"]||t.x5VideoPlayerType;return Te.isWeixin&&Te.os.isAndroid&&r&&(e.mediaConfig["x5-video-player-type"]=r,delete e.mediaConfig.playsinline,delete e.mediaConfig["webkit-playsinline"],delete e.mediaConfig["x5-playsinline"]),t.loop&&(e.mediaConfig.loop="loop"),t.autoplayMuted&&!Object.prototype.hasOwnProperty.call(e.mediaConfig,"muted")&&(e.mediaConfig.muted=!0),e.media=p.createDom(e.mediaConfig.mediaType,"",e.mediaConfig,""),t.defaultPlaybackRate&&(e.media.defaultPlaybackRate=e.media.playbackRate=t.defaultPlaybackRate),p.typeOf(t.volume)==="Number"&&(e.volume=t.volume),t.autoplayMuted&&(e.media.muted=!0,e._lastMuted=!0),t.autoplay&&(e.media.autoplay=!0),e._interval={},e.mediaEventMiddleware={},e.attachVideoEvents(),e}return ue(i,[{key:"setEventsMiddleware",value:function(e){var r=this;Object.keys(e).map(function(o){r.mediaEventMiddleware[o]=e[o]})}},{key:"removeEventsMiddleware",value:function(e){var r=this;Object.keys(e).map(function(o){delete r.mediaEventMiddleware[o]})}},{key:"attachVideoEvents",value:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.media;this._evHandlers||(this._evHandlers=Ac.map(function(o){var a="on".concat(o.charAt(0).toUpperCase()).concat(o.slice(1));return typeof e[a]=="function"&&e.on(o,e[a]),D({},o,ap(o,e))})),this._evHandlers.forEach(function(o){var a=Object.keys(o)[0];r.addEventListener(a,o[a],!1)})}},{key:"detachVideoEvents",value:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.media;this._evHandlers.forEach(function(o){var a=Object.keys(o)[0];r.removeEventListener(a,o[a],!1)}),this._evHandlers.forEach(function(o){var a=Object.keys(o)[0],u="on".concat(a.charAt(0).toUpperCase()).concat(a.slice(1));typeof e[u]=="function"&&e.off(a,e[u])}),this._evHandlers=null}},{key:"_attachSourceEvents",value:function(e,r){var o=this;e.removeAttribute("src"),e.load(),r.forEach(function(f,h){o.media.appendChild(p.createDom("source","",{src:"".concat(f.src),type:"".concat(f.type||""),"data-index":h+1}))});var a=e.children;if(a){this._videoSourceCount=a.length,this._videoSourceIndex=a.length,this._vLoadeddata=function(f){o.emit(Ic,{src:f.target.currentSrc,host:p.getHostFromUrl(f.target.currentSrc)})};for(var u=null,l=0;l<this._evHandlers.length;l++)if(Object.keys(this._evHandlers[l])[0]==="error"){u=this._evHandlers[l];break}!this._sourceError&&(this._sourceError=function(f){var h=parseInt(f.target.getAttribute("data-index"),10);if(o._videoSourceIndex--,o._videoSourceIndex===0||h>=o._videoSourceCount){var d={code:4,message:"sources_load_error"};u?u.error(f,d):o.errorHandler("error",d)}var g=Ka[4];o.emit(Rc,new ti(o,{errorType:g,errorCode:4,errorMessage:"sources_load_error",mediaError:{code:4,message:"sources_load_error"},src:f.target.src}))});for(var c=0;c<a.length;c++)a[c].addEventListener("error",this._sourceError);e.addEventListener("loadeddata",this._vLoadeddata)}}},{key:"_detachSourceEvents",value:function(e){var r=e.children;if(!(!r||r.length===0||!this._sourceError)){for(var o=0;o<r.length;o++)r[o].removeEventListener("error",this._sourceError);for(;r.length>0;)e.removeChild(r[0]);this._vLoadeddata&&e.removeEventListener("loadeddata",this._vLoadeddata)}}},{key:"errorHandler",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.media&&(this.media.error||r)){var o=this.media.error||r,a=o.code?Ka[o.code]:"other",u=o.message;this.media.currentSrc||(u="empty_src",o={code:6,message:u}),this.emit(e,new ti(this,{errorType:a,errorCode:o.code,errorMessage:o.message||"",mediaError:o}))}}},{key:"destroy",value:function(){this.media&&(this.media.pause&&(this.media.pause(),this.media.muted=!0),this.media.removeAttribute("src"),this.media.load()),this._currentTime=0,this._duration=0,this.mediaConfig=null;for(var e in this._interval)Object.prototype.hasOwnProperty.call(this._interval,e)&&(clearInterval(this._interval[e]),this._interval[e]=null);this.detachVideoEvents(),this.media=null,this.mediaEventMiddleware={},this.removeAllListeners()}},{key:"video",get:function(){return this.media},set:function(e){this.media=e}},{key:"play",value:function(){var e=this.media?this.media.play():null;return e}},{key:"pause",value:function(){this.media&&this.media.pause()}},{key:"load",value:function(){this.media&&this.media.load()}},{key:"canPlayType",value:function(e){return this.media?this.media.canPlayType(e):!1}},{key:"getBufferedRange",value:function(e){var r=[0,0];if(!this.media)return r;e||(e=this.media.buffered);var o=this.media.currentTime;if(e)for(var a=0,u=e.length;a<u&&(r[0]=e.start(a),r[1]=e.end(a),!(r[0]<=o&&o<=r[1]));a++);return r[0]-o<=0&&o-r[1]<=0?r:[0,0]}},{key:"autoplay",get:function(){return this.media?this.media.autoplay:!1},set:function(e){this.media&&(this.media.autoplay=e)}},{key:"buffered",get:function(){return this.media?this.media.buffered:null}},{key:"buffered2",get:function(){return this.media&&this.media.buffered?p.getBuffered2(this.media.buffered):null}},{key:"bufferedPoint",get:function(){var e={start:0,end:0};if(!this.media)return e;var r=this.media.buffered;if(!r||r.length===0)return e;for(var o=0;o<r.length;o++)if((r.start(o)<=this.currentTime||r.start(o)<.1)&&r.end(o)>=this.currentTime)return{start:r.start(o),end:r.end(o)};return e}},{key:"crossOrigin",get:function(){return this.media?this.media.crossOrigin:""},set:function(e){this.media&&(this.media.crossOrigin=e)}},{key:"currentSrc",get:function(){return this.media?this.media.currentSrc:""},set:function(e){this.media&&(this.media.currentSrc=e)}},{key:"currentTime",get:function(){return this.media?this.media.currentTime!==void 0?this.media.currentTime:this._currentTime:0},set:function(e){this.media&&(this.media.currentTime=e)}},{key:"defaultMuted",get:function(){return this.media?this.media.defaultMuted:!1},set:function(e){this.media&&(this.media.defaultMuted=e)}},{key:"duration",get:function(){return this._duration}},{key:"ended",get:function(){return this.media?this.media.ended:!1}},{key:"error",get:function(){return this.media.error}},{key:"errorNote",get:function(){var e=this.media.error;if(!e)return"";var r=["MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED"];return r[this.media.error.code-1]}},{key:"loop",get:function(){return this.media?this.media.loop:!1},set:function(e){this.media&&(this.media.loop=e)}},{key:"muted",get:function(){return this.media?this.media.muted:!1},set:function(e){!this.media||this.media.muted===e||(this._lastMuted=this.media.muted,this.media.muted=e)}},{key:"networkState",get:function(){return this.media.networkState}},{key:"paused",get:function(){return this.media?this.media.paused:!0}},{key:"playbackRate",get:function(){return this.media?this.media.playbackRate:0},set:function(e){!this.media||e===1/0||(this.media.defaultPlaybackRate=e,this.media.playbackRate=e)}},{key:"played",get:function(){return this.media?this.media.played:null}},{key:"preload",get:function(){return this.media?this.media.preload:!1},set:function(e){this.media&&(this.media.preload=e)}},{key:"readyState",get:function(){return this.media.readyState}},{key:"seekable",get:function(){return this.media?this.media.seekable:!1}},{key:"seeking",get:function(){return this.media?this.media.seeking:!1}},{key:"src",get:function(){return this.media?this.media.src:""},set:function(e){if(this.media){if(this.emit(Ni,e),this.emit(Bi),this._currentTime=0,this._duration=0,p.isMSE(this.media)){this.onWaiting();return}this._detachSourceEvents(this.media),p.typeOf(e)==="Array"?this._attachSourceEvents(this.media,e):e?this.media.src=e:this.media.removeAttribute("src"),this.load()}}},{key:"volume",get:function(){return this.media?this.media.volume:0},set:function(e){e===1/0||!this.media||(this.media.volume=e)}},{key:"aspectRatio",get:function(){return this.media?this.media.videoWidth/this.media.videoHeight:0}},{key:"addInnerOP",value:function(e){this._internalOp[e]=!0}},{key:"removeInnerOP",value:function(e){delete this._internalOp[e]}},{key:"emit",value:function(e,r){for(var o,a=arguments.length,u=new Array(a>2?a-2:0),l=2;l<a;l++)u[l-2]=arguments[l];(o=_e(ve(i.prototype),"emit",this)).call.apply(o,[this,e,r].concat(u))}},{key:"on",value:function(e,r){for(var o,a=arguments.length,u=new Array(a>2?a-2:0),l=2;l<a;l++)u[l-2]=arguments[l];(o=_e(ve(i.prototype),"on",this)).call.apply(o,[this,e,r].concat(u))}},{key:"once",value:function(e,r){for(var o,a=arguments.length,u=new Array(a>2?a-2:0),l=2;l<a;l++)u[l-2]=arguments[l];(o=_e(ve(i.prototype),"once",this)).call.apply(o,[this,e,r].concat(u))}},{key:"off",value:function(e,r){for(var o,a=arguments.length,u=new Array(a>2?a-2:0),l=2;l<a;l++)u[l-2]=arguments[l];(o=_e(ve(i.prototype),"off",this)).call.apply(o,[this,e,r].concat(u))}},{key:"offAll",value:function(){_e(ve(i.prototype),"removeAllListeners",this).call(this)}}]),i}(Vi),lp=function(){function n(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{name:"xgplayer",version:1,db:null,ojstore:{name:"xg-m4a",keypath:"vid"}};ae(this,n),this.indexedDB=window.indexedDB||window.webkitindexedDB,this.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange,this.myDB=s}return ue(n,[{key:"openDB",value:function(i){var t=this,e=this,r=this.myDB.version||1,o=e.indexedDB.open(e.myDB.name,r);o.onerror=function(a){},o.onsuccess=function(a){t.myDB.db=a.target.result,i.call(e)},o.onupgradeneeded=function(a){var u=a.target.result;a.target.transaction,u.objectStoreNames.contains(e.myDB.ojstore.name)||u.createObjectStore(e.myDB.ojstore.name,{keyPath:e.myDB.ojstore.keypath})}}},{key:"deletedb",value:function(){var i=this;i.indexedDB.deleteDatabase(this.myDB.name)}},{key:"closeDB",value:function(){this.myDB.db.close()}},{key:"addData",value:function(i,t){for(var e=this.myDB.db.transaction(i,"readwrite").objectStore(i),r,o=0;o<t.length;o++)r=e.add(t[o]),r.onerror=function(){},r.onsuccess=function(){}}},{key:"putData",value:function(i,t){for(var e=this.myDB.db.transaction(i,"readwrite").objectStore(i),r,o=0;o<t.length;o++)r=e.put(t[o]),r.onerror=function(){},r.onsuccess=function(){}}},{key:"getDataByKey",value:function(i,t,e){var r=this,o=this.myDB.db.transaction(i,"readwrite").objectStore(i),a=o.get(t);a.onerror=function(){e.call(r,null)},a.onsuccess=function(u){var l=u.target.result;e.call(r,l)}}},{key:"deleteData",value:function(i,t){var e=this.myDB.db.transaction(i,"readwrite").objectStore(i);e.delete(t)}},{key:"clearData",value:function(i){var t=this.myDB.db.transaction(i,"readwrite").objectStore(i);t.clear()}}]),n}(),$a=["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],qa=["requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen"],Xa=["exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],Ii="data-xgplayerid";function nr(n,s,i){for(var t=arguments.length,e=new Array(t>3?t-3:0),r=3;r<t;r++)e[r-3]=arguments[r];var o=s.call.apply(s,[n].concat(e));!i||typeof i!="function"||(o&&o.then?o.then(function(){for(var a=arguments.length,u=new Array(a),l=0;l<a;l++)u[l]=arguments[l];i.call.apply(i,[n].concat(u))}):i.call.apply(i,[n].concat(e)))}function Ar(n,s){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{pre:null,next:null};return this.__hooks||(this.__hooks={}),!this.__hooks[n]&&(this.__hooks[n]=null),(function(){var t=arguments,e=this;if(i.pre)try{var r;(r=i.pre).call.apply(r,[this].concat(Array.prototype.slice.call(arguments)))}catch(u){throw u.message="[pluginName: ".concat(this.pluginName,":").concat(n,":pre error] >> ").concat(u.message),u}if(this.__hooks&&this.__hooks[n])try{var o,a=(o=this.__hooks[n]).call.apply(o,[this,this].concat(Array.prototype.slice.call(arguments)));a?a.then?a.then(function(u){u!==!1&&nr.apply(void 0,[e,s,i.next].concat(Ot(t)))}).catch(function(u){throw u}):nr.apply(void 0,[this,s,i.next].concat(Array.prototype.slice.call(arguments))):a===void 0&&nr.apply(void 0,[this,s,i.next].concat(Array.prototype.slice.call(arguments)))}catch(u){throw u.message="[pluginName: ".concat(this.pluginName,":").concat(n,"] >> ").concat(u.message),u}else nr.apply(void 0,[this,s,i.next].concat(Array.prototype.slice.call(arguments)))}).bind(this)}function Lr(n,s){var i=this.__hooks;if(i)return i.hasOwnProperty(n)?(i&&(i[n]=s),!0):(console.warn("has no supported hook which name [".concat(n,"]")),!1)}function Or(n,s){var i=this.__hooks;i&&delete i[n]}function Ja(n){if(!(!this.plugins||!this.plugins[n.toLowerCase()])){for(var s=this.plugins[n.toLowerCase()],i=arguments.length,t=new Array(i>1?i-1:0),e=1;e<i;e++)t[e-1]=arguments[e];return s.useHooks&&s.useHooks.apply(s,t)}}function Qa(n){if(!(!this.plugins||!this.plugins[n.toLowerCase()])){var s=this.plugins[n.toLowerCase()];if(s){for(var i=arguments.length,t=new Array(i>1?i-1:0),e=1;e<i;e++)t[e-1]=arguments[e];return s.removeHooks&&s.removeHooks.apply(s,t)}}}function Dc(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];n.__hooks={},s&&s.map(function(i){n.__hooks[i]=null}),Object.defineProperty(n,"hooks",{get:function(){return n.__hooks&&Object.keys(n.__hooks).map(function(t){if(n.__hooks[t])return t})}})}function Mc(n){n.__hooks=null}function ii(n,s,i){for(var t=arguments.length,e=new Array(t>3?t-3:0),r=3;r<t;r++)e[r-3]=arguments[r];if(n.__hooks&&n.__hooks[s]){var o,a=(o=n.__hooks[s]).call.apply(o,[n,n].concat(e));if(a&&a.then)a.then(function(u){return u===!1?null:i.call.apply(i,[n,n].concat(e))}).catch(function(u){console.warn("[runHooks]".concat(s," reject"),u.message)});else if(a!==!1)return i.call.apply(i,[n,n].concat(e))}else return i.call.apply(i,[n,n].concat(e))}function ms(n,s){ke.logError("[".concat(n,"] event or callback cant be undefined or null when call ").concat(s))}var Yt=function(){function n(s){ae(this,n),p.checkIsFunction(this.beforeCreate)&&this.beforeCreate(s),Dc(this),this.__args=s,this.__events={},this.__onceEvents={},this.config=s.config||{},this.player=null,this.playerConfig={},this.pluginName="",this.__init(s)}return ue(n,[{key:"beforeCreate",value:function(i){}},{key:"afterCreate",value:function(){}},{key:"beforePlayerInit",value:function(){}},{key:"onPluginsReady",value:function(){}},{key:"afterPlayerInit",value:function(){}},{key:"destroy",value:function(){}},{key:"__init",value:function(i){this.player=i.player,this.playerConfig=i.player&&i.player.config,this.pluginName=i.pluginName?i.pluginName.toLowerCase():this.constructor.pluginName.toLowerCase(),this.logger=i.player&&i.player.logger}},{key:"updateLang",value:function(i){i||(i=this.lang)}},{key:"lang",get:function(){return this.player.lang}},{key:"i18n",get:function(){return this.player.i18n}},{key:"i18nKeys",get:function(){return this.player.i18nKeys}},{key:"domEventType",get:function(){var i=p.checkTouchSupport()?"touch":"mouse";return this.playerConfig&&(this.playerConfig.domEventType==="touch"||this.playerConfig.domEventType==="mouse")&&(i=this.playerConfig.domEventType),i}},{key:"on",value:function(i,t){var e=this;if(!i||!t||!this.player){ms(this.pluginName,"plugin.on(event, callback)");return}typeof i=="string"?(this.__events[i]=t,this.player.on(i,t)):Array.isArray(i)&&i.forEach(function(r){e.__events[r]=t,e.player.on(r,t)})}},{key:"once",value:function(i,t){var e=this;if(!i||!t||!this.player){ms(this.pluginName,"plugin.once(event, callback)");return}typeof i=="string"?(this.__onceEvents[i]=t,this.player.once(i,t)):Array.isArray(i)&&i.forEach(function(r){e.__onceEvents[r]=t,e.player.once(i,t)})}},{key:"off",value:function(i,t){var e=this;if(!i||!t||!this.player){ms(this.pluginName,"plugin.off(event, callback)");return}typeof i=="string"?(delete this.__events[i],this.player.off(i,t)):Array.isArray(i)&&i.forEach(function(r){delete e.__events[i],e.player.off(r,t)})}},{key:"offAll",value:function(){var i=this;["__events","__onceEvents"].forEach(function(t){Object.keys(i[t]).forEach(function(e){i[t][e]&&i.off(e,i[t][e]),e&&delete i[t][e]})}),this.__events={},this.__onceEvents={}}},{key:"emit",value:function(i){var t;if(this.player){for(var e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];(t=this.player).emit.apply(t,[i].concat(r))}}},{key:"emitUserAction",value:function(i,t){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.player){var r=ze(ze({},e),{},{pluginName:this.pluginName});this.player.emitUserAction(i,t,r)}}},{key:"hook",value:function(i,t){return Ar.call.apply(Ar,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"useHooks",value:function(i,t){for(var e=arguments.length,r=new Array(e>2?e-2:0),o=2;o<e;o++)r[o-2]=arguments[o];return Lr.call.apply(Lr,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removeHooks",value:function(i,t){for(var e=arguments.length,r=new Array(e>2?e-2:0),o=2;o<e;o++)r[o-2]=arguments[o];return Or.call.apply(Or,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"registerPlugin",value:function(i){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(this.player)return e&&(t.pluginName=e),this.player.registerPlugin({plugin:i,options:t})}},{key:"getPlugin",value:function(i){return this.player?this.player.getPlugin(i):null}},{key:"__destroy",value:function(){var i=this,t=this.player,e=this.pluginName;this.offAll(),p.clearAllTimers(this),p.checkIsFunction(this.destroy)&&this.destroy(),["player","playerConfig","pluginName","logger","__args","__hooks"].map(function(r){i[r]=null}),t.unRegisterPlugin(e),Mc(this)}}],[{key:"defineGetterOrSetter",value:function(i,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&Object.defineProperty(i,e,t[e])}},{key:"defaultConfig",get:function(){return{}}},{key:"pluginName",get:function(){return"pluginName"}}]),n}(),cp=9;if(typeof Element<"u"&&!Element.prototype.matches){var Yi=Element.prototype;Yi.matches=Yi.matchesSelector||Yi.mozMatchesSelector||Yi.msMatchesSelector||Yi.oMatchesSelector||Yi.webkitMatchesSelector}function fp(n,s){for(;n&&n.nodeType!==cp;){if(typeof n.matches=="function"&&n.matches(s))return n;n=n.parentNode}}var hp=fp,dp=hp;function ys(n,s,i,t,e){var r=pp.apply(this,arguments);return n.addEventListener(i,r,e),{destroy:function(){n.removeEventListener(i,r,e)}}}function gp(n,s,i,t,e){return typeof n.addEventListener=="function"?ys.apply(null,arguments):typeof i=="function"?ys.bind(null,document).apply(null,arguments):(typeof n=="string"&&(n=document.querySelectorAll(n)),Array.prototype.map.call(n,function(r){return ys(r,s,i,t,e)}))}function pp(n,s,i,t){return function(e){e.delegateTarget=dp(e.target,s),e.delegateTarget&&t.call(n,e)}}var vp=gp;const Za=qr(vp);var mp={CONTROLS:"controls",ROOT:"root"},He={ROOT:"root",ROOT_LEFT:"rootLeft",ROOT_RIGHT:"rootRight",ROOT_TOP:"rootTop",CONTROLS_LEFT:"controlsLeft",CONTROLS_RIGTH:"controlsRight",CONTROLS_RIGHT:"controlsRight",CONTROLS_CENTER:"controlsCenter",CONTROLS:"controls"},eu={ICON_DISABLE:"xg-icon-disable",ICON_HIDE:"xg-icon-hide"};function _s(n){return n?n.indexOf&&/^(?:http|data:|\/)/.test(n):!1}function yp(n,s){return ot(n)==="object"&&n.class&&typeof n.class=="string"?"".concat(s," ").concat(n.class):s}function _p(n,s){return ot(n)==="object"&&n.attr&&ot(n.attr)==="object"&&Object.keys(n.attr).map(function(i){s[i]=n.attr[i]}),s}function tu(n,s){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},e=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"",r=null;if(n instanceof window.Element)return p.addClass(n,i),Object.keys(t).map(function(o){n.setAttribute(o,t[o])}),n;if(_s(n)||_s(n.url))return t.src=_s(n)?n:n.url||"",r=p.createDom(n.tag||"img","",t,"xg-img ".concat(i)),r;if(typeof n=="function")try{return r=n(),r instanceof window.Element?(p.addClass(r,i),Object.keys(t).map(function(o){r.setAttribute(o,t[o])}),r):(ke.logWarn("warn>>icons.".concat(s," in config of plugin named [").concat(e,"] is a function mast return an Element Object")),null)}catch(o){return ke.logError("Plugin named [".concat(e,"]:createIcon"),o),null}return typeof n=="string"?p.createDomFromHtml(n,t,i):(ke.logWarn("warn>>icons.".concat(s," in config of plugin named [").concat(e,"] is invalid")),null)}function bp(n,s){var i=s.config.icons||s.playerConfig.icons;Object.keys(n).map(function(t){var e=n[t],r=e&&e.class?e.class:"",o=e&&e.attr?e.attr:{},a=null;i&&i[t]&&(r=yp(i[t],r),o=_p(i[t],o),a=tu(i[t],t,r,o,s.pluginName)),!a&&e&&(a=tu(e.icon?e.icon:e,o,r,{},s.pluginName)),s.icons[t]=a})}function Ep(n,s){Object.keys(n).map(function(i){Object.defineProperty(s.langText,i,{get:function(){var e=s.lang,r=s.i18n;return r[i]?r[i]:n[i]&&n[i][e]||""}})})}var Ie=function(n){de(i,n);var s=ge(i);function i(){var t,e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ae(this,i),t=s.call(this,e),t.__delegates=[],t}return ue(i,[{key:"__init",value:function(e){if(_e(ve(i.prototype),"__init",this).call(this,e),!!e.root){var r=e.root,o=null;this.icons={},this.root=null,this.parent=null;var a=this.registerIcons()||{};bp(a,this),this.langText={};var u=this.registerLanguageTexts()||{};Ep(u,this);var l="";try{l=this.render()}catch(h){throw ke.logError("Plugin:".concat(this.pluginName,":render"),h),new Error("Plugin:".concat(this.pluginName,":render:").concat(h.message))}if(l)o=i.insert(l,r,e.index),o.setAttribute("data-index",e.index);else if(e.tag)o=p.createDom(e.tag,"",e.attr,e.name),o.setAttribute("data-index",e.index),r.appendChild(o);else return;this.root=o,this.parent=r;var c=this.config.attr||{},f=this.config.style||{};this.setAttr(c),this.setStyle(f),this.config.index&&this.root.setAttribute("data-index",this.config.index),this.__registerChildren()}}},{key:"__registerChildren",value:function(){var e=this;if(this.root){this._children=[];var r=this.children();r&&ot(r)==="object"&&Object.keys(r).length>0&&Object.keys(r).map(function(o){var a=o,u=r[a],l={root:e.root},c,f;typeof u=="function"?(c=e.config[a]||{},f=u):ot(u)==="object"&&typeof u.plugin=="function"&&(c=u.options?p.deepCopy(e.config[a]||{},u.options):e.config[a]||{},f=u.plugin),l.config=c,c.index!==void 0&&(l.index=c.index),c.root&&(l.root=c.root),e.registerPlugin(f,l,a)})}}},{key:"updateLang",value:function(e){e||(e=this.lang);function r(l,c){for(var f=0;f<l.children.length;f++)l.children[f].children.length>0?r(l.children[f],c):c(l.children[f])}var o=this.root,a=this.i18n,u=this.langText;o&&r(o,function(l){var c=l.getAttribute&&l.getAttribute("lang-key");if(c){var f=a[c.toUpperCase()]||u[c];f&&(l.innerHTML=typeof f=="function"?f(e):f)}})}},{key:"lang",get:function(){return this.player.lang}},{key:"changeLangTextKey",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",o=this.i18n||{},a=this.langText;e.setAttribute&&e.setAttribute("lang-key",r);var u=o[r]||a[r]||"";u&&(e.innerHTML=u)}},{key:"plugins",value:function(){return this._children}},{key:"disable",value:function(){this.config.disable=!0,p.addClass(this.find(".xgplayer-icon"),eu.ICON_DISABLE)}},{key:"enable",value:function(){this.config.disable=!1,p.removeClass(this.find(".xgplayer-icon"),eu.ICON_DISABLE)}},{key:"children",value:function(){return{}}},{key:"registerPlugin",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";r.root=r.root||this.root;var a=_e(ve(i.prototype),"registerPlugin",this).call(this,e,r,o);return this._children.push(a),a}},{key:"registerIcons",value:function(){return{}}},{key:"registerLanguageTexts",value:function(){return{}}},{key:"find",value:function(e){if(this.root)return this.root.querySelector(e)}},{key:"bind",value:function(e,r,o){var a=this;if(arguments.length<3&&typeof r=="function")Array.isArray(e)?e.forEach(function(l){a.bindEL(l,r)}):this.bindEL(e,r);else{var u=i.delegate.call(this,this.root,e,r,o);this.__delegates=this.__delegates.concat(u)}}},{key:"unbind",value:function(e,r){var o=this;if(arguments.length<3&&typeof r=="function")Array.isArray(e)?e.forEach(function(l){o.unbindEL(l,r)}):this.unbindEL(e,r);else for(var a="".concat(e,"_").concat(r),u=0;u<this.__delegates.length;u++)if(this.__delegates[u].key===a){this.__delegates[u].destroy(),this.__delegates.splice(u,1);break}}},{key:"setStyle",value:function(e,r){var o=this;if(this.root){if(p.typeOf(e)==="String")return this.root.style[e]=r;p.typeOf(e)==="Object"&&Object.keys(e).map(function(a){o.root.style[a]=e[a]})}}},{key:"setAttr",value:function(e,r){var o=this;if(this.root){if(p.typeOf(e)==="String")return this.root.setAttribute(e,r);p.typeOf(e)==="Object"&&Object.keys(e).map(function(a){o.root.setAttribute(a,e[a])})}}},{key:"setHtml",value:function(e,r){this.root&&(this.root.innerHTML=e,typeof r=="function"&&r())}},{key:"bindEL",value:function(e,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.root&&"on".concat(e)in this.root&&typeof r=="function"&&this.root.addEventListener(e,r,o)}},{key:"unbindEL",value:function(e,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.root&&"on".concat(e)in this.root&&typeof r=="function"&&this.root.removeEventListener(e,r,o)}},{key:"show",value:function(e){if(this.root){this.root.style.display=e!==void 0?e:"block";var r=window.getComputedStyle(this.root,null),o=r.getPropertyValue("display");if(o==="none")return this.root.style.display="block"}}},{key:"hide",value:function(){this.root&&(this.root.style.display="none")}},{key:"appendChild",value:function(e,r){if(!this.root)return null;if(arguments.length<2&&arguments[0]instanceof window.Element)return this.root.appendChild(arguments[0]);if(!r||!(r instanceof window.Element))return null;try{return typeof e=="string"?this.find(e).appendChild(r):e.appendChild(r)}catch(o){return ke.logError("Plugin:appendChild",o),null}}},{key:"render",value:function(){return""}},{key:"destroy",value:function(){}},{key:"__destroy",value:function(){var e=this,r=this.player;this.__delegates.map(function(o){o.destroy()}),this.__delegates=[],this._children instanceof Array&&(this._children.map(function(o){r.unRegisterPlugin(o.pluginName)}),this._children=null),this.root&&(this.root.hasOwnProperty("remove")?this.root.remove():this.root.parentNode&&this.root.parentNode.removeChild(this.root)),_e(ve(i.prototype),"__destroy",this).call(this),this.icons={},["root","parent"].map(function(o){e[o]=null})}}],[{key:"insert",value:function(e,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=r.children.length,u=Number(o),l=e instanceof window.Node;if(a){for(var c=0,f=null,h="";c<a;c++){f=r.children[c];var d=Number(f.getAttribute("data-index"));if(d>=u){h="beforebegin";break}else d<u&&(h="afterend")}return l?h==="afterend"?r.appendChild(e):r.insertBefore(e,f):f.insertAdjacentHTML(h,e),h==="afterend"?r.children[r.children.length-1]:r.children[c]}else return l?r.appendChild(e):r.insertAdjacentHTML("beforeend",e),r.children[r.children.length-1]}},{key:"defaultConfig",get:function(){return{}}},{key:"delegate",value:function(e,r,o,a){var u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,l=[];if(e instanceof window.Node&&typeof a=="function")if(Array.isArray(o))o.forEach(function(f){var h=Za(e,r,f,a,u);h.key="".concat(r,"_").concat(f),l.push(h)});else{var c=Za(e,r,o,a,u);c.key="".concat(r,"_").concat(o),l.push(c)}return l}},{key:"ROOT_TYPES",get:function(){return mp}},{key:"POSITIONS",get:function(){return He}}]),i}(Yt),Tp=function(){function n(){var s=this;if(ae(this,n),D(this,"__trigger",function(i){var t=new Date().getTime();s.timeStamp=t;for(var e=0;e<i.length;e++)s.__runHandler(i[e].target)}),this.__handlers=[],this.timeStamp=0,this.observer=null,!!window.ResizeObserver)try{this.observer=new window.ResizeObserver(Kg(this.__trigger,100,{trailing:!0})),this.timeStamp=new Date().getTime()}catch(i){console.error(i)}}return ue(n,[{key:"addObserver",value:function(i,t){if(this.observer){this.observer&&this.observer.observe(i);for(var e=i.getAttribute(Ii),r=this.__handlers,o=-1,a=0;a<r.length;a++)r[a]&&i===r[a].target&&(o=a);o>-1?this.__handlers[o].handler=t:this.__handlers.push({target:i,handler:t,playerId:e})}}},{key:"unObserver",value:function(i){var t=-1;this.__handlers.map(function(e,r){i===e.target&&(t=r)});try{this.observer&&this.observer.unobserve(i)}catch{}this.observer&&this.observer.unobserve(i),t>-1&&this.__handlers.splice(t,1)}},{key:"destroyObserver",value:function(){this.observer&&this.observer.disconnect(),this.observer=null,this.__handlers=null}},{key:"__runHandler",value:function(i){for(var t=this.__handlers,e=0;e<t.length;e++)if(t[e]&&i===t[e].target){try{t[e].handler(i)}catch(r){console.error(r)}return!0}return!1}}]),n}(),kn=null;function Sp(n,s){return kn||(kn=new Tp),kn.addObserver(n,s),kn}function wp(n,s){kn.unObserver(n,s)}var Je={pluginGroup:{},init:function(s){var i=s._pluginInfoId;i||(i=new Date().getTime(),s._pluginInfoId=i),!s.config.closeResizeObserver&&Sp(s.root,function(){s.resize()}),this.pluginGroup[i]={_originalOptions:s.config||{},_plugins:{}}},formatPluginInfo:function(s,i){var t=null,e=null;return s.plugin&&typeof s.plugin=="function"?(t=s.plugin,e=s.options):(t=s,e={}),i&&(e.config=i||{}),{PLUFGIN:t,options:e}},checkPluginIfExits:function(s,i){for(var t=0;t<i.length;t++)if(s.toLowerCase()===i[t].pluginName.toLowerCase())return!0;return!1},getRootByConfig:function(s,i){for(var t=Object.keys(i),e=null,r=0;r<t.length;r++)if(s.toLowerCase()===t[r].toLowerCase()){e=i[t[r]];break}return p.typeOf(e)==="Object"?{root:e.root,position:e.position}:{}},lazyRegister:function(s,i){var t=this,e=i.timeout||1500;return Promise.race([i.loader().then(function(r){var o;r&&r.__esModule?o=r.default:o=r,t.register(s,o,r.options)}),new Promise(function(r,o){setTimeout(function(){o(new Error("timeout"))},e)})])},register:function(s,i){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!(!s||!i||typeof i!="function"||i.prototype===void 0)){var e=s._pluginInfoId;if(!(!e||!this.pluginGroup[e])){this.pluginGroup[e]._plugins||(this.pluginGroup[e]._plugins={});var r=this.pluginGroup[e]._plugins,o=this.pluginGroup[e]._originalOptions;t.player=s;var a=t.pluginName||i.pluginName;if(!a)throw new Error("The property pluginName is necessary");if(i.isSupported&&!i.isSupported(s.config.mediaType,s.config.codecType)){console.warn("not supported plugin [".concat(a,"]"));return}t.config||(t.config={});for(var u=Object.keys(o),l=0;l<u.length;l++)if(a.toLowerCase()===u[l].toLowerCase()){var c=o[u[l]];p.typeOf(c)==="Object"?t.config=Object.assign({},t.config,o[u[l]]):p.typeOf(c)==="Boolean"&&(t.config.disable=!c);break}i.defaultConfig&&Object.keys(i.defaultConfig).forEach(function(h){typeof t.config[h]>"u"&&(t.config[h]=i.defaultConfig[h])}),t.root?typeof t.root=="string"&&(t.root=s[t.root]):t.root=s.root,t.index=t.config.index||0;try{r[a.toLowerCase()]&&(this.unRegister(e,a.toLowerCase()),console.warn("the is one plugin with same pluginName [".concat(a,"] exist, destroy the old instance")));var f=new i(t);return r[a.toLowerCase()]=f,r[a.toLowerCase()].func=i,f&&typeof f.afterCreate=="function"&&f.afterCreate(),f}catch(h){throw console.error(h),h}}}},unRegister:function(s,i){s._pluginInfoId&&(s=s._pluginInfoId),i=i.toLowerCase();try{var t=this.pluginGroup[s]._plugins[i];t&&(t.pluginName&&t.__destroy(),delete this.pluginGroup[s]._plugins[i])}catch(e){console.error("[unRegister:".concat(i,"] cgid:[").concat(s,"] error"),e)}},deletePlugin:function(s,i){var t=s._pluginInfoId;t&&this.pluginGroup[t]&&this.pluginGroup[t]._plugins&&delete this.pluginGroup[t]._plugins[i]},getPlugins:function(s){var i=s._pluginInfoId;return i&&this.pluginGroup[i]?this.pluginGroup[i]._plugins:{}},findPlugin:function(s,i){var t=s._pluginInfoId;if(!t||!this.pluginGroup[t])return null;var e=i.toLowerCase();return this.pluginGroup[t]._plugins[e]},beforeInit:function(s){var i=this;function t(e){return!e||!e.then?new Promise(function(r){r()}):e}return new Promise(function(e){if(i.pluginGroup){var r;return s._loadingPlugins&&s._loadingPlugins.length?r=Promise.all(s._loadingPlugins):r=Promise.resolve(),r.then(function(){var o=s._pluginInfoId;if(!i.pluginGroup[o]){e();return}var a=i.pluginGroup[o]._plugins,u=[];Object.keys(a).forEach(function(l){if(a[l]&&a[l].beforePlayerInit)try{var c=a[l].beforePlayerInit();u.push(t(c))}catch(f){throw u.push(t(null)),f}}),Promise.all([].concat(u)).then(function(){e()}).catch(function(l){console.error(l),e()})})}})},afterInit:function(s){var i=s._pluginInfoId;if(!(!i||!this.pluginGroup[i])){var t=this.pluginGroup[i]._plugins;Object.keys(t).forEach(function(e){t[e]&&t[e].afterPlayerInit&&t[e].afterPlayerInit()})}},setLang:function(s,i){var t=i._pluginInfoId;if(!(!t||!this.pluginGroup[t])){var e=this.pluginGroup[t]._plugins;Object.keys(e).forEach(function(r){if(e[r].updateLang)e[r].updateLang(s);else try{e[r].lang=s}catch{console.warn("".concat(r," setLang"))}})}},reRender:function(s){var i=this,t=s._pluginInfoId;if(!(!t||!this.pluginGroup[t])){var e=[],r=this.pluginGroup[t]._plugins;Object.keys(r).forEach(function(o){o!=="controls"&&r[o]&&(e.push({plugin:r[o].func,options:r[o].__args}),i.unRegister(t,o))}),e.forEach(function(o){i.register(s,o.plugin,o.options)})}},onPluginsReady:function(s){var i=s._pluginInfoId;if(!(!i||!this.pluginGroup[i])){var t=this.pluginGroup[i]._plugins||{};Object.keys(t).forEach(function(e){t[e].onPluginsReady&&typeof t[e].onPluginsReady=="function"&&t[e].onPluginsReady()})}},destroy:function(s){var i=s._pluginInfoId;if(this.pluginGroup[i]){wp(s.root);for(var t=this.pluginGroup[i]._plugins,e=0,r=Object.keys(t);e<r.length;e++){var o=r[e];this.unRegister(i,o)}delete this.pluginGroup[i],delete s._pluginInfoId}}},z={DEFAULT:"xgplayer",DEFAULT_SKIN:"xgplayer-skin-default",ENTER:"xgplayer-is-enter",PAUSED:"xgplayer-pause",PLAYING:"xgplayer-playing",ENDED:"xgplayer-ended",CANPLAY:"xgplayer-canplay",LOADING:"xgplayer-isloading",ERROR:"xgplayer-is-error",REPLAY:"xgplayer-replay",NO_START:"xgplayer-nostart",ACTIVE:"xgplayer-active",INACTIVE:"xgplayer-inactive",FULLSCREEN:"xgplayer-is-fullscreen",CSS_FULLSCREEN:"xgplayer-is-cssfullscreen",ROTATE_FULLSCREEN:"xgplayer-rotate-fullscreen",PARENT_ROTATE_FULLSCREEN:"xgplayer-rotate-parent",PARENT_FULLSCREEN:"xgplayer-fullscreen-parent",INNER_FULLSCREEN:"xgplayer-fullscreen-inner",NO_CONTROLS:"no-controls",FLEX_CONTROLS:"flex-controls",CONTROLS_FOLLOW:"controls-follow",CONTROLS_AUTOHIDE:"controls-autohide",TOP_BAR_AUTOHIDE:"top-bar-autohide",NOT_ALLOW_AUTOPLAY:"not-allow-autoplay",SEEKING:"seeking",PC:"xgplayer-pc",MOBILE:"xgplayer-mobile",MINI:"xgplayer-mini"};function iu(){return{id:"",el:null,url:"",domEventType:"default",nullUrlStart:!1,width:600,height:337.5,fluid:!1,fitVideoSize:"fixed",videoFillMode:"auto",volume:.6,autoplay:!1,autoplayMuted:!1,loop:!1,isLive:!1,zoom:1,videoInit:!0,poster:"",isMobileSimulateMode:!1,defaultPlaybackRate:1,execBeforePluginsCall:null,allowSeekAfterEnded:!0,enableContextmenu:!0,closeVideoClick:!1,closeVideoDblclick:!1,closePlayerBlur:!1,closeDelayBlur:!1,leavePlayerTime:3e3,closePlayVideoFocus:!1,closePauseVideoFocus:!1,closeFocusVideoFocus:!0,closeControlsBlur:!0,topBarAutoHide:!0,videoAttributes:{},startTime:0,seekedStatus:"play",miniprogress:!1,disableSwipeHandler:function(){},enableSwipeHandler:function(){},preProcessUrl:null,ignores:[],whitelist:[],inactive:3e3,lang:Yg(),controls:!0,marginControls:!1,fullscreenTarget:null,screenShot:!1,rotate:!1,pip:!1,download:!1,mini:!1,cssFullscreen:!0,keyShortcut:!0,presets:[],plugins:[],playbackRate:1,definition:{list:[]},playsinline:!0,customDuration:0,timeOffset:0,icons:{},i18n:[],tabindex:0,thumbnail:null,videoConfig:{},isHideTips:!1,minWaitDelay:200,commonStyle:{progressColor:"",playedColor:"",cachedColor:"",sliderBtnStyle:{},volumeColor:""}}}var Cp=function(s,i){var t,e,r;i.preset&&i.options?r=new i.preset(i.options,s.config):r=new i({},s.config);var o=r,a=o.plugins,u=a===void 0?[]:a,l=o.ignores,c=l===void 0?[]:l,f=o.icons,h=f===void 0?{}:f,d=o.i18n,g=d===void 0?[]:d;s.config.plugins||(s.config.plugins=[]),s.config.ignores||(s.config.ignores=[]),(t=s.config.plugins).push.apply(t,Ot(u)),(e=s.config.ignores).push.apply(e,Ot(c)),Object.keys(h).map(function(m){s.config.icons[m]||(s.config.icons[m]=h[m])});var v=s.config.i18n||[];g.push.apply(g,Ot(v)),s.config.i18n=g},kp=function(n){de(i,n);var s=ge(i);function i(){var t;ae(this,i);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t=s.call.apply(s,[this].concat(r)),D(R(t),"onMouseEnter",function(a){var u=R(t),l=u.player,c=u.playerConfig;c.closeControlsBlur&&l.focus({autoHide:!1})}),D(R(t),"onMouseLeave",function(a){var u=R(t),l=u.player;l.focus()}),t}return ue(i,[{key:"beforeCreate",value:function(e){!e.config.mode&&Te.device==="mobile"&&(e.config.mode="flex"),e.player.config.marginControls&&(e.config.autoHide=!1)}},{key:"afterCreate",value:function(){var e=this,r=this.config,o=r.disable,a=r.height,u=r.mode;if(!o){u==="flex"&&this.player.addClass(z.FLEX_CONTROLS);var l={height:"".concat(a,"px")};Object.keys(l).map(function(f){e.root.style[f]=l[f]}),this.left=this.find("xg-left-grid"),this.center=this.find("xg-center-grid"),this.right=this.find("xg-right-grid"),this.innerRoot=this.find("xg-inner-controls"),this.on(Pr,function(f){f?p.addClass(e.root,"mini-controls"):p.removeClass(e.root,"mini-controls")});var c=this.playerConfig.isMobileSimulateMode;Te.device!=="mobile"&&c!=="mobile"&&(this.bind("mouseenter",this.onMouseEnter),this.bind("mouseleave",this.onMouseLeave))}}},{key:"focus",value:function(){this.player.focus({autoHide:!1})}},{key:"focusAwhile",value:function(){this.player.focus({autoHide:!0})}},{key:"blur",value:function(){this.player.blur({ignorePaused:!0})}},{key:"recoverAutoHide",value:function(){this.config.autoHide&&p.addClass(this.root,z.CONTROLS_AUTOHIDE)}},{key:"pauseAutoHide",value:function(){p.removeClass(this.root,z.CONTROLS_AUTOHIDE)}},{key:"show",value:function(e){this.root.style.display="",this.player.focus()}},{key:"hide",value:function(){this.root.style.display="none"}},{key:"mode",get:function(){return this.config.mode}},{key:"registerPlugin",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;if(this.root){var a=e.defaultConfig||{};if(!r.root){var u=r.position?r.position:r.config&&r.config.position?r.config.position:a.position;switch(u){case He.CONTROLS_LEFT:r.root=this.left;break;case He.CONTROLS_RIGHT:r.root=this.right;break;case He.CONTROLS_CENTER:r.root=this.center;break;case He.CONTROLS:r.root=this.root;break;default:r.root=this.left}return _e(ve(i.prototype),"registerPlugin",this).call(this,e,r,o)}}}},{key:"destroy",value:function(){Te.device!=="mobile"&&(this.unbind("mouseenter",this.onMouseEnter),this.unbind("mouseleave",this.onMouseLeave))}},{key:"render",value:function(){var e=this.config,r=e.mode,o=e.autoHide,a=e.initShow,u=e.disable;if(!u){var l=p.classNames({"xgplayer-controls":!0},{"flex-controls":r==="flex"},{"bottom-controls":r==="bottom"},D({},z.CONTROLS_AUTOHIDE,o),{"xgplayer-controls-initshow":a||!o});return'<xg-controls class="'.concat(l,`" unselectable="on">
    <xg-inner-controls class="xg-inner-controls xg-pos">
      <xg-left-grid class="xg-left-grid">
      </xg-left-grid>
      <xg-center-grid class="xg-center-grid"></xg-center-grid>
      <xg-right-grid class="xg-right-grid">
      </xg-right-grid>
    </xg-inner-controls>
    </xg-controls>`)}}}],[{key:"pluginName",get:function(){return"controls"}},{key:"defaultConfig",get:function(){return{disable:!1,autoHide:!0,mode:"",initShow:!1}}}]),i}(Ie),Pp={LANG:"en",TEXT:{ERROR_TYPES:{network:{code:1,msg:"video download error"},mse:{code:2,msg:"stream append error"},parse:{code:3,msg:"parsing error"},format:{code:4,msg:"wrong format"},decoder:{code:5,msg:"decoding error"},runtime:{code:6,msg:"grammatical errors"},timeout:{code:7,msg:"play timeout"},other:{code:8,msg:"other errors"}},HAVE_NOTHING:"There is no information on whether audio/video is ready",HAVE_METADATA:"Audio/video metadata is ready ",HAVE_CURRENT_DATA:"Data about the current play location is available, but there is not enough data to play the next frame/millisecond",HAVE_FUTURE_DATA:"Current and at least one frame of data is available",HAVE_ENOUGH_DATA:"The available data is sufficient to start playing",NETWORK_EMPTY:"Audio/video has not been initialized",NETWORK_IDLE:"Audio/video is active and has been selected for resources, but no network is used",NETWORK_LOADING:"The browser is downloading the data",NETWORK_NO_SOURCE:"No audio/video source was found",MEDIA_ERR_ABORTED:"The fetch process is aborted by the user",MEDIA_ERR_NETWORK:"An error occurred while downloading",MEDIA_ERR_DECODE:"An error occurred while decoding",MEDIA_ERR_SRC_NOT_SUPPORTED:"Audio/video is not supported",REPLAY:"Replay",ERROR:"Network is offline",PLAY_TIPS:"Play",PAUSE_TIPS:"Pause",PLAYNEXT_TIPS:"Play next",DOWNLOAD_TIPS:"Download",ROTATE_TIPS:"Rotate",RELOAD_TIPS:"Reload",FULLSCREEN_TIPS:"Fullscreen",EXITFULLSCREEN_TIPS:"Exit fullscreen",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"Exit cssfullscreen",TEXTTRACK:"Caption",PIP:"PIP",SCREENSHOT:"Screenshot",LIVE:"LIVE",OFF:"Off",OPEN:"Open",MINI_DRAG:"Click and hold to drag",MINISCREEN:"Miniscreen",REFRESH_TIPS:"Please Try",REFRESH:"Refresh",FORWARD:"forward",LIVE_TIP:"Live"}},mt={lang:{},langKeys:[],textKeys:[]};function Kn(n,s){return Object.keys(s).forEach(function(i){var t=p.typeOf(s[i]),e=p.typeOf(n[i]);if(t==="Array"){var r;e!=="Array"&&(n[i]=[]),(r=n[i]).push.apply(r,Ot(s[i]))}else t==="Object"?(e!=="Object"&&(n[i]={}),Kn(n[i],s[i])):n[i]=s[i]}),n}function Nc(){Object.keys(mt.lang.en).map(function(n){mt.textKeys[n]=n})}function xp(n,s){var i=[];if(s||(s=mt),!!s.lang){p.typeOf(n)!=="Array"?i=Object.keys(n).map(function(r){var o=r==="zh"?"zh-cn":r;return{LANG:o,TEXT:n[r]}}):i=n;var t=s,e=t.lang;i.map(function(r){r.LANG==="zh"&&(r.LANG="zh-cn"),e[r.LANG]?Kn(e[r.LANG]||{},r.TEXT||{}):Bo(r,s)}),Nc()}}function Bo(n,s){var i=n.LANG;if(s||(s=mt),!!s.lang){var t=n.TEXT||{};i==="zh"&&(i="zh-cn"),s.lang[i]?Kn(s.lang[i],t):(s.langKeys.push(i),s.lang[i]=t),Nc()}}function Rp(n){var s,i={lang:{},langKeys:[],textKeys:{},pId:n};return Kn(i.lang,mt.lang),(s=i.langKeys).push.apply(s,Ot(mt.langKeys)),Kn(i.textKeys,mt.textKeys),i}Bo(Pp);var on={get textKeys(){return mt.textKeys},get langKeys(){return mt.langKeys},get lang(){var n={};return mt.langKeys.map(function(s){n[s]=mt.lang[s]}),mt.lang["zh-cn"]&&(n.zh=mt.lang["zh-cn"]||{}),n},extend:xp,use:Bo,init:Rp},Pe={INITIAL:1,READY:2,ATTACHING:3,ATTACHED:4,NOTALLOW:5,RUNNING:6,ENDED:7,DESTROYED:8},nu=["ERROR","INITIAL","READY","ATTACHING","ATTACHED","NOTALLOW","RUNNING","ENDED","DESTROYED"],ut={},bs=null,Fc=function(n){de(i,n);var s=ge(i);function i(){return ae(this,i),s.apply(this,arguments)}return ue(i,[{key:"add",value:function(e){e&&(ut[e.playerId]=e,Object.keys(ut).length===1&&this.setActive(e.playerId,!0))}},{key:"remove",value:function(e){e&&(e.isUserActive,delete ut[e.playerId])}},{key:"_iterate",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;for(var o in ut)if(Object.prototype.hasOwnProperty.call(ut,o)){var a=ut[o];if(r){if(e(a))break}else e(a)}}},{key:"forEach",value:function(e){this._iterate(e)}},{key:"find",value:function(e){var r=null;return this._iterate(function(o){var a=e(o);return a&&(r=o),a},!0),r}},{key:"findAll",value:function(e){var r=[];return this._iterate(function(o){e(o)&&r.push(o)}),r}},{key:"setActive",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(ut[e])return r?this.forEach(function(o){e===o.playerId?(o.isUserActive=!0,o.isInstNext=!1):o.isUserActive=!1}):ut[e].isUserActive=r,e}},{key:"getActiveId",value:function(){for(var e=Object.keys(ut),r=0;r<e.length;r++){var o=ut[e[r]];if(o&&o.isUserActive)return e[r]}return null}},{key:"setNext",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(ut[e])return r?this.forEach(function(o){e===o.playerId?(o.isUserActive=!1,o.isInstNext=!0):o.isInstNext=!1}):ut[e].isInstNext=r,e}}],[{key:"getInstance",value:function(){return bs||(bs=new i),bs}}]),i}(pc.EventEmitter);function Ip(n){for(var s=Object.keys(ut),i=0;i<s.length;i++){var t=ut[s[i]];if(t.root===n)return t}return null}var Ap=["play","pause","replay","retry"],ru=0,su=0,hi=null,Zr=function(n){de(i,n);var s=ge(i);function i(t){var e;ae(this,i);var r=p.deepMerge(iu(),t);e=s.call(this,r),D(R(e),"canPlayFunc",function(){if(e.config){var g=e.config,v=g.autoplay,m=g.defaultPlaybackRate;ke.logInfo("player","canPlayFunc, startTime",e.__startTime),e.__startTime>0&&e.duration>0&&(e.currentTime=e.__startTime>e.duration?e.duration:e.__startTime,e.__startTime=-1),e.playbackRate=m,(v||e._useAutoplay)&&e.mediaPlay(),e.off(ni,e.canPlayFunc),e.removeClass(z.ENTER)}}),D(R(e),"onFullscreenChange",function(g,v){var m=function(){p.setTimeout(R(e),function(){e.resize()},100)},S=p.getFullScreenEl();e._fullActionFrom?e._fullActionFrom="":e.emit(Ir,{eventType:"system",action:"switch_fullscreen",pluginName:"player",currentTime:e.currentTime,duration:e.duration,props:[{prop:"fullscreen",from:!0,to:!1}]});var w=$g(S,e.playerId,Ii);if(v||S&&(S===e._fullscreenEl||w))m(),!e.config.closeFocusVideoFocus&&e.media.focus(),e.fullscreen=!0,e.changeFullStyle(e.root,S,z.FULLSCREEN),e.emit(Zt,!0,e._fullScreenOffset),e.cssfullscreen&&e.exitCssFullscreen();else if(e.fullscreen){m();var _=R(e),P=_._fullScreenOffset,I=_.config;I.needFullscreenScroll?(window.scrollTo(P.left,P.top),p.setTimeout(R(e),function(){e.fullscreen=!1,e._fullScreenOffset=null},100)):(!e.config.closeFocusVideoFocus&&e.media.focus(),e.fullscreen=!1,e._fullScreenOffset=null),e.cssfullscreen?e.removeClass(z.FULLSCREEN):e.recoverFullStyle(e.root,e._fullscreenEl,z.FULLSCREEN),e._fullscreenEl=null,e.emit(Zt,!1)}}),D(R(e),"_onWebkitbeginfullscreen",function(g){e._fullscreenEl=e.media,e.onFullscreenChange(g,!0)}),D(R(e),"_onWebkitendfullscreen",function(g){e.onFullscreenChange(g,!1)}),Dc(R(e),Ap),e.config=r,e._pluginInfoId=p.generateSessionId(),Vg(R(e));var o=e.constructor.defaultPreset;if(e.config.presets.length){var a=e.config.presets.indexOf("default");a>=0&&o&&(e.config.presets[a]=o)}else o&&e.config.presets.push(o);e.userTimer=null,e.waitTimer=null,e.handleSource=!0,e._state=Pe.INITIAL,e.isError=!1,e._hasStart=!1,e.isSeeking=!1,e.isCanplay=!1,e._useAutoplay=!1,e.__startTime=-1,e.rotateDeg=0,e.isActive=!1,e.fullscreen=!1,e.cssfullscreen=!1,e.isRotateFullscreen=!1,e._fullscreenEl=null,e.timeSegments=[],e._cssfullscreenEl=null,e.curDefinition=null,e._orgCss="",e._fullScreenOffset=null,e._videoHeight=0,e._videoWidth=0,e.videoPos={pi:1,scale:0,rotate:-1,x:0,y:0,h:-1,w:-1,vy:0,vx:0},e.sizeInfo={width:0,height:0,left:0,top:0},e._accPlayed={t:0,acc:0,loopAcc:0},e._offsetInfo={currentTime:-1,duration:0},e.innerContainer=null,e.controls=null,e.topBar=null,e.root=null,e.__i18n=on.init(e._pluginInfoId),Te.os.isAndroid&&Te.osVersion>0&&Te.osVersion<6&&(e.config.autoplay=!1),e.database=new lp,e.isUserActive=!1,e._onceSeekCanplay=null,e._isPauseBeforeSeek=0,e.innerStates={isActiveLocked:!1},e.instManager=hi;var u=e._initDOM();if(!u)return console.error(new Error("can't find the dom which id is ".concat(e.config.id," or this.config.el does not exist"))),Ao(e);var l=e.config,c=l.definition,f=c===void 0?{}:c,h=l.url;if(!h&&f.list&&f.list.length>0){var d=f.list.find(function(g){return g.definition&&g.definition===f.defaultDefinition});d||(f.defaultDefinition=f.list[0].definition,d=f.list[0]),e.config.url=d.url,e.curDefinition=d}return e._bindEvents(),e._registerPresets(),e._registerPlugins(),Je.onPluginsReady(R(e)),e.getInitDefinition(),e.setState(Pe.READY),p.setTimeout(R(e),function(){e.emit(Mo)},0),e.onReady&&e.onReady(),(e.config.videoInit||e.config.autoplay)&&(!e.hasStart||e.state<Pe.ATTACHED)&&e.start(),e}return ue(i,[{key:"_initDOM",value:function(){var e,r=this;if(this.root=this.config.id?document.getElementById(this.config.id):null,!this.root){var o=this.config.el;if(o&&o.nodeType===1)this.root=o;else return this.emit(Jn,new ti("use",this.config.vid,{line:32,handle:"Constructor",msg:"container id can't be empty"})),console.error("this.confg.id or this.config.el can't be empty"),!1}var a=Ip(this.root);a&&(ke.logWarn("The is an Player instance already exists in this.root, destroy it and reinitialize"),a.destroy()),this.root.setAttribute(Ii,this.playerId),(e=hi)===null||e===void 0||e.add(this),Je.init(this),this._initBaseDoms();var u=this.constructor.XgVideoProxy;if(u&&this.mediaConfig.mediaType===u.mediaType){var l=this.innerContainer||this.root;this.detachVideoEvents(this.media);var c=new u(l,this.config,this.mediaConfig);this.attachVideoEvents(c),this.media=c}if(this.media.setAttribute(Ii,this.playerId),this.config.controls){var f=this.config.controls.root||null,h=Je.register(this,kp,{root:f});this.controls=h}var d=this.config.isMobileSimulateMode==="mobile"?"mobile":Te.device;if(this.addClass("".concat(z.DEFAULT," ").concat(z.INACTIVE," xgplayer-").concat(d," ").concat(this.config.controls?"":z.NO_CONTROLS)),this.config.autoplay?this.addClass(z.ENTER):this.addClass(z.NO_START),this.config.fluid){var g=this.config,v=g.width,m=g.height;(typeof v!="number"||typeof m!="number")&&(v=600,m=337.5);var S={width:"100%",height:"0","max-width":"100%","padding-top":"".concat(m*100/v,"%")};Object.keys(S).forEach(function(O){r.root.style[O]=S[O]})}else["width","height"].forEach(function(O){r.config[O]&&(typeof r.config[O]!="number"?r.root.style[O]=r.config[O]:r.root.style[O]="".concat(r.config[O],"px"))});var w=this.root.getBoundingClientRect(),_=w.width,P=w.height,I=w.left,j=w.top;return this.sizeInfo.width=_,this.sizeInfo.height=P,this.sizeInfo.left=I,this.sizeInfo.top=j,!0}},{key:"_initBaseDoms",value:function(){this.topBar=null,this.leftBar=null,this.rightBar=null,this.config.marginControls&&(this.innerContainer=p.createDom("xg-video-container","",{"data-index":-1},"xg-video-container"),this.root.appendChild(this.innerContainer))}},{key:"_bindEvents",value:function(){var e=this;["focus","blur"].forEach(function(r){e.on(r,e["on"+r.charAt(0).toUpperCase()+r.slice(1)])}),$a.forEach(function(r){document&&document.addEventListener(r,e.onFullscreenChange)}),Te.os.isIos&&(this.media.addEventListener("webkitbeginfullscreen",this._onWebkitbeginfullscreen),this.media.addEventListener("webkitendfullscreen",this._onWebkitendfullscreen)),this.once(ai,this.resize),this.playFunc=function(){e.config.closeFocusVideoFocus||e.media.focus()},this.once(bt,this.playFunc)}},{key:"_unbindEvents",value:function(){var e=this;this.root.removeEventListener("mousemove",this.mousemoveFunc),$a.forEach(function(r){document.removeEventListener(r,e.onFullscreenChange)}),this.playFunc&&this.off(bt,this.playFunc),this.off(ni,this.canPlayFunc),this.media.removeEventListener("webkitbeginfullscreen",this._onWebkitbeginfullscreen),this.media.removeEventListener("webkitendfullscreen",this._onWebkitendfullscreen)}},{key:"_clearUserTimer",value:function(){this.userTimer&&(p.clearTimeout(this,this.userTimer),this.userTimer=null)}},{key:"_startInit",value:function(e){var r=this;if(this.media&&!((!e||e===""||p.typeOf(e)==="Array"&&e.length===0)&&(e="",this.emit(Ec),ke.logWarn("config.url is null, please get url and run player._startInit(url)"),this.config.nullUrlStart))){this.handleSource&&(this._detachSourceEvents(this.media),p.typeOf(e)==="Array"&&e.length>0?this._attachSourceEvents(this.media,e):!this.media.src||this.media.src!==e?this.media.src=e:e||this.media.removeAttribute("src")),p.typeOf(this.config.volume)==="Number"&&(this.volume=this.config.volume);var o=this.innerContainer?this.innerContainer:this.root;this.media instanceof window.Element&&!o.contains(this.media)&&o.insertBefore(this.media,o.firstChild);var a=this.media.readyState;ke.logInfo("_startInit readyState",a),this.config.autoplay&&(!p.isMSE(this.media)&&this.load(),(Te.os.isIpad||Te.os.isPhone)&&this.mediaPlay());var u=this.config.startTime;this.__startTime=u>0?u:-1,this.config.startTime=0,a>=2&&this.duration>0?this.canPlayFunc():this.on(ni,this.canPlayFunc),(!this.hasStart||this.state<Pe.ATTACHED)&&Je.afterInit(this),this.hasStart=!0,this.setState(Pe.ATTACHED),p.setTimeout(this,function(){r.emit(Xr)},0)}}},{key:"_registerPlugins",value:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this._loadingPlugins=[];var o=this.config.ignores||[],a=this.config.plugins||[],u=this.config.i18n||[];r&&on.extend(u,this.__i18n);var l=o.join("||").toLowerCase().split("||"),c=this.plugins;a.forEach(function(f){try{var h=f.plugin?f.plugin.pluginName:f.pluginName;if(h&&l.indexOf(h.toLowerCase())>-1)return null;if(!r&&c[h.toLowerCase()])return;if(f.lazy&&f.loader){var d=Je.lazyRegister(e,f);f.forceBeforeInit&&(d.then(function(){e._loadingPlugins.splice(e._loadingPlugins.indexOf(d),1)}).catch(function(g){ke.logError("_registerPlugins:loadingPlugin",g),e._loadingPlugins.splice(e._loadingPlugins.indexOf(d),1)}),e._loadingPlugins.push(d));return}return e.registerPlugin(f)}catch(g){ke.logError("_registerPlugins:",g)}})}},{key:"_registerPresets",value:function(){var e=this;this.config.presets.forEach(function(r){Cp(e,r)})}},{key:"_getRootByPosition",value:function(e){var r=null;switch(e){case He.ROOT_RIGHT:this.rightBar||(this.rightBar=p.createPositionBar("xg-right-bar",this.root)),r=this.rightBar;break;case He.ROOT_LEFT:this.leftBar||(this.leftBar=p.createPositionBar("xg-left-bar",this.root)),r=this.leftBar;break;case He.ROOT_TOP:this.topBar||(this.topBar=p.createPositionBar("xg-top-bar",this.root),this.config.topBarAutoHide&&p.addClass(this.topBar,z.TOP_BAR_AUTOHIDE)),r=this.topBar;break;default:r=this.innerContainer||this.root;break}return r}},{key:"registerPlugin",value:function(e,r){var o=Je.formatPluginInfo(e,r),a=o.PLUFGIN,u=o.options,l=this.config.plugins,c=Je.checkPluginIfExits(a.pluginName,l);!c&&l.push(a);var f=Je.getRootByConfig(a.pluginName,this.config);f.root&&(u.root=f.root),f.position&&(u.position=f.position);var h=u.position?u.position:u.config&&u.config.position||a.defaultConfig&&a.defaultConfig.position;return!u.root&&typeof h=="string"&&h.indexOf("controls")>-1?this.controls&&this.controls.registerPlugin(a,u,a.pluginName):(u.root||(u.root=this._getRootByPosition(h)),Je.register(this,a,u))}},{key:"deregister",value:function(e){typeof e=="string"?Je.unRegister(this,e):e instanceof Yt&&Je.unRegister(this,e.pluginName)}},{key:"unRegisterPlugin",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.deregister(e),r&&this.removePluginFromConfig(e)}},{key:"removePluginFromConfig",value:function(e){var r;if(typeof e=="string"?r=e:e instanceof Yt&&(r=e.pluginName),!!r)for(var o=this.config.plugins.length-1;o>-1;o--){var a=this.config.plugins[o];if(a.pluginName.toLowerCase()===r.toLowerCase()){this.config.plugins.splice(o,1);break}}}},{key:"plugins",get:function(){return Je.getPlugins(this)}},{key:"getPlugin",value:function(e){var r=Je.findPlugin(this,e);return r&&r.pluginName?r:null}},{key:"addClass",value:function(e){this.root&&(p.hasClass(this.root,e)||p.addClass(this.root,e))}},{key:"removeClass",value:function(e){this.root&&p.removeClass(this.root,e)}},{key:"hasClass",value:function(e){if(this.root)return p.hasClass(this.root,e)}},{key:"setAttribute",value:function(e,r){this.root&&this.root.setAttribute(e,r)}},{key:"removeAttribute",value:function(e,r){this.root&&this.root.removeAttribute(e,r)}},{key:"start",value:function(e){var r=this;if(!(this.state>Pe.ATTACHING))return!e&&!this.config.url&&this.getInitDefinition(),this.hasStart=!0,this.setState(Pe.ATTACHING),this._registerPlugins(!1),Je.beforeInit(this).then(function(){if(r.config){e||(e=r.url||r.config.url);var o=r._preProcessUrl(e),a=r._startInit(o.url);return a}}).catch(function(o){throw o.fileName="player",o.lineNumber="236",ke.logError("start:beforeInit:",o),o})}},{key:"switchURL",value:function(e,r){var o=this,a=e;p.typeOf(e)==="Object"&&(a=e.url),a=this._preProcessUrl(a).url;var u=this.currentTime;this.__startTime=u;var l=this.paused&&!this.isError;return this.src=a,new Promise(function(c,f){var h=function(v){o.off("timeupdate",d),o.off("canplay",d),f(v)},d=function(){o.duration>0&&o.__startTime>0&&(o.currentTime=o.__startTime,o.__startTime=-1),l&&o.pause(),o.off("error",h),c(!0)};if(o.once("error",h),!a){o.errorHandler("error",{code:6,message:"empty_src"});return}Te.os.isAndroid?o.once("timeupdate",d):o.once("canplay",d),o.play()})}},{key:"videoPlay",value:function(){this.mediaPlay()}},{key:"mediaPlay",value:function(){var e=this;if(!this.hasStart&&this.state<Pe.ATTACHED){this.removeClass(z.NO_START),this.addClass(z.ENTER),this.start(),this._useAutoplay=!0;return}this.state<Pe.RUNNING&&(this.removeClass(z.NO_START),!this.isCanplay&&this.addClass(z.ENTER));var r=_e(ve(i.prototype),"play",this).call(this);return r!==void 0&&r&&r.then?r.then(function(){e.removeClass(z.NOT_ALLOW_AUTOPLAY),e.addClass(z.PLAYING),e.state<Pe.RUNNING&&(ke.logInfo(">>>>playPromise.then"),e.setState(Pe.RUNNING),e.emit(Mi))}).catch(function(o){if(ke.logWarn(">>>>playPromise.catch",o.name),e.media&&e.media.error){e.onError(),e.removeClass(z.ENTER);return}o.name==="NotAllowedError"&&(e._errorTimer=p.setTimeout(e,function(){e._errorTimer=null,e.emit(No),e.addClass(z.NOT_ALLOW_AUTOPLAY),e.removeClass(z.ENTER),e.pause(),e.setState(Pe.NOTALLOW)},0))}):(ke.logWarn("video.play not return promise"),this.state<Pe.RUNNING&&(this.setState(Pe.RUNNING),this.removeClass(z.NOT_ALLOW_AUTOPLAY),this.removeClass(z.NO_START),this.removeClass(z.ENTER),this.addClass(z.PLAYING),this.emit(Mi))),r}},{key:"mediaPause",value:function(){_e(ve(i.prototype),"pause",this).call(this)}},{key:"videoPause",value:function(){_e(ve(i.prototype),"pause",this).call(this)}},{key:"play",value:function(){var e=this;return this.removeClass(z.PAUSED),ii(this,"play",function(){return e.mediaPlay()})}},{key:"pause",value:function(){var e=this;ii(this,"pause",function(){_e(ve(i.prototype),"pause",e).call(e)})}},{key:"seek",value:function(e,r){var o=this;if(!(!this.media||Number.isNaN(Number(e))||!this.hasStart)){var a=this.config,u=a.isSeekedPlay,l=a.seekedStatus,c=r||(u?"play":l);e=e<0?0:e>this.duration?parseInt(this.duration,10):e,!this._isPauseBeforeSeek&&(this._isPauseBeforeSeek=this.paused?2:1),this._onceSeekCanplay&&this.off(si,this._onceSeekCanplay),this._onceSeekCanplay=function(){switch(o.removeClass(z.ENTER),o.isSeeking=!1,c){case"play":o.play();break;case"pause":o.pause();break;default:o._isPauseBeforeSeek>1||o.paused?o.pause():o.play()}o._isPauseBeforeSeek=0,o._onceSeekCanplay=null},this.once(si,this._onceSeekCanplay),this.state<Pe.RUNNING?(this.removeClass(z.NO_START),this.currentTime=e,this.play()):this.currentTime=e}}},{key:"getInitDefinition",value:function(){var e=this,r=this.config,o=r.definition,a=r.url;!a&&o&&o.list&&o.list.length>0&&o.defaultDefinition&&o.list.map(function(u){u.definition===o.defaultDefinition&&(e.config.url=u.url,e.curDefinition=u)})}},{key:"changeDefinition",value:function(e,r){var o=this,a=this.config.definition;if(Array.isArray(a==null?void 0:a.list)&&a.list.forEach(function(l){(e==null?void 0:e.definition)===l.definition&&(o.curDefinition=l)}),e!=null&&e.bitrate&&typeof e.bitrate!="number"&&(e.bitrate=parseInt(e.bitrate,10)||0),this.emit(Jr,{from:r,to:e}),!this.hasStart){this.config.url=e.url;return}var u=this.switchURL(e.url,ze({seamless:a.seamless!==!1&&typeof MediaSource<"u"&&typeof MediaSource.isTypeSupported=="function"},e));u&&u.then?u.then(function(){o.emit(xr,{from:r,to:e})}):this.emit(xr,{from:r,to:e})}},{key:"reload",value:function(){this.load(),this.reloadFunc=function(){this.play()},this.once(ai,this.reloadFunc)}},{key:"resetState",value:function(){var e=this,r=z.NOT_ALLOW_AUTOPLAY,o=z.PLAYING,a=z.NO_START,u=z.PAUSED,l=z.REPLAY,c=z.ENTER,f=z.ENDED,h=z.ERROR,d=z.LOADING,g=[r,o,a,u,l,c,f,h,d];this.hasStart=!1,this.isError=!1,this._useAutoplay=!1,this.mediaPause(),this._accPlayed.acc=0,this._accPlayed.t=0,this._accPlayed.loopAcc=0,g.forEach(function(v){e.removeClass(v)}),this.addClass(z.NO_START),this.emit(Qr)}},{key:"reset",value:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],o=arguments.length>1?arguments[1]:void 0;this.resetState();var a=this.plugins;if(a&&(r.map(function(l){e.deregister(l)}),o)){var u=iu();Object.keys(this.config).keys(function(l){e.config[l]!=="undefined"&&(l==="plugins"||l==="presets"||l==="el"||l==="id")&&(e.config[l]=u[l])})}}},{key:"destroy",value:function(){var e,r=this,o=this.innerContainer,a=this.root,u=this.media;if(!(!a||!u)){if(this.hasStart=!1,this._useAutoplay=!1,a.removeAttribute(Ii),this.updateAcc("destroy"),this._unbindEvents(),this._detachSourceEvents(this.media),p.clearAllTimers(this),this.emit(Fo),(e=hi)===null||e===void 0||e.remove(this),Je.destroy(this),Mc(this),_e(ve(i.prototype),"destroy",this).call(this),this.fullscreen&&this._fullscreenEl===this.root&&this.exitFullscreen(),o)for(var l=o.children,c=0;c<l.length;c++)o.removeChild(l[c]);!o&&u instanceof window.Node&&a.contains(u)&&a.removeChild(u),["topBar","leftBar","rightBar","innerContainer"].map(function(h){r[h]&&a.removeChild(r[h]),r[h]=null});var f=a.className.split(" ");f.length>0?a.className=f.filter(function(h){return h.indexOf("xgplayer")<0}).join(" "):a.className="",this.removeAttribute("data-xgfill"),["isSeeking","isCanplay","isActive","cssfullscreen","fullscreen"].forEach(function(h){r[h]=!1})}}},{key:"replay",value:function(){var e=this;this.removeClass(z.ENDED),this.currentTime=0,this.isSeeking=!1,ii(this,"replay",function(){e.once(si,function(){var r=e.mediaPlay();r&&r.catch&&r.catch(function(o){console.log(o)})}),e.emit(Cr),e.onPlay()})}},{key:"retry",value:function(){var e=this;this.removeClass(z.ERROR),this.addClass(z.LOADING),ii(this,"retry",function(){var r=e.currentTime,o=e.config.url,a=p.isMSE(e.media)?{url:o}:e._preProcessUrl(o);e.src=a.url,!e.config.isLive&&(e.currentTime=r),e.once(ni,function(){e.mediaPlay()})})}},{key:"changeFullStyle",value:function(e,r,o,a){e&&(a||(a=z.PARENT_FULLSCREEN),this._orgCss||(this._orgCss=p.filterStyleFromText(e)),p.addClass(e,o),r&&r!==e&&!this._orgPCss&&(this._orgPCss=p.filterStyleFromText(r),p.addClass(r,a),r.setAttribute(Ii,this.playerId)))}},{key:"recoverFullStyle",value:function(e,r,o,a){a||(a=z.PARENT_FULLSCREEN),this._orgCss&&(p.setStyleFromCsstext(e,this._orgCss),this._orgCss=""),p.removeClass(e,o),r&&r!==e&&this._orgPCss&&(p.setStyleFromCsstext(r,this._orgPCss),this._orgPCss="",p.removeClass(r,a),r.removeAttribute(Ii))}},{key:"getFullscreen",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.fullscreenTarget,r=this.root,o=this.media;e||(e=r),this._fullScreenOffset={top:p.scrollTop(),left:p.scrollLeft()},this._fullscreenEl=e,this._fullActionFrom="get";var a=p.getFullScreenEl();if(a===this._fullscreenEl)return this.onFullscreenChange(),Promise.resolve();try{for(var u=0;u<qa.length;u++){var l=qa[u];if(e[l]){var c=l==="webkitRequestFullscreen"?e.webkitRequestFullscreen(window.Element.ALLOW_KEYBOARD_INPUT):e[l]();return c&&c.then?c:Promise.resolve()}}return o.fullscreenEnabled||o.webkitSupportsFullscreen?(o.webkitEnterFullscreen(),Promise.resolve()):Promise.reject(new Error("call getFullscreen fail"))}catch{return Promise.reject(new Error("call getFullscreen fail"))}}},{key:"exitFullscreen",value:function(e){if(this.isRotateFullscreen&&this.exitRotateFullscreen(),!(!this._fullscreenEl&&!p.getFullScreenEl())){this.root;var r=this.media;this._fullActionFrom="exit";try{for(var o=0;o<Xa.length;o++){var a=Xa[o];if(document[a]){var u=document[a]();return u&&u.then?u:Promise.resolve()}}return r&&r.webkitSupportsFullscreen?(r.webkitExitFullScreen(),Promise.resolve()):Promise.reject(new Error("call exitFullscreen fail"))}catch{return Promise.reject(new Error("call exitFullscreen fail"))}}}},{key:"getCssFullscreen",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.fullscreenTarget;this.isRotateFullscreen?this.exitRotateFullscreen():this.fullscreen&&this.exitFullscreen();var r=e?"".concat(z.INNER_FULLSCREEN," ").concat(z.CSS_FULLSCREEN):z.CSS_FULLSCREEN;this.changeFullStyle(this.root,e,r);var o=this.config.fullscreen,a=o===void 0?{}:o,u=a.useCssFullscreen===!0||typeof a.useCssFullscreen=="function"&&a.useCssFullscreen();u&&(this.fullscreen=!0,this.emit(Zt,!0)),this._cssfullscreenEl=e,this.cssfullscreen=!0,this.emit(kr,!0)}},{key:"exitCssFullscreen",value:function(){var e=this._cssfullscreenEl?"".concat(z.INNER_FULLSCREEN," ").concat(z.CSS_FULLSCREEN):z.CSS_FULLSCREEN;if(!this.fullscreen)this.recoverFullStyle(this.root,this._cssfullscreenEl,e);else{var r=this.config.fullscreen,o=r===void 0?{}:r,a=o.useCssFullscreen===!0||typeof o.useCssFullscreen=="function"&&o.useCssFullscreen();a?(this.recoverFullStyle(this.root,this._cssfullscreenEl,e),this.fullscreen=!1,this.emit(Zt,!1)):this.removeClass(e)}this._cssfullscreenEl=null,this.cssfullscreen=!1,this.emit(kr,!1)}},{key:"getRotateFullscreen",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.fullscreenTarget;this.cssfullscreen&&this.exitCssFullscreen(e);var r=e?"".concat(z.INNER_FULLSCREEN," ").concat(z.ROTATE_FULLSCREEN):z.ROTATE_FULLSCREEN;this._fullscreenEl=e||this.root,this.changeFullStyle(this.root,e,r,z.PARENT_ROTATE_FULLSCREEN),this.isRotateFullscreen=!0,this.fullscreen=!0,this.setRotateDeg(90),this._rootStyle=this.root.getAttribute("style"),this.root.style.width="".concat(window.innerHeight,"px"),this.emit(Zt,!0)}},{key:"exitRotateFullscreen",value:function(e){var r=this._fullscreenEl!==this.root?"".concat(z.INNER_FULLSCREEN," ").concat(z.ROTATE_FULLSCREEN):z.ROTATE_FULLSCREEN;this.recoverFullStyle(this.root,this._fullscreenEl,r,z.PARENT_ROTATE_FULLSCREEN),this.isRotateFullscreen=!1,this.fullscreen=!1,this.setRotateDeg(0),this.emit(Zt,!1),this._rootStyle&&(this.root.style.style=this._rootStyle,this._rootStyle=!1)}},{key:"setRotateDeg",value:function(e){window.orientation===90||window.orientation===-90?this.rotateDeg=0:this.rotateDeg=e}},{key:"focus",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{autoHide:!this.config.closeDelayBlur,delay:this.config.inactive};if(this.isActive){this.onFocus(e);return}this.emit(Do,ze({paused:this.paused,ended:this.ended},e))}},{key:"blur",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{ignorePaused:!1};if(!this.isActive){this.onBlur(e);return}this._clearUserTimer(),this.emit(bc,ze({paused:this.paused,ended:this.ended},e))}},{key:"onFocus",value:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{autoHide:!0,delay:3e3},o=this.innerStates;if(this.isActive=!0,this.removeClass(z.INACTIVE),this._clearUserTimer(),r.isLock!==void 0&&(o.isActiveLocked=r.isLock),r.autoHide===!1||r.isLock===!0||o.isActiveLocked){this._clearUserTimer();return}var a=r&&r.delay?r.delay:this.config.inactive;this.userTimer=p.setTimeout(this,function(){e.userTimer=null,e.blur()},a)}},{key:"onBlur",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.ignorePaused,o=r===void 0?!1:r;if(!this.innerStates.isActiveLocked){var a=this.config.closePauseVideoFocus;this.isActive=!1,(o||a||!this.paused&&!this.ended)&&this.addClass(z.INACTIVE)}}},{key:"onEmptied",value:function(){this.updateAcc("emptied")}},{key:"onCanplay",value:function(){this.removeClass(z.ENTER),this.removeClass(z.ERROR),this.removeClass(z.LOADING),this.isCanplay=!0,this.waitTimer&&p.clearTimeout(this,this.waitTimer)}},{key:"onDurationchange",value:function(){this.__startTime>0&&this.duration>0&&(this.currentTime=this.__startTime,this.__startTime=-1)}},{key:"onLoadeddata",value:function(){this.isError=!1,this.isSeeking=!1}},{key:"onLoadstart",value:function(){this.removeClass(z.ERROR),this.isCanplay=!1}},{key:"onPlay",value:function(){this.state===Pe.ENDED&&this.setState(Pe.RUNNING),this.removeClass(z.PAUSED),this.ended&&this.removeClass(z.ENDED),!this.config.closePlayVideoFocus&&this.focus()}},{key:"onPause",value:function(){this.addClass(z.PAUSED),this.updateAcc("pause"),this.config.closePauseVideoFocus||(this._clearUserTimer(),this.focus())}},{key:"onEnded",value:function(){this.updateAcc("ended"),this.addClass(z.ENDED),this.setState(Pe.ENDED)}},{key:"onError",value:function(){this.isError=!0,this.updateAcc("error"),this.removeClass(z.NOT_ALLOW_AUTOPLAY),this.removeClass(z.NO_START),this.removeClass(z.ENTER),this.removeClass(z.LOADING),this.addClass(z.ERROR)}},{key:"onSeeking",value:function(){this.isSeeking||this.updateAcc("seeking"),this.isSeeking=!0,this.addClass(z.SEEKING)}},{key:"onSeeked",value:function(){this.isSeeking=!1,this.waitTimer&&p.clearTimeout(this,this.waitTimer),this.removeClass(z.LOADING),this.removeClass(z.SEEKING)}},{key:"onWaiting",value:function(){var e=this;this.waitTimer&&p.clearTimeout(this,this.waitTimer),this.updateAcc("waiting"),this.waitTimer=p.setTimeout(this,function(){e.addClass(z.LOADING),e.emit(wc),p.clearTimeout(e,e.waitTimer),e.waitTimer=null},this.config.minWaitDelay)}},{key:"onPlaying",value:function(){var e=this;this.isError=!1;var r=z.NO_START,o=z.PAUSED,a=z.ENDED,u=z.ERROR,l=z.REPLAY,c=z.LOADING,f=[r,o,a,u,l,c];f.forEach(function(h){e.removeClass(h)}),!this._accPlayed.t&&!this.paused&&!this.ended&&(this._accPlayed.t=new Date().getTime())}},{key:"onTimeupdate",value:function(){!this._videoHeight&&this.media.videoHeight&&this.resize(),(this.waitTimer||this.hasClass(z.LOADING))&&this.media.readyState>2&&(this.removeClass(z.LOADING),p.clearTimeout(this,this.waitTimer),this.waitTimer=null),!this.paused&&this.state<Pe.RUNNING&&this.duration&&(this.setState(Pe.RUNNING),this.emit(Mi)),!this._accPlayed.t&&!this.paused&&!this.ended&&(this._accPlayed.t=new Date().getTime())}},{key:"onVolumechange",value:function(){p.typeOf(this.config.volume)==="Number"&&(this.config.volume=this.volume)}},{key:"onRatechange",value:function(){this.config.defaultPlaybackRate=this.playbackRate}},{key:"emitUserAction",value:function(e,r,o){if(!(!this.media||!r||!e)){var a=p.typeOf(e)==="String"?e:e.type||"";o.props&&p.typeOf(o.props)!=="Array"&&(o.props=[o.props]),this.emit(Ir,ze({eventType:a,action:r,currentTime:this.currentTime,duration:this.duration,ended:this.ended,event:e},o))}}},{key:"updateAcc",value:function(e){if(this._accPlayed.t){var r=new Date().getTime()-this._accPlayed.t;this._accPlayed.acc+=r,this._accPlayed.t=0,(e==="ended"||this.ended)&&(this._accPlayed.loopAcc=this._accPlayed.acc)}}},{key:"checkBuffer",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{startDiff:0,endDiff:0},o=r||{},a=o.startDiff,u=a===void 0?0:a,l=o.endDiff,c=l===void 0?0:l,f=this.media.buffered;if(!f||f.length===0||!this.duration)return!0;for(var h=e||this.media.currentTime||.2,d=f.length,g=0;g<d;g++)if(f.start(g)+u<=h&&f.end(g)-c>h)return!0;return!1}},{key:"resizePosition",value:function(){var e=this.videoPos,r=e.vy,o=e.vx,a=e.h,u=e.w,l=this.videoPos.rotate;if(!(l<0&&a<0&&u<0)){var c=this.videoPos._pi;if(!c&&this.media.videoHeight&&(c=this.media.videoWidth/this.media.videoHeight*100),!!c){this.videoPos.pi=c,l=l<0?0:l;var f={rotate:l},h=0,d=0,g=1,v=Math.abs(l/90),m=this.root,S=this.innerContainer,w=m.offsetWidth,_=S?S.offsetHeight:m.offsetHeight,P=_,I=w;if(v%2===0)g=a>0?100/a:u>0?100/u:1,f.scale=g,h=r>0?(100-a)/2-r:0,f.y=v===2?0-h:h,d=o>0?(100-u)/2-o:0,f.x=v===2?0-d:d,this.media.style.width="".concat(I,"px"),this.media.style.height="".concat(P,"px");else if(v%2===1){I=_,P=w;var j=_-w;d=-j/2/I*100,f.x=v===3?d+r/2:d-r/2,h=j/2/P*100,f.y=v===3?h+o/2:h-o/2,f.scale=g,this.media.style.width="".concat(I,"px"),this.media.style.height="".concat(P,"px")}var O=p.getTransformStyle(f,this.media.style.transform||this.media.style.webkitTransform);this.media.style.transform=O,this.media.style.webkitTransform=O}}}},{key:"position",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{h:0,y:0,x:0,w:0};if(!(!this.media||!e||!e.h)){var r=this.videoPos;r.h=e.h*100||0,r.w=e.w*100||0,r.vx=e.x*100||0,r.vy=e.y*100||0,this.resizePosition()}}},{key:"setConfig",value:function(e){var r=this;e&&Object.keys(e).map(function(o){if(o!=="plugins"){r.config[o]=e[o];var a=r.plugins[o.toLowerCase()];a&&p.typeOf(a.setConfig)==="Function"&&a.setConfig(e[o])}})}},{key:"playNext",value:function(e){var r=this;this.resetState(),this.setConfig(e),this._currentTime=0,this._duration=0,ii(this,"playnext",function(){r.start(),r.emit(Rr,e)})}},{key:"resize",value:function(){var e=this;if(this.media){var r=this.root.getBoundingClientRect();this.sizeInfo.width=r.width,this.sizeInfo.height=r.height,this.sizeInfo.left=r.left,this.sizeInfo.top=r.top;var o=this.media,a=o.videoWidth,u=o.videoHeight,l=this.config,c=l.fitVideoSize,f=l.videoFillMode;if((f==="fill"||f==="cover"||f==="contain")&&this.setAttribute("data-xgfill",f),!(!u||!a)){this._videoHeight=u,this._videoWidth=a;var h=this.controls&&this.innerContainer?this.controls.root.getBoundingClientRect().height:0,d=r.width,g=r.height-h,v=parseInt(a/u*1e3,10),m=parseInt(d/g*1e3,10),S=d,w=g,_={};c==="auto"&&m>v||c==="fixWidth"?(w=d/v*1e3,this.config.fluid?_.paddingTop="".concat(w*100/S,"%"):_.height="".concat(w+h,"px")):(c==="auto"&&m<v||c==="fixHeight")&&(S=v*g/1e3,_.width="".concat(S,"px")),!this.fullscreen&&!this.cssfullscreen&&Object.keys(_).forEach(function(I){e.root.style[I]=_[I]}),(f==="fillHeight"&&m<v||f==="fillWidth"&&m>v)&&this.setAttribute("data-xgfill","cover");var P={videoScale:v,vWidth:S,vHeight:w,cWidth:S,cHeight:w+h};this.resizePosition(),this.emit(Ti,P)}}}},{key:"updateObjectPosition",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.media.updateObjectPosition){this.media.updateObjectPosition(e,r);return}this.media.style.objectPosition="".concat(e*100,"% ").concat(r*100,"%")}},{key:"setState",value:function(e){ke.logInfo("setState","state from:".concat(nu[this.state]," to:").concat(nu[e])),this._state=e}},{key:"_preProcessUrl",value:function(e,r){var o=this.config.preProcessUrl;return!p.isBlob(e)&&typeof o=="function"?o(e,r):{url:e}}},{key:"state",get:function(){return this._state}},{key:"isFullscreen",get:function(){return this.fullscreen}},{key:"isCssfullScreen",get:function(){return this.cssfullscreen}},{key:"hasStart",get:function(){return this._hasStart},set:function(e){typeof e=="boolean"&&(this._hasStart=e,e===!1&&this.setState(Pe.READY),this.emit("hasstart"))}},{key:"isPlaying",get:function(){return this._state===Pe.RUNNING||this._state===Pe.ENDED},set:function(e){e?this.setState(Pe.RUNNING):this._state>=Pe.RUNNING&&this.setState(Pe.ATTACHED)}},{key:"definitionList",get:function(){return!this.config||!this.config.definition?[]:this.config.definition.list||[]},set:function(e){var r=this,o=this.config.definition,a=null,u=null;o.list=e,this.emit("resourceReady",e),e.forEach(function(l){var c;((c=r.curDefinition)===null||c===void 0?void 0:c.definition)===l.definition&&(a=l),o.defaultDefinition===l.definition&&(u=l)}),!u&&e.length>0&&(u=e[0]),a?this.changeDefinition(a):u&&this.changeDefinition(u)}},{key:"videoFrameInfo",get:function(){var e={total:0,dropped:0,corrupted:0,droppedRate:0,droppedDuration:0};if(!this.media||!this.media.getVideoPlaybackQuality)return e;var r=this.media.getVideoPlaybackQuality();return e.dropped=r.droppedVideoFrames||0,e.total=r.totalVideoFrames||0,e.corrupted=r.corruptedVideoFrames||0,e.total>0&&(e.droppedRate=e.dropped/e.total*100,e.droppedDuration=parseInt(this.cumulateTime/e.total*e.dropped,0)),e}},{key:"lang",get:function(){return this.config.lang},set:function(e){var r=on.langKeys.filter(function(o){return o===e});if(r.length===0&&e!=="zh"){console.error("Sorry, set lang fail, because the language [".concat(e,"] is not supported now, list of all supported languages is [").concat(on.langKeys.join(),"] "));return}this.config.lang=e,Je.setLang(e,this)}},{key:"i18n",get:function(){var e=this.config.lang;return e==="zh"&&(e="zh-cn"),this.__i18n.lang[e]||this.__i18n.lang.en}},{key:"i18nKeys",get:function(){return this.__i18n.textKeys||{}}},{key:"version",get:function(){return Xs}},{key:"playerId",get:function(){return this._pluginInfoId}},{key:"url",get:function(){return this.__url||this.config.url},set:function(e){this.__url=e}},{key:"poster",get:function(){return this.plugins.poster?this.plugins.poster.config.poster:this.config.poster},set:function(e){this.plugins.poster&&this.plugins.poster.update(e)}},{key:"readyState",get:function(){return _e(ve(i.prototype),"readyState",this)}},{key:"error",get:function(){var e=_e(ve(i.prototype),"error",this);return this.i18n[e]||e}},{key:"networkState",get:function(){return _e(ve(i.prototype),"networkState",this)}},{key:"fullscreenChanging",get:function(){return this._fullScreenOffset!==null}},{key:"cumulateTime",get:function(){var e=this._accPlayed,r=e.acc,o=e.t;return o?new Date().getTime()-o+r:r}},{key:"zoom",get:function(){return this.config.zoom},set:function(e){this.config.zoom=e}},{key:"videoRotateDeg",get:function(){return this.videoPos.rotate},set:function(e){e=p.convertDeg(e),!(e%90!==0||e===this.videoPos.rotate)&&(this.videoPos.rotate=e,this.resizePosition())}},{key:"avgSpeed",get:function(){return su},set:function(e){su=e}},{key:"realTimeSpeed",get:function(){return ru},set:function(e){ru=e}},{key:"offsetCurrentTime",get:function(){return this._offsetInfo.currentTime||0},set:function(e){this._offsetInfo.currentTime=e}},{key:"offsetDuration",get:function(){return this._offsetInfo.duration||0},set:function(e){this._offsetInfo.duration=e||0}},{key:"hook",value:function(e,r){return Ar.call.apply(Ar,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"useHooks",value:function(e,r){return Lr.call.apply(Lr,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removeHooks",value:function(e,r){return Or.call.apply(Or,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"usePluginHooks",value:function(e,r,o){for(var a=arguments.length,u=new Array(a>3?a-3:0),l=3;l<a;l++)u[l-3]=arguments[l];return Ja.call.apply(Ja,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removePluginHooks",value:function(e,r,o){for(var a=arguments.length,u=new Array(a>3?a-3:0),l=3;l<a;l++)u[l-3]=arguments[l];return Qa.call.apply(Qa,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"setUserActive",value:function(e,r){var o;typeof r=="boolean"&&r!==this.muted&&(this.addInnerOP("volumechange"),p.typeOf(r)===Boolean&&(this.muted=r)),(o=hi)===null||o===void 0||o.setActive(this.playerId,e)}}],[{key:"debugger",get:function(){return ke.config.debug},set:function(e){ke.config.debug=e}},{key:"instManager",get:function(){return hi},set:function(e){hi=e}},{key:"getCurrentUserActivePlayerId",value:function(){var e;return(e=hi)===null||e===void 0?void 0:e.getActiveId()}},{key:"setCurrentUserActive",value:function(e,r){var o;(o=hi)===null||o===void 0||o.setActive(e,r)}},{key:"isHevcSupported",value:function(){return Te.isHevcSupported()}},{key:"probeConfigSupported",value:function(e){return Te.probeConfigSupported(e)}},{key:"install",value:function(e,r){i.plugins||(i.plugins={}),i.plugins[e]||(i.plugins[e]=r)}},{key:"use",value:function(e,r){i.plugins||(i.plugins={}),i.plugins[e]=r}}]),i}(up);D(Zr,"defaultPreset",null);D(Zr,"XgVideoProxy",null);Zr.instManager=Fc.getInstance();function tt(){return new Date().getTime()}var di={LOAD_START:"loadstart",LOADED_DATA:"loadeddata",FIRST_FRAME:"firstFrame",WAIT_START:"waitingStart",WAIT_END:"waitingEnd",SEEK_START:"seekStart",SEEK_END:"seekEnd"},Lp=function(n){de(i,n);var s=ge(i);function i(){var t;ae(this,i);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t=s.call.apply(s,[this].concat(r)),D(R(t),"_onTimeupdate",function(){t._state.isTimeUpdate=!0,t._state.autoplayStart&&(ke.logInfo("[xgLogger]".concat(t.player.playerId," _onTimeupdate")),t._sendFF("onTimeupdate"))}),D(R(t),"_onAutoplayStart",function(){ke.logInfo("[xgLogger]".concat(t.player.playerId," _onAutoplayStart")),t._state.autoplayStart=!0,t.vt&&t._sendFF("onAutoplayStart")}),D(R(t),"_onReset",function(){t._state={autoplayStart:!1,isFFLoading:!1,isTimeUpdate:!1,isFFSend:!1,isLs:!1},t.vt=0,t.pt=0,t.fvt=0,t.newPointTime=tt(),t.loadedCostTime=0,t.startCostTime=0,t._isSeeking=!1,t.seekingStart=0,t.waitingStart=0,t.fixedWaitingStart=0,t._isWaiting=!1,t._waitTimer&&p.clearTimeout(R(t),t._waitTimer),t._waittTimer&&p.clearTimeout(R(t),t._waittTimer),t._waitTimer=null,t._waittTimer=null,t._waitType=0}),D(R(t),"_onSeeking",function(){t.seekingStart||(t.suspendWaitingStatus("seek"),t.seekingStart=tt(),t.emitLog(di.SEEK_START,{start:tt()}))}),D(R(t),"_onSeeked",function(){t.suspendSeekingStatus("seeked")}),D(R(t),"_onWaitingLoadStart",function(){t._isWaiting||t.vt||(t._isWaiting=!0,t.waitingStart=tt(),t.fixedWaitingStart=tt(),t._waitType=1,t.emitLog(di.WAIT_START,{fixedStart:t.fixedWaitingStart,start:t.waitingStart,type:1,endType:"loadstart"}))}),D(R(t),"_onWaiting",function(){t._isWaiting||!t.vt||(t._isWaiting=!0,t.vt?t.seekingStart?t._waitType=2:t._waitType=0:t._waitType=1,t.fixedWaitingStart=tt(),t._waitTimer=p.setTimeout(R(t),function(){t._isWaiting&&(t.waitingStart=tt(),p.clearTimeout(R(t),t._waitTimer),t._waitTimer=null,t._startWaitTimeout(),t.emitLog(di.WAIT_START,{fixedStart:t.fixedWaitingStart,start:t.waitingStart,type:t._waitType,endType:t._waitType===2?"seek":"playing"}))},200))}),D(R(t),"_onError",function(){t.suspendSeekingStatus("error"),t.suspendWaitingStatus("error")}),D(R(t),"_onPlaying",function(){t._isWaiting&&t.suspendWaitingStatus("playing")}),t}return ue(i,[{key:"afterCreate",value:function(){var e=this;this._onReset(),this._waitType="firstFrame",this._initOnceEvents(),this.newPointTime=tt(),this.loadedCostTime=0,this.startCostTime=0,this.on(Oo,function(){var r=e._state,o=r.autoplayStart,a=r.isFFSend;e.startCostTime=tt()-e.newPointTime,ke.logInfo("[xgLogger]".concat(e.player.playerId," LOAD_START"),"autoplayStart:".concat(o," isFFSend:").concat(a," startCostTime:").concat(e.startCostTime," newPointTime").concat(e.newPointTime)),!a&&(!r.isLs&&e.emitLog(di.LOAD_START,{}),r.isLs=!0,r.isTimeUpdate=!1,r.isFFLoading=!0,e.pt=tt(),e.vt=0,e.fvt=0,e._initOnceEvents(),e._onWaitingLoadStart())}),this.on(ai,function(){e.vt=tt(),e.fvt=e.vt-e.pt,e.loadedCostTime=e.vt-e.newPointTime;var r=e._state,o=r.isTimeUpdate,a=r.isFFSend,u=r.autoplayStart;ke.logInfo("[xgLogger]".concat(e.player.playerId," LOADED_DATA"),"fvt:".concat(e.fvt," isTimeUpdate:").concat(e._state.isTimeUpdate," loadedCostTime:").concat(e.loadedCostTime)),(o||u)&&e._sendFF("loadedData"),a||e.emitLog(di.LOADED_DATA,{}),e.suspendWaitingStatus("loadeddata")}),this.on(Di,this._onSeeking),this.on(si,this._onSeeked),this.on(Fo,function(){e.endState("destroy")}),this.on(Ni,function(){e.endState("urlChange"),ke.logInfo("[xgLogger]".concat(e.player.playerId," URL_CHANGE")),e._state.isFFSend&&e._onReset()}),this.on([Lo,ni],this._onPlaying),this.on(Bi,this._onWaiting),this.on(Jn,this._onError),this.on(Qr,function(){ke.logInfo("[xgLogger]".concat(e.player.playerId," RESET")),e.endState("reset"),e._initOnceEvents(),e._onReset()})}},{key:"_initOnceEvents",value:function(){this.off(Mi,this._onAutoplayStart),this.off(_t,this._onTimeupdate),this.once(Mi,this._onAutoplayStart),this.once(_t,this._onTimeupdate)}},{key:"_sendFF",value:function(e){this.s=tt();var r=this._state,o=r.isFFLoading,a=r.isFFSend;ke.logInfo("[xgLogger]".concat(this.player.playerId," _sendFF"),"".concat(e," fvt:").concat(this.fvt," isFFLoading:").concat(o," !isFFSend:").concat(!a)),this.vt>0&&o&&!a&&(ke.logInfo("[xgLogger]".concat(this.player.playerId," emitLog_firstFrame"),e),this._state.isFFLoading=!1,this._state.isFFSend=!0,this.emitLog(di.FIRST_FRAME,{fvt:this.fvt,costTime:this.fvt,vt:this.vt,startCostTime:this.startCostTime,loadedCostTime:this.loadedCostTime}))}},{key:"_startWaitTimeout",value:function(){var e=this;this._waittTimer&&p.clearTimeout(this,this._waittTimer),this._waittTimer=p.setTimeout(this,function(){e.suspendWaitingStatus("timeout"),p.clearTimeout(e,e._waittTimer),e._waittTimer=null},this.config.waitTimeout)}},{key:"endState",value:function(e){this.suspendWaitingStatus(e),this.suspendSeekingStatus(e)}},{key:"suspendSeekingStatus",value:function(e){if(this.seekingStart){var r=tt(),o=r-this.seekingStart;this.seekingStart=0,this.emitLog(di.SEEK_END,{end:r,costTime:o,endType:e})}}},{key:"suspendWaitingStatus",value:function(e){if(this._waitTimer&&(p.clearTimeout(this,this._waitTimer),this._waitTimer=null),this._waittTimer&&(p.clearTimeout(this,this._waittTimer),this._waittTimer=null),this._isWaiting=!1,!!this.waitingStart){var r=tt(),o=r-this.waitingStart,a=r-this.fixedWaitingStart,u=this.config.waitTimeout;this._isWaiting=!1,this.waitingStart=0,this.fixedWaitingStart=0,this.emitLog(di.WAIT_END,{fixedCostTime:a>u?u:a,costTime:o>u?u:o,type:e==="loadeddata"?1:this._waitType,endType:this._waitType===2?"seek":e})}}},{key:"emitLog",value:function(e,r){var o=this.player;this.emit(xc,ze({t:tt(),host:p.getHostFromUrl(o.currentSrc),vtype:o.vtype,eventType:e,currentTime:this.player.currentTime,readyState:o.video.readyState,networkState:o.video.networkState},r))}}],[{key:"pluginName",get:function(){return"xgLogger"}},{key:"defaultConfig",get:function(){return{waitTimeout:1e4}}}]),i}(Ie);function Op(){return new DOMParser().parseFromString(`<svg class="xgplayer-replay-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 78 78" width="78" height="78">
  <path fill="#fff" transform="translate(20, 20)" d="M8.22708362,13.8757234 L11.2677371,12.6472196 C11.7798067,12.4403301 12.3626381,12.6877273 12.5695276,13.1997969 L12.9441342,14.1269807 C13.1510237,14.6390502 12.9036264,15.2218816 12.3915569,15.4287712 L6.8284538,17.6764107 L5.90126995,18.0510173 C5.38920044,18.2579068 4.80636901,18.0105096 4.5994795,17.49844 L1.97723335,11.0081531 C1.77034384,10.4960836 2.0177411,9.91325213 2.52981061,9.70636262 L3.45699446,9.33175602 C3.96906396,9.12486652 4.5518954,9.37226378 4.75878491,9.88433329 L5.67885163,12.1615783 C7.99551726,6.6766934 13.3983951,3 19.5,3 C27.7842712,3 34.5,9.71572875 34.5,18 C34.5,26.2842712 27.7842712,33 19.5,33 C15.4573596,33 11.6658607,31.3912946 8.87004692,28.5831991 C8.28554571,27.9961303 8.28762719,27.0463851 8.87469603,26.4618839 C9.46176488,25.8773827 10.4115101,25.8794641 10.9960113,26.466533 C13.2344327,28.7147875 16.263503,30 19.5,30 C26.127417,30 31.5,24.627417 31.5,18 C31.5,11.372583 26.127417,6 19.5,6 C14.4183772,6 9.94214483,9.18783811 8.22708362,13.8757234 Z"></path>
</svg>
`,"image/svg+xml").firstChild}var Dp=function(n){de(i,n);var s=ge(i);function i(){return ae(this,i),s.apply(this,arguments)}return ue(i,[{key:"registerIcons",value:function(){return{replay:Op}}},{key:"afterCreate",value:function(){var e=this;Ie.insert(this.icons.replay,this.root,0),this.__handleReplay=this.hook("replayClick",function(){e.player.replay()},{pre:function(o){o.preventDefault(),o.stopPropagation()}}),this.bind(".xgplayer-replay",["click","touchend"],this.__handleReplay),this.on(zi,function(){if(e.playerConfig.loop||p.addClass(e.player.root,"replay"),!e.config.disable){e.show();var r=e.root.querySelector("path");if(r){var o=window.getComputedStyle(r).getPropertyValue("transform");if(typeof o=="string"&&o.indexOf("none")>-1)return null;r.setAttribute("transform",o)}}}),this.on(bt,function(){e.hide()})}},{key:"handleReplay",value:function(e){e.preventDefault(),e.stopPropagation(),this.player.replay(),p.removeClass(this.player.root,"replay")}},{key:"show",value:function(e){this.config.disable||(this.root.style.display="flex")}},{key:"enable",value:function(){this.config.disable=!1}},{key:"disable",value:function(){this.config.disable=!0,this.hide()}},{key:"destroy",value:function(){this.unbind(".xgplayer-replay",["click","touchend"],this.__handleReplay)}},{key:"render",value:function(){return`<xg-replay class="xgplayer-replay">
      <xg-replay-txt class="xgplayer-replay-txt" lang-key="`.concat(this.i18nKeys.REPLAY,'">').concat(this.i18n.REPLAY,`</xg-replay-txt>
    </xg-replay>`)}}],[{key:"pluginName",get:function(){return"replay"}},{key:"defaultConfig",get:function(){return{disable:!1}}}]),i}(Ie),Mp=function(n){de(i,n);var s=ge(i);function i(){return ae(this,i),s.apply(this,arguments)}return ue(i,[{key:"isEndedShow",get:function(){return this.config.isEndedShow},set:function(e){this.config.isEndedShow=e}},{key:"hide",value:function(){p.addClass(this.root,"hide")}},{key:"show",value:function(e){p.removeClass(this.root,"hide")}},{key:"beforeCreate",value:function(e){typeof e.player.config.poster=="string"&&(e.config.poster=e.player.config.poster)}},{key:"afterCreate",value:function(){var e=this;this.on(zi,function(){e.isEndedShow&&p.removeClass(e.root,"hide")}),this.config.hideCanplay?(this.once(_t,function(){e.onTimeUpdate()}),this.on(Ni,function(){p.removeClass(e.root,"hide"),p.addClass(e.root,"xg-showplay"),e.once(_t,function(){e.onTimeUpdate()})})):this.on(bt,function(){p.addClass(e.root,"hide")})}},{key:"onTimeUpdate",value:function(){var e=this;this.player.currentTime?p.removeClass(this.root,"xg-showplay"):this.once(_t,function(){e.onTimeUpdate()})}},{key:"update",value:function(e){e&&(this.config.poster=e,this.root.style.backgroundImage="url(".concat(e,")"))}},{key:"getBgSize",value:function(e){var r="";switch(e){case"cover":r="cover";break;case"contain":r="contain";break;case"fixHeight":r="auto 100%";break;default:r=""}return r?"background-size: ".concat(r,";"):""}},{key:"render",value:function(){var e=this.config,r=e.poster,o=e.hideCanplay,a=e.fillMode,u=e.notHidden,l=this.getBgSize(a),c=r?"background-image:url(".concat(r,");").concat(l):l,f=u?"xg-not-hidden":o?"xg-showplay":"";return'<xg-poster class="xgplayer-poster '.concat(f,'" style="').concat(c,`">
    </xg-poster>`)}}],[{key:"pluginName",get:function(){return"poster"}},{key:"defaultConfig",get:function(){return{isEndedShow:!0,hideCanplay:!1,notHidden:!1,poster:"",fillMode:"fixWidth"}}}]),i}(Ie);function Uo(){return new DOMParser().parseFromString(`<svg class="play" xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="3 -4 28 40">
  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M576,363L810,512L576,661zM342,214L576,363L576,661L342,810z"></path>
</svg>
`,"image/svg+xml").firstChild}function Ho(){return new DOMParser().parseFromString(`<svg class="pause" xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="3 -4 28 40">
  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M598,214h170v596h-170v-596zM256 810v-596h170v596h-170z"></path>
</svg>
`,"image/svg+xml").firstChild}var Ht={};function Np(n,s){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{start:null,end:null};return Ht[n]&&window.clearTimeout(Ht[n].id),Ht[n]={},i.start&&i.start(),Ht[n].id=window.setTimeout(function(){i.end&&i.end(),window.clearTimeout(Ht[n].id),delete Ht[n]},s),Ht[n].id}function ou(n){if(n){window.clearTimeout(n);return}Object.keys(Ht).map(function(s){window.clearTimeout(Ht[s].id),delete Ht[s]})}var Fp=function(n){de(i,n);var s=ge(i);function i(t){var e;return ae(this,i),e=s.call(this,t),D(R(e),"onPlayerReset",function(){e.autoPlayStart=!1;var r=e.config.mode==="auto"?"auto-hide":"hide";e.setAttr("data-state","play"),p.removeClass(e.root,r),e.show()}),D(R(e),"onAutoplayStart",function(){if(!e.autoPlayStart){var r=e.config.mode==="auto"?"auto-hide":"hide";p.addClass(e.root,r),e.autoPlayStart=!0,e.onPlayPause("play")}}),e.autoPlayStart=!1,e}return ue(i,[{key:"afterCreate",value:function(){var e=this,r=this.player,o=this.playerConfig;this.initIcons(),this.once(Mo,function(){o&&(o.lang&&o.lang==="en"?p.addClass(r.root,"lang-is-en"):o.lang==="jp"&&p.addClass(r.root,"lang-is-jp"))}),this.on(Mi,this.onAutoplayStart),o.autoplay||this.show(),this.on(No,function(){var a=e.config.mode==="auto"?"auto-hide":"hide";e.setAttr("data-state","play"),p.removeClass(e.root,a),e.show()}),this.on(bt,function(){e.onPlayPause("play")}),this.on(mn,function(){e.onPlayPause("pause")}),this.on(Qr,function(){e.onPlayerReset()}),this.clickHandler=this.hook("startClick",this.switchPausePlay,{pre:function(u){u.cancelable&&u.preventDefault(),u.stopPropagation();var l=e.player.paused;e.emitUserAction(u,"switch_play_pause",{props:"paused",from:l,to:!l})}}),this.bind(["click","touchend"],this.clickHandler)}},{key:"registerIcons",value:function(){return{startPlay:{icon:Uo,class:"xg-icon-play"},startPause:{icon:Ho,class:"xg-icon-pause"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild("xg-start-inner",e.startPlay),this.appendChild("xg-start-inner",e.startPause)}},{key:"hide",value:function(){p.addClass(this.root,"hide")}},{key:"show",value:function(e){p.removeClass(this.root,"hide")}},{key:"focusHide",value:function(){p.addClass(this.root,"focus-hide")}},{key:"recover",value:function(){p.removeClass(this.root,"focus-hide")}},{key:"switchStatus",value:function(e){e?this.setAttr("data-state",this.player.paused?"pause":"play"):this.setAttr("data-state",this.player.paused?"play":"pause")}},{key:"animate",value:function(e){var r=this;this._animateId=Np("pauseplay",400,{start:function(){p.addClass(r.root,"interact"),r.show(),r.switchStatus(!0)},end:function(){p.removeClass(r.root,"interact"),!e&&r.hide(),r._animateId=null}})}},{key:"endAnimate",value:function(){p.removeClass(this.root,"interact"),ou(this._animateId),this._animateId=null}},{key:"switchPausePlay",value:function(e){var r=this.player;if(e.cancelable&&e.preventDefault(),e.stopPropagation(),!(r.state<Pe.READY)){var o=this.player.paused;!o&&r.state===Pe.RUNNING?r.pause():r.play()}}},{key:"onPlayPause",value:function(e){var r=this.config,o=this.player;if(!(!o||o.state<Pe.RUNNING||!this.autoPlayStart)){if(r.mode==="show"){this.switchStatus(),this.show();return}if(r.mode==="auto"){this.switchStatus();return}if(r.isShowPause&&o.paused&&!o.ended||r.isShowEnd&&o.ended){this.switchStatus(),this.show(),this.endAnimate();return}if(r.disableAnimate){this.switchStatus(),this.hide();return}if(e==="play")this.autoPlayStart?this.animate():this.hide();else{if(!this.autoPlayStart||o.ended)return;this.animate()}}}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.clickHandler),ou(this._animateId)}},{key:"render",value:function(){var e=this.playerConfig.autoplay?this.config.mode==="auto"?"auto-hide":"hide":"";return`
    <xg-start class="xgplayer-start `.concat(e,`">
    <xg-start-inner></xg-start-inner>
    </xg-start>`)}}],[{key:"pluginName",get:function(){return"start"}},{key:"defaultConfig",get:function(){return{isShowPause:!1,isShowEnd:!1,disableAnimate:!1,mode:"hide"}}}]),i}(Ie),Bp=function(n){de(i,n);var s=ge(i);function i(){return ae(this,i),s.apply(this,arguments)}return ue(i,[{key:"render",value:function(){var e=this.config.innerHtml,r=p.createDom("xg-enter","",{},"xgplayer-enter");if(e&&e instanceof window.HTMLElement)r.appendChild(e);else if(e&&typeof e=="string")r.innerHTML=e;else{for(var o="",a=1;a<=12;a++)o+='<div class="xgplayer-enter-bar'.concat(a,'"></div>');r.innerHTML='<div class="xgplayer-enter-spinner">'.concat(o,"</div>")}return r}}],[{key:"pluginName",get:function(){return"enter"}},{key:"defaultConfig",get:function(){return{innerHtml:"",logo:""}}}]),i}(Ie);function ki(n,s,i){try{return' <div class="xg-tips '.concat(i?"hide":" ",'" lang-key="').concat(n.i18nKeys[s],`">
    `).concat(n.i18n[s],`
    </div>`)}catch{return'<div class="xg-tips hide"></div>'}}var au=function(n){de(i,n);var s=ge(i);function i(){return ae(this,i),s.apply(this,arguments)}return ue(i,[{key:"afterCreate",value:function(){this.getMini=this.getMini.bind(this),this.exitMini=this.exitMini.bind(this),this.bind("click",this.getMini)}},{key:"getMini",value:function(){this.config.onClick&&this.config.onClick()}},{key:"exitMini",value:function(){this.config.onClick&&this.config.onClick()}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.getMini)}},{key:"render",value:function(){var e="MINISCREEN";return`
      <xg-icon class="xgplayer-miniicon">
      <div class="xgplayer-icon btn-text"><span class="icon-text" lang-key="`.concat(this.i18nKeys[e],'">').concat(this.i18n[e],`</span></div>
      </xg-icon>`)}}],[{key:"pluginName",get:function(){return"miniscreenIcon"}},{key:"defaultConfig",get:function(){return{position:He.CONTROLS_RIGHT,index:10}}}]),i}(Ie);function uu(n){var s=parseFloat(n),i=n.indexOf("%")===-1&&!Number.isNaN(s);return i&&s}var jo=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],Bc=jo.length;function Up(){for(var n={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},s=0;s<Bc;s++){var i=jo[s];n[i]=0}return n}function Hp(n){var s=window.getComputedStyle(n);return s}function lu(n){if(typeof n=="string"&&(n=document.querySelector(n)),!(!n||ot(n)!=="object"||!n.nodeType)){var s=Hp(n);if(s.display==="none")return Up();var i={};i.width=n.offsetWidth,i.height=n.offsetHeight;for(var t=i.isBorderBox=s.boxSizing==="border-box",e=0;e<Bc;e++){var r=jo[e],o=s[r],a=parseFloat(o);i[r]=Number.isNaN(a)?0:a}var u=i.paddingLeft+i.paddingRight,l=i.paddingTop+i.paddingBottom,c=i.marginLeft+i.marginRight,f=i.marginTop+i.marginBottom,h=i.borderLeftWidth+i.borderRightWidth,d=i.borderTopWidth+i.borderBottomWidth,g=t,v=uu(s.width);v!==!1&&(i.width=v+(g?0:u+h));var m=uu(s.height);return m!==!1&&(i.height=m+(g?0:l+d)),i.innerWidth=i.width-(u+h),i.innerHeight=i.height-(l+d),i.outerWidth=i.width+c,i.outerHeight=i.height+f,i}}function Es(n,s){for(var i=0;i<n.length;i++){var t=n[i];if(t.identifier===s)return t}}var Ts={START:"dragStart",MOVE:"dragMove",ENDED:"dragEnded"},cu={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"]},jp=function(n){de(i,n);var s=ge(i);function i(t){var e,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ae(this,i),e=s.call(this),e.isEnabled=!0,e.isDragging=!1,e.isDown=!1,e.position={},e.downPoint={},e.dragPoint={x:0,y:0},e.startPos={x:0,y:0},e._root=t instanceof Element?t:document.querySelector(t),e._handlerDom=r.handle instanceof Element?r.handle:document.querySelector(r.handle),!e._root||!e._handlerDom?Ao(e):(e._bindStartEvent(),e)}return ue(i,[{key:"_bindStartEvent",value:function(){var e=this;"ontouchstart"in window?this._startKey="touchstart":this._startKey="mousedown",this["on".concat(this._startKey)]=this["on".concat(this._startKey)].bind(this),this._handlerDom.addEventListener(this._startKey,this["on".concat(this._startKey)]),cu[this._startKey].map(function(r){e["on".concat(r)]=e["on".concat(r)].bind(e)})}},{key:"_unbindStartEvent",value:function(){this._handlerDom.removeEventListener(this._startKey,this["on".concat(this._startKey)])}},{key:"_bindPostStartEvents",value:function(e){var r=this;if(e){var o=cu[this._startKey];o.map(function(a){window.addEventListener(a,r["on".concat(a)])}),this._boundPointerEvents=o}}},{key:"_unbindPostStartEvents",value:function(){var e=this;this._boundPointerEvents&&(this._boundPointerEvents.map(function(r){window.removeEventListener(r,e["on".concat(r)])}),delete this._boundPointerEvents)}},{key:"enable",value:function(){this.isEnabled=!0}},{key:"disable",value:function(){this.isEnabled=!1,this.isDragging&&this.onUp()}},{key:"onDocUp",value:function(e){this.onUp()}},{key:"animate",value:function(){var e=this;this.isDragging&&(this.positionDrag(),window.requestAnimationFrame(function(){e.animate()}))}},{key:"positionDrag",value:function(){var e="translate3d(".concat(this.dragPoint.x,"px, ").concat(this.dragPoint.y,"px, 0)");this._root.style.transform=e,this._root.style.webKitTransform=e}},{key:"setLeftTop",value:function(){this._root.style.left=this.position.x+"px",this._root.style.top=this.position.y+"px"}},{key:"onmousedown",value:function(e){this.dragStart(e,e)}},{key:"onmousemove",value:function(e){this.dragMove(e,e)}},{key:"onmouseup",value:function(e){this.dragEnd(e,e)}},{key:"ontouchstart",value:function(e){var r=e.changedTouches[0];this.dragStart(e,r),this.touchIdentifier=r.pointerId!==void 0?r.pointerId:r.identifier,e.preventDefault()}},{key:"ontouchmove",value:function(e){var r=Es(e.changedTouches,this.touchIdentifier);r&&this.dragMove(e,r)}},{key:"ontouchend",value:function(e){var r=Es(e.changedTouches,this.touchIdentifier);r&&this.dragEnd(e,r),e.preventDefault()}},{key:"ontouchcancel",value:function(e){var r=Es(e.changedTouches,this.touchIdentifier);r&&this.dragCancel(e,r)}},{key:"dragStart",value:function(e,r){if(!(!this._root||this.isDown||!this.isEnabled)){this.downPoint=r,this.dragPoint.x=0,this.dragPoint.y=0,this._getPosition();var o=lu(this._root);this.startPos.x=this.position.x,this.startPos.y=this.position.y,this.startPos.maxY=window.innerHeight-o.height,this.startPos.maxX=window.innerWidth-o.width,this.setLeftTop(),this.isDown=!0,this._bindPostStartEvents(e)}}},{key:"dragRealStart",value:function(e,r){this.isDragging=!0,this.animate(),this.emit(Ts.START,this.startPos)}},{key:"dragEnd",value:function(e,r){this._root&&(this._unbindPostStartEvents(),this.isDragging&&(this._root.style.transform="",this.setLeftTop(),this.emit(Ts.ENDED)),this.presetInfo())}},{key:"_dragPointerMove",value:function(e,r){var o={x:r.pageX-this.downPoint.pageX,y:r.pageY-this.downPoint.pageY};return!this.isDragging&&this.hasDragStarted(o)&&this.dragRealStart(e,r),o}},{key:"dragMove",value:function(e,r){if(e=e||window.event,!!this.isDown){var o=this.startPos,a=o.x,u=o.y,l=this._dragPointerMove(e,r),c=l.x,f=l.y;c=this.checkContain("x",c,a),f=this.checkContain("y",f,u),this.position.x=a+c,this.position.y=u+f,this.dragPoint.x=c,this.dragPoint.y=f,this.emit(Ts.MOVE,this.position)}}},{key:"dragCancel",value:function(e,r){this.dragEnd(e,r)}},{key:"presetInfo",value:function(){this.isDragging=!1,this.startPos={x:0,y:0},this.dragPoint={x:0,y:0},this.isDown=!1}},{key:"destroy",value:function(){this._unbindStartEvent(),this._unbindPostStartEvents(),this.isDragging&&this.dragEnd(),this.removeAllListeners(),this._handlerDom=null}},{key:"hasDragStarted",value:function(e){return Math.abs(e.x)>3||Math.abs(e.y)>3}},{key:"checkContain",value:function(e,r,o){return r+o<0?0-o:e==="x"&&r+o>this.startPos.maxX?this.startPos.maxX-o:e==="y"&&r+o>this.startPos.maxY?this.startPos.maxY-o:r}},{key:"_getPosition",value:function(){var e=window.getComputedStyle(this._root),r=this._getPositionCoord(e.left,"width"),o=this._getPositionCoord(e.top,"height");this.position.x=Number.isNaN(r)?0:r,this.position.y=Number.isNaN(o)?0:o,this._addTransformPosition(e)}},{key:"_addTransformPosition",value:function(e){var r=e.transform;if(r.indexOf("matrix")===0){var o=r.split(","),a=r.indexOf("matrix3d")===0?12:4,u=parseInt(o[a],10),l=parseInt(o[a+1],10);this.position.x+=u,this.position.y+=l}}},{key:"_getPositionCoord",value:function(e,r){if(e.indexOf("%")!==-1){var o=lu(this._root.parentNode);return o?parseFloat(e)/100*o[r]:0}return parseInt(e,10)}}]),i}(Vi),Vp=function(n){de(i,n);var s=ge(i);function i(t){var e;ae(this,i),e=s.call(this,t),D(R(e),"onCancelClick",function(a){e.exitMini(),e.isClose=!0}),D(R(e),"onCenterClick",function(a){var u=R(e),l=u.player;l.paused?l.play():l.pause()}),D(R(e),"onScroll",function(a){if(!(!window.scrollY&&window.scrollY!==0||Math.abs(window.scrollY-e.pos.scrollY)<50)){var u=parseInt(p.getCss(e.player.root,"height"));u+=e.config.scrollTop,e.pos.scrollY=window.scrollY,window.scrollY>u+5?!e.isMini&&!e.isClose&&e.getMini():window.scrollY<=u&&(e.isMini&&e.exitMini(),e.isClose=!1)}}),e.isMini=!1,e.isClose=!1;var r=R(e),o=r.config;return e.pos={left:o.left<0?window.innerWidth-o.width-20:o.left,top:o.top<0?window.innerHeight-o.height-20:o.top,height:e.config.height,width:e.config.width,scrollY:window.scrollY||0},e.lastStyle=null,e}return ue(i,[{key:"beforeCreate",value:function(e){typeof e.player.config.mini=="boolean"&&(e.config.isShowIcon=e.player.config.mini)}},{key:"afterCreate",value:function(){var e=this;this.initIcons(),this.on(mn,function(){e.setAttr("data-state","pause")}),this.on(bt,function(){e.setAttr("data-state","play")})}},{key:"onPluginsReady",value:function(){var e=this,r=this.player,o=this.config;if(!o.disable){if(this.config.isShowIcon){var a={config:{onClick:function(){e.getMini()}}};r.controls.registerPlugin(au,a,au.pluginName)}var u=p.checkTouchSupport()?"touchend":"click";this.bind(".mini-cancel-btn",u,this.onCancelClick),this.bind(".play-icon",u,this.onCenterClick),this.config.disableDrag||(this._draggabilly=new jp(this.player.root,{handle:this.root})),this.config.isScrollSwitch&&window.addEventListener("scroll",this.onScroll)}}},{key:"registerIcons",value:function(){return{play:{icon:Uo,class:"xg-icon-play"},pause:{icon:Ho,class:"xg-icon-pause"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".play-icon",e.play),this.appendChild(".play-icon",e.pause)}},{key:"getMini",value:function(){var e=this;if(!this.isMini){var r=this.player,o=this.playerConfig,a=this.config.target||this.player.root;this.lastStyle={},p.addClass(r.root,"xgplayer-mini"),["width","height","top","left"].map(function(u){e.lastStyle[u]=a.style[u],a.style[u]="".concat(e.pos[u],"px")}),o.fluid&&(a.style["padding-top"]=""),this.emit(Pr,!0),r.isMini=this.isMini=!0}}},{key:"exitMini",value:function(){var e=this;if(!this.isMini)return!1;var r=this.player,o=this.playerConfig,a=this.config.target||this.player.root;p.removeClass(r.root,"xgplayer-mini"),this.lastStyle&&Object.keys(this.lastStyle).map(function(u){a.style[u]=e.lastStyle[u]}),this.lastStyle=null,o.fluid&&(r.root.style.width="100%",r.root.style.height="0",r.root.style["padding-top"]="".concat(o.height*100/o.width,"%")),this.emit(Pr,!1),this.isMini=r.isMini=!1}},{key:"destroy",value:function(){window.removeEventListener("scroll",this.onScroll);var e=p.checkTouchSupport()?"touchend":"click";this.unbind(".mini-cancel-btn",e,this.onCancelClick),this.unbind(".play-icon",e,this.onCenterClick),this._draggabilly&&this._draggabilly.destroy(),this._draggabilly=null,this.exitMini()}},{key:"render",value:function(){if(!this.config.disable)return`
      <xg-mini-layer class="xg-mini-layer">
      <xg-mini-header class="xgplayer-mini-header">
      `.concat(ki(this,"MINI_DRAG",this.playerConfig.isHideTips),`
      </xg-mini-header>
      <div class="mini-cancel-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">
          <path fill="#fff" fill-rule="evenodd" d="M3.99 3.49a1 1 0 0 1 1.414 0L10 8.085l4.596-4.595a1 1 0 1 1 1.414 1.414L11.414 9.5l4.596 4.596a1 1 0 0 1 .084 1.32l-.084.094a1 1 0 0 1-1.414 0L10 10.914 5.404 15.51a1 1 0 0 1-1.414-1.414L8.585 9.5 3.99 4.904a1 1 0 0 1-.084-1.32z"></path>
        </svg>
      </div>
      <div class="play-icon">
      </div>
      </xg-mini-layer>`)}}],[{key:"pluginName",get:function(){return"miniscreen"}},{key:"defaultConfig",get:function(){return{index:10,disable:!1,width:320,height:180,left:-1,top:-1,isShowIcon:!1,isScrollSwitch:!1,scrollTop:0,disableDrag:!1}}}]),i}(Ie),rr={mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousemove:"onMouseMove"},Ss=["videoClick","videoDbClick"],ws=function(n){de(i,n);var s=ge(i);function i(){var t;ae(this,i);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t=s.call.apply(s,[this].concat(r)),D(R(t),"onMouseMove",function(a){var u=R(t),l=u.player,c=u.playerConfig;l.isActive||(l.focus({autoHide:!c.closeDelayBlur}),!c.closeFocusVideoFocus&&l.media.focus())}),D(R(t),"onMouseEnter",function(a){var u=R(t),l=u.playerConfig,c=u.player;!l.closeFocusVideoFocus&&c.media.focus(),l.closeDelayBlur?c.focus({autoHide:!1}):c.focus(),t.emit(Sc)}),D(R(t),"onMouseLeave",function(a){var u=t.playerConfig,l=u.closePlayerBlur,c=u.leavePlayerTime,f=u.closeDelayBlur;!l&&!f&&(c?t.player.focus({autoHide:!0,delay:c}):t.player.blur({ignorePaused:!0})),t.emit(Tc)}),D(R(t),"onVideoClick",function(a){var u=R(t),l=u.player,c=u.playerConfig;a.target&&c.closeVideoClick||(a.target===l.root||a.target===l.media||a.target===l.innerContainer||a.target===l.media.__canvas)&&(a.preventDefault(),c.closeVideoStopPropagation||a.stopPropagation(),t._clickCount++,t.clickTimer&&(clearTimeout(t.clickTimer),t.clickTimer=null),t.clickTimer=setTimeout(function(){t._clickCount&&(t._clickCount--,ii(R(t),Ss[0],function(f,h){t.switchPlayPause(h.e)},{e:a,paused:l.paused}),clearTimeout(t.clickTimer),t.clickTimer=null)},300))}),D(R(t),"onVideoDblClick",function(a){var u=R(t),l=u.player,c=u.playerConfig;if(!(c.closeVideoDblclick||!a.target||a.target!==l.media&&a.target!==l.media.__canvas)){if(!c.closeVideoClick&&t._clickCount<2){t._clickCount=0;return}t._clickCount=0,t.clickTimer&&(clearTimeout(t.clickTimer),t.clickTimer=null),a.preventDefault(),a.stopPropagation(),ii(R(t),Ss[1],function(f,h){t.emitUserAction(h.e,"switch_fullscreen",{props:"fullscreen",from:l.fullscreen,to:!l.fullscreen}),l.fullscreen?l.exitFullscreen():l.getFullscreen()},{e:a,fullscreen:l.fullscreen})}}),t}return ue(i,[{key:"afterCreate",value:function(){var e=this;this._clickCount=0,Ss.map(function(o){e.__hooks[o]=null});var r=this.playerConfig.isMobileSimulateMode;r==="mobile"||Te.device==="mobile"&&!Te.os.isIpad||this.initEvents()}},{key:"initEvents",value:function(){var e=this,r=this.player,o=r.media,a=r.root,u=this.playerConfig.enableContextmenu;a&&a.addEventListener("click",this.onVideoClick,!1),a&&a.addEventListener("dblclick",this.onVideoDblClick,!1),Object.keys(rr).map(function(l){a.addEventListener(l,e[rr[l]],!1)}),!u&&o&&o.addEventListener("contextmenu",this.onContextmenu,!1)}},{key:"switchPlayPause",value:function(e){var r=this.player;this.emitUserAction(e,"switch_play_pause",{props:"paused",from:r.paused,to:!r.paused}),r.ended?r.duration!==1/0&&r.duration>0&&r.replay():r.paused?r.play():r.pause()}},{key:"onContextmenu",value:function(e){e=e||window.event,e.preventDefault&&e.preventDefault(),e.stopPropagation?e.stopPropagation():(e.returnValue=!1,e.cancelBubble=!0)}},{key:"destroy",value:function(){var e=this,r=this.player,o=r.video,a=r.root;this.clickTimer&&clearTimeout(this.clickTimer),a.removeEventListener("click",this.onVideoClick,!1),a.removeEventListener("dblclick",this.onVideoDblClick,!1),o.removeEventListener("contextmenu",this.onContextmenu,!1),Object.keys(rr).map(function(u){a.removeEventListener(u,e[rr[u]],!1)})}}],[{key:"pluginName",get:function(){return"pc"}},{key:"defaultConfig",get:function(){return{}}}]),i}(Yt),gi={PRESS:"press",PRESS_END:"pressend",DOUBlE_CLICK:"doubleclick",CLICK:"click",TOUCH_MOVE:"touchmove",TOUCH_START:"touchstart",TOUCH_END:"touchend"},zp={start:"touchstart",end:"touchend",move:"touchmove",cancel:"touchcancel"},Wp={start:"mousedown",end:"mouseup",move:"mousemove",cancel:"mouseleave"};function fu(n){return n&&n.length>0?n[n.length-1]:null}function Gp(){return{pressDelay:600,dbClickDelay:200,disablePress:!1,disableDbClick:!1,miniStep:2,needPreventDefault:!0}}var Kp=function(){function n(s){var i=this,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{eventType:"touch"};ae(this,n),D(this,"onTouchStart",function(e){var r=i._pos,o=i.root,a=fu(e.touches);r.x=a?parseInt(a.pageX,10):e.pageX,r.y=a?parseInt(a.pageX,10):e.pageX,r.start=!0,i.__setPress(e),o.addEventListener(i.events.end,i.onTouchEnd),o.addEventListener(i.events.cancel,i.onTouchCancel),o.addEventListener(i.events.move,i.onTouchMove),i.trigger(gi.TOUCH_START,e)}),D(this,"onTouchCancel",function(e){i.onTouchEnd(e)}),D(this,"onTouchEnd",function(e){var r=i._pos,o=i.root;i.__clearPress(),o.removeEventListener(i.events.cancel,i.onTouchCancel),o.removeEventListener(i.events.end,i.onTouchEnd),o.removeEventListener(i.events.move,i.onTouchMove),e.moving=r.moving,e.press=r.press,r.press&&i.trigger(gi.PRESS_END,e),i.trigger(gi.TOUCH_END,e),!r.press&&!r.moving&&i.__setDb(e),r.press=!1,r.start=!1,r.moving=!1}),D(this,"onTouchMove",function(e){var r=i._pos,o=i.config,a=fu(e.touches),u=a?parseInt(a.pageX,10):e.pageX,l=a?parseInt(a.pageY,10):e.pageX,c=u-r.x,f=l-r.y;Math.abs(f)<o.miniStep&&Math.abs(c)<o.miniStep||(i.__clearPress(),r.press&&i.trigger(gi.PRESS_END,e),r.press=!1,r.moving=!0,i.trigger(gi.TOUCH_MOVE,e))}),this._pos={moving:!1,start:!1,x:0,y:0},this.config=Gp(),Object.keys(t).map(function(e){i.config[e]=t[e]}),this.root=s,this.events=t.eventType==="mouse"?Wp:zp,this.pressIntrvalId=null,this.dbIntrvalId=null,this.__handlers={},this._initEvent()}return ue(n,[{key:"_initEvent",value:function(){this.root.addEventListener(this.events.start,this.onTouchStart)}},{key:"__setPress",value:function(i){var t=this,e=this.config;this.pressIntrvalId&&this.__clearPress(),this.pressIntrvalId=setTimeout(function(){t.trigger(gi.PRESS,i),t._pos.press=!0,t.__clearPress()},e.pressDelay)}},{key:"__clearPress",value:function(){window.clearTimeout(this.pressIntrvalId),this.pressIntrvalId=null}},{key:"__setDb",value:function(i){var t=this,e=this.config;if(this.dbIntrvalId){this.__clearDb(),this.trigger(gi.DOUBlE_CLICK,i);return}this.dbIntrvalId=setTimeout(function(){t.__clearDb(),!t._pos.start&&!t._pos.press&&!t._pos.moving&&t.trigger(gi.CLICK,i)},e.dbClickDelay)}},{key:"__clearDb",value:function(){clearTimeout(this.dbIntrvalId),this.dbIntrvalId=null}},{key:"on",value:function(i,t){this.__handlers[i]||(this.__handlers[i]=[]),this.__handlers[i].push(t)}},{key:"off",value:function(i,t){if(this.__handlers[i]){for(var e=this.__handlers[i],r=-1,o=0;o<e.length;o++)if(e[o]===t){r=o;break}r>=0&&this.__handlers[i].splice(r,1)}}},{key:"trigger",value:function(i,t){this.__handlers[i]&&this.__handlers[i].map(function(e){try{e(t)}catch(r){console.error("trigger>>:".concat(i),r)}})}},{key:"destroy",value:function(){var i=this,t={touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"};Object.keys(t).forEach(function(e){i.root.removeEventListener(e,i[t[e]])})}}]),n}();function Yp(){return new DOMParser().parseFromString(`<svg width="20" height="9" viewBox="0 0 8 9" fill="none" xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink">
  <path opacity="0.54"
    d="M7.5 3.63397C8.16667 4.01887 8.16667 4.98113 7.5 5.36603L1.5 8.83013C0.833334 9.21503 0 8.7339 0 7.9641L0 1.0359C0 0.266098 0.833333 -0.215027 1.5 0.169873L7.5 3.63397Z"
    fill="white" />
  <path transform="translate(5 0)" d="M7.5 3.63397C8.16667 4.01887 8.16667 4.98113 7.5 5.36603L1.5 8.83013C0.833334 9.21503 0 8.7339 0 7.9641L0 1.0359C0 0.266098 0.833333 -0.215027 1.5 0.169873L7.5 3.63397Z" fill="white"/>
</svg>`,"image/svg+xml").firstChild}var $i={AUTO:"auto",SEEKING:"seeking",PLAYBACK:"playbackrate",LIGHT:""},Cs=["videoClick","videoDbClick"],$p=function(n){de(i,n);var s=ge(i);function i(t){var e;return ae(this,i),e=s.call(this,t),D(R(e),"onTouchStart",function(r){var o=R(e),a=o.player,u=o.config,l=o.pos,c=o.playerConfig,f=e.getTouche(r);if(f&&!u.disableGesture&&e.duration>0&&!a.ended){l.isStart=!0,e.timer&&clearTimeout(e.timer),p.checkIsFunction(c.disableSwipeHandler)&&c.disableSwipeHandler(),e.find(".xg-dur").innerHTML=p.format(e.duration);var h=e.root.getBoundingClientRect();a.rotateDeg===90?(l.top=h.left,l.left=h.top,l.width=h.height,l.height=h.width):(l.top=h.top,l.left=h.left,l.width=h.width,l.height=h.height);var d=parseInt(f.pageX-l.left,10),g=parseInt(f.pageY-l.top,10);l.x=a.rotateDeg===90?g:d,l.y=a.rotateDeg===90?d:g,l.scopeL=u.scopeL*l.width,l.scopeR=(1-u.scopeR)*l.width,l.scopeM1=l.width*(1-u.scopeM)/2,l.scopeM2=l.width-l.scopeM1}}),D(R(e),"onTouchMove",function(r){var o=e.getTouche(r),a=R(e),u=a.pos,l=a.config,c=a.player;if(!(!o||l.disableGesture||!e.duration||!u.isStart)){var f=l.miniMoveStep,h=l.hideControlsActive,d=parseInt(o.pageX-u.left,10),g=parseInt(o.pageY-u.top,10),v=c.rotateDeg===90?g:d,m=c.rotateDeg===90?d:g;if(Math.abs(v-u.x)>f||Math.abs(m-u.y)>f){var S=v-u.x,w=m-u.y,_=u.scope;if(_===-1&&(_=e.checkScope(v,m,S,w,u),_===0&&(h?c.blur():c.focus({autoHide:!1}),!u.time&&(u.time=parseInt(c.currentTime*1e3,10)+e.timeOffset*1e3)),u.scope=_),_===-1||_>0&&!l.gestureY||_===0&&!l.gestureX)return;r.cancelable&&r.preventDefault(),e.executeMove(S,w,_,u.width,u.height),u.x=v,u.y=m}}}),D(R(e),"onTouchEnd",function(r){var o=R(e),a=o.player,u=o.pos,l=o.playerConfig;if(setTimeout(function(){a.getPlugin("progress")&&a.getPlugin("progress").resetSeekState()},10),!!u.isStart){u.scope>-1&&r.cancelable&&r.preventDefault();var c=e.config,f=c.disableGesture,h=c.gestureX;!f&&h?e.endLastMove(u.scope):u.time=0,u.scope=-1,e.resetPos(),p.checkIsFunction(l.enableSwipeHandler)&&l.enableSwipeHandler(),e.changeAction($i.AUTO)}}),D(R(e),"onRootTouchMove",function(r){e.config.disableGesture||!e.config.gestureX||e.checkIsRootTarget(r)&&(r.stopPropagation(),e.pos.isStart?e.onTouchMove(r):e.onTouchStart(r))}),D(R(e),"onRootTouchEnd",function(r){e.pos.isStart&&e.checkIsRootTarget(r)&&(r.stopPropagation(),e.onTouchEnd(r))}),e.pos={isStart:!1,x:0,y:0,time:0,volume:0,rate:1,light:0,width:0,height:0,scopeL:0,scopeR:0,scopeM1:0,scopeM2:0,scope:-1},e.timer=null,e}return ue(i,[{key:"duration",get:function(){return this.playerConfig.customDuration||this.player.duration}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"registerIcons",value:function(){return{seekTipIcon:{icon:Yp,class:"xg-seek-pre"}}}},{key:"afterCreate",value:function(){var e=this;Cs.map(function(f){e.__hooks[f]=null});var r=this.playerConfig,o=this.config,a=this.player;r.closeVideoDblclick===!0&&(o.closedbClick=!0),this.resetPos(),p.isUndefined(r.disableGesture)||(o.disableGesture=!!r.disableGesture),this.appendChild(".xg-seek-icon",this.icons.seekTipIcon),this.xgMask=p.createDom("xg-mask","",{},"xgmask"),a.root.appendChild(this.xgMask),this.initCustomStyle(),this.registerThumbnail();var u=this.domEventType==="mouse"?"mouse":"touch";this.touch=new Kp(this.root,{eventType:u,needPreventDefault:!this.config.disableGesture}),this.root.addEventListener("contextmenu",function(f){f.preventDefault()}),a.root.addEventListener("touchmove",this.onRootTouchMove,!0),a.root.addEventListener("touchend",this.onRootTouchEnd,!0),this.on(Ci,function(){var f=e.player,h=e.config;f.duration*1e3<h.moveDuration&&(h.moveDuration=f.duration*1e3)}),this.on([ni,zi],function(){var f=e.pos,h=f.time,d=f.isStart;!d&&h>0&&(e.pos.time=0)});var l={touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",press:"onPress",pressend:"onPressEnd",click:"onClick",doubleclick:"onDbClick"};if(Object.keys(l).map(function(f){e.touch.on(f,function(h){e[l[f]](h)})}),!o.disableActive){var c=a.plugins.progress;c&&(c.addCallBack("dragmove",function(f){e.activeSeekNote(f.currentTime,f.forward)}),["dragend","click"].forEach(function(f){c.addCallBack(f,function(){e.changeAction($i.AUTO)})}))}}},{key:"registerThumbnail",value:function(){var e=this.player,r=e.plugins.thumbnail;if(r&&r.usable){this.thumbnail=r.createThumbnail(null,"mobile-thumbnail");var o=this.find(".time-preview");o.insertBefore(this.thumbnail,o.children[0])}}},{key:"initCustomStyle",value:function(){var e=this.playerConfig||{},r=e.commonStyle,o=r.playedColor,a=r.progressColor,u=r.timePreviewStyle,l=r.curTimeColor,c=r.durationColor;if(o&&(this.find(".xg-curbar").style.backgroundColor=o),a&&(this.find(".xg-bar").style.backgroundColor=a),u){var f=this.find(".time-preview");Object.keys(u).forEach(function(g){f.style[g]=u[g]})}var h=l||o,d=c;h&&(this.find(".xg-cur").style.color=h),d&&(this.find(".xg-dur").style.color=d),this.config.disableTimeProgress&&p.addClass(this.find(".xg-timebar"),"hide")}},{key:"resetPos",value:function(){var e=this;this.pos?(this.pos.isStart=!1,this.pos.scope=-1,["x","y","width","height","scopeL","scopeR","scopeM1","scopeM2"].map(function(r){e.pos[r]=0})):this.pos={isStart:!1,x:0,y:0,volume:0,rate:1,light:0,width:0,height:0,scopeL:0,scopeR:0,scopeM1:0,scopeM2:0,scope:-1,time:0}}},{key:"changeAction",value:function(e){var r=this.player,o=this.root;o.setAttribute("data-xg-action",e);var a=r.plugins.start;a&&a.recover()}},{key:"getTouche",value:function(e){var r=this.player.rotateDeg,o=e.touches&&e.touches.length>0?e.touches[e.touches.length-1]:e;return r===0?{pageX:o.pageX,pageY:o.pageY}:{pageX:o.pageX,pageY:o.pageY}}},{key:"checkScope",value:function(e,r,o,a,u){var l=u.width,c=-1;if(e<0||e>l)return c;var f=Math.abs(a===0?o:o/a);return Math.abs(o)>0&&f>=1.73&&e>u.scopeM1&&e<u.scopeM2?c=0:(Math.abs(o)===0||f<=.57)&&(c=e<u.scopeL?1:e>u.scopeR?2:3),c}},{key:"executeMove",value:function(e,r,o,a,u){switch(o){case 0:this.updateTime(e/a*this.config.scopeM);break;case 1:this.updateBrightness(r/u);break;case 2:Te.os.isIos||this.updateVolume(r/u);break}}},{key:"endLastMove",value:function(e){var r=this,o=this.pos,a=this.player,u=this.config,l=(o.time-this.timeOffset)/1e3;switch(e){case 0:a.seek(Number(l).toFixed(1)),u.hideControlsEnd?a.blur():a.focus(),this.timer=setTimeout(function(){r.pos.time=0},500);break}this.changeAction($i.AUTO)}},{key:"checkIsRootTarget",value:function(e){var r=this.player.plugins||{};return r.progress&&r.progress.root.contains(e.target)?!1:r.start&&r.start.root.contains(e.target)||r.controls&&r.controls.root.contains(e.target)}},{key:"sendUseAction",value:function(e){var r=this.player.paused;this.emitUserAction(e,"switch_play_pause",{prop:"paused",from:r,to:!r})}},{key:"clickHandler",value:function(e){var r=this.player,o=this.config,a=this.playerConfig;if(r.state<Pe.RUNNING){a.closeVideoClick||(this.sendUseAction(p.createEvent("click")),r.play());return}!o.closedbClick||a.closeVideoClick?r.isActive?r.blur():r.focus():a.closeVideoClick||((r.isActive||o.focusVideoClick)&&(this.sendUseAction(p.createEvent("click")),this.switchPlayPause()),r.focus())}},{key:"dbClickHandler",value:function(e){var r=this.config,o=this.player;!r.closedbClick&&o.state>=Pe.RUNNING&&(this.sendUseAction(p.createEvent("dblclick")),this.switchPlayPause())}},{key:"onClick",value:function(e){var r=this,o=this.player;ii(this,Cs[0],function(a,u){r.clickHandler(u.e)},{e,paused:o.paused})}},{key:"onDbClick",value:function(e){var r=this,o=this.player;ii(this,Cs[1],function(a,u){r.dbClickHandler(u.e)},{e,paused:o.paused})}},{key:"onPress",value:function(e){var r=this.pos,o=this.config,a=this.player;o.disablePress||(r.rate=this.player.playbackRate,this.emitUserAction("press","change_rate",{prop:"playbackRate",from:a.playbackRate,to:o.pressRate}),a.playbackRate=o.pressRate,this.changeAction($i.PLAYBACK))}},{key:"onPressEnd",value:function(e){var r=this.pos,o=this.config,a=this.player;o.disablePress||(this.emitUserAction("pressend","change_rate",{prop:"playbackRate",from:a.playbackRate,to:r.rate}),a.playbackRate=r.rate,r.rate=1,this.changeAction($i.AUTO))}},{key:"updateTime",value:function(e){var r=this.player,o=this.config,a=this.player.duration;e=Number(e.toFixed(4));var u=parseInt(e*o.moveDuration,10)+this.timeOffset;u+=this.pos.time,u=u<0?0:u>a*1e3?a*1e3-200:u,r.getPlugin("time")&&r.getPlugin("time").updateTime(u/1e3),r.getPlugin("progress")&&r.getPlugin("progress").updatePercent(u/1e3/this.duration,!0),this.activeSeekNote(u/1e3,e>0),o.isTouchingSeek&&r.seek(Number((u-this.timeOffset)/1e3).toFixed(1)),this.pos.time=u}},{key:"updateVolume",value:function(e){this.player.rotateDeg&&(e=-e);var r=this.player,o=this.pos;if(e=parseInt(e*100,10),o.volume+=e,!(Math.abs(o.volume)<10)){var a=parseInt(r.volume*10,10)-parseInt(o.volume/10,10);a=a>10?10:a<1?0:a,r.volume=a/10,o.volume=0}}},{key:"updateBrightness",value:function(e){this.player.rotateDeg&&(e=-e);var r=this.pos,o=this.config,a=this.xgMask,u=r.light+.8*e;u=u>o.maxDarkness?o.maxDarkness:u<0?0:u,a&&(a.style.backgroundColor="rgba(0,0,0,".concat(u,")")),r.light=u}},{key:"activeSeekNote",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=this.player,a=this.config,u=!(this.duration!==1/0&&this.duration>0);if(!(!e||typeof e!="number"||u||a.disableActive)){e<0?e=0:e>o.duration&&(e=o.duration-.2),this.changeAction($i.SEEKING);var l=o.plugins.start;l&&l.focusHide(),this.find(".xg-dur").innerHTML=p.format(this.duration),this.find(".xg-cur").innerHTML=p.format(e),this.find(".xg-curbar").style.width="".concat(e/this.duration*100,"%"),r?p.removeClass(this.find(".xg-seek-show"),"xg-back"):p.addClass(this.find(".xg-seek-show"),"xg-back"),this.updateThumbnails(e)}}},{key:"updateThumbnails",value:function(e){var r=this.player,o=r.plugins.thumbnail;o&&o.usable&&this.thumbnail&&o.update(this.thumbnail,e,160,90)}},{key:"switchPlayPause",value:function(){var e=this.player;if(e.state<Pe.ATTACHED)return!1;e.ended||(e.paused?e.play():e.pause())}},{key:"disableGesture",value:function(){this.config.disableGesture=!1}},{key:"enableGesture",value:function(){this.config.disableGesture=!0}},{key:"destroy",value:function(){var e=this.player;this.timer&&clearTimeout(this.timer),this.thumbnail=null,e.root.removeChild(this.xgMask),this.xgMask=null,this.touch&&this.touch.destroy(),this.touch=null,e.root.removeEventListener("touchmove",this.onRootTouchMove,!0),e.root.removeEventListener("touchend",this.onRootTouchEnd,!0)}},{key:"render",value:function(){var e=this.config.gradient!=="normal"?"gradient ".concat(this.config.gradient):"gradient";return`
     <xg-trigger class="trigger">
     <div class="`.concat(e,`"></div>
        <div class="time-preview">
            <div class="xg-seek-show `).concat(this.config.disableSeekIcon?" hide-seek-icon":"",`">
              <i class="xg-seek-icon"></i>
              <span class="xg-cur">00:00</span>
              <span class="xg-separator">/</span>
              <span class="xg-dur">00:00</span>
            </div>
              <div class="xg-bar xg-timebar">
                <div class="xg-curbar"></div>
              </div>
        </div>
        <div class="xg-playbackrate xg-top-note">
            <span><i>`).concat(this.config.pressRate,"X</i>").concat(this.i18n.FORWARD,`</span>
        </div>
     </xg-trigger>
    `)}}],[{key:"pluginName",get:function(){return"mobile"}},{key:"defaultConfig",get:function(){return{index:0,disableGesture:!1,gestureX:!0,gestureY:!0,gradient:"normal",isTouchingSeek:!1,miniMoveStep:5,miniYPer:5,scopeL:.25,scopeR:.25,scopeM:.9,pressRate:2,darkness:!0,maxDarkness:.8,disableActive:!1,disableTimeProgress:!1,hideControlsActive:!1,hideControlsEnd:!1,moveDuration:60*6*1e3,closedbClick:!1,disablePress:!0,disableSeekIcon:!1,focusVideoClick:!1}}}]),i}(Ie);function qp(n){n.preventDefault(),n.returnValue=!1}function hu(n){var s=n.tagName;return!!(s==="INPUT"||s==="TEXTAREA"||n.isContentEditable)}var du=function(n){de(i,n);var s=ge(i);function i(){var t;ae(this,i);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t=s.call.apply(s,[this].concat(r)),D(R(t),"onBodyKeyDown",function(a){if(t.player){var u=a||window.event,l=u.keyCode,c=R(t),f=c._keyState,h=c.player,d=t.config,g=d.disable,v=d.disableBodyTrigger,m=d.isIgnoreUserActive;if(g||v||!(h.isUserActive||m)||hu(u.target)||!t.checkIsVisible()||u.metaKey||u.altKey||u.ctrlKey){f.isBodyKeyDown=!1;return}!a.repeat&&!f.isKeyDown&&((u.target===document.body||t.config.isGlobalTrigger&&!hu(u.target))&&t.checkCode(l,!0)&&(f.isBodyKeyDown=!0),document.addEventListener("keyup",t.onBodyKeyUp)),f.isBodyKeyDown&&t.handleKeyDown(u)}}),D(R(t),"onBodyKeyUp",function(a){t.player&&(document.removeEventListener("keyup",t.onBodyKeyUp),t.handleKeyUp(a))}),D(R(t),"onKeydown",function(a){if(t.player){var u=a||window.event,l=R(t),c=l._keyState;if(!u.repeat){if(t.config.disable||t.config.disableRootTrigger||u.metaKey||u.altKey||u.ctrlKey)return;u&&(u.keyCode===37||t.checkCode(u.keyCode))&&(u.target===t.player.root||u.target===t.player.video||u.target===t.player.controls.el)&&(c.isKeyDown=!0),t.player.root.addEventListener("keyup",t.onKeyup)}c.isKeyDown&&t.handleKeyDown(u)}}),D(R(t),"onKeyup",function(a){t.player&&(t.player.root.removeEventListener("keyup",t.onKeyup),t.handleKeyUp(a))}),t}return ue(i,[{key:"mergekeyCodeMap",value:function(){var e=this,r=this.config.keyCodeMap;r&&Object.keys(r).map(function(o){e.keyCodeMap[o]?["keyCode","action","disable","pressAction","disablePress","isBodyTarget"].map(function(a){r[o][a]&&(e.keyCodeMap[o][a]=r[o][a])}):e.keyCodeMap[o]=r[o]})}},{key:"afterCreate",value:function(){this.config.disable=!this.playerConfig.keyShortcut;var e=typeof this.config.seekStep=="function"?this.config.seekStep(this.player):this.config.seekStep;!e||typeof e!="number"||(this.seekStep=e),this.keyCodeMap={space:{keyCode:32,action:"playPause",disable:!1,disablePress:!1,noBodyTarget:!1},up:{keyCode:38,action:"upVolume",disable:!1,disablePress:!1,noBodyTarget:!0},down:{keyCode:40,action:"downVolume",disable:!1,disablePress:!1,noBodyTarget:!0},left:{keyCode:37,action:"seekBack",disablePress:!1,disable:!1},right:{keyCode:39,action:"seek",pressAction:"changePlaybackRate",disablePress:!1,disable:!1},esc:{keyCode:27,action:"exitFullscreen",disablePress:!0,disable:!1}},this.mergekeyCodeMap(),this._keyState={isKeyDown:!1,isBodyKeyDown:!1,isPress:!1,tt:0,playbackRate:0},this.player.root.addEventListener("keydown",this.onKeydown),document.addEventListener("keydown",this.onBodyKeyDown)}},{key:"setConfig",value:function(e){var r=this;Object.keys(e).forEach(function(o){r.config[o]=e[o]})}},{key:"checkIsVisible",value:function(){if(!this.config.checkVisible)return!0;var e=this.player.root.getBoundingClientRect(),r=e.height,o=e.top,a=e.bottom,u=window.innerHeight;return!(o<0&&o<0-r*.9||a>0&&a-u>r*.9)}},{key:"checkCode",value:function(e,r){var o=this,a=!1;return Object.keys(this.keyCodeMap).map(function(u){o.keyCodeMap[u]&&e===o.keyCodeMap[u].keyCode&&!o.keyCodeMap[u].disable&&(a=!r||r&&!o.keyCodeMap[u].noBodyTarget)}),a}},{key:"downVolume",value:function(e){var r=this.player;if(!(r.volume<=0)){var o=parseFloat((r.volume-.1).toFixed(1)),a={volume:{from:r.volume,to:o}};this.emitUserAction(e,"change_volume",{props:a}),o>=0?r.volume=o:r.volume=0}}},{key:"upVolume",value:function(e){var r=this.player;if(!(r.volume>=1)){var o=parseFloat((r.volume+.1).toFixed(1)),a={volume:{from:r.volume,to:o}};this.emitUserAction(e,"change_volume",{props:a}),o<=1?r.volume=o:r.volume=1}}},{key:"seek",value:function(e){var r=this.player,o=r.currentTime,a=r.offsetCurrentTime,u=r.duration,l=r.offsetDuration,c=r.timeSegments,f=a>-1?a:o,h=l||u,d=e.repeat&&this.seekStep>=4?parseInt(this.seekStep/2,10):this.seekStep;f+d<=h?f=f+d:f=h;var g=p.getCurrentTimeByOffset(f,c),v={currentTime:{from:o,to:g}};this.emitUserAction(e,"seek",{props:v}),this.player.currentTime=g}},{key:"seekBack",value:function(e){var r=this.player,o=r.currentTime,a=r.offsetCurrentTime,u=r.timeSegments,l=e.repeat?parseInt(this.seekStep/2,10):this.seekStep,c=a>-1?a:o,f=c-l;f<0&&(f=0),f=p.getCurrentTimeByOffset(f,u);var h={currentTime:{from:o,to:f}};this.emitUserAction(e,"seek",{props:h}),this.player.currentTime=f}},{key:"changePlaybackRate",value:function(e){var r=this._keyState,o=this.config,a=this.player;r.playbackRate===0&&(r.playbackRate=a.playbackRate,a.playbackRate=o.playbackRate)}},{key:"playPause",value:function(e){var r=this.player;r&&(this.emitUserAction(e,"switch_play_pause"),r.paused?r.play():r.pause())}},{key:"exitFullscreen",value:function(e){var r=this.player,o=r.fullscreen,a=r.cssfullscreen;o&&(this.emitUserAction("keyup","switch_fullscreen",{prop:"fullscreen",from:o,to:!o}),r.exitFullscreen()),a&&(this.emitUserAction("keyup","switch_css_fullscreen",{prop:"cssfullscreen",from:a,to:!a}),r.exitCssFullscreen())}},{key:"handleKeyDown",value:function(e){var r=this._keyState;if(e.repeat){r.isPress=!0;var o=Date.now();if(o-r.tt<200)return;r.tt=o}this.handleKeyCode(e.keyCode,e,r.isPress)}},{key:"handleKeyUp",value:function(e){var r=this._keyState;r.playbackRate>0&&(this.player.playbackRate=r.playbackRate,r.playbackRate=0),r.isKeyDown=!1,r.isPress=!1,r.tt=0}},{key:"handleKeyCode",value:function(e,r,o){for(var a=Object.keys(this.keyCodeMap),u=0;u<a.length;u++){var l=this.keyCodeMap[a[u]],c=l.action,f=l.keyCode,h=l.disable,d=l.pressAction,g=l.disablePress;if(f===e){if(!h&&!(o&&g)){var v=o&&d||c;typeof v=="function"?c(r,this.player,o):typeof v=="string"&&typeof this[v]=="function"&&this[v](r,this.player,o),this.emit(Pc,ze({key:a[u],target:r.target,isPress:o},this.keyCodeMap[a[u]]))}qp(r),r.stopPropagation();break}}}},{key:"destroy",value:function(){this.player.root.removeEventListener("keydown",this.onKeydown),document.removeEventListener("keydown",this.onBodyKeyDown),this.player.root.removeEventListener("keyup",this.onKeyup),document.removeEventListener("keyup",this.onBodyKeyUp)}},{key:"disable",value:function(){this.config.disable=!0}},{key:"enable",value:function(){this.config.disable=!1}}],[{key:"pluginName",get:function(){return"keyboard"}},{key:"defaultConfig",get:function(){return{seekStep:10,checkVisible:!1,disableBodyTrigger:!1,disableRootTrigger:!1,isGlobalTrigger:!0,keyCodeMap:{},disable:!1,playbackRate:2,isIgnoreUserActive:!0}}}]),i}(Yt);function Xp(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="-5 -5 110 110">
  <path d="M100,50A50,50,0,1,1,50,0" stroke-width="5" stroke="#ddd" stroke-dasharray="236" fill="none"></path>
</svg>
`,"image/svg+xml").firstChild}var Jp=function(n){de(i,n);var s=ge(i);function i(){return ae(this,i),s.apply(this,arguments)}return ue(i,[{key:"registerIcons",value:function(){return{loadingIcon:Xp}}},{key:"afterCreate",value:function(){this.appendChild("xg-loading-inner",this.icons.loadingIcon)}},{key:"render",value:function(){return`
    <xg-loading class="xgplayer-loading">
      <xg-loading-inner></xg-loading-inner>
    </xg-loading>`}}],[{key:"pluginName",get:function(){return"loading"}},{key:"defaultConfig",get:function(){return{position:He.ROOT}}}]),i}(Ie),Qp=[{tag:"xg-cache",className:"xgplayer-progress-cache",styleKey:"cachedColor"},{tag:"xg-played",className:"xgplayer-progress-played",styleKey:"playedColor"}],Zp=function(){function n(s){ae(this,n),this.fragments=s.fragments||[],this.fragments.length===0&&this.fragments.push({percent:1}),this._callBack=s.actionCallback,this.fragConfig={fragFocusClass:s.fragFocusClass||"inner-focus-point",fragAutoFocus:!!s.fragAutoFocus,fragClass:s.fragClass||""},this.style=s.style||{playedColor:"",cachedColor:"",progressColor:""},this.duration=0,this.cachedIndex=0,this.playedIndex=0,this.focusIndex=-1}return ue(n,[{key:"updateDuration",value:function(i){var t=this;this.duration=i;var e=0,r=this.fragments;this.fragments=r.map(function(o){return o.start=parseInt(e,10),o.end=parseInt(e+o.percent*t.duration,10),o.duration=parseInt(o.percent*t.duration,10),e+=o.percent*t.duration,o})}},{key:"updateProgress",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"played",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{newIndex:0,curIndex:0,millisecond:0},e=this.progressList,r=this.fragments;if(!(e.length<1)){var o=t.newIndex,a=t.curIndex,u=t.millisecond;o!==a&&e.map(function(f,h){h<o?f[i].style.width="100%":h>o&&(f[i].style.width=0)});var l=r[o],c=u===0?0:(u-l.start)/l.duration;e[o][i].style.width=c<0?0:"".concat(c*100,"%")}}},{key:"updateFocus",value:function(i){if(!(!this.fragConfig.fragAutoFocus||this.fragments.length<2)){if(!i){if(this.focusIndex>-1){this.unHightLight(this.focusIndex);var t={index:-1,preIndex:this.focusIndex,fragment:null};this._callBack&&this._callBack(t),this.focusIndex=-1}return}var e=this.findIndex(i.currentTime*1e3,this.focusIndex);if(e>=0&&e!==this.focusIndex){this.focusIndex>-1&&this.unHightLight(this.focusIndex),this.setHightLight(e);var r={index:e,preIndex:this.focusIndex,fragment:this.fragments[this.focusIndex]};this.focusIndex=e,this._callBack&&this._callBack(r)}}}},{key:"update",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{cached:0,played:0},t=arguments.length>1?arguments[1]:void 0;if(!this.duration||parseInt(t*1e3,10)!==this.duration){if(!t&&t!==0)return;this.updateDuration(parseInt(t*1e3,10))}var e=this.playedIndex,r=this.cachedIndex;if(p.typeOf(i.played)!=="Undefined"){var o=this.findIndex(i.played*1e3,e);if(o<0)return;this.updateProgress("played",{newIndex:o,curIndex:e,millisecond:parseInt(i.played*1e3,10)}),this.playedIndex=o}if(p.typeOf(i.cached)!=="Undefined"){var a=this.findIndex(i.cached*1e3,r);if(a<0)return;this.updateProgress("cached",{newIndex:a,curIndex:r,millisecond:parseInt(i.cached*1e3,10)}),this.cachedIndex=a}}},{key:"findIndex",value:function(i,t){var e=this.fragments;if(!e||e.length===0)return-1;if(e.length===1)return 0;if(t>-1&&t<e.length&&i>e[t].start&&i<e[t].end)return t;if(i>e[e.length-1].start)return e.length-1;for(var r=0;r<e.length;r++)if(i>e[r].start&&i<=e[r].end){t=r;break}return t}},{key:"findHightLight",value:function(){for(var i=this.root.children,t=0;t<i.length;t++)if(p.hasClass(i[t],this.fragConfig.fragFocusClass))return{dom:i[t],pos:i[t].getBoundingClientRect()}}},{key:"findFragment",value:function(i){var t=this.root.children;return i<0||i>=t.length?null:{dom:t[i],pos:t[i].getBoundingClientRect()}}},{key:"unHightLight",value:function(){for(var i=this.root.children,t=0;t<i.length;t++)p.removeClass(i[t],this.fragConfig.fragFocusClass)}},{key:"setHightLight",value:function(i){var t=this.root.children;if(i<t.length)return p.addClass(t[i],this.fragConfig.fragFocusClass),{dom:t[i],pos:t[i].getBoundingClientRect()}}},{key:"destroy",value:function(){this.progressList=null,this.fragments=null,this.root.innerHTML=""}},{key:"reset",value:function(i){var t=this;if(Object.keys(this.fragConfig).forEach(function(r){i[r]!==void 0&&(t.fragConfig[r]=i[r])}),i.fragments){if(this.fragments=i.fragments.length===0?[{percent:1}]:i.fragments,this.updateDuration(this.duration),this.playedIndex=0,this.cachedIndex=0,this.root)for(var e=this.root.children;e.length>0;)this.root.removeChild(e[0]);this.render()}}},{key:"render",value:function(){var i=this,t=this.style.progressColor;if(this.root||(this.root=p.createDom("xg-inners","",{},"progress-list")),this.fragments){var e=this.fragConfig,r=e.fragClass,o=e.fragFocusClass;this.progressList=this.fragments.map(function(a){var u=p.createDom("xg-inner","",{style:t?"background:".concat(t,"; flex: ").concat(a.percent):"flex: ".concat(a.percent)},"".concat(a.isFocus?o:""," xgplayer-progress-inner ").concat(r));return i.root.appendChild(u),Qp.forEach(function(l){u.appendChild(p.createDom(l.tag,"",{style:l.styleKey?"background: ".concat(i.style[l.styleKey],"; width:0;"):"width:0;"},l.className))}),{cached:u.children[0],played:u.children[1]}})}return this.root}}]),n}(),gu={POINT:"inner-focus-point",HIGHLIGHT:"inner-focus-highlight"},ev=function(n){de(i,n);var s=ge(i);function i(t){var e;return ae(this,i),e=s.call(this,t),D(R(e),"onMoveOnly",function(r,o){var a=R(e),u=a.pos,l=a.config,c=a.player,f=o;if(r){p.event(r);var h=p.getEventPos(r,c.zoom),d=c.rotateDeg===90?h.clientY:h.clientX;if(u.moving&&Math.abs(u.x-d)<l.miniMoveStep)return;u.moving=!0,u.x=d,f=e.computeTime(r,d)}e.triggerCallbacks("dragmove",f,r),e._updateInnerFocus(f)}),D(R(e),"onBodyClick",function(r){e.pos.isLocked&&(e.pos.isLocked=!1,r.preventDefault(),r.stopPropagation())}),D(R(e),"_mouseDownHandler",function(r,o){e._state.time=o.currentTime,e.updateWidth(o.currentTime,o.seekTime,o.percent,0),e._updateInnerFocus(o)}),D(R(e),"_mouseUpHandler",function(r,o){var a=R(e),u=a.pos;u.moving&&e.updateWidth(o.currentTime,o.seekTime,o.percent,2)}),D(R(e),"_mouseMoveHandler",function(r,o){var a=R(e),u=a._state,l=a.pos,c=a.config,f=a.player;u.time<o.currentTime?o.forward=!0:o.forward=!1,u.time=o.currentTime,l.isDown&&!l.moving&&(l.moving=!0,c.isPauseMoving&&f.pause(),e.triggerCallbacks("dragstart",o,r),e.emitUserAction("drag","dragstart",o)),e.updateWidth(o.currentTime,o.seekTime,o.percent,1),e.triggerCallbacks("dragmove",o,r),e._updateInnerFocus(o)}),D(R(e),"onMouseDown",function(r){var o=R(e),a=o._state,u=o.player,l=o.pos,c=o.config,f=o.playerConfig,h=p.getEventPos(r,u.zoom),d=u.rotateDeg===90?h.clientY:h.clientX;if(!(u.isMini||c.closeMoveSeek||!f.allowSeekAfterEnded&&u.ended)){if(!u.duration&&!u.isPlaying){u.play();return}r.stopPropagation(),e.focus(),p.checkIsFunction(f.disableSwipeHandler)&&f.disableSwipeHandler(),p.checkIsFunction(c.onMoveStart)&&c.onMoveStart(),p.event(r),l.x=d,l.isDown=!0,l.moving=!1,a.prePlayTime=u.currentTime,u.focus({autoHide:!1}),e.isProgressMoving=!0,p.addClass(e.progressBtn,"active");var g=e.computeTime(r,d);g.prePlayTime=a.prePlayTime,e._mouseDownHandlerHook(r,g);var v=r.type;return v==="touchstart"?(e.root.addEventListener("touchmove",e.onMouseMove),e.root.addEventListener("touchend",e.onMouseUp),e.root.addEventListener("touchcancel",e.onMouseUp)):(e.unbind("mousemove",e.onMoveOnly),document.addEventListener("mousemove",e.onMouseMove,!1),document.addEventListener("mouseup",e.onMouseUp,!1)),!0}}),D(R(e),"onMouseUp",function(r){var o=R(e),a=o.player,u=o.config,l=o.pos,c=o.playerConfig,f=o._state;r.stopPropagation(),r.preventDefault(),p.checkIsFunction(c.enableSwipeHandler)&&c.enableSwipeHandler(),p.checkIsFunction(u.onMoveEnd)&&u.onMoveEnd(),p.event(r),p.removeClass(e.progressBtn,"active");var h=e.computeTime(r,l.x);h.prePlayTime=f.prePlayTime,l.moving?(e.triggerCallbacks("dragend",h,r),e.emitUserAction("drag","dragend",h)):(e.triggerCallbacks("click",h,r),e.emitUserAction("click","click",h)),e._mouseUpHandlerHook(r,h),l.moving=!1,l.isDown=!1,l.x=0,l.y=0,l.isLocked=!0,f.prePlayTime=0,f.time=0;var d=r.type;d==="touchend"||d==="touchcancel"?(e.root.removeEventListener("touchmove",e.onMouseMove),e.root.removeEventListener("touchend",e.onMouseUp),e.root.removeEventListener("touchcancel",e.onMouseUp),e.blur()):(document.removeEventListener("mousemove",e.onMouseMove,!1),document.removeEventListener("mouseup",e.onMouseUp,!1),l.isEnter?c.isMobileSimulateMode!=="mobile"&&e.bind("mousemove",e.onMoveOnly):e.onMouseLeave(r)),p.setTimeout(R(e),function(){e.resetSeekState()},10),a.focus()}),D(R(e),"onMouseMove",function(r){var o=R(e),a=o._state,u=o.pos,l=o.player,c=o.config;p.checkTouchSupport()&&r.preventDefault(),p.event(r);var f=p.getEventPos(r,l.zoom),h=l.rotateDeg===90?f.clientY:f.clientX,d=Math.abs(u.x-h);if(!(u.moving&&d<c.miniMoveStep||!u.moving&&d<c.miniStartStep)){u.x=h;var g=e.computeTime(r,h);g.prePlayTime=a.prePlayTime,e._mouseMoveHandlerHook(r,g)}}),D(R(e),"onMouseOut",function(r){e.triggerCallbacks("mouseout",null,r)}),D(R(e),"onMouseOver",function(r){e.triggerCallbacks("mouseover",null,r)}),D(R(e),"onMouseEnter",function(r){var o=R(e),a=o.player,u=o.pos;if(!(u.isDown||u.isEnter||a.isMini||!a.config.allowSeekAfterEnded&&a.ended)){u.isEnter=!0,e.bind("mousemove",e.onMoveOnly),e.bind("mouseleave",e.onMouseLeave),p.event(r);var l=p.getEventPos(r,a.zoom),c=a.rotateDeg===90?l.clientY:l.clientX,f=e.computeTime(r,c);e.triggerCallbacks("mouseenter",f,r),e.focus()}}),D(R(e),"onMouseLeave",function(r){e.triggerCallbacks("mouseleave",null,r),e.unlock(),e._updateInnerFocus(null)}),D(R(e),"onVideoResize",function(){var r=e.pos,o=r.x,a=r.isDown,u=r.isEnter;if(u&&!a){var l=e.computeTime(null,o);e.onMoveOnly(null,l)}}),e.useable=!1,e.isProgressMoving=!1,e.__dragCallBacks=[],e._state={now:-1,direc:0,time:0,prePlayTime:-1},e._disableBlur=!1,e}return ue(i,[{key:"offsetDuration",get:function(){return this.playerConfig.customDuration||this.player.offsetDuration||this.player.duration}},{key:"duration",get:function(){return this.playerConfig.customDuration||this.player.duration}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"currentTime",get:function(){var e=this.player,r=e.offsetCurrentTime,o=e.currentTime;return r>=0?r:o+this.timeOffset}},{key:"changeState",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.useable=e}},{key:"show",value:function(e){this.root&&(this.root.style.display="flex")}},{key:"_initInner",value:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(!r||r.length===0)&&(r=[{percent:1}]);var a=ze(ze({fragments:r},o),{},{actionCallback:function(l){e.emitUserAction("fragment_focus","fragment_focus",l)}});this.innerList?this.innerList.reset(a):(this.innerList=new Zp(a),this.outer.insertBefore(this.innerList.render(),this.outer.children[0]),["findHightLight","unHightLight","setHightLight","findFragment"].map(function(u){e[u]=e.innerList[u].bind(e.innerList)}))}},{key:"_updateInnerFocus",value:function(e){this.innerList&&this.innerList.updateFocus(e)}},{key:"afterCreate",value:function(){var e=this;if(!(this.config.disable||this.playerConfig.isLive)){this.pos={x:0,y:0,moving:!1,isDown:!1,isEnter:!1,isLocked:!1},this.outer=this.find("xg-outer");var r=this.config,o=r.fragFocusClass,a=r.fragAutoFocus,u=r.fragClass;this._initInner(this.config.fragments,{fragFocusClass:o,fragAutoFocus:a,fragClass:u,style:this.playerConfig.commonStyle||{}}),Te.device==="mobile"&&(this.config.isDragingSeek=!1,this.isMobile=!0),this.progressBtn=this.find(".xgplayer-progress-btn"),this.on(Ci,function(){e.onMouseLeave()}),this.on(_t,function(){e.onTimeupdate()}),this.on(si,function(){e.onTimeupdate(),e.onCacheUpdate()}),this.on(_c,function(){e.onCacheUpdate()}),this.on(zi,function(){e.onCacheUpdate(!0),e.onTimeupdate(!0),e._state.now=0}),this.on(Wi,function(){e.onReset()}),this.on(Ti,function(){e.onVideoResize()}),this.bindDomEvents(),this.initCustomStyle()}}},{key:"setConfig",value:function(e){var r=this,o=null;Object.keys(e).forEach(function(a){r.config[a]=e[a],a==="fragments"&&(o=e[a])}),o&&this._initInner(o,e)}},{key:"initCustomStyle",value:function(){var e=this.playerConfig||{},r=e.commonStyle,o=r.sliderBtnStyle,a=this.progressBtn;o&&(typeof o=="string"?a.style.boxShadow=o:ot(o)==="object"&&Object.keys(o).map(function(u){a.style[u]=o[u]}))}},{key:"triggerCallbacks",value:function(e,r,o){this.__dragCallBacks.length>0&&this.__dragCallBacks.map(function(a){if(a&&a.handler&&a.type===e)try{a.handler(r,o)}catch(u){console.error("[XGPLAYER][triggerCallbacks] ".concat(a," error"),u)}})}},{key:"addCallBack",value:function(e,r){r&&typeof r=="function"&&this.__dragCallBacks.push({type:e,handler:r})}},{key:"removeCallBack",value:function(e,r){var o=this.__dragCallBacks,a=-1;o.map(function(u,l){u&&u.type===e&&u.handler===r&&(a=l)}),a>-1&&o.splice(a,1)}},{key:"unlock",value:function(){var e=this.player,r=this.pos;if(r.isEnter=!1,r.isLocked=!1,!e.isMini){if(this.unbind("mousemove",this.onMoveOnly),r.isDown){this.unbind("mouseleave",this.onMouseLeave);return}this.blur()}}},{key:"bindDomEvents",value:function(){var e=this.player,r=e.controls,o=e.config;this._mouseDownHandlerHook=this.hook("dragstart",this._mouseDownHandler),this._mouseUpHandlerHook=this.hook("dragend",this._mouseUpHandler),this._mouseMoveHandlerHook=this.hook("drag",this._mouseMoveHandler),(this.domEventType==="touch"||this.domEventType==="compatible")&&(this.root.addEventListener("touchstart",this.onMouseDown),r&&(r.root&&r.root.addEventListener("touchmove",p.stopPropagation),r.center&&r.center.addEventListener("touchend",p.stopPropagation))),(this.domEventType==="mouse"||this.domEventType==="compatible")&&(this.bind("mousedown",this.onMouseDown),o.isMobileSimulateMode!=="mobile"&&this.bind("mouseenter",this.onMouseEnter),this.bind("mouseover",this.onMouseOver),this.bind("mouseout",this.onMouseOut),this.player.root.addEventListener("click",this.onBodyClick,!0))}},{key:"focus",value:function(){this.player.controls.pauseAutoHide(),p.addClass(this.root,"active")}},{key:"blur",value:function(){this._disableBlur||(this.player.controls.recoverAutoHide(),p.removeClass(this.root,"active"))}},{key:"disableBlur",value:function(){this._disableBlur=!0}},{key:"enableBlur",value:function(){this._disableBlur=!1}},{key:"updateWidth",value:function(e,r,o,a){var u=this.config,l=this.player;if(!(u.isCloseClickSeek&&a===0)){var c=r=r>=l.duration?l.duration-u.endedDiff:Number(r).toFixed(1);this.updatePercent(o),this.updateTime(e),!(a===1&&(!u.isDragingSeek||l.config.mediaType==="audio"))&&(this._state.now=c,this._state.direc=c>l.currentTime?0:1,l.seek(c))}}},{key:"computeTime",value:function(e,r){var o=this.player,a=this.root.getBoundingClientRect(),u=a.width,l=a.height,c=a.top,f=a.left,h,d,g=r;o.rotateDeg===90?(h=l,d=c):(h=u,d=f);var v=g-d;v=v>h?h:v<0?0:v;var m=v/h;m=m<0?0:m>1?1:m;var S=parseInt(m*this.offsetDuration*1e3,10)/1e3,w=p.getCurrentTimeByOffset(S,o.timeSegments);return{percent:m,currentTime:S,seekTime:w,offset:v,width:h,left:d,e}}},{key:"updateTime",value:function(e){var r=this.player,o=this.duration;e>o?e=o:e<0&&(e=0);var a=r.plugins.time;a&&a.updateTime(e)}},{key:"resetSeekState",value:function(){this.isProgressMoving=!1;var e=this.player.plugins.time;e&&e.resetActive()}},{key:"updatePercent",value:function(e,r){if(this.isProgressMoving=!0,!this.config.disable){e=e>1?1:e<0?0:e,this.progressBtn.style.left="".concat(e*100,"%"),this.innerList.update({played:e*this.offsetDuration},this.offsetDuration);var o=this.player.plugins.miniprogress;o&&o.update({played:e*this.offsetDuration},this.offsetDuration)}}},{key:"onTimeupdate",value:function(e){var r=this.player,o=this._state,a=this.offsetDuration;if(!(r.isSeeking&&r.media.seeking||this.isProgressMoving||!r.hasStart)){if(o.now>-1){var u=parseInt(o.now*1e3,10)-parseInt(r.currentTime*1e3,10);if(o.direc===0&&u>300||o.direc===1&&u>-300){o.now=-1;return}else o.now=-1}var l=this.currentTime;l=p.adjustTimeByDuration(l,a,e),this.innerList.update({played:l},a),this.progressBtn.style.left="".concat(l/a*100,"%")}}},{key:"onCacheUpdate",value:function(e){var r=this.player,o=this.duration;if(r){var a=r.bufferedPoint.end;a=p.adjustTimeByDuration(a,o,e),this.innerList.update({cached:a},o)}}},{key:"onReset",value:function(){this.innerList.update({played:0,cached:0},0),this.progressBtn.style.left="0%"}},{key:"destroy",value:function(){var e=this.player,r=e.controls;this.thumbnailPlugin=null,this.innerList.destroy(),this.innerList=null;var o=this.domEventType;(o==="touch"||o==="compatible")&&(this.root.removeEventListener("touchstart",this.onMouseDown),this.root.removeEventListener("touchmove",this.onMouseMove),this.root.removeEventListener("touchend",this.onMouseUp),this.root.removeEventListener("touchcancel",this.onMouseUp),r&&(r.root&&r.root.removeEventListener("touchmove",p.stopPropagation),r.center&&r.center.removeEventListener("touchend",p.stopPropagation))),(o==="mouse"||o==="compatible")&&(this.unbind("mousedown",this.onMouseDown),this.unbind("mouseenter",this.onMouseEnter),this.unbind("mousemove",this.onMoveOnly),this.unbind("mouseleave",this.onMouseLeave),document.removeEventListener("mousemove",this.onMouseMove,!1),document.removeEventListener("mouseup",this.onMouseUp,!1),e.root.removeEventListener("click",this.onBodyClick,!0))}},{key:"render",value:function(){if(!(this.config.disable||this.playerConfig.isLive)){var e=this.player.controls?this.player.controls.config.mode:"",r=e==="bottom"?"xgplayer-progress-bottom":"";return`
    <xg-progress class="xgplayer-progress `.concat(r,`">
      <xg-outer class="xgplayer-progress-outer">
        <xg-progress-btn class="xgplayer-progress-btn"></xg-progress-btn>
      </xg-outer>
    </xg-progress>
    `)}}}],[{key:"pluginName",get:function(){return"progress"}},{key:"defaultConfig",get:function(){return{position:He.CONTROLS_CENTER,index:0,disable:!1,isDragingSeek:!0,closeMoveSeek:!1,isPauseMoving:!1,isCloseClickSeek:!1,fragments:[{percent:1}],fragFocusClass:gu.POINT,fragClass:"",fragAutoFocus:!1,miniMoveStep:5,miniStartStep:2,onMoveStart:function(){},onMoveEnd:function(){},endedDiff:.2}}},{key:"FRAGMENT_FOCUS_CLASS",get:function(){return gu}}]),i}(Ie),Gi=function(n){de(i,n);var s=ge(i);function i(){var t;ae(this,i);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t=s.call.apply(s,[this].concat(r)),D(R(t),"_onMouseenter",function(a){t.emit("icon_mouseenter",{pluginName:t.pluginName})}),D(R(t),"_onMouseLeave",function(a){t.emit("icon_mouseleave",{pluginName:t.pluginName})}),t}return ue(i,[{key:"afterCreate",value:function(){this.bind("mouseenter",this._onMouseenter),this.bind("mouseleave",this._onMouseLeave),this.config.disable&&this.disable()}},{key:"destroy",value:function(){this.unbind("mouseenter",this._onMouseenter),this.unbind("mouseleave",this._onMouseLeave)}}]),i}(Ie),tv=function(n){de(i,n);var s=ge(i);function i(){return ae(this,i),s.apply(this,arguments)}return ue(i,[{key:"afterCreate",value:function(){var e=this;_e(ve(i.prototype),"afterCreate",this).call(this);var r=this.player,o=this.config;o.disable||(this.initIcons(),this.btnClick=this.btnClick.bind(this),this.bind(["touchend","click"],this.btnClick),this.on([mn,Jn,Wi],function(){e.animate(r.paused)}),this.on(bt,function(){e.animate(r.paused)}),this.animate(!0))}},{key:"registerIcons",value:function(){return{play:{icon:Uo,class:"xg-icon-play"},pause:{icon:Ho,class:"xg-icon-pause"}}}},{key:"btnClick",value:function(e){e.preventDefault(),e.stopPropagation();var r=this.player;return this.emitUserAction(e,"switch_play_pause",{prop:"paused",from:r.paused,to:!r.paused}),r.ended?r.replay():r.paused?(r.play(),this.animate(!1)):(r.pause(),this.animate(!0)),!1}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.play),this.appendChild(".xgplayer-icon",e.pause)}},{key:"animate",value:function(e){if(this.player){var r=this.i18nKeys,o=this.find(".xg-tips");e?(this.setAttr("data-state","pause"),o&&this.changeLangTextKey(o,r.PLAY_TIPS)):(this.setAttr("data-state","play"),o&&this.changeLangTextKey(o,r.PAUSE_TIPS))}}},{key:"destroy",value:function(){_e(ve(i.prototype),"destroy",this).call(this),this.unbind(["touchend","click"],this.btnClick)}},{key:"render",value:function(){if(!this.config.disable)return`<xg-icon class="xgplayer-play">
    <div class="xgplayer-icon">
    </div>
    `.concat(ki(this,"PLAY_TIPS",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"play"}},{key:"defaultConfig",get:function(){return{position:He.CONTROLS_LEFT,index:0,disable:!1}}}]),i}(Gi);function iv(){return new DOMParser().parseFromString(`<svg width="32px" height="40px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <path d="M11.2374369,14 L17.6187184,7.61871843 C17.9604272,7.27700968 17.9604272,6.72299032 17.6187184,6.38128157 C17.2770097,6.03957281 16.7229903,6.03957281 16.3812816,6.38128157 L9.38128157,13.3812816 C9.03957281,13.7229903 9.03957281,14.2770097 9.38128157,14.6187184 L16.3812816,21.6187184 C16.7229903,21.9604272 17.2770097,21.9604272 17.6187184,21.6187184 C17.9604272,21.2770097 17.9604272,20.7229903 17.6187184,20.3812816 L11.2374369,14 L11.2374369,14 Z" fill="#FFFFFF"></path>
    </g>
</svg>`,"image/svg+xml").firstChild}var nv=function(n){de(i,n);var s=ge(i);function i(){return ae(this,i),s.apply(this,arguments)}return ue(i,[{key:"afterCreate",value:function(){var e=this;this.initIcons(),this.onClick=function(r){r.preventDefault(),r.stopPropagation(),e.config.onClick(r)},this.bind(["click","touchend"],this.onClick)}},{key:"registerIcons",value:function(){return{screenBack:{icon:iv,class:"xg-fullscreen-back"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(this.root,e.screenBack)}},{key:"show",value:function(){p.addClass(this.root,"show")}},{key:"hide",value:function(){p.removeClass(this.root,"show")}},{key:"render",value:function(){return`<xg-icon class="xgplayer-back">
    </xg-icon>`}}],[{key:"pluginName",get:function(){return"topbackicon"}},{key:"defaultConfig",get:function(){return{position:He.ROOT_TOP,index:0}}}]),i}(Ie);function rv(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="2 -4 28 40">
  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M598 214h212v212h-84v-128h-128v-84zM726 726v-128h84v212h-212v-84h128zM214 426v-212h212v84h-128v128h-84zM298 598v128h128v84h-212v-212h84z"></path>
</svg>
`,"image/svg+xml").firstChild}function sv(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="2 -4 28 40">
  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M682 342h128v84h-212v-212h84v128zM598 810v-212h212v84h-128v128h-84zM342 342v-128h84v212h-212v-84h128zM214 682v-84h212v212h-84v-128h-128z"></path>
</svg>
`,"image/svg+xml").firstChild}var ov=function(n){de(i,n);var s=ge(i);function i(){var t;ae(this,i);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t=s.call.apply(s,[this].concat(r)),D(R(t),"_onOrientationChange",function(a){t.player.fullscreen&&t.config.rotateFullscreen&&(window.orientation===90||window.orientation===-90?t.player.setRotateDeg(0):t.player.setRotateDeg(90))}),t}return ue(i,[{key:"afterCreate",value:function(){var e=this;_e(ve(i.prototype),"afterCreate",this).call(this);var r=this.config,o=this.playerConfig;if(!r.disable){r.target&&(this.playerConfig.fullscreenTarget=this.config.target);var a=p.getFullScreenEl();o.fullscreenTarget===a&&this.player.getFullscreen().catch(function(u){}),this.initIcons(),this.handleFullscreen=this.hook("fullscreenChange",this.toggleFullScreen,{pre:function(l){var c=e.player.fullscreen;e.emitUserAction(l,"switch_fullscreen",{prop:"fullscreen",from:c,to:!c})}}),this.bind(".xgplayer-fullscreen",["touchend","click"],this.handleFullscreen),this.on(Zt,function(u){var l=e.find(".xg-tips");l&&e.changeLangTextKey(l,u?e.i18nKeys.EXITFULLSCREEN_TIPS:e.i18nKeys.FULLSCREEN_TIPS),e.animate(u)}),this.config.needBackIcon&&(this.topBackIcon=this.player.registerPlugin({plugin:nv,options:{config:{onClick:function(l){e.handleFullscreen(l)}}}})),Te.device==="mobile"&&window.addEventListener("orientationchange",this._onOrientationChange)}}},{key:"registerIcons",value:function(){return{fullscreen:{icon:rv,class:"xg-get-fullscreen"},exitFullscreen:{icon:sv,class:"xg-exit-fullscreen"}}}},{key:"destroy",value:function(){_e(ve(i.prototype),"destroy",this).call(this),this.unbind(".xgplayer-icon",Te.device==="mobile"?"touchend":"click",this.handleFullscreen),Te.device==="mobile"&&window.removeEventListener("orientationchange",this._onOrientationChange)}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.fullscreen),this.appendChild(".xgplayer-icon",e.exitFullscreen)}},{key:"toggleFullScreen",value:function(e){e&&(e.preventDefault(),e.stopPropagation());var r=this.player,o=this.config,a=o.useCssFullscreen===!0||typeof o.useCssFullscreen=="function"&&o.useCssFullscreen();a?(r.fullscreen?r.exitCssFullscreen():r.getCssFullscreen(),this.animate(r.fullscreen)):o.rotateFullscreen?(r.fullscreen?r.exitRotateFullscreen():r.getRotateFullscreen(),this.animate(r.fullscreen)):o.switchCallback&&typeof o.switchCallback=="function"?o.switchCallback(r.fullscreen):r.fullscreen?(r.exitFullscreen(),o.useScreenOrientation&&this.unlockScreen()):(r.getFullscreen().catch(function(u){}),o.useScreenOrientation&&r.aspectRatio>1&&this.lockScreen(o.lockOrientationType))}},{key:"animate",value:function(e){e?this.setAttr("data-state","full"):this.setAttr("data-state","normal"),this.topBackIcon&&(e?(this.topBackIcon.show(),this.hide()):(this.topBackIcon.hide(),this.show()))}},{key:"render",value:function(){if(!this.config.disable){var e="FULLSCREEN_TIPS";return`<xg-icon class="xgplayer-fullscreen">
    <div class="xgplayer-icon">
    </div>
    `.concat(ki(this,e,this.playerConfig.isHideTips),`
    </xg-icon>`)}}},{key:"lockScreen",value:function(e){try{screen.orientation.lock(e).catch(function(r){})}catch{}}},{key:"unlockScreen",value:function(){try{screen.orientation.unlock().catch(function(e){})}catch{}}}],[{key:"pluginName",get:function(){return"fullscreen"}},{key:"defaultConfig",get:function(){return{position:He.CONTROLS_RIGHT,index:0,useCssFullscreen:!1,rotateFullscreen:!1,useScreenOrientation:!1,lockOrientationType:"landscape",switchCallback:null,target:null,disable:!1,needBackIcon:!1}}}]),i}(Gi),av=function(n){de(i,n);var s=ge(i);function i(t){var e;return ae(this,i),e=s.call(this,t),e.isActiving=!1,e}return ue(i,[{key:"duration",get:function(){var e=this.player,r=e.offsetDuration,o=e.duration;return this.playerConfig.customDuration||r||o}},{key:"currentTime",get:function(){var e=this.player,r=e.offsetCurrentTime,o=e.currentTime;return r>=0?r:o}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"afterCreate",value:function(){var e=this,r=this.player.controls.config.mode;this.mode=r==="flex"?"flex":"normal",!this.config.disable&&(this.mode==="flex"&&(this.createCenterTime(),this.root.style.display="none"),this.durationDom=this.find(".time-duration"),this.timeDom=this.find(".time-current"),this.on([Ci,si,_t],function(o){o.eventName==="durationchange"&&(e.isActiving=!1),e.onTimeUpdate()}),this.on(zi,function(){e.onTimeUpdate(!0)}),this.on(Wi,function(){e.onReset()}))}},{key:"show",value:function(e){if(this.mode==="flex"){this.centerCurDom&&(this.centerCurDom.style.display="block"),this.centerDurDom&&(this.centerDurDom.style.display="block");return}this.root.style.display="block"}},{key:"hide",value:function(){if(this.mode==="flex"){this.centerCurDom&&(this.centerCurDom.style.display="none"),this.centerDurDom&&(this.centerDurDom.style.display="none");return}this.root.style.display="none"}},{key:"onTimeUpdate",value:function(e){var r=this.player,o=this.config,a=this.duration;if(!(o.disable||this.isActiving||!r.hasStart)){var u=this.currentTime+this.timeOffset;u=p.adjustTimeByDuration(u,a,e),this.mode==="flex"?(this.centerCurDom.innerHTML=this.minWidthTime(p.format(u)),a!==1/0&&a>0&&(this.centerDurDom.innerHTML=p.format(a))):(this.timeDom.innerHTML=this.minWidthTime(p.format(u)),a!==1/0&&a>0&&(this.durationDom.innerHTML=p.format(a)))}}},{key:"onReset",value:function(){this.mode==="flex"?(this.centerCurDom.innerHTML=this.minWidthTime(p.format(0)),this.centerDurDom.innerHTML=p.format(0)):(this.timeDom.innerHTML=this.minWidthTime(p.format(0)),this.durationDom.innerHTML=p.format(0))}},{key:"createCenterTime",value:function(){var e=this.player;if(!(!e.controls||!e.controls.center)){var r=e.controls.center;this.centerCurDom=p.createDom("xg-icon","00:00",{},"xgplayer-time xg-time-left"),this.centerDurDom=p.createDom("xg-icon","00:00",{},"xgplayer-time xg-time-right"),r.children.length>0?r.insertBefore(this.centerCurDom,r.children[0]):r.appendChild(this.centerCurDom),r.appendChild(this.centerDurDom)}}},{key:"afterPlayerInit",value:function(){var e=this.config;if(this.duration===1/0||this.playerConfig.isLive?(p.hide(this.durationDom),p.hide(this.timeDom),p.hide(this.find(".time-separator")),p.show(this.find(".time-live-tag"))):p.hide(this.find(".time-live-tag")),e.hide){this.hide();return}this.show()}},{key:"changeLiveState",value:function(e){e?(p.hide(this.durationDom),p.hide(this.timeDom),p.hide(this.find(".time-separator")),p.show(this.find(".time-live-tag"))):(p.hide(this.find(".time-live-tag")),p.show(this.find(".time-separator")),p.show(this.durationDom),p.show(this.timeDom))}},{key:"updateTime",value:function(e){if(this.isActiving=!0,!(!e&&e!==0||e>this.duration)){if(this.mode==="flex"){this.centerCurDom.innerHTML=this.minWidthTime(p.format(e));return}this.timeDom.innerHTML=this.minWidthTime(p.format(e))}}},{key:"minWidthTime",value:function(e){return e.split(":").map(function(r){return'<span class="time-min-width">'.concat(r,"</span>")}).join(":")}},{key:"resetActive",value:function(){var e=this,r=this.player,o=function(){e.isActiving=!1};this.off(si,o),r.isSeeking&&r.media.seeking?this.once(si,o):this.isActiving=!1}},{key:"destroy",value:function(){var e=this.player.controls.center;this.centerCurDom&&e.removeChild(this.centerCurDom),this.centerCurDom=null,this.centerDurDom&&e.removeChild(this.centerDurDom),this.centerDurDom=null}},{key:"render",value:function(){if(!this.config.disable)return`<xg-icon class="xgplayer-time">
    <span class="time-current">00:00</span>
    <span class="time-separator">/</span>
    <span class="time-duration">00:00</span>
    <span class="time-live-tag">`.concat(this.i18n.LIVE_TIP,`</span>
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"time"}},{key:"defaultConfig",get:function(){return{position:He.CONTROLS_LEFT,index:2,disable:!1}}}]),i}(Ie),uv=function(n){de(i,n);var s=ge(i);function i(){var t;ae(this,i);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t=s.call.apply(s,[this].concat(r)),D(R(t),"_onDurationChange",function(){t.updateSegments();var a=t.player,u=a.currentTime,l=a.timeSegments;if(t._checkIfEnabled(l)){var c=p.getIndexByTime(u,l),f=p.getOffsetCurrentTime(u,l,c);t.player.offsetCurrentTime=f,t.changeIndex(c,l)}}),D(R(t),"_onLoadedData",function(){var a=t.player.timeSegments;if(t._checkIfEnabled(a)){var u=p.getOffsetCurrentTime(0,a);t.player.offsetCurrentTime=u,t.changeIndex(0,a),t.curPos.start>0&&(t.player.currentTime=t.curPos.start)}}),D(R(t),"_onTimeupdate",function(){var a=t.player,u=a.currentTime,l=a.timeSegments;if(t._checkIfEnabled(l)){var c=l.length;t.lastCurrentTime=u;var f=p.getIndexByTime(u,l);f!==t.curIndex&&t.changeIndex(f,l);var h=p.getOffsetCurrentTime(u,l,f);if(t.player.offsetCurrentTime=h,!!t.curPos){var d=t.curPos,g=d.start,v=d.end;u<g?t.player.currentTime=g:u>v&&f>=c-1&&t.player.pause()}}}),D(R(t),"_onSeeking",function(){var a=t.player,u=a.currentTime,l=a.timeSegments;if(t._checkIfEnabled(l))if(u<l[0].start)t.player.currentTime=l[0].start;else if(u>l[l.length-1].end)t.player.currentTime=l[l.length-1].end;else{var c=p.getIndexByTime(u,l);if(c>=0){var f=t.getSeekTime(u,t.lastCurrentTime,c,l);f>=0&&(t.player.currentTime=f)}}}),D(R(t),"_onPlay",function(){var a=t.player,u=a.currentTime,l=a.timeSegments;t._checkIfEnabled(l)&&u>=l[l.length-1].end&&(t.player.currentTime=l[0].start)}),t}return ue(i,[{key:"afterCreate",value:function(){this.curIndex=-1,this.curPos=null,this.lastCurrentTime=0,this.updateSegments(),this.on(Ci,this._onDurationChange),this.on(ai,this._onLoadedData),this.on(_t,this._onTimeupdate),this.on(Di,this._onSeeking),this.on(bt,this._onPlay)}},{key:"setConfig",value:function(e){var r=this;if(e){var o=Object.keys(e);o.length<1||(o.forEach(function(a){r.config[a]=e[a]}),this.updateSegments())}}},{key:"updateSegments",value:function(){var e=this.config,r=e.disable,o=e.segments,a=this.player;if(r||!o||o.length===0)a.timeSegments=[],a.offsetDuration=0,a.offsetCurrentTime=-1;else{var u=this.formatTimeSegments(o,a.duration);a.timeSegments=u,a.offsetDuration=u.length>0?u[u.length-1].duration:0}}},{key:"formatTimeSegments",value:function(e,r){var o=[];return e?(e.sort(function(a,u){return a.start-u.start}),e.forEach(function(a,u){var l={};if(l.start=a.start<0?0:a.start,l.end=r>0&&a.end>r?r:a.end,!(r>0&&l.start>r)){o.push(l);var c=l.end-l.start;if(u===0)l.offset=a.start,l.cTime=0,l.segDuration=c,l.duration=c;else{var f=o[u-1];l.offset=f.offset+(l.start-f.end),l.cTime=f.duration+f.cTime,l.segDuration=c,l.duration=f.duration+c}}}),o):[]}},{key:"getSeekTime",value:function(e,r,o,a){var u=-1,l=a[o],c=l.start,f=l.end;if(e>=c&&e<=f)return u;var h=e-r;if(h<0&&e<c){var d=r>c?r-c:0;return u=o-1>=0?a[o-1].end+h+d:0,u}return-1}},{key:"_checkIfEnabled",value:function(e){return!(!e||e.length<1)}},{key:"changeIndex",value:function(e,r){this.curIndex=e,e>=0&&r.length>0?this.curPos=r[e]:this.curPos=null}}],[{key:"pluginName",get:function(){return"TimeSegmentsControls"}},{key:"defaultConfig",get:function(){return{disable:!0,segments:[]}}}]),i}(Yt);function lv(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="0 -10 28 40">
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M940.632 837.632l-72.192-72.192c65.114-64.745 105.412-154.386 105.412-253.44s-40.299-188.695-105.396-253.424l-0.016-0.016 72.192-72.192c83.639 83.197 135.401 198.37 135.401 325.632s-51.762 242.434-135.381 325.612l-0.020 0.020zM795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021z"></path>
</svg>
`,"image/svg+xml").firstChild}function cv(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="0 -10 28 40">
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021zM795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021z"></path>
</svg>
`,"image/svg+xml").firstChild}function fv(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="0 -10 28 40">
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M920.4 439.808l-108.544-109.056-72.704 72.704 109.568 108.544-109.056 108.544 72.704 72.704 108.032-109.568 108.544 109.056 72.704-72.704-109.568-108.032 109.056-108.544-72.704-72.704-108.032 109.568z"></path>
</svg>
`,"image/svg+xml").firstChild}var hv=function(n){de(i,n);var s=ge(i);function i(){var t;ae(this,i);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t=s.call.apply(s,[this].concat(r)),D(R(t),"onBarMousedown",function(a){var u=R(t),l=u.player,c=t.find(".xgplayer-bar");p.event(a);var f=c.getBoundingClientRect(),h=p.getEventPos(a,l.zoom),d=f.height-(h.clientY-f.top);if(h.h=d,h.barH=f.height,t.pos=h,!(d<-2))return t.updateVolumePos(d,a),document.addEventListener("mouseup",t.onBarMouseUp),t._d.isStart=!0,!1}),D(R(t),"onBarMouseMove",function(a){var u=R(t),l=u._d;if(l.isStart){var c=R(t),f=c.pos,h=c.player;a.preventDefault(),a.stopPropagation(),p.event(a);var d=p.getEventPos(a,h.zoom);l.isMoving=!0;var g=f.h-d.clientY+f.clientY;g>f.barH||t.updateVolumePos(g,a)}}),D(R(t),"onBarMouseUp",function(a){p.event(a),document.removeEventListener("mouseup",t.onBarMouseUp);var u=R(t),l=u._d;l.isStart=!1,l.isMoving=!1}),D(R(t),"onMouseenter",function(a){t._d.isActive=!0,t.focus(),t.emit("icon_mouseenter",{pluginName:t.pluginName})}),D(R(t),"onMouseleave",function(a){t._d.isActive=!1,t.unFocus(100,!1,a),t.emit("icon_mouseleave",{pluginName:t.pluginName})}),D(R(t),"onVolumeChange",function(a){if(t.player){var u=t.player,l=u.muted,c=u.volume;t._d.isMoving||(t.find(".xgplayer-drag").style.height=l||c===0?"4px":"".concat(c*100,"%"),t.config.showValueLabel&&t.updateVolumeValue()),t.animate(l,c)}}),t}return ue(i,[{key:"registerIcons",value:function(){return{volumeSmall:{icon:cv,class:"xg-volume-small"},volumeLarge:{icon:lv,class:"xg-volume"},volumeMuted:{icon:fv,class:"xg-volume-mute"}}}},{key:"afterCreate",value:function(){var e=this;if(this._timerId=null,this._d={isStart:!1,isMoving:!1,isActive:!1},!this.config.disable){this.initIcons();var r=this.playerConfig,o=r.commonStyle,a=r.volume;o.volumeColor&&(this.find(".xgplayer-drag").style.backgroundColor=o.volumeColor),this.changeMutedHandler=this.hook("mutedChange",function(u){e.changeMuted(u)},{pre:function(l){l.preventDefault(),l.stopPropagation()}}),this._onMouseenterHandler=this.hook("mouseenter",this.onMouseenter),this._onMouseleaveHandler=this.hook("mouseleave",this.onMouseleave),Te.device!=="mobile"&&this.playerConfig.isMobileSimulateMode!=="mobile"&&(this.bind("mouseenter",this._onMouseenterHandler),this.bind(["blur","mouseleave"],this._onMouseleaveHandler),this.bind(".xgplayer-slider","mousedown",this.onBarMousedown),this.bind(".xgplayer-slider","mousemove",this.onBarMouseMove),this.bind(".xgplayer-slider","mouseup",this.onBarMouseUp)),this.bind(".xgplayer-icon",["touchend","click"],this.changeMutedHandler),this.on(mc,this.onVolumeChange),this.once(ai,this.onVolumeChange),p.typeOf(a)!=="Number"&&(this.player.volume=this.config.default),this.onVolumeChange()}}},{key:"updateVolumePos",value:function(e,r){var o=this.player,a=this.find(".xgplayer-drag"),u=this.find(".xgplayer-bar");if(!(!u||!a)){var l=parseInt(e/u.getBoundingClientRect().height*1e3,10);a.style.height="".concat(e,"px");var c=Math.max(Math.min(l/1e3,1),0),f={volume:{from:o.volume,to:c}};o.muted&&(f.muted={from:!0,to:!1}),this.emitUserAction(r,"change_volume",{muted:o.muted,volume:o.volume,props:f}),o.volume=Math.max(Math.min(l/1e3,1),0),o.muted&&(o.muted=!1),this.config.showValueLabel&&this.updateVolumeValue()}}},{key:"updateVolumeValue",value:function(){var e=this.player,r=e.volume,o=e.muted,a=this.find(".xgplayer-value-label"),u=Math.max(Math.min(r,1),0);a.innerText=o?0:Math.ceil(u*100)}},{key:"focus",value:function(){var e=this.player;e.focus({autoHide:!1}),this._timerId&&(p.clearTimeout(this,this._timerId),this._timerId=null),p.addClass(this.root,"slide-show")}},{key:"unFocus",value:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2?arguments[2]:void 0,u=this._d,l=this.player;u.isActive||(this._timerId&&(p.clearTimeout(this,this._timerId),this._timerId=null),this._timerId=p.setTimeout(this,function(){u.isActive||(o?l.blur():l.focus(),p.removeClass(e.root,"slide-show"),u.isStart&&e.onBarMouseUp(a)),e._timerId=null},r))}},{key:"changeMuted",value:function(e){e&&e.stopPropagation();var r=this.player,o=this._d;o.isStart&&this.onBarMouseUp(e),this.emitUserAction(e,"change_muted",{muted:r.muted,volume:r.volume,props:{muted:{from:r.muted,to:!r.muted}}}),r.volume>0&&(r.muted=!r.muted),r.volume<.01&&(r.volume=this.config.miniVolume)}},{key:"animate",value:function(e,r){e||r===0?this.setAttr("data-state","mute"):r<.5&&this.icons.volumeSmall?this.setAttr("data-state","small"):this.setAttr("data-state","normal")}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.volumeSmall),this.appendChild(".xgplayer-icon",e.volumeLarge),this.appendChild(".xgplayer-icon",e.volumeMuted)}},{key:"destroy",value:function(){this._timerId&&(p.clearTimeout(this,this._timerId),this._timerId=null),this.unbind("mouseenter",this.onMouseenter),this.unbind(["blur","mouseleave"],this.onMouseleave),this.unbind(".xgplayer-slider","mousedown",this.onBarMousedown),this.unbind(".xgplayer-slider","mousemove",this.onBarMouseMove),this.unbind(".xgplayer-slider","mouseup",this.onBarMouseUp),document.removeEventListener("mouseup",this.onBarMouseUp),this.unbind(".xgplayer-icon",Te.device==="mobile"?"touchend":"click",this.changeMutedHandler)}},{key:"render",value:function(){if(!this.config.disable){var e=this.config.default||this.player.volume,r=this.config.showValueLabel;return`
    <xg-icon class="xgplayer-volume" data-state="normal">
      <div class="xgplayer-icon">
      </div>
      <xg-slider class="xgplayer-slider">
        `.concat(r?'<div class="xgplayer-value-label">'.concat(e*100,"</div>"):"",`
        <div class="xgplayer-bar">
          <xg-drag class="xgplayer-drag" style="height: `).concat(e*100,`%"></xg-drag>
        </div>
      </xg-slider>
    </xg-icon>`)}}}],[{key:"pluginName",get:function(){return"volume"}},{key:"defaultConfig",get:function(){return{position:He.CONTROLS_RIGHT,index:1,disable:!1,showValueLabel:!1,default:.6,miniVolume:.2}}}]),i}(Ie);function dv(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="-4 -6 40 40" fill="none">
  <g clip-path="url(#clip0)">
    <path transform="scale(1.5 1.5)" d="M11.6665 9.16663H4.1665C2.78579 9.16663 1.6665 10.2859 1.6665 11.6666V15.8333C1.6665 17.214 2.78579 18.3333 4.1665 18.3333H11.6665C13.0472 18.3333 14.1665 17.214 14.1665 15.8333V11.6666C14.1665 10.2859 13.0472 9.16663 11.6665 9.16663Z" fill="white"/>
    <path transform="scale(1.5 1.5)" fill-rule="evenodd" clip-rule="evenodd" d="M3.88148 4.06298C3.75371 4.21005 3.67667 4.40231 3.67749 4.61242C3.67847 4.87253 3.79852 5.10435 3.98581 5.25646L6.99111 8.05895C7.32771 8.37283 7.85502 8.35443 8.16891 8.01782C8.48279 7.68122 8.46437 7.15391 8.12778 6.84003L6.62061 5.43457L9.8198 5.4224C9.82848 5.42239 9.8372 5.42221 9.84591 5.4219C10.9714 5.38233 12.0885 5.6285 13.0931 6.13744C14.0976 6.64635 14.957 7.40148 15.5908 8.33234C16.2246 9.2632 16.6122 10.3394 16.7177 11.4606C16.823 12.5819 16.6427 13.7115 16.1934 14.7442C16.0098 15.1661 16.203 15.6571 16.6251 15.8408C17.0471 16.0243 17.5381 15.8311 17.7216 15.4091C18.2833 14.1183 18.5087 12.7063 18.3771 11.3047C18.2453 9.90318 17.7607 8.55792 16.9684 7.39433C16.1761 6.23073 15.1021 5.28683 13.8463 4.65065C12.5946 4.01651 11.203 3.70872 9.80072 3.75583L6.43415 3.76862L7.96326 2.12885C8.27715 1.79225 8.25872 1.26494 7.92213 0.951061C7.58553 0.63718 7.05822 0.655585 6.74433 0.99219L3.90268 4.0395C3.89545 4.04724 3.88841 4.05509 3.88154 4.06303L3.88148 4.06298Z" fill="white"/>
  </g>
  <defs>
    <clipPath id="clip0">
      <rect width="40" height="40" fill="white"/>
    </clipPath>
  </defs>
</svg>
`,"image/svg+xml").firstChild}var gv=function(n){de(i,n);var s=ge(i);function i(t){var e;return ae(this,i),e=s.call(this,t),e.rotateDeg=e.config.rotateDeg||0,e}return ue(i,[{key:"afterCreate",value:function(){var e=this;if(!this.config.disable){_e(ve(i.prototype),"afterCreate",this).call(this),this.appendChild(".xgplayer-icon",this.icons.rotate),this.onBtnClick=this.onBtnClick.bind(this),this.bind(".xgplayer-icon",["click","touchend"],this.onBtnClick),this.on(Ti,function(){e.rotateDeg&&e.config.innerRotate&&p.setTimeout(e,function(){e.updateRotateDeg(e.rotateDeg,e.config.innerRotate)},100)});var r=this.player.root;this.rootWidth=r.style.width||r.offsetWidth||r.clientWidth,this.rootHeight=r.style.height||r.offsetHeight||r.clientHeight,this.rotateDeg&&this.updateRotateDeg(this.rotateDeg,this.config.innerRotate)}}},{key:"destroy",value:function(){_e(ve(i.prototype),"destroy",this).call(this),this.unbind(".xgplayer-icon",["click","touchend"],this.onBtnClick)}},{key:"onBtnClick",value:function(e){e.preventDefault(),e.stopPropagation(),this.emitUserAction(e,"rotate"),this.rotate(this.config.clockwise,this.config.innerRotate,1)}},{key:"updateRotateDeg",value:function(e,r){if(e||(e=0),r){this.player.videoRotateDeg=e;return}var o=this.player,a=this.rootWidth,u=this.rootHeight,l=o.root,c=o.innerContainer,f=o.media,h=l.offsetWidth,d=c&&r?c.offsetHeight:l.offsetHeight,g=a,v=u,m=0,S=0;(e===.75||e===.25)&&(g="".concat(d,"px"),v="".concat(h,"px"),m=-(d-h)/2,S=-(h-d)/2);var w="translate(".concat(m,"px,").concat(S,"px) rotate(").concat(e,"turn)"),_={transformOrigin:"center center",transform:w,webKitTransform:w,height:v,width:g},P=r?f:l,I=r?o.getPlugin("poster"):null;Object.keys(_).map(function(j){P.style[j]=_[j],I&&I.root&&(I.root.style[j]=_[j])})}},{key:"rotate",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,a=this.player;this.rotateDeg||(this.rotateDeg=0);var u=e?1:-1;this.rotateDeg=(this.rotateDeg+1+u*.25*o)%1,this.updateRotateDeg(this.rotateDeg,r),a.emit(Cc,this.rotateDeg*360)}},{key:"registerIcons",value:function(){return{rotate:dv}}},{key:"render",value:function(){if(!this.config.disable)return`
    <xg-icon class="xgplayer-rotate">
      <div class="xgplayer-icon">
      </div>
      `.concat(ki(this,"ROTATE_TIPS",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"rotate"}},{key:"defaultConfig",get:function(){return{position:He.CONTROLS_RIGHT,index:6,innerRotate:!0,clockwise:!1,rotateDeg:0,disable:!1}}}]),i}(Gi);function pv(){return new DOMParser().parseFromString(`<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd"
    d="M16.5 4.3H3.5C3.38954 4.3 3.3 4.38954 3.3 4.5V15.5C3.3 15.6105 3.38954 15.7 3.5 15.7H8.50005L8.50006 17.5H3.5C2.39543 17.5 1.5 16.6046 1.5 15.5V4.5C1.5 3.39543 2.39543 2.5 3.5 2.5H16.5C17.6046 2.5 18.5 3.39543 18.5 4.5V8.5H16.7V4.5C16.7 4.38954 16.6105 4.3 16.5 4.3ZM12 11.5C11.4477 11.5 11 11.9477 11 12.5L11 16.5C11 17.0523 11.4478 17.5 12 17.5H17.5C18.0523 17.5 18.5 17.0523 18.5 16.5L18.5 12.5C18.5 11.9477 18.0523 11.5 17.5 11.5H12Z"
    fill="white" />
</svg>`,"image/svg+xml").firstChild}function vv(){return new DOMParser().parseFromString(`<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd"
    d="M16.5 4.3H3.5C3.38954 4.3 3.3 4.38954 3.3 4.5V15.5C3.3 15.6105 3.38954 15.7 3.5 15.7H8.50005L8.50006 17.5H3.5C2.39543 17.5 1.5 16.6046 1.5 15.5V4.5C1.5 3.39543 2.39543 2.5 3.5 2.5H16.5C17.6046 2.5 18.5 3.39543 18.5 4.5V8.5H16.7V4.5C16.7 4.38954 16.6105 4.3 16.5 4.3ZM12 11.5C11.4477 11.5 11 11.9477 11 12.5L11 16.5C11 17.0523 11.4478 17.5 12 17.5H17.5C18.0523 17.5 18.5 17.0523 18.5 16.5L18.5 12.5C18.5 11.9477 18.0523 11.5 17.5 11.5H12Z"
    fill="white" />
  <path fill-rule="evenodd" clip-rule="evenodd"
    d="M9.4998 7.7C9.77595 7.7 9.9998 7.47614 9.9998 7.2V6.5C9.9998 6.22386 9.77595 6 9.4998 6H5.5402L5.52754 6.00016H5.5C5.22386 6.00016 5 6.22401 5 6.50016V10.4598C5 10.7359 5.22386 10.9598 5.5 10.9598H6.2C6.47614 10.9598 6.7 10.7359 6.7 10.4598V8.83005L8.76983 10.9386C8.96327 11.1357 9.27984 11.1386 9.47691 10.9451L9.97645 10.4548C10.1735 10.2613 10.1764 9.94476 9.983 9.7477L7.97289 7.7H9.4998Z"
    fill="white" />
</svg>`,"image/svg+xml").firstChild}var qi={PIP:"picture-in-picture",INLINE:"inline",FULLSCREEN:"fullscreen"},mv=function(n){de(i,n);var s=ge(i);function i(){var t;ae(this,i);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t=s.call.apply(s,[this].concat(r)),D(R(t),"switchPIP",function(a){if(!t.isPIPAvailable())return!1;a.stopPropagation&&a.stopPropagation(),t.isPip?(t.exitPIP(),t.emitUserAction(a,"change_pip",{props:"pip",from:!0,to:!1}),t.setAttr("data-state","normal")):t.player.media.readyState===4&&(t.requestPIP(),t.emitUserAction(a,"change_pip",{props:"pip",from:!1,to:!0}),t.setAttr("data-state","pip"))}),t}return ue(i,[{key:"beforeCreate",value:function(e){typeof e.player.config.pip=="boolean"&&(e.config.showIcon=e.player.config.pip)}},{key:"afterCreate",value:function(){var e=this;this.isPIPAvailable()&&(_e(ve(i.prototype),"afterCreate",this).call(this),this.pMode=qi.INLINE,this.initPipEvents(),this.config.showIcon&&this.initIcons(),this.once(Xr,function(){e.config.showIcon&&(p.removeClass(e.find(".xgplayer-icon"),"xg-icon-disable"),e.bind("click",e.switchPIP))}))}},{key:"registerIcons",value:function(){return{pipIcon:{icon:pv,class:"xg-get-pip"},pipIconExit:{icon:vv,class:"xg-exit-pip"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.pipIcon),this.appendChild(".xgplayer-icon",e.pipIconExit)}},{key:"initPipEvents",value:function(){var e=this,r=this.player;this.leavePIPCallback=function(){var o=r.paused;p.setTimeout(e,function(){!o&&r.mediaPlay()},0),!o&&r.mediaPlay(),e.setAttr("data-state","normal"),e.pipWindow=null,r.emit(Qs,!1)},this.enterPIPCallback=function(o){r.emit(Qs,!0),o!=null&&o.pictureInPictureWindow&&(e.pipWindow=o.pictureInPictureWindow),e.setAttr("data-state","pip")},this.onWebkitpresentationmodechanged=function(o){var a=r.media.webkitPresentationMode;e.pMode===qi.FULLSCREEN&&a!==qi.FULLSCREEN&&r.onFullscreenChange(null,!1),e.pMode=a,a===qi.PIP?e.enterPIPCallback(o):a===qi.INLINE&&e.leavePIPCallback(o)},r.media&&(r.media.addEventListener("enterpictureinpicture",this.enterPIPCallback),r.media.addEventListener("leavepictureinpicture",this.leavePIPCallback),i.checkWebkitSetPresentationMode(r.media)&&r.media.addEventListener("webkitpresentationmodechanged",this.onWebkitpresentationmodechanged))}},{key:"copyStyleIntoPiPWindow",value:function(e){var r=Ot(document.styleSheets).map(function(a){try{return Ot(a.cssRules).map(function(l){return l.cssText}).join("")}catch{var u=document.createElement("link");u.rel="stylesheet",u.type=a.type,u.media=a.media,u.href=a.href,e.document.head.appendChild(u)}return""}).filter(Boolean).join(`
`),o=document.createElement("style");o.textContent=r,e.document.head.appendChild(o)}},{key:"requestPIP",value:function(){var e=this,r=this.player,o=this.playerConfig,a=this.config;if(!(!this.isPIPAvailable()||this.isPip))try{var u=o.poster;if(u&&(r.media.poster=p.typeOf(u)==="String"?u:u.poster),a.preferDocument&&this.isDocPIPAvailable()){var l={};if(a.width&&a.height)l.width=a.width,l.height=a.height;else{var c=r.root.getBoundingClientRect();l.width=c.width,l.height=c.height}documentPictureInPicture.requestWindow(l).then(function(f){var h=a.docPiPNode,d=a.docPiPStyle;e.enterPIPCallback();var g=h||r.root,v=g.parentElement,m=g.previousSibling,S=g.nextSibling;e.copyStyleIntoPiPWindow(f);var w=document.createElement("style");if(w.append("body{padding:0; margin:0;}"),d){var _="";typeof d=="string"?_=d:typeof d=="function"&&(_=d.call(a)),_&&w.append(_)}else g===r.root&&w.append(`
              .xgplayer{width: 100%!important; height: 100%!important;}
            `);f.document.head.append(w),f.document.body.append(g),f.addEventListener("pagehide",function(P){v&&(S?v.insertBefore(g,S):m?v.insertBefore(g,m.nextSibling):v.appendChild(g)),e.leavePIPCallback()},{once:!0})})}else i.checkWebkitSetPresentationMode(r.media)?r.media.webkitSetPresentationMode("picture-in-picture"):r.media.requestPictureInPicture();return!0}catch(f){return console.error("requestPiP",f),!1}}},{key:"exitPIP",value:function(){var e=this.player;try{if(this.isPIPAvailable()&&this.isPip){var r;this.isDocPIPAvailable()&&(r=documentPictureInPicture)!==null&&r!==void 0&&r.window?documentPictureInPicture.window.close():i.checkWebkitSetPresentationMode(e.media)?e.media.webkitSetPresentationMode("inline"):document.exitPictureInPicture()}return!0}catch(o){return console.error("exitPIP",o),!1}}},{key:"isPip",get:function(){var e,r=this.player;return!!(this.isDocPIPAvailable()&&(e=documentPictureInPicture)!==null&&e!==void 0&&e.window)||document.pictureInPictureElement&&document.pictureInPictureElement===r.media||r.media.webkitPresentationMode===qi.PIP}},{key:"isPIPAvailable",value:function(){var e=this.player.media,r=p.typeOf(document.pictureInPictureEnabled)==="Boolean"?document.pictureInPictureEnabled:!0;return r&&(p.typeOf(e.disablePictureInPicture)==="Boolean"&&!e.disablePictureInPicture||e.webkitSupportsPresentationMode&&p.typeOf(e.webkitSetPresentationMode)==="Function")||this.isDocPIPAvailable()}},{key:"isDocPIPAvailable",value:function(){return"documentPictureInPicture"in window&&/^(https|file)/.test(location.protocol)}},{key:"destroy",value:function(){_e(ve(i.prototype),"destroy",this).call(this);var e=this.player;e.media.removeEventListener("enterpictureinpicture",this.enterPIPCallback),e.media.removeEventListener("leavepictureinpicture",this.leavePIPCallback),i.checkWebkitSetPresentationMode(e.media)&&e.media.removeEventListener("webkitpresentationmodechanged",this.onWebkitpresentationmodechanged),this.exitPIP(),this.unbind("click",this.btnClick)}},{key:"render",value:function(){if(!(!this.config.showIcon||!this.isPIPAvailable()))return`<xg-icon class="xgplayer-pip">
      <div class="xgplayer-icon xg-icon-disable">
      </div>
      `.concat(ki(this,"PIP",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"pip"}},{key:"defaultConfig",get:function(){return{position:He.CONTROLS_RIGHT,index:6,showIcon:!1,preferDocument:!1,width:void 0,height:void 0,docPiPNode:void 0,docPiPStyle:void 0}}},{key:"checkWebkitSetPresentationMode",value:function(e){return typeof e.webkitSetPresentationMode=="function"}}]),i}(Gi);function yv(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="40" viewBox="10 0 24 40">
  <path transform="scale(0.038 0.028)" d="M800 380v768h-128v-352l-320 320v-704l320 320v-352z"></path>
</svg>
`,"image/svg+xml").firstChild}var _v=function(n){de(i,n);var s=ge(i);function i(t){var e;return ae(this,i),e=s.call(this,t),D(R(e),"playNext",function(r){var o=R(e),a=o.player;r.preventDefault(),r.stopPropagation(),e.idx+1<e.config.urlList.length?(e.idx++,e.nextHandler(e.config.urlList[e.idx],e.idx),a.emit(Rr,e.idx+1)):(e.nextHandler(),a.emit(Rr))}),e.idx=-1,e}return ue(i,[{key:"afterCreate",value:function(){!this.config.urlList||this.config.urlList.length===0||(this.appendChild(".xgplayer-icon",this.icons.playNext),this.initEvents())}},{key:"registerIcons",value:function(){return{playNext:yv}}},{key:"initEvents",value:function(){this.nextHandler=this.hook("nextClick",this.changeSrc);var e=Te.device==="mobile"?"touchend":"click";this.bind(e,this.playNext),this.show()}},{key:"changeSrc",value:function(e){var r=this.player;e&&(r.pause(),r.currentTime=0,r.switchURL?r.switchURL(e):r.src=e,r.config.url=e,r.play())}},{key:"destroy",value:function(){this.unbind(["touchend","click"],this.playNext)}},{key:"render",value:function(){if(!(!this.config.urlList||this.config.urlList.length===0))return`
     <xg-icon class="xgplayer-playnext">
      <div class="xgplayer-icon">
      </div>
      `.concat(ki(this,"PLAYNEXT_TIPS",this.playerConfig.isHideTips),`
     </xg-icon>
    `)}}],[{key:"pluginName",get:function(){return"playNext"}},{key:"defaultConfig",get:function(){return{position:He.CONTROLS_LEFT,index:1,url:null,urlList:[]}}}]),i}(Ie),Uc={exports:{}};(function(n,s){(function(i,t){n.exports=t()})(Hg,function(){return function i(t,e,r){var o=window,a="application/octet-stream",u=r||a,l=t,c=!e&&!r&&l,f=document.createElement("a"),h=function(O){return String(O)},d=o.Blob||o.MozBlob||o.WebKitBlob||h,g=e||"download",v,m;if(d=d.call?d.bind(o):Blob,String(this)==="true"&&(l=[l,u],u=l[0],l=l[1]),c&&c.length<2048&&(g=c.split("/").pop().split("?")[0],f.href=c,f.href.indexOf(c)!==-1)){var S=new XMLHttpRequest;return S.open("GET",c,!0),S.responseType="blob",S.onload=function(O){i(O.target.response,g,a)},setTimeout(function(){S.send()},0),S}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(l))if(l.length>1024*1024*1.999&&d!==h)l=I(l),u=l.type||a;else return navigator.msSaveBlob?navigator.msSaveBlob(I(l),g):j(l);else if(/([\x80-\xff])/.test(l)){var w=0,_=new Uint8Array(l.length),P=_.length;for(w;w<P;++w)_[w]=l.charCodeAt(w);l=new d([_],{type:u})}v=l instanceof d?l:new d([l],{type:u});function I(O){var Z=O.split(/[:;,]/),te=Z[1],F=Z[2]=="base64"?atob:decodeURIComponent,re=F(Z.pop()),E=re.length,b=0,C=new Uint8Array(E);for(b;b<E;++b)C[b]=re.charCodeAt(b);return new d([C],{type:te})}function j(O,Z){if("download"in f)return f.href=O,f.setAttribute("download",g),f.className="download-js-link",f.innerHTML="downloading...",f.style.display="none",document.body.appendChild(f),setTimeout(function(){f.click(),document.body.removeChild(f),Z===!0&&setTimeout(function(){o.URL.revokeObjectURL(f.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(O)&&(O="data:"+O.replace(/^data:([\w\/\-\+]+)/,a)),window.open(O)||confirm(`Displaying New Document

Use Save As... to download, then click back to return to this page.`)&&(location.href=O),!0;var te=document.createElement("iframe");document.body.appendChild(te),!Z&&/^data:/.test(O)&&(O="data:"+O.replace(/^data:([\w\/\-\+]+)/,a)),te.src=O,setTimeout(function(){document.body.removeChild(te)},333)}if(navigator.msSaveBlob)return navigator.msSaveBlob(v,g);if(o.URL)j(o.URL.createObjectURL(v),!0);else{if(typeof v=="string"||v.constructor===h)try{return j("data:"+u+";base64,"+o.btoa(v))}catch{return j("data:"+u+","+encodeURIComponent(v))}m=new FileReader,m.onload=function(O){j(this.result)},m.readAsDataURL(v)}return!0}})})(Uc);var bv=Uc.exports;const Ev=qr(bv);function Tv(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24">
  <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
    <g transform="translate(-488.000000, -340.000000)" fill="#FFFFFF">
      <g id="Group-2">
        <g id="volme_big-copy" transform="translate(488.000000, 340.000000)">
          <rect id="Rectangle-18" x="11" y="4" width="2" height="12" rx="1"></rect>
          <rect id="Rectangle-2" x="3" y="18" width="18" height="2" rx="1"></rect>
          <rect id="Rectangle-2" transform="translate(4.000000, 17.500000) rotate(90.000000) translate(-4.000000, -17.500000) " x="1.5" y="16.5" width="5" height="2" rx="1"></rect><rect id="Rectangle-2-Copy-3" transform="translate(20.000000, 17.500000) rotate(90.000000) translate(-20.000000, -17.500000) " x="17.5" y="16.5" width="5" height="2" rx="1"></rect>
          <path d="M9.48791171,8.26502656 L9.48791171,14.2650266 C9.48791171,14.8173113 9.04019646,15.2650266 8.48791171,15.2650266 C7.93562696,15.2650266 7.48791171,14.8173113 7.48791171,14.2650266 L7.48791171,7.26502656 C7.48791171,6.71274181 7.93562696,6.26502656 8.48791171,6.26502656 L15.4879117,6.26502656 C16.0401965,6.26502656 16.4879117,6.71274181 16.4879117,7.26502656 C16.4879117,7.81731131 16.0401965,8.26502656 15.4879117,8.26502656 L9.48791171,8.26502656 Z" id="Combined-Shape" transform="translate(11.987912, 10.765027) scale(1, -1) rotate(45.000000) translate(-11.987912, -10.765027) "></path>
        </g>
      </g>
    </g>
  </g>
</svg>
`,"image/svg+xml").firstChild}var Sv=function(n){de(i,n);var s=ge(i);function i(t){var e;return ae(this,i),e=s.call(this,t),D(R(e),"download",function(r){if(!e.isLock){e.emitUserAction(r,"download");var o=e.playerConfig.url,a="";p.typeOf(o)==="String"?a=o:p.typeOf(o)==="Array"&&o.length>0&&(a=o[0].src);var u=e.getAbsoluteURL(a);Ev(u),e.isLock=!0,e.timer=window.setTimeout(function(){e.isLock=!1,window.clearTimeout(e.timer),e.timer=null},300)}}),e.timer=null,e.isLock=!1,e}return ue(i,[{key:"afterCreate",value:function(){_e(ve(i.prototype),"afterCreate",this).call(this),!this.config.disable&&(this.appendChild(".xgplayer-icon",this.icons.download),this._handler=this.hook("click",this.download,{pre:function(r){r.preventDefault(),r.stopPropagation()}}),this.bind(["click","touchend"],this._handler))}},{key:"registerIcons",value:function(){return{download:Tv}}},{key:"getAbsoluteURL",value:function(e){if(!e.match(/^https?:\/\//)){var r=document.createElement("div");r.innerHTML='<a href="'.concat(e,'">x</a>'),e=r.firstChild.href}return e}},{key:"destroy",value:function(){_e(ve(i.prototype),"destroy",this).call(this),this.unbind(["click","touchend"],this.download),window.clearTimeout(this.timer),this.timer=null}},{key:"render",value:function(){if(!this.config.disable)return`<xg-icon class="xgplayer-download">
   <div class="xgplayer-icon">
   </div>
   `.concat(ki(this,"DOWNLOAD_TIPS",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"download"}},{key:"defaultConfig",get:function(){return{position:He.CONTROLS_RIGHT,index:3,disable:!0}}}]),i}(Gi),wv=function(n){de(i,n);var s=ge(i);function i(){return ae(this,i),s.apply(this,arguments)}return ue(i,[{key:"beforeCreate",value:function(e){typeof e.player.config.screenShot=="boolean"&&(e.config.disable=!e.player.config.screenShot)}},{key:"afterCreate",value:function(){_e(ve(i.prototype),"afterCreate",this).call(this),this.appendChild(".xgplayer-icon",this.icons.screenshotIcon);var e=this.config;this.initSize=function(r){e.fitVideo&&(e.width=r.vWidth,e.height=r.vHeight)},this.once(Ti,this.initSize)}},{key:"onPluginsReady",value:function(){this.show(),this.onClickBtn=this.onClickBtn.bind(this),this.bind(["click","touchend"],this.onClickBtn)}},{key:"saveScreenShot",value:function(e,r){var o=document.createElement("a");o.href=e,o.download=r;var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(a)}},{key:"createCanvas",value:function(e,r){var o=document.createElement("canvas"),a=o.getContext("2d");this.canvasCtx=a,this.canvas=o,o.width=e||this.config.width,o.height=r||this.config.height,a.imageSmoothingEnabled=!0,a.imageSmoothingEnabled&&(a.imageSmoothingQuality="high")}},{key:"onClickBtn",value:function(e){var r=this;e.preventDefault(),e.stopPropagation(),this.emitUserAction(e,"shot");var o=this.config;this.shot(o.width,o.height).then(function(a){r.emit(kc,a),o.saveImg&&r.saveScreenShot(a,o.name+o.format)})}},{key:"shot",value:function(e,r){var o=this,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{quality:.92,type:"image/png"},u=this.config,l=this.player,c=a.quality||u.quality,f=a.type||u.type;return new Promise(function(h,d){var g=null,v;if(l.media.canvas)g=l.media.canvas;else{o.canvas?(o.canvas.width=e||u.width,o.canvas.height=r||u.height):o.createCanvas(e,r),g=o.canvas,v=o.canvasCtx;var m=l.media.videoWidth/l.media.videoHeight,S=g.width/g.height,w=0,_=0,P=l.media.videoWidth,I=l.media.videoHeight,j,O,Z,te;m>S?(Z=g.width,te=g.width/m,j=0,O=Math.round((g.height-te)/2)):m===S?(Z=g.width,te=g.height,j=0,O=0):m<S&&(Z=g.height*m,te=g.height,j=Math.round((g.width-Z)/2),O=0),v.drawImage(l.media,w,_,P,I,j,O,Z,te)}var F=g.toDataURL(f,c).replace(f,"image/octet-stream");F=F.replace(/^data:image\/[^;]+/,"data:application/octet-stream"),h(F)})}},{key:"registerIcons",value:function(){return{screenshotIcon:null}}},{key:"destroy",value:function(){_e(ve(i.prototype),"destroy",this).call(this),this.unbind(["click","touchend"],this.onClickBtn),this.off(Ti,this.initSize)}},{key:"render",value:function(){if(!this.config.disable){var e=this.icons.screenshotIcon?"xgplayer-icon":"xgplayer-icon btn-text",r="SCREENSHOT";return`
      <xg-icon class="xgplayer-shot">
      <div class="`.concat(e,`">
      `).concat(this.icons.screenshotIcon?"":'<span lang-key="'.concat(this.i18nKeys[r],'">').concat(this.i18n[r],"</span>"),`
      </div>
    </xg-icon>`)}}}],[{key:"pluginName",get:function(){return"screenShot"}},{key:"defaultConfig",get:function(){return{position:He.CONTROLS_RIGHT,index:5,quality:.92,type:"image/png",format:".png",width:600,height:337,saveImg:!0,fitVideo:!0,disable:!1,name:"screenshot"}}}]),i}(Gi),Cv=function(){function n(s){ae(this,n),this.config=s.config,this.parent=s.root,this.root=p.createDom("ul","",{},"xg-options-list xg-list-slide-scroll ".concat(this.config.className)),s.root.appendChild(this.root);var i=this.config.maxHeight;i&&this.setStyle({maxHeight:i}),this.onItemClick=this.onItemClick.bind(this),this.renderItemList();var t=Te.device==="mobile"?"touchend":"click";this._delegates=Ie.delegate.call(this,this.root,"li",t,this.onItemClick)}return ue(n,[{key:"renderItemList",value:function(i){var t=this,e=this.config,r=this.root;i?e.data=i:i=e.data,e.style&&Object.keys(e.style).map(function(o){r.style[o]=e[o]}),i.length>0&&(this.attrKeys=Object.keys(i[0])),this.root.innerHTML="",i.map(function(o,a){var u=o.selected?"option-item selected":"option-item";o["data-index"]=a,t.root.appendChild(p.createDom("li","<span>".concat(o.showText,"</span>"),o,u))})}},{key:"onItemClick",value:function(i){i.delegateTarget||(i.delegateTarget=i.target);var t=i.delegateTarget;if(t&&p.hasClass(t,"selected"))return!1;var e=typeof this.config.onItemClick=="function"?this.config.onItemClick:null,r=this.root.querySelector(".selected");p.addClass(t,"selected"),r&&p.removeClass(r,"selected"),e(i,{from:r?this.getAttrObj(r,this.attrKeys):null,to:this.getAttrObj(t,this.attrKeys)})}},{key:"getAttrObj",value:function(i,t){if(!i||!t)return{};var e={};t.map(function(o){e[o]=i.getAttribute(o)});var r=i.getAttribute("data-index");return r&&(e.index=Number(r)),e}},{key:"show",value:function(){p.removeClass(this.root,"hide"),p.addClass(this.root,"active")}},{key:"hide",value:function(){p.removeClass(this.root,"active"),p.addClass(this.root,"hide")}},{key:"setStyle",value:function(i){var t=this;Object.keys(i).forEach(function(e){t.root.style[e]=i[e]})}},{key:"destroy",value:function(){this._delegates&&(this._delegates.map(function(i){i.destroy&&i.destroy()}),this._delegates=null),this.root.innerHTML=null,this.parent.removeChild(this.root),this.root=null}}]),n}(),Bt={SIDE:"side",MIDDLE:"middle"},Xi={CLICK:"click",HOVER:"hover"};function kv(n,s){return n===Bt.SIDE?s===He.CONTROLS_LEFT?"xg-side-list xg-left-side":"xg-side-list xg-right-side":""}var sr=Te.device==="mobile",Dr=function(n){de(i,n);var s=ge(i);function i(t){var e;return ae(this,i),e=s.call(this,t),D(R(e),"onEnter",function(r){r.stopPropagation(),e.emit("icon_mouseenter",{pluginName:e.pluginName}),e.switchActiveState(r)}),D(R(e),"switchActiveState",function(r){r.stopPropagation();var o=e.config.toggleMode;o===Xi.CLICK?e.toggle(!e.isActive):e.toggle(!0)}),D(R(e),"onLeave",function(r){r.stopPropagation(),e.emit("icon_mouseleave",{pluginName:e.pluginName}),e.config.listType!==Bt.SIDE&&e.isActive&&e.toggle(!1)}),D(R(e),"onListEnter",function(r){e.enterType=2}),D(R(e),"onListLeave",function(r){e.enterType=0,e.isActive&&e.toggle(!1)}),e.isIcons=!1,e.isActive=!1,e.curValue=null,e.curIndex=0,e}return ue(i,[{key:"updateLang",value:function(e){this.renderItemList(this.config.list,this.curIndex)}},{key:"afterCreate",value:function(){var e=this,r=this.config;this.initIcons(),sr&&r.listType!==Bt.MIDDLE&&(r.listType=Bt.SIDE),r.hidePortrait&&p.addClass(this.root,"portrait"),this.on([Ti,Zt],function(){e._resizeList()}),this.once(ni,function(){r.list&&r.list.length>0&&(e.renderItemList(r.list),e.show())}),sr&&this.on(Do,function(){e.isActive&&(e.optionsList&&e.optionsList.hide(),e.isActive=!1)}),sr?(r.toggleMode=Xi.CLICK,this.activeEvent="touchend"):this.activeEvent=r.toggleMode===Xi.CLICK?"click":"mouseenter",r.toggleMode===Xi.CLICK?this.bind(this.activeEvent,this.switchActiveState):(this.bind(this.activeEvent,this.onEnter),this.bind("mouseleave",this.onLeave)),this.isIcons&&this.bind("click",this.onIconClick)}},{key:"initIcons",value:function(){var e=this,r=this.icons,o=Object.keys(r),a=!1;o.length>0&&(o.forEach(function(u){e.appendChild(".xgplayer-icon",r[u]),!a&&(a=r[u])}),this.isIcons=a),!a&&(this.appendChild(".xgplayer-icon",p.createDom("span","",{},"icon-text")),p.addClass(this.find(".xgplayer-icon"),"btn-text"))}},{key:"show",value:function(e){!this.config.list||this.config.list.length<2||p.addClass(this.root,"show")}},{key:"hide",value:function(){p.removeClass(this.root,"show")}},{key:"getTextByLang",value:function(e,r,o){if(e===void 0)return"";var a=this.config.list;!o&&(o=this.player.lang),r=!r||p.isUndefined(e[r])?"text":r,typeof e=="number"&&(e=a[e]);try{return ot(e[r])==="object"?e[r][o]||e[r].en:e[r]}catch(u){return console.warn(u),""}}},{key:"toggle",value:function(e){if(e!==this.isActive){var r=this.player.controls,o=this.config.listType;e?(o===Bt.SIDE?r.blur():r.focus(),this.optionsList&&this.optionsList.show()):(o===Bt.SIDE?r.focus():r.focusAwhile(),this.optionsList&&this.optionsList.hide()),this.isActive=e}}},{key:"onItemClick",value:function(e,r){e.stopPropagation();var o=this.config,a=o.listType,u=o.list;this.curIndex=r.to.index,this.curItem=u[this.curIndex],this.changeCurrentText();var l=this.config.isItemClickHide;(l||sr||a===Bt.SIDE)&&this.toggle(!1)}},{key:"onIconClick",value:function(e){}},{key:"changeCurrentText",value:function(){if(!this.isIcons){var e=this.config.list,r=this.curIndex<e.length?this.curIndex:0,o=e[r];o&&(this.find(".icon-text").innerHTML=this.getTextByLang(o,"iconText"))}}},{key:"renderItemList",value:function(e,r){var o=this,a=this.config,u=this.optionsList,l=this.player;if(typeof r=="number"&&(this.curIndex=r,this.curItem=a.list[r]),u){u.renderItemList(e),this.changeCurrentText();return}var c={config:{data:e||[],className:kv(a.listType,a.position),onItemClick:function(v,m){o.onItemClick(v,m)}},root:a.listType===Bt.SIDE?l.innerContainer||l.root:this.root};if(this.config.isShowIcon){var f=this.player.root.getBoundingClientRect(),h=f.height,d=a.listType===Bt.MIDDLE?h-50:h;d&&a.heightLimit&&(c.config.maxHeight="".concat(d,"px")),this.optionsList=new Cv(c),this.changeCurrentText(),this.show()}this._resizeList()}},{key:"_resizeList",value:function(){if(this.config.heightLimit){var e=this.player.root.getBoundingClientRect(),r=e.height,o=this.config.listType===Bt.MIDDLE?r-50:r;this.optionsList&&this.optionsList.setStyle({maxHeight:"".concat(o,"px")})}}},{key:"destroy",value:function(){var e=this.config;e.toggleMode===Xi.CLICK?this.unbind(this.activeEvent,this.switchActiveState):(this.unbind(this.activeEvent,this.onEnter),this.unbind("mouseleave",this.onLeave)),this.isIcons&&this.unbind("click",this.onIconClick),this.optionsList&&(this.optionsList.destroy(),this.optionsList=null)}},{key:"render",value:function(){if(this.config.isShowIcon)return'<xg-icon class="xg-options-icon '.concat(this.config.className||"",`">
    <div class="xgplayer-icon">
    </div>
   </xg-icon>`)}}],[{key:"pluginName",get:function(){return"optionsIcon"}},{key:"defaultConfig",get:function(){return{position:He.CONTROLS_RIGHT,index:100,list:[],listType:"middle",listStyle:{},hidePortrait:!0,isShowIcon:!1,isItemClickHide:!0,toggleMode:Xi.HOVER,heightLimit:!0}}}]),i}(Ie),Pv=function(n){de(i,n);var s=ge(i);function i(t){var e;return ae(this,i),e=s.call(this,t),e.curTime=0,e.isPaused=!0,e}return ue(i,[{key:"beforeCreate",value:function(e){var r=e.config.list;Array.isArray(r)&&r.length>0&&(e.config.list=r.map(function(o){return!o.text&&o.name&&(o.text=o.name),o.text||(o.text=o.definition),o}))}},{key:"afterCreate",value:function(){var e=this;_e(ve(i.prototype),"afterCreate",this).call(this),this.on("resourceReady",function(r){e.changeDefinitionList(r)}),this.on(Jr,function(r){e.renderItemList(e.config.list,r.to)}),this.player.definitionList.length<2&&this.hide()}},{key:"show",value:function(e){!this.config.list||this.config.list.length<2||p.addClass(this.root,"show")}},{key:"initDefinition",value:function(){var e=this.config,r=e.list,o=e.defaultDefinition;if(r.length>0){var a=null;r.map(function(u){u.definition===o&&(a=u)}),a||(a=r[0]),this.changeDefinition(a)}}},{key:"renderItemList",value:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.list||[],o=arguments.length>1?arguments[1]:void 0,a=o&&o.definition?o.definition:this.config.defaultDefinition;o&&r.forEach(function(c){c.selected=!1});var u=0,l=r.map(function(c,f){var h=ze(ze({},c),{},{showText:e.getTextByLang(c)||c.definition,selected:!1});return(c.selected||c.definition&&c.definition==a)&&(h.selected=!0,u=f),h});_e(ve(i.prototype),"renderItemList",this).call(this,l,u)}},{key:"changeDefinitionList",value:function(e){Array.isArray(e)&&(this.config.list=e.map(function(r){return!r.text&&r.name&&(r.text=r.name),r.text||(r.text=r.definition),r}),this.renderItemList(),this.config.list.length<2?this.hide():this.show())}},{key:"changeDefinition",value:function(e,r){this.player.changeDefinition(e,r)}},{key:"onItemClick",value:function(e,r){var o=this.player.definitionList;_e(ve(i.prototype),"onItemClick",this).apply(this,arguments),this.emitUserAction(e,"change_definition",{from:r.from,to:r.to});for(var a=0;a<o.length;a++)r.to&&o[a].definition===r.to.definition&&(r.to.url=o[a].url),r.from&&o[a].definition===r.from.definition&&(r.from.url=o[a].url);this.player.changeDefinition(r.to,r.from)}}],[{key:"pluginName",get:function(){return"definition"}},{key:"defaultConfig",get:function(){return ze(ze({},Dr.defaultConfig),{},{position:He.CONTROLS_RIGHT,index:3,list:[],defaultDefinition:"",disable:!1,hidePortrait:!1,className:"xgplayer-definition",isShowIcon:!0})}}]),i}(Dr),xv=function(n){de(i,n);var s=ge(i);function i(t){var e;return ae(this,i),e=s.call(this,t),e.curRate=1,e}return ue(i,[{key:"beforeCreate",value:function(e){var r=e.player.config.playbackRate,o=r?Array.isArray(r)?r:e.config.list:[];Array.isArray(o)&&(e.config.list=o.map(function(a){return typeof a=="number"?a={rate:a,text:"".concat(a,"x")}:!a.text&&a.rate&&(a.text="".concat(a.rate,"x")),a}))}},{key:"afterCreate",value:function(){var e=this;_e(ve(i.prototype),"afterCreate",this).call(this),this.on(yc,function(){e.curValue!==e.player.playbackRate&&e.renderItemList()}),this.renderItemList()}},{key:"show",value:function(e){!this.config.list||this.config.list.length===0||_e(ve(i.prototype),"show",this).call(this)}},{key:"onItemClick",value:function(e,r){_e(ve(i.prototype),"onItemClick",this).call(this,e,r);var o=e.delegateTarget,a=Number(o.getAttribute("rate"));if(!a||a===this.curValue)return!1;var u={playbackRate:{from:this.player.playbackRate,to:a}};this.emitUserAction(e,"change_rate",{props:u}),this.curValue=a,this.player.playbackRate=a}},{key:"renderItemList",value:function(){var e=this,r=this.player.playbackRate||1;this.curValue=r;var o=-1,a=this.config.list.map(function(u,l){var c={rate:u.rate};return c.rate===r&&(c.selected=!0,o=l),c.showText=e.getTextByLang(u),c});_e(ve(i.prototype),"renderItemList",this).call(this,a,o)}},{key:"changeCurrentText",value:function(){if(!this.isIcons){var e=this.config.list,r=this.curIndex<e.length?this.curIndex:0,o=e[r],a="";!o||this.curIndex<0?a="".concat(this.player.playbackRate,"x"):a=this.getTextByLang(o,"iconText"),this.find(".icon-text").innerHTML=a}}},{key:"destroy",value:function(){_e(ve(i.prototype),"destroy",this).call(this)}}],[{key:"pluginName",get:function(){return"playbackRate"}},{key:"defaultConfig",get:function(){return ze(ze({},Dr.defaultConfig),{},{position:He.CONTROLS_RIGHT,index:4,list:[2,1.5,1,.75,.5],className:"xgplayer-playbackrate",isShowIcon:!0,hidePortrait:!1})}}]),i}(Dr);function Rv(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="31" height="40" viewBox="0 -5 31 40">
  <path fill="#fff" transform="scale(1.3, 1.3)" class='path_full' d="M9,10v1a.9.9,0,0,1-1,1,.9.9,0,0,1-1-1V9A.9.9,0,0,1,8,8h2a.9.9,0,0,1,1,1,.9.9,0,0,1-1,1Zm6,4V13a1,1,0,0,1,2,0v2a.9.9,0,0,1-1,1H14a1,1,0,0,1,0-2Zm3-7H6V17H18Zm2,0V17a2,2,0,0,1-2,2H6a2,2,0,0,1-2-2V7A2,2,0,0,1,6,5H18A2,2,0,0,1,20,7Z"></path>
</svg>
`,"image/svg+xml").firstChild}function Iv(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="31" height="40" viewBox="0 -5 31 40">
  <path fill="#fff" transform="scale(1.3, 1.3)" d="M9,10V9a.9.9,0,0,1,1-1,.9.9,0,0,1,1,1v2a.9.9,0,0,1-1,1H8a.9.9,0,0,1-1-1,.9.9,0,0,1,1-1Zm6,4v1a1,1,0,0,1-2,0V13a.9.9,0,0,1,1-1h2a1,1,0,0,1,0,2Zm3-7H6V17H18Zm2,0V17a2,2,0,0,1-2,2H6a2,2,0,0,1-2-2V7A2,2,0,0,1,6,5H18A2,2,0,0,1,20,7Z"></path>
</svg>
`,"image/svg+xml").firstChild}var pu=function(n){de(i,n);var s=ge(i);function i(){return ae(this,i),s.apply(this,arguments)}return ue(i,[{key:"beforeCreate",value:function(e){typeof e.player.config.cssFullscreen=="boolean"&&(e.config.disable=!e.player.config.cssFullscreen)}},{key:"afterCreate",value:function(){var e=this;_e(ve(i.prototype),"afterCreate",this).call(this),!this.config.disable&&(this.config.target&&(this.playerConfig.fullscreenTarget=this.config.target),this.initIcons(),this.on(kr,function(r){e.animate(r)}),this.btnClick=this.btnClick.bind(this),this.handleCssFullscreen=this.hook("cssFullscreen_change",this.btnClick,{pre:function(o){o.preventDefault(),o.stopPropagation()}}),this.bind(["click","touchend"],this.handleCssFullscreen))}},{key:"initIcons",value:function(){var e=this.icons,r=this.find(".xgplayer-icon");r.appendChild(e.cssFullscreen),r.appendChild(e.exitCssFullscreen)}},{key:"btnClick",value:function(e){e.preventDefault(),e.stopPropagation();var r=this.player.isCssfullScreen;this.emitUserAction(e,"switch_cssfullscreen",{cssfullscreen:r}),r?this.player.exitCssFullscreen():this.player.getCssFullscreen()}},{key:"animate",value:function(e){this.root&&(e?this.setAttr("data-state","full"):this.setAttr("data-state","normal"),this.switchTips(e))}},{key:"switchTips",value:function(e){var r=this.i18nKeys,o=this.find(".xg-tips");o&&this.changeLangTextKey(o,e?r.EXITCSSFULLSCREEN_TIPS:r.CSSFULLSCREEN_TIPS)}},{key:"registerIcons",value:function(){return{cssFullscreen:{icon:Rv,class:"xg-get-cssfull"},exitCssFullscreen:{icon:Iv,class:"xg-exit-cssfull"}}}},{key:"destroy",value:function(){_e(ve(i.prototype),"destroy",this).call(this),this.unbind(["click","touchend"],this.btnClick)}},{key:"render",value:function(){if(!this.config.disable)return`<xg-icon class='xgplayer-cssfullscreen'>
    <div class="xgplayer-icon">
    </div>
    `.concat(ki(this,"CSSFULLSCREEN_TIPS",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"cssFullscreen"}},{key:"defaultConfig",get:function(){return{position:He.CONTROLS_RIGHT,index:1,disable:!1,target:null}}}]),i}(Gi),Av=function(n){de(i,n);var s=ge(i);function i(){return ae(this,i),s.apply(this,arguments)}return ue(i,[{key:"afterCreate",value:function(){var e=this;this.clickHandler=this.hook("errorRetry",this.errorRetry,{pre:function(o){o.preventDefault(),o.stopPropagation()}}),this.onError=this.hook("showError",this.handleError),this.bind(".xgplayer-error-refresh","click",this.clickHandler),this.on(Jn,function(r){e.onError(r)})}},{key:"errorRetry",value:function(e){this.emitUserAction(e,"error_retry",{}),this.player.retry()}},{key:"handleError",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=this.player,o=e.errorType,a=r.errorNote?this.i18n[r.errorNote]:"";if(!a)switch(o){case"decoder":a=this.i18n.MEDIA_ERR_DECODE;break;case"network":a=this.i18n.MEDIA_ERR_NETWORK;break;default:a=this.i18n.MEDIA_ERR_SRC_NOT_SUPPORTED}this.find(".xgplayer-error-text").innerHTML=a,this.find(".xgplayer-error-tips").innerHTML="".concat(this.i18n.REFRESH_TIPS,'<span class="xgplayer-error-refresh">').concat(this.i18n.REFRESH,"</span>")}},{key:"destroy",value:function(){this.unbind(".xgplayer-error-refresh","click",this.clickHandler)}},{key:"render",value:function(){return`<xg-error class="xgplayer-error">
      <div class="xgplayer-errornote">
       <span class="xgplayer-error-text"></span>
       <span class="xgplayer-error-tips"><em class="xgplayer-error-refresh"></em></span>
      </div>
    </xg-error>`}}],[{key:"pluginName",get:function(){return"error"}}]),i}(Ie),Lv=function(n){de(i,n);var s=ge(i);function i(){return ae(this,i),s.apply(this,arguments)}return ue(i,[{key:"afterCreate",value:function(){var e=this;this.intervalId=0,this.customConfig=null,this.bind(".highlight",["click","touchend"],function(r){(e.config.onClick||e.customOnClick)&&(r.preventDefault(),r.stopPropagation(),e.customOnClick?e.customOnClick(r):e.config.onClick(r))}),this.player.showPrompt=function(){e.showPrompt.apply(e,arguments)},this.player.hidePrompt=function(){e.hide()}}},{key:"setStyle",value:function(e){var r=this;Object.keys(e).map(function(o){r.root.style[o]=e[o]})}},{key:"showPrompt",value:function(e){var r=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){};if(e){this.customOnClick=a;var u=this.config.interval;this.intervalId&&(clearTimeout(this.intervalId),this.intervalId=null),p.addClass(this.root,"show"),o.mode==="arrow"&&p.addClass(this.root,"arrow"),typeof e=="string"?this.find(".xgplayer-prompt-detail").innerHTML=e:this.find(".xgplayer-prompt-detail").innerHTML="".concat(e.text||"")+"".concat(e.highlight?'<i class="highlight">'.concat(e.highlight,"</i>"):""),o.style&&this.setStyle(o.style);var l=typeof o.autoHide=="boolean"?o.autoHide:this.config.autoHide;if(l){var c=o.interval||u;this.intervalId=setTimeout(function(){r.hide()},c)}}}},{key:"hide",value:function(){p.removeClass(this.root,"show"),p.removeClass(this.root,"arrow"),this.root.removeAttribute("style"),this.customOnClick=null}},{key:"render",value:function(){return'<xg-prompt class="xgplayer-prompt '.concat(z.CONTROLS_FOLLOW,`">
    <span class="xgplayer-prompt-detail"></span>
    </xg-prompt>`)}}],[{key:"pluginName",get:function(){return"prompt"}},{key:"defaultConfig",get:function(){return{interval:3e3,style:{},mode:"arrow",autoHide:!0,detail:{text:"",highlight:""},onClick:function(){}}}}]),i}(Ie),vu={time:0,text:"",id:1,duration:1,color:"#fff",style:{},width:6,height:6};function Hc(n){Object.keys(vu).map(function(s){n[s]===void 0&&(n[s]=vu[s])})}var mu={_updateDotDom:function(s,i){if(i){var t=this.calcuPosition(s.time,s.duration),e=s.style||{};e.left="".concat(t.left,"%"),e.width="".concat(t.width,"%"),i.setAttribute("data-text",s.text),i.setAttribute("data-time",s.time),t.isMini?p.addClass(i,"mini"):p.removeClass(i,"mini"),Object.keys(e).map(function(r){i.style[r]=e[r]})}},initDots:function(){var s=this;this._ispots.map(function(i){s.createDot(i,!1)}),this.ispotsInit=!0},createDot:function(s){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=this.player.plugins.progress;if(t&&(i&&(Hc(s),this._ispots.push(s)),!(!this.ispotsInit&&i))){var e=this.calcuPosition(s.time,s.duration),r=s.style||{};r.left="".concat(e.left,"%"),r.width="".concat(e.width,"%");var o="xgspot_".concat(s.id," xgplayer-spot");e.isMini&&(o+=" mini");var a=s.template?'<div class="xgplayer-spot-pop">'.concat(s.template,"</div>"):"",u=p.createDom("xg-spot",a,{"data-text":s.text,"data-time":s.time,"data-id":s.id},o);Object.keys(r).map(function(l){u.style[l]=r[l]}),t.outer&&t.outer.appendChild(u),this.positionDot(u,s.id)}},findDot:function(s){if(this.player.plugins.progress){var i=this._ispots.filter(function(t,e){return t.id===s});return i.length>0?i[0]:null}},updateDot:function(s){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=this.player.plugins.progress;if(t){var e=this.findDot(s.id);if(e&&Object.keys(s).map(function(o){e[o]=s[o]}),!!this.ispotsInit){var r=t.find('xg-spot[data-id="'.concat(s.id,'"]'));r&&(this._updateDotDom(s,r),i&&this.showDot(s.id))}}},deleteDot:function(s){var i=this._ispots,t=this.player.plugins.progress;if(t){for(var e=[],r=0;r<i.length;r++)i[r].id===s&&e.push(r);for(var o=e.length,a=o-1;a>=0;a--)if(i.splice(e[a],1),this.ispotsInit){var u=t.find('xg-spot[data-id="'.concat(s,'"]'));u&&u.parentElement.removeChild(u)}}},deleteAllDots:function(){var s=this.player.plugins.progress;if(s){if(!this.ispotsInit){this._ispots=[];return}for(var i=s.root.getElementsByTagName("xg-spot"),t=i.length-1;t>=0;t--)s.outer.removeChild(i[t]);this._ispots=[]}},updateAllDots:function(){var s=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=this.player.plugins.progress;if(t){if(!this.ispotsInit){this._ispots=i;return}this._ispots=[];var e=t.root.getElementsByTagName("xg-spot"),r=e.length;if(r>i.length)for(var o=r-1;o>i.length-1;o--)t.outer.removeChild(e[o]);i.forEach(function(a,u){u<r?(e[u].setAttribute("data-id","".concat(a.id)),s._ispots.push(a),s.updateDot(a)):s.createDot(a)})}},positionDots:function(){var s=this,i=this._ispots,t=this.playerSize,e=this.player.sizeInfo,r=this.player.plugins.progress;!r||e.width===t.width||(t.width=e.width,t.left=e.left,i.forEach(function(o){var a=r.find('xg-spot[data-id="'.concat(o.id,'"]'));a&&s.positionDot(a,o.id)}))},positionDot:function(s,i){var t=p.findDom(s,".xgplayer-spot-pop");if(t){var e=this.playerSize,r=s.getBoundingClientRect(),o=t.getBoundingClientRect(),a=r.left-e.left,u=e.width-a-r.width/2;if(a<o.width/2||e.width<o.width){var l=o.width/2-a;t.style.left="".concat(l,"px")}else if(u<o.width/2){var c=u-o.width/2+r.width/2;t.style.left="".concat(c,"px")}else t.style.left="50%"}},updateDuration:function(){var s=this,i=this.player.plugins.progress;if(i){var t=this._ispots;t.forEach(function(e){var r=i.find('xg-spot[data-id="'.concat(e.id,'"]'));s._updateDotDom(e,r)})}},getAllDotsDom:function(){var s=this.player.plugins.progress;if(!s)return[];var i=s.root.getElementsByTagName("xg-spot");return i},getDotDom:function(s){var i=this.player.plugins.progress;if(i)return i.find('xg-spot[data-id="'.concat(s,'"]'))}};function Ov(n){var s=n.config,i=n.player;Object.keys(mu).map(function(e){n[e]=mu[e].bind(n)});var t=i.config.progressDot||s.ispots||[];n._ispots=t.map(function(e){return Hc(e),e}),n.ispotsInit=!1,n.playerSize={left:i.sizeInfo.left,width:i.sizeInfo.width},n.on(Ci,function(){n.ispotsInit?n.updateDuration():n.initDots()}),n.on(Ti,function(){n.positionDots()})}var Ji={dragmove:"onProgressMove",dragstart:"onProgressDragStart",dragend:"onProgressDragEnd",click:"onProgressClick",mouseover:"onProgressMouseOver",mouseenter:"onProgressMouseOver"},Dv=function(n){de(i,n);var s=ge(i);function i(t){var e;return ae(this,i),e=s.call(this,t),D(R(e),"onMousemove",function(r){if(!e.config.disable){if(p.hasClass(r.target,"xg-spot-content")&&e.config.isHideThumbnailHover){e.player.plugins.progress.onMouseLeave(r);return}(e._state.f||p.hasClass(r.target,"xg-spot-content"))&&(p.event(r),r.stopPropagation())}}),D(R(e),"onMousedown",function(r){e.config.disable||(e._state.f||p.hasClass(r.target,"xg-spot-content"))&&(p.event(r),r.stopPropagation())}),D(R(e),"onMouseup",function(r){if(e.isDrag){var o=e.player.plugins.progress;o&&o.pos&&(o.onMouseUp(r),!o.pos.isEnter&&o.onMouseLeave(r))}}),D(R(e),"onDotMouseLeave",function(r){if(!e.config.disable){e._curDot.removeEventListener("mouseleave",e.onDotMouseLeave),e.blurDot(r.target),e._curDot=null;var o=e.player.plugins.progress;o&&o.enableBlur(),e.show()}}),D(R(e),"onProgressMouseOver",function(r,o){if(!e.config.disable&&p.hasClass(o.target,"xgplayer-spot")&&!e._curDot){e._curDot=o.target,e.focusDot(o.target),e._curDot.children.length>0&&e.hide();var a=e.player.plugins.progress;a&&a.disableBlur(),e._curDot.addEventListener("mouseleave",e.onDotMouseLeave)}}),e._ispots=[],e.videoPreview=null,e.videothumbnail=null,e.thumbnail=null,e.timeStr="",e._state={now:0,f:!1},e}return ue(i,[{key:"beforeCreate",value:function(e){var r=e.player.plugins.progress;r&&(e.root=r.root)}},{key:"afterCreate",value:function(){var e=this;this._curDot=null,this.handlerSpotClick=this.hook("spotClick",function(r,o){o.seekTime&&e.player.seek(o.seekTime)}),this.transformTimeHook=this.hook("transformTime",function(r){e.setTimeContent(p.format(r))}),Ov(this),this.on(Ci,function(){e.show()}),this.config.disable&&this.disable(),this.extTextRoot=this.find(".xg-spot-ext-text")}},{key:"setConfig",value:function(e){var r=this;e&&Object.keys(e).map(function(o){r.config[o]=e[o]})}},{key:"onPluginsReady",value:function(){var e=this.player;e.plugins.progress&&(this.previewLine=this.find(".xg-spot-line"),this.timePoint=this.find(".xgplayer-progress-point"),this.timeText=this.find(".xg-spot-time"),this.tipText=this.find(".spot-inner-text"),this._hasThumnail=!1,this.registerThumbnail(),this.bindEvents())}},{key:"bindEvents",value:function(){var e=this,r=this.player.plugins.progress;if(r&&(Object.keys(Ji).map(function(a){e[Ji[a]]=e[Ji[a]].bind(e),r.addCallBack(a,e[Ji[a]])}),Te.device!=="mobile")){this.bind(".xg-spot-info","mousemove",this.onMousemove),this.bind(".xg-spot-info","mousedown",this.onMousedown),this.bind(".xg-spot-info","mouseup",this.onMouseup);var o=this.hook("previewClick",function(){});this.handlerPreviewClick=function(a){a.stopPropagation(),o(parseInt(e._state.now*1e3,10)/1e3,a)},this.bind(".xg-spot-content","mouseup",this.handlerPreviewClick)}}},{key:"onProgressMove",value:function(e,r){this.config.disable||!this.player.duration||this.updatePosition(e.offset,e.width,e.currentTime,e.e)}},{key:"onProgressDragStart",value:function(e){this.config.disable||!this.player.duration||(this.isDrag=!0,this.videoPreview&&p.addClass(this.videoPreview,"show"))}},{key:"onProgressDragEnd",value:function(e){this.config.disable||!this.player.duration||(this.isDrag=!1,this.videoPreview&&p.removeClass(this.videoPreview,"show"))}},{key:"onProgressClick",value:function(e,r){this.config.disable||p.hasClass(r.target,"xgplayer-spot")&&(r.stopPropagation(),r.preventDefault(),["time","id","text"].map(function(o){e[o]=r.target.getAttribute("data-".concat(o))}),e.time&&(e.time=Number(e.time)),this.handlerSpotClick(r,e))}},{key:"updateLinePos",value:function(e,r){var o=this.root,a=this.previewLine,u=this.player,l=this.config,c=u.controls.mode,f=c==="flex",h=o.getBoundingClientRect().width;if(!(!h&&this._hasThumnail)){h=this._hasThumnail&&h<l.width?l.width:h;var d=e-h/2,g;d<0&&!f?(d=0,g=e-h/2):d>r-h&&!f?(g=d-(r-h),d=r-h):g=0,g!==void 0&&(a.style.transform="translateX(".concat(g.toFixed(2),"px)")),o.style.transform="translateX(".concat(d.toFixed(2),"px) translateZ(0)")}}},{key:"updateTimeText",value:function(e){var r=this.timeText,o=this.timePoint;r.innerHTML=e,!this.thumbnail&&(o.innerHTML=e)}},{key:"updatePosition",value:function(e,r,o,a){var u=this.root,l=this.config,c=this._state;if(u){c.now=o,this.transformTimeHook(o);var f=this.timeStr;a&&a.target&&p.hasClass(a.target,"xgplayer-spot")?(this.showTips(a.target.getAttribute("data-text"),!1,f),this.focusDot(a.target),c.f=!0,l.isFocusDots&&c.f&&(c.now=parseInt(a.target.getAttribute("data-time"),10))):l.defaultText?(c.f=!1,this.showTips(l.defaultText,!0,f)):(c.f=!1,this.hideTips("")),this.updateTimeText(f),this.updateThumbnails(c.now),this.updateLinePos(e,r)}}},{key:"setTimeContent",value:function(e){this.timeStr=e}},{key:"updateThumbnails",value:function(e){var r=this.player,o=this.videoPreview,a=this.config,u=r.plugins.thumbnail;if(u&&u.usable){this.thumbnail&&u.update(this.thumbnail,e,a.width,a.height);var l=o&&o.getBoundingClientRect();this.videothumbnail&&u.update(this.videothumbnail,e,l.width,l.height)}}},{key:"registerThumbnail",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Te.device!=="mobile"){var r=this.player,o=this.config,a=r.getPlugin("thumbnail");if(a&&a.setConfig(e),!a||!a.usable||!o.isShowThumbnail){p.addClass(this.root,"short-line no-thumbnail");return}else p.removeClass(this.root,"short-line no-thumbnail");o.mode==="short"&&p.addClass(this.root,"short-line"),this._hasThumnail=!0;var u=this.find(".xg-spot-thumbnail");this.thumbnail=a.createThumbnail(u,"progress-thumbnail"),o.isShowCoverPreview&&(this.videoPreview=p.createDom("xg-video-preview","",{},"xgvideo-preview"),r.root.appendChild(this.videoPreview),this.videothumbnail=a.createThumbnail(this.videoPreview,"xgvideo-thumbnail")),this.updateThumbnails(0)}}},{key:"calcuPosition",value:function(e,r){var o=this.player.plugins.progress,a=this.player,u=o.root.getBoundingClientRect().width,l=a.duration/u*6;return e+r>a.duration&&(r=a.duration-e),e/a.duration*100,r/a.duration,{left:e/a.duration*100,width:r/a.duration*100,isMini:r<l}}},{key:"showDot",value:function(e){var r=this.findDot(e);if(r){var o=this.root.getBoundingClientRect(),a=o.width,u=r.time/this.player.duration*a;this.updatePosition(u,a,r.time)}}},{key:"focusDot",value:function(e,r){e&&(r||(r=e.getAttribute("data-id")),p.addClass(e,"active"),this._activeDotId=r)}},{key:"blurDot",value:function(e){if(!e){var r=this._activeDotId;e=this.getDotDom(r)}e&&(p.removeClass(e,"active"),this._activeDotId=null)}},{key:"showTips",value:function(e,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";p.addClass(this.root,"no-timepoint"),e&&(p.addClass(this.find(".xg-spot-content"),"show-text"),r&&this.config.mode==="production"?(p.addClass(this.root,"product"),this.tipText.textContent=e):(p.removeClass(this.root,"product"),this.tipText.textContent=this._hasThumnail?e:"".concat(o," ").concat(e)))}},{key:"hideTips",value:function(){p.removeClass(this.root,"no-timepoint"),this.tipText.textContent="",p.removeClass(this.find(".xg-spot-content"),"show-text"),p.removeClass(this.root,"product")}},{key:"hide",value:function(){p.addClass(this.root,"hide")}},{key:"show",value:function(e){p.removeClass(this.root,"hide")}},{key:"enable",value:function(){var e=this.config,r=this.playerConfig;this.config.disable=!1,this.show(),!this.thumbnail&&e.isShowThumbnail&&this.registerThumbnail(r.thumbnail||{})}},{key:"disable",value:function(){this.config.disable=!0,this.hide()}},{key:"destroy",value:function(){var e=this,r=this.player.plugins.progress;r&&Object.keys(Ji).map(function(o){r.removeCallBack(o,e[Ji[o]])}),this.videothumbnail=null,this.thumbnail=null,this.videoPreview&&this.player.root.removeChild(this.videoPreview),this.unbind(".xg-spot-info","mousemove",this.onMousemove),this.unbind(".xg-spot-info","mousedown",this.onMousedown),this.unbind(".xg-spot-info","mouseup",this.onMouseup),this.unbind(".xg-spot-content","mouseup",this.handlerPreviewClick)}},{key:"render",value:function(){return Te.device==="mobile"||this.playerConfig.isMobileSimulateMode==="mobile"?"":'<div class="xg-spot-info hide '.concat(this.config.mode==="short"?"short-line":"",`">
      <div class="xg-spot-content">
        <div class="xg-spot-thumbnail">
          <span class="xg-spot-time"></span>
        </div>
        <div class="xg-spot-text"><span class="spot-inner-text"></span></div>
      </div>
      <div class="xgplayer-progress-point">00:00</div>
      <div class="xg-spot-ext-text"></div>
      <div class="xg-spot-line"></div>
    </div>`)}}],[{key:"pluginName",get:function(){return"progresspreview"}},{key:"defaultConfig",get:function(){return{index:1,miniWidth:6,ispots:[],defaultText:"",isFocusDots:!0,isHideThumbnailHover:!0,isShowThumbnail:!0,isShowCoverPreview:!1,mode:"",disable:!1,width:160,height:90}}}]),i}(Ie),Mv=function(n){de(i,n);var s=ge(i);function i(t){var e;return ae(this,i),e=s.call(this,t),e.ratio=1,e.interval=null,e._preloadMark={},e}return ue(i,[{key:"afterCreate",value:function(){var e=this;this.usable&&this.initThumbnail(),this.on([Ci],function(){var r=e.config,o=r.pic_num,a=r.interval;e.usable&&(e.interval=a>0?a:Math.round(e.player.duration*1e3/o)/1e3)})}},{key:"setConfig",value:function(e){var r=this;if(e){var o=Object.keys(e);o.length<1||(o.forEach(function(a){r.config[a]=e[a]}),this.usable&&this.initThumbnail())}}},{key:"usable",get:function(){var e=this.config,r=e.urls,o=e.pic_num;return r&&r.length>0&&o>0}},{key:"initThumbnail",value:function(){var e=this.config,r=e.width,o=e.height,a=e.pic_num,u=e.interval;this.ratio=r/o*100,this.interval=u||Math.round(this.player.duration/a),this._preloadMark={}}},{key:"getUrlByIndex",value:function(e){return e>=0&&e<this.config.urls.length?this.config.urls[e]:""}},{key:"preload",value:function(e){var r=this;if(!this._preloadMark[e]){var o=this.config.urls,a=o.length,u=[];e>0&&u.push(e-1),u.push(e),e>0&&e<a-1&&u.push(e+1),u.map(function(l){!r._preloadMark[l]&&l>=0&&l<a&&(r._preloadMark[l]=1,p.preloadImg(o[l],function(){r._preloadMark[l]=2}))})}}},{key:"getPosition",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=this.config,u=a.pic_num,l=a.row,c=a.col,f=a.width,h=a.height;this.interval=Math.round(this.player.duration/u);var d=Math.ceil(e/this.interval);d=d>u?u:d;var g=d<l*c?0:Math.ceil(d/(l*c))-1,v=d-g*(c*l),m=v>0?Math.ceil(v/c)-1:0,S=v>0?v-m*c-1:0,w=0,_=0;if(r&&o){var P=r/o;P<f/h?(_=o,w=_*(f/h)):(w=r,_=w/(f/h))}else o?r||(_=o||h,w=_*(f/h)):(w=r||f,_=w/(f/h));var I=this.getUrlByIndex(g);return{urlIndex:g,rowIndex:m,colIndex:S,url:I,height:_,width:w,style:{backgroundImage:"url(".concat(I,")"),backgroundSize:"".concat(w*c,"px auto"),backgroundPosition:"-".concat(S*w,"px -").concat(m*_,"px"),width:"".concat(w,"px"),height:"".concat(_,"px")}}}},{key:"update",value:function(e,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"",l=this.config,c=l.pic_num,f=l.urls;if(!(c<=0||!f||f.length===0)){var h=this.getPosition(r,o,a);this.preload(h.urlIndex),Object.keys(h.style).map(function(d){e.style[d]=h.style[d]}),Object.keys(u).map(function(d){e.style[d]=u[d]})}}},{key:"changeConfig",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.setConfig(e)}},{key:"createThumbnail",value:function(e,r){var o=p.createDom("xg-thumbnail","",{},"thumbnail ".concat(r));return e&&e.appendChild(o),o}}],[{key:"pluginName",get:function(){return"thumbnail"}},{key:"defaultConfig",get:function(){return{isShow:!1,urls:[],pic_num:0,col:0,row:0,height:90,width:160,scale:1,className:"",hidePortrait:!1}}}]),i}(Ie);function ks(n){return n?"background:".concat(n,";"):""}var Nv=function(n){de(i,n);var s=ge(i);function i(){var t;ae(this,i);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t=s.call.apply(s,[this].concat(r)),D(R(t),"onTimeupdate",function(){var a=t.player.ended,u=R(t),l=u.offsetDuration,c=t.currentTime;c=p.adjustTimeByDuration(c,l,a),t.update({played:c},l)}),t}return ue(i,[{key:"offsetDuration",get:function(){return this.playerConfig.customDuration||this.player.offsetDuration||this.player.duration}},{key:"currentTime",get:function(){var e=this.player,r=e.offsetCurrentTime,o=e.currentTime;return r>=0?r:o}},{key:"afterCreate",value:function(){var e=this;this.root&&(this.on(_t,this.onTimeupdate),this.on(Wi,function(){e.reset()}))}},{key:"reset",value:function(){this.update({played:0,cached:0},0)}},{key:"update",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{cached:0,played:0},r=arguments.length>1?arguments[1]:void 0;!r||!this.root||(e.cached&&(this.find("xg-mini-progress-cache").style.width="".concat(e.cached/r*100,"%")),e.played&&(this.find("xg-mini-progress-played").style.width="".concat(e.played/r*100,"%")))}},{key:"render",value:function(){var e=this.playerConfig,r=e.commonStyle,o=e.miniprogress;if(o){var a=this.config,u=a.mode,l=a.height,c={cached:ks(r.cachedColor),played:ks(r.playedColor),progress:ks(r.progressColor),height:l>0&&l!==2?"height: ".concat(l,"px;"):""},f=u==="show"?"xg-mini-progress-show":"";return'<xg-mini-progress class="xg-mini-progress '.concat(f,'" style="').concat(c.progress," ").concat(c.height,`">
    <xg-mini-progress-cache class="xg-mini-progress-cache" style="`).concat(c.cached,`"></xg-mini-progress-cache>
    <xg-mini-progress-played class="xg-mini-progress-played" style="`).concat(c.played,`"></xg-mini-progress-played>
    </xg-mini-progress>`)}}}],[{key:"pluginName",get:function(){return"MiniProgress"}},{key:"defaultConfig",get:function(){return{mode:"auto",height:2}}}]),i}(Ie),Qi={REAL_TIME:"realtime",FIRST_FRAME:"firstframe",FRAME_RATE:"framerate",POSTER:"poster"};function Fv(){try{return parseInt(window.performance.now(),10)}catch{return new Date().getTime()}}function Bv(){try{var n=document.createElement("canvas").getContext;return!!n}catch{return!1}}var or=null,Uv=function(n){de(i,n);var s=ge(i);function i(){var t;ae(this,i);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t=s.call.apply(s,[this].concat(r)),D(R(t),"onLoadedData",function(a){t.player&&(t._frameCount=t.config.startFrameCount,t.stop(),t.renderOnTimeupdate(a),t.off(_t,t.renderOnTimeupdate),t.on(_t,t.renderOnTimeupdate))}),D(R(t),"onVisibilitychange",function(a){document.visibilityState==="visible"?t._checkIfCanStart()&&t.start():document.visibilityState==="hidden"&&t.stop()}),D(R(t),"renderOnTimeupdate",function(a){if(t._frameCount>0)t.renderOnce(),t._frameCount--;else{t._isLoaded=!0,t.off(_t,t.renderOnTimeupdate);var u=t.config.startInterval;!t.player.paused&&t._checkIfCanStart()&&t.start(0,u)}}),D(R(t),"start",function(a,u){var l=t.player.video,c=Fv(),f=t.checkVideoIsSupport(l);!f||!t.canvasCtx||(u||(u=t.interval),t.stop(),l.videoWidth&&l.videoHeight&&(t.videoPI=l.videoHeight>0?parseInt(l.videoWidth/l.videoHeight*100,10):0,(t.config.mode===Qi.REAL_TIME||c-t.preTime>=u)&&(l&&l.videoWidth&&t.update(f,t.videoPI),t.preTime=c)),t.frameId=t._loopType==="timer"?p.setTimeout(R(t),t.start,u):p.requestAnimationFrame(t.start))}),D(R(t),"stop",function(){t.frameId&&(t._loopType==="timer"?p.clearTimeout(R(t),t.frameId):p.cancelAnimationFrame(t.frameId),t.frameId=null)}),t}return ue(i,[{key:"afterCreate",value:function(){var e=this;this.playerConfig.dynamicBg===!0&&(this.config.disable=!1),i.isSupport||(this.config.disable=!0);var r=this.config,o=r.disable,a=r.mode,u=r.frameRate;o||(this._pos={width:0,height:0,rwidth:0,rheight:0,x:0,y:0,pi:0},this.isStart=!1,this._isLoaded=!1,this.videoPI=0,this.preTime=0,this.interval=parseInt(1e3/u,10),this.canvas=null,this.canvasCtx=null,this._frameCount=0,this._loopType=this.config.mode!==Qi.REAL_TIME&&this.interval>=1e3?"timer":"animation",this.once(Xr,function(){e.player&&(e.init(),e.renderByPoster(),e.player.paused||e.start())}),a!==Qi.POSTER&&(a!==Qi.FIRST_FRAME&&(this.on(Wi,function(){e.stop()}),this.on(bt,function(){var l=e.config.startInterval;e._checkIfCanStart()&&e.start(0,l)}),this.on(mn,function(){e.stop()})),this.on(ai,this.onLoadedData),this.on(Oo,function(){e._isLoaded=!1,e.stop()}),document.addEventListener("visibilitychange",this.onVisibilitychange)))}},{key:"setConfig",value:function(e){var r=this;Object.keys(e).forEach(function(o){o==="root"&&e[o]!==r.config[o]?r.reRender(e[o]):o==="frameRate"?r.interval=parseInt(1e3/e[o],10):o==="disable"&&e[o]&&r.stop(),r.config[o]=e[o]})}},{key:"init",value:function(e){var r=this.player,o=this.config;this.canvasFilter=i.supportCanvasFilter();try{var a=e||o.root;a||(a=o.isInnerRender&&r.innerContainer||r.root),a.insertAdjacentHTML("afterbegin",'<div class="xgplayer-dynamic-bg" data-index="'.concat(o.index,`"><canvas>
        </canvas><xgmask></xgmask></div>`)),this.root=a.children[0],this.canvas=this.find("canvas"),this.canvasFilter||(this.canvas.style.filter=o.filter,this.canvas.style.webkitFilter=o.filter),this.mask=this.find("xgmask"),o.addMask&&(this.mask.style.background=o.maskBg),this.canvasCtx=this.canvas.getContext("2d")}catch(u){ke.logError("plugin:DynamicBg",u)}}},{key:"reRender",value:function(e){var r=this.config.disable;if(!(!r&&!this.root)){this.stop();var o=this.root?this.root.parentElement:null;if(o!==e&&o.removeChild(this.root),!e){this.root=null;return}this.init(e),this.renderOnce();var a=this.config.startInterval;this._checkIfCanStart()&&this.start(0,a)}}},{key:"checkVideoIsSupport",value:function(e){if(!e)return null;var r=e&&e instanceof window.HTMLVideoElement?e:e.canvas?e.canvas:e.flyVideo?e.flyVideo:null;if(r&&!(Te.browser==="safari"&&p.isMSE(r)))return r;var o=r?r.tagName.toLowerCase():"";return o==="canvas"||o==="img"?r:null}},{key:"renderByPoster",value:function(){var e=this.playerConfig.poster;if(e){var r=p.typeOf(e)==="String"?e:p.typeOf(e.poster)==="String"?e.poster:null;this.updateImg(r)}}},{key:"_checkIfCanStart",value:function(){var e=this.config.mode;return this._isLoaded&&!this.player.paused&&e!==Qi.FIRST_FRAME&&e!==Qi.POSTER}},{key:"renderOnce",value:function(){var e=this.player.video;if(!(!e.videoWidth||!e.videoHeight)){this.videoPI=parseInt(e.videoWidth/e.videoHeight*100,10);var r=this.checkVideoIsSupport(e);r&&this.update(r,this.videoPI)}}},{key:"updateImg",value:function(e){var r=this;if(e){var o=this.canvas.getBoundingClientRect(),a=o.width,u=o.height,l=new window.Image;l.onload=function(){if(!(!r.canvas||r.frameId||r.isStart)){r.canvas.height=u,r.canvas.width=a;var c=parseInt(a/u*100,10);r.update(l,c),l=null}},l.src=e}}},{key:"update",value:function(e,r){if(!(!this.canvas||!this.canvasCtx||!r))try{var o=this._pos,a=this.config,u=this.canvas.getBoundingClientRect(),l=u.width,c=u.height;if(l!==o.width||c!==o.height||o.pi!==r){var f=parseInt(l/c*100,10);o.pi=r,o.width!==l&&(o.width=this.canvas.width=l),o.height!==c&&(o.height=this.canvas.height=c);var h=c,d=l;f<r?d=parseInt(c*r/100,10):f>r&&(h=parseInt(l*100/r,10)),o.rwidth=d*a.multiple,o.rheight=h*a.multiple,o.x=(l-o.rwidth)/2,o.y=(c-o.rheight)/2}this.canvasFilter&&(this.canvasCtx.filter=a.filter),this.canvasCtx.drawImage(e,o.x,o.y,o.rwidth,o.rheight)}catch(g){ke.logError("plugin:DynamicBg",g)}}},{key:"destroy",value:function(){this.stop(),document.removeEventListener("visibilitychange",this.onVisibilitychange),this.canvasCtx=null,this.canvas=null}},{key:"render",value:function(){return""}}],[{key:"pluginName",get:function(){return"dynamicBg"}},{key:"defaultConfig",get:function(){return{isInnerRender:!1,disable:!0,index:-1,mode:"framerate",frameRate:10,filter:"blur(50px)",startFrameCount:2,startInterval:0,addMask:!0,multiple:1.2,maskBg:"rgba(0,0,0,0.7)"}}},{key:"isSupport",get:function(){return typeof or=="boolean"||(or=Bv()),or}},{key:"supportCanvasFilter",value:function(){return!(Te.browser==="safari"||Te.browser==="firefox")}}]),i}(Ie),Hv={LANG:"zh-cn",TEXT:{ERROR_TYPES:{network:{code:1,msg:"视频下载错误"},mse:{code:2,msg:"流追加错误"},parse:{code:3,msg:"解析错误"},format:{code:4,msg:"格式错误"},decoder:{code:5,msg:"解码错误"},runtime:{code:6,msg:"语法错误"},timeout:{code:7,msg:"播放超时"},other:{code:8,msg:"其他错误"}},HAVE_NOTHING:"没有关于音频/视频是否就绪的信息",HAVE_METADATA:"音频/视频的元数据已就绪",HAVE_CURRENT_DATA:"关于当前播放位置的数据是可用的，但没有足够的数据来播放下一帧/毫秒",HAVE_FUTURE_DATA:"当前及至少下一帧的数据是可用的",HAVE_ENOUGH_DATA:"可用数据足以开始播放",NETWORK_EMPTY:"音频/视频尚未初始化",NETWORK_IDLE:"音频/视频是活动的且已选取资源，但并未使用网络",NETWORK_LOADING:"浏览器正在下载数据",NETWORK_NO_SOURCE:"未找到音频/视频来源",MEDIA_ERR_ABORTED:"取回过程被用户中止",MEDIA_ERR_NETWORK:"网络错误",MEDIA_ERR_DECODE:"解码错误",MEDIA_ERR_SRC_NOT_SUPPORTED:"不支持的音频/视频格式",REPLAY:"重播",ERROR:"网络连接似乎出现了问题",PLAY_TIPS:"播放",PAUSE_TIPS:"暂停",PLAYNEXT_TIPS:"下一集",DOWNLOAD_TIPS:"下载",ROTATE_TIPS:"旋转",RELOAD_TIPS:"重新载入",FULLSCREEN_TIPS:"进入全屏",EXITFULLSCREEN_TIPS:"退出全屏",CSSFULLSCREEN_TIPS:"进入样式全屏",EXITCSSFULLSCREEN_TIPS:"退出样式全屏",TEXTTRACK:"字幕",PIP:"画中画",SCREENSHOT:"截图",LIVE:"正在直播",OFF:"关闭",OPEN:"开启",MINI_DRAG:"点击按住可拖动视频",MINISCREEN:"小屏幕",REFRESH_TIPS:"请试试",REFRESH:"刷新",FORWARD:"快进中",LIVE_TIP:"直播"}},Tn="info",Ps=Lc,jv=function(n){de(i,n);var s=ge(i);function i(){var t;ae(this,i);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t=s.call.apply(s,[this].concat(r)),D(R(t),"_recordUserActions",function(a){var u=t._getTime(),l=Object.assign({},a,{msg:a.msg||a.action});t._stats[Tn].push(ze(ze({type:"userAction"},u),{},{payload:l}))}),D(R(t),"_onReset",function(){t.reset()}),D(R(t),"_recordInfo",function(a){t.info(a)}),D(R(t),"_downloadStats",function(){var a=t.getStats(),u=new Blob([JSON.stringify(a)],{type:"application/json"}),l=window.URL.createObjectURL(u),c=document.createElement("a");c.style.display="none",c.href=l,c.download="player.txt",c.disabled=!1,c.click()}),t}return ue(i,[{key:"_getTime",value:function(){return{timestamp:Date.now(),timeFormat:new Date().toISOString()}}},{key:"afterCreate",value:function(){this.reset(),this.on(Ir,this._recordUserActions),this.on(Ps.STATS_INFO,this._recordInfo),this.on(Ps.STATS_DOWNLOAD,this._downloadStats),this.on(Ps.STATS_RESET,this._onReset)}},{key:"destroy",value:function(){this.offAll()}},{key:"downloadStats",value:function(){this._downloadStats()}},{key:"info",value:function(e){e.profile?this._infoProfile(e):this._info(e)}},{key:"_info",value:function(e){var r=this._getTime();this._stats[Tn].push(ze(ze({},r),{},{payload:e}))}},{key:"_infoProfile",value:function(e){if(e&&e.startMs){var r=Date.now(),o=r-e.startMs,a=ze({cat:"function",dur:o,name:e.name||e.msg,ph:"X",pid:0,tid:0,ts:e.startMs,profile:!0},e);this._info(a)}else console.warn("infoProfile need object data, include startMs")}},{key:"reset",value:function(){var e;this._stats=(e={},D(e,Tn,[]),D(e,"media",{}),e)}},{key:"getStats",value:function(){for(var e=this.player,r=e.media,o=[],a=0;a<r.buffered.length;a++)o.push({start:r.buffered.start(a),end:r.buffered.end(a)});var u={currentTime:r.currentTime,readyState:r.readyState,buffered:o,paused:r.paused,ended:r.ended};return this._stats.media=u,{raw:this._stats,timestat:this._getTimeStats(),profile:this._getProfile()}}},{key:"_getTimeStats",value:function(){var e=this._stats[Tn],r=e.map(function(o){var a=o.payload.data,u="";try{a instanceof Error?u=a.msg:a!==void 0&&(u=JSON.stringify(a))}catch(l){console.log("err",l)}return"[".concat(o.timeFormat,"] : ").concat(o.payload.msg," ").concat(u," ")});return r}},{key:"_getProfile",value:function(){var e={traceEvents:[]},r=this._stats[Tn];return r.forEach(function(o){o.payload.profile&&e.traceEvents.push(o.payload)}),e}}],[{key:"pluginName",get:function(){return"stats"}},{key:"defaultConfig",get:function(){return{}}}]),i}(Yt),jc=function(n){de(i,n);var s=ge(i);function i(){var t;ae(this,i);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t=s.call.apply(s,[this].concat(r)),D(R(t),"onGapJump",function(){var a=R(t),u=a.player,l=a.config;if(u.media.readyState!==HTMLMediaElement.HAVE_NOTHING){if(u.media.seeking){if(!t.seekingEventReceived)return}else t.seekingEventReceived=!1;if(!(u.media.paused&&u.media.currentTime!==0&&t.hasPlayed)){var c=u.media.buffered,f=l.smallGapLimit||.5,h=l.gapDetectionThreshold||.3,d=u.media.currentTime,g=t._getIndex(c,d,h);if(!(g===null||g===0)){console.log("GapJump  bufferRange ",c.start(g),c.end(g));var v=c.start(g)+.1,m=u.media.duration;if(!(v>m)){var S=v-d,w=S<=f;S<i.BROWSER_GAP_TOLERANCE||w&&(l.useGapJump!==!1&&(u.media.currentTime=t.isSafari?v+.1:v),t.player&&t.player.emit("detectGap"),console.log("gapJump gapIndex",g," isGapSamll:",w," currentTime:",u.media.currentTime," jumpSize:",d-u.media.currentTime),v!==.08&&u&&u.emit("log",{type:"oneevent",end_type:"gap",vid:u.config.vid,ext:{video_postion:Math.floor(v*1e3)}}))}}}}}),t}return ue(i,[{key:"afterCreate",value:function(){var e=this,r=this.config.useGapJump;r!==!1&&(this.hasPlayed=!1,this.seekingEventReceived=!1,this.isSafari=/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),this.on(Bi,this.onGapJump),this.on(bt,function(){e.hasPlayed=!0}),this.on(Di,function(){e.seekingEventReceived=!0}))}},{key:"_getIndex",value:function(e,r,o){if(!e||!e.length||e.length===1&&e.end(0)-e.start(0)<1e-6)return null;for(var a=this._getBuffered(e),u=null,l=0;l<a.length;l++){var c=a[l];if(c.start>r&&(l===0||a[l-1].end-r<=o)){u=l;break}}return u}},{key:"_getBuffered",value:function(e){if(!e)return[];for(var r=[],o=0;o<e.length;o++)r.push({start:e.start(o),end:e.end(o)});return r}}],[{key:"pluginName",get:function(){return"gapJump"}},{key:"defaultConfig",get:function(){return{useGapJump:!1,smallGapLimit:.5,gapDetectionThreshold:.3}}}]),i}(Ie);jc.BROWSER_GAP_TOLERANCE=.001;var Vv=function(n){de(i,n);var s=ge(i);function i(){var t;ae(this,i);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t=s.call.apply(s,[this].concat(r)),D(R(t),"onWaiting",function(){var a=R(t),u=a.config;t.jumpCnt>u.jumpCntMax||t.timer||u.useWaitingTimeoutJump===!1||(t.timer=setTimeout(t.onJump,u.waitingTime*1e3))}),D(R(t),"onJump",function(){var a=R(t),u=a.player,l=a.config;if(clearTimeout(t.timer),t.timer=null,!(t.jumpCnt>l.jumpCntMax||l.useWaitingTimeoutJump===!1)&&!(u.media.paused&&u.media.currentTime!==0&&t.hasPlayed)){t.jumpSize=l.jumpSize*(t.jumpCnt+1),t.jumpCnt===l.jumpSize&&t.jumpSize<6&&(t.jumpSize=6);var c=u.currentTime+t.jumpSize,f=u.media.duration;c>f||(console.log("waitintTimeout, currentTime:",u.currentTime,", jumpTo:",c),t.jumpCnt++,u.currentTime=c)}}),t}return ue(i,[{key:"afterCreate",value:function(){var e=this,r=this.config,o=r.useWaitingTimeoutJump,a=r.jumpSize;o!==!1&&(this.hasPlayed=!1,this.jumpCnt=0,this.timer=null,this.jumpSize=a,this.on(Bi,this.onWaiting),this.on([Lo,ni],function(){clearTimeout(e.timer),e.timer=null,e.jumpSize=e.config.jumpSize}),this.on(bt,function(){e.hasPlayed=!0}))}}],[{key:"pluginName",get:function(){return"waitingTimeoutJump"}},{key:"defaultConfig",get:function(){return{useWaitingTimeoutJump:!1,waitingTime:15,jumpSize:2,jumpCntMax:4}}}]),i}(Ie),Zi="cdn",ar=["cdn"],zv=function(n){de(i,n);var s=ge(i);function i(){var t;ae(this,i);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t=s.call.apply(s,[this].concat(r)),D(R(t),"getSpeed",function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Zi;if(!t.speedListCache||!t.speedListCache[a]||t.speedListCache[a].length<=0)return 0;var u=0;return t.speedListCache[a].map(function(l){u+=l}),Math.floor(u/t.speedListCache[a].length)}),D(R(t),"startTimer",function(){p.isMSE(t.player.video)||(t.initSpeedList(),t.cnt=0,t.timer=setTimeout(t.testSpeed,t.config.testTimeStep))}),D(R(t),"initSpeedList",function(){t.speedListCache={},ar.forEach(function(a){t.speedListCache[a]=[]})}),D(R(t),"_onRealSpeedChange",function(a){a.speed&&t.appendList(a.speed,a.type||Zi)}),D(R(t),"testSpeed",function(){if(clearTimeout(t.timer),t.timer=null,!(!t.player||!t.config.openSpeed)){var a=t.config,u=a.url,l=a.loadSize,c=a.testCnt,f=a.testTimeStep,h=u+(u.indexOf("?")<0?"?testst=":"&testst=")+Date.now();if(!(t.cnt>=c)){t.cnt++;try{var d=new Date().getTime(),g=null,v=new XMLHttpRequest;t.xhr=v,v.open("GET",h);var m={},S=Math.floor(Math.random()*10);m.Range="bytes="+S+"-"+(l+S),m&&Object.keys(m).forEach(function(w){v.setRequestHeader(w,m[w])}),v.onreadystatechange=function(){if(v.readyState===4){t.xhr=null,g=new Date().getTime();var w=v.getResponseHeader("Content-Length")/1024*8,_=Math.round(w*1e3/(g-d));t.appendList(_),t.timer=setTimeout(t.testSpeed,f)}},v.send()}catch(w){console.error(w)}}}}),D(R(t),"appendList",function(a){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Zi;if(!(!t.speedListCache||!t.speedListCache[u])){var l=t.config.saveSpeedMax;t.speedListCache[u].length>=l&&t.speedListCache[u].shift(),t.speedListCache[u].push(a);var c=R(t),f=c.player;f&&(u===Zi?f.realTimeSpeed=a:f[t.getSpeedName("realTime",u)]=a),t.updateSpeed(u)}}),D(R(t),"updateSpeed",function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Zi,u=t.getSpeed(a),l=R(t),c=l.player;if(c)if(a===Zi)(!c.avgSpeed||u!==c.avgSpeed)&&(c.avgSpeed=u,c.emit(Js,{speed:u,realTimeSpeed:c.realTimeSpeed}));else{var f=t.getSpeedName("avg",a);(!c[f]||u!==c[f])&&(c[f]=u,c.emit(Js,{speed:u,realTimeSpeed:c.realTimeSpeed}))}}),t}return ue(i,[{key:"afterCreate",value:function(){var e=this.config,r=e.openSpeed,o=e.addSpeedTypeList;(o==null?void 0:o.length)>0&&ar.push.apply(ar,Ot(o)),this.initSpeedList(),this.on("real_time_speed",this._onRealSpeedChange),this.timer=null,this.cnt=0,this.xhr=null,r&&this.on([ai,Cr],this.startTimer)}},{key:"getSpeedName",value:function(e,r){return e+"Speed"+r.toUpperCase()}},{key:"openSpeed",get:function(){return this.config.openSpeed},set:function(e){if(this.config.openSpeed=e,!e&&this.timer){clearTimeout(this.timer),this.timer=null;return}if(this.config.openSpeed){if(this.timer)return;this.timer=setTimeout(this.testSpeed,this.config.testTimeStep)}}},{key:"destroy",value:function(){var e=this;this.off("real_time_speed",this._onRealSpeedChange),this.off([ai,Cr],this.startTimer),ar.forEach(function(r){e.speedListCache&&e.speedListCache[r]&&(e.speedListCache[r]=[])}),this.speedListCache&&(this.speedListCache={}),clearTimeout(this.timer),this.timer=null,this.xhr&&this.xhr.readyState!==4&&(this.xhr.cancel&&this.xhr.cancel(),this.xhr=null)}}],[{key:"pluginName",get:function(){return"testspeed"}},{key:"defaultConfig",get:function(){return{openSpeed:!1,testCnt:3,loadSize:200*1024,testTimeStep:3e3,url:"",saveSpeedMax:5,addSpeedTypeList:[]}}}]),i}(Ie),Wv=function(n){de(i,n);var s=ge(i);function i(){return ae(this,i),s.apply(this,arguments)}return ue(i,[{key:"afterCreate",value:function(){var e=this,r=this.player,o=this.config,a=r.media||r.video;if(this.timer=null,this._lastDecodedFrames=0,this._currentStuckCount=0,this._lastCheckPoint=null,this._payload=[],!o.disabled){var u=a.getVideoPlaybackQuality;u&&(this.on(bt,function(){e._startTick()}),this.on(mn,function(){e._stopTick()}),this.on(zi,function(){e._stopTick()}),this.on(Wi,function(){e._stopTick()}))}}},{key:"_startTick",value:function(){var e=this;this._stopTick(),this._timer=setTimeout(function(){e._checkDecodeFPS(),e._startTick()},this.config.tick)}},{key:"_stopTick",value:function(){clearTimeout(this._timer),this._timer=null}},{key:"_checkBuffer",value:function(e,r){for(var o=!1,a=[],u=0;u<r.length;u++){var l=r.start(u),c=r.end(u);if(a.push({start:l,end:c}),l<=e&&e<=c-1){o=!0;break}}return{enoughBuffer:o,buffers:a}}},{key:"_checkStuck",value:function(e,r,o,a){var u=this.player.media||this.player.video,l=document.hidden,c=u.paused,f=u.readyState,h=u.currentTime,d=u.buffered;if(!(l||c||f<4)){var g=this._checkBuffer(h,d),v=g.enoughBuffer,m=g.buffers;v&&(e<=this.config.reportFrame?(this._currentStuckCount++,this._payload.push({currentTime:h,buffers:m,curDecodedFrames:e,totalVideoFrames:r,droppedVideoFrames:o,checkInterval:a}),this._currentStuckCount>=this.config.stuckCount&&(this.emit(Oc,this._payload),this._reset())):this._reset())}}},{key:"_reset",value:function(){this._payload=[],this._currentStuckCount=0}},{key:"_checkDecodeFPS",value:function(){var e=this.player.media||this.player.video;if(e){var r=e.getVideoPlaybackQuality(),o=r.totalVideoFrames,a=r.droppedVideoFrames,u=performance.now();if(o&&this._lastCheckPoint){var l=o-this._lastDecodedFrames,c=u-this._lastCheckPoint;this._checkStuck(l,o,a,c)}this._lastDecodedFrames=o,this._lastCheckPoint=u}}},{key:"destroy",value:function(){this._stopTick()}}],[{key:"pluginName",get:function(){return"FpsDetect"}},{key:"defaultConfig",get:function(){return{disabled:!1,tick:1e3,stuckCount:3,reportFrame:0}}}]),i}(Ie);on.use(Hv);var Gv=ue(function n(s,i){var t,e,r;ae(this,n);var o=i&&i.isMobileSimulateMode==="mobile",a=i.isLive,u=a?[]:[uv,ev,Nv,Dv,av],l=[].concat(u,[tv,ov,gv,_v,Pv,xv,Sv,wv,hv,mv]),c=[Dp,Mp,Fp,Jp,Bp,Av,Lv,Mv,Vp];this.plugins=[jv,Lp].concat(Ot(l),c,[jc,Vv]);var f=o?"mobile":Te.device;switch(f){case"pc":(t=this.plugins).push.apply(t,[du,ws,pu,zv,Wv]);break;case"mobile":(e=this.plugins).push.apply(e,[$p]);break;default:(r=this.plugins).push.apply(r,[du,ws,pu])}(Te.os.isIpad||f==="pc")&&this.plugins.push(Uv),Te.os.isIpad&&this.plugins.push(ws),this.ignores=[],this.i18n=[]}),Mt=function(n){de(i,n);var s=ge(i);function i(){return ae(this,i),s.apply(this,arguments)}return ue(i)}(Zr);D(Mt,"defaultPreset",Gv);D(Mt,"Util",p);D(Mt,"Sniffer",Te);D(Mt,"Errors",ti);D(Mt,"Events",op);D(Mt,"Plugin",Ie);D(Mt,"BasePlugin",Yt);D(Mt,"I18N",on);D(Mt,"STATE_CLASS",z);D(Mt,"InstManager",Fc);var Vo={};Object.defineProperty(Vo,"__esModule",{value:!0});Vo.default=function(n){for(var s=0,i=arguments.length,t=Array(i>1?i-1:0),e=1;e<i;e++)t[e-1]=arguments[e];var r=!0,o=!1,a=void 0;try{for(var u=t[Symbol.iterator](),l;!(r=(l=u.next()).done);r=!0){var c=l.value;s+=c.length}}catch(_){o=!0,a=_}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}var f=new n(s),h=0,d=!0,g=!1,v=void 0;try{for(var m=t[Symbol.iterator](),S;!(d=(S=m.next()).done);d=!0){var w=S.value;f.set(w,h),h+=w.length}}catch(_){g=!0,v=_}finally{try{!d&&m.return&&m.return()}finally{if(g)throw v}}return f};var Kv=Vo,Yv=$v(Kv);function $v(n){return n&&n.__esModule?n:{default:n}}var qv=Yv.default;const Xv=qr(qv);function Jv(n,s){var i=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(i!=null){var t,e,r,o,a=[],u=!0,l=!1;try{if(r=(i=i.call(n)).next,s!==0)for(;!(u=(t=r.call(i)).done)&&(a.push(t.value),a.length!==s);u=!0);}catch(c){l=!0,e=c}finally{try{if(!u&&i.return!=null&&(o=i.return(),Object(o)!==o))return}finally{if(l)throw e}}return a}}function St(n,s){if(!(n instanceof s))throw new TypeError("Cannot call a class as a function")}function yu(n,s){for(var i=0;i<s.length;i++){var t=s[i];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(n,zc(t.key),t)}}function wt(n,s,i){return s&&yu(n.prototype,s),i&&yu(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n}function W(n,s,i){return s=zc(s),s in n?Object.defineProperty(n,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[s]=i,n}function Qv(n,s){return em(n)||Jv(n,s)||Vc(n,s)||nm()}function Et(n){return Zv(n)||tm(n)||Vc(n)||im()}function Zv(n){if(Array.isArray(n))return Zs(n)}function em(n){if(Array.isArray(n))return n}function tm(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function Vc(n,s){if(n){if(typeof n=="string")return Zs(n,s);var i=Object.prototype.toString.call(n).slice(8,-1);if(i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set")return Array.from(n);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Zs(n,s)}}function Zs(n,s){(s==null||s>n.length)&&(s=n.length);for(var i=0,t=new Array(s);i<s;i++)t[i]=n[i];return t}function im(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nm(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rm(n,s){if(typeof n!="object"||n===null)return n;var i=n[Symbol.toPrimitive];if(i!==void 0){var t=i.call(n,s||"default");if(typeof t!="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}function zc(n){var s=rm(n,"string");return typeof s=="symbol"?s:String(s)}var cn={VIDEO:"video",AUDIO:"audio",METADATA:"metadata"},Mr={AVC:"avc",HEVC:"hevc"},Nr={AAC:"aac",G711PCMA:"g7110a",G711PCMU:"g7110m"},sm=function(){function n(){St(this,n),W(this,"id",1),W(this,"type",cn.VIDEO),W(this,"codecType",Mr.AVC),W(this,"pid",-1),W(this,"hvcC",void 0),W(this,"codec",""),W(this,"timescale",0),W(this,"formatTimescale",0),W(this,"sequenceNumber",0),W(this,"baseMediaDecodeTime",0),W(this,"baseDts",0),W(this,"duration",0),W(this,"warnings",[]),W(this,"samples",[]),W(this,"pps",[]),W(this,"sps",[]),W(this,"vps",[]),W(this,"fpsNum",0),W(this,"fpsDen",0),W(this,"sarRatio",[]),W(this,"width",0),W(this,"height",0),W(this,"nalUnitSize",4),W(this,"present",!1),W(this,"isVideoEncryption",!1),W(this,"isAudioEncryption",!1),W(this,"isVideo",!0),W(this,"kid",null),W(this,"pssh",null),W(this,"ext",void 0)}return wt(n,[{key:"reset",value:function(){this.sequenceNumber=this.width=this.height=this.fpsDen=this.fpsNum=this.duration=this.baseMediaDecodeTime=this.timescale=0,this.codec="",this.present=!1,this.pid=-1,this.pps=[],this.sps=[],this.vps=[],this.sarRatio=[],this.samples=[],this.warnings=[],this.hvcC=null}},{key:"firstDts",get:function(){return this.samples.length?this.samples[0].dts:null}},{key:"firstPts",get:function(){return this.samples.length?this.samples[0].pts:null}},{key:"samplesDuration",get:function(){if(this.samples.length>0){var i=this.samples[0],t=this.samples[this.samples.length-1];return t.dts-i.dts+t.duration}return 0}},{key:"exist",value:function(){return!!(this.pps.length&&this.sps.length&&this.codec)}},{key:"hasSample",value:function(){return!!this.samples.length}},{key:"isEncryption",get:function(){return this.isVideoEncryption}}]),n}(),om=function(){function n(){St(this,n),W(this,"id",2),W(this,"type",cn.AUDIO),W(this,"codecType",Nr.AAC),W(this,"pid",-1),W(this,"codec",""),W(this,"sequenceNumber",0),W(this,"sampleDuration",0),W(this,"timescale",0),W(this,"formatTimescale",0),W(this,"baseMediaDecodeTime",0),W(this,"duration",0),W(this,"warnings",[]),W(this,"samples",[]),W(this,"baseDts",0),W(this,"sampleSize",16),W(this,"sampleRate",0),W(this,"channelCount",0),W(this,"objectType",0),W(this,"sampleRateIndex",0),W(this,"config",[]),W(this,"present",!1),W(this,"isVideoEncryption",!1),W(this,"isAudioEncryption",!1),W(this,"kid",null),W(this,"ext",void 0)}return wt(n,[{key:"reset",value:function(){this.sequenceNumber=0,this.timescale=0,this.sampleDuration=0,this.sampleRate=0,this.channelCount=0,this.baseMediaDecodeTime=0,this.present=!1,this.pid=-1,this.codec="",this.samples=[],this.config=[],this.warnings=[]}},{key:"exist",value:function(){return!!(this.sampleRate&&this.channelCount&&this.codec&&this.codecType===Nr.AAC)}},{key:"hasSample",value:function(){return!!this.samples.length}},{key:"isEncryption",get:function(){return this.isAudioEncryption}},{key:"firstDts",get:function(){return this.samples.length?this.samples[0].dts:null}},{key:"firstPts",get:function(){return this.samples.length?this.samples[0].pts:null}},{key:"samplesDuration",get:function(){if(this.samples.length>0){var i=this.samples[0],t=this.samples[this.samples.length-1];return t.dts-i.dts+t.duration}return 0}}]),n}(),_u=function(){function n(s,i,t){St(this,n),W(this,"flag",{}),W(this,"keyframe",!1),W(this,"gopId",0),W(this,"duration",0),W(this,"size",0),W(this,"units",[]),W(this,"chromaFormat",420),this.originPts=this.pts=s,this.originDts=this.dts=i,t&&(this.units=t)}return wt(n,[{key:"cts",get:function(){return this.pts-this.dts}},{key:"setToKeyframe",value:function(){this.keyframe=!0,this.flag.dependsOn=2,this.flag.isNonSyncSample=0}}]),n}(),bu=wt(function n(s,i,t,e){St(this,n),W(this,"duration",1024),W(this,"flag",{dependsOn:2,isNonSyncSample:0}),W(this,"keyframe",!0),this.originPts=this.pts=this.dts=s,this.data=i,this.size=i.byteLength,this.sampleOffset=e,t&&(this.duration=t)}),am=function(){function n(){St(this,n),W(this,"id",3),W(this,"type",cn.METADATA),W(this,"timescale",0),W(this,"flvScriptSamples",[]),W(this,"seiSamples",[])}return wt(n,[{key:"exist",value:function(){return!!((this.flvScriptSamples.length||this.seiSamples.length)&&this.timescale)}},{key:"reset",value:function(){this.timescale=0,this.flvScriptSamples=[],this.seiSamples=[]}},{key:"hasSample",value:function(){return!!(this.flvScriptSamples.length||this.seiSamples.length)}}]),n}(),zo=typeof window<"u",Wc=zo&&navigator.userAgent.toLocaleLowerCase(),um=zo&&Wc.includes("firefox"),lm=zo&&Wc.includes("android"),Pn=function(){function n(){St(this,n)}return wt(n,null,[{key:"getRateIndexByRate",value:function(i){return n.FREQ.indexOf(i)}},{key:"parseADTS",value:function(i,t){for(var e=i.length,r=0;r+2<e&&!(i[r]===255&&(i[r+1]&246)===240);)r++;if(!(r>=e)){var o=r,a=[],u=(i[r+2]&60)>>>2,l=n.FREQ[u];if(!l)throw new Error("Invalid sampling index: ".concat(u));for(var c=((i[r+2]&192)>>>6)+1,f=(i[r+2]&1)<<2|(i[r+3]&192)>>>6,h=n._getConfig(u,f,c),d=h.config,g=h.codec,v,m,S=0,w=n.getFrameDuration(l);r+7<e;){if(i[r]!==255||(i[r+1]&246)!==240){r++;continue}if(m=(i[r+3]&3)<<11|i[r+4]<<3|(i[r+5]&224)>>5,e-r<m)break;v=(~i[r+1]&1)*2,a.push({pts:t+S*w,data:i.subarray(r+7+v,r+m)}),S++,r+=m}return{skip:o,remaining:r>=e?void 0:i.subarray(r),frames:a,samplingFrequencyIndex:u,sampleRate:l,objectType:c,channelCount:f,codec:g,config:d,originCodec:"mp4a.40.".concat(c)}}}},{key:"parseAudioSpecificConfig",value:function(i){if(i.length){var t=i[0]>>>3,e=(i[0]&7)<<1|i[1]>>>7,r=(i[1]&120)>>>3,o=n.FREQ[e];if(o){var a=n._getConfig(e,r,t),u=a.config,l=a.codec;return{samplingFrequencyIndex:e,sampleRate:o,objectType:t,channelCount:r,config:u,codec:l,originCodec:"mp4a.40.".concat(t)}}}}},{key:"getFrameDuration",value:function(i){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:9e4;return 1024*t/i}},{key:"_getConfig",value:function(i,t,e){var r=[],o,a;return um?i>=6?(o=5,a=i-3):(o=2,a=i):lm?(o=2,a=i):(o=e===2||e===5?e:5,a=i,i>=6?a=i-3:t===1&&(o=2,a=i)),r[0]=o<<3,r[0]|=(i&14)>>1,r[1]=(i&1)<<7,r[1]|=t<<3,o===5&&(r[1]|=(a&14)>>1,r[2]=(a&1)<<7,r[2]|=8,r[3]=0),{config:r,codec:"mp4a.40.".concat(o)}}},{key:"getSilentFrame",value:function(i,t){switch(i){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}]),n}();W(Pn,"FREQ",[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350]);function Jt(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];s=s.filter(Boolean);var t=new Uint8Array(s.reduce(function(r,o){return r+o.byteLength},0)),e=0;return s.forEach(function(r){t.set(r,e),e+=r.byteLength}),t}var cm=Math.pow(2,32);function Fe(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n[s]<<8)+(n[s+1]||0)}function fm(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n[s]<<16)+(n[s+1]<<8)+(n[s+2]||0)}function Q(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n[s]<<24>>>0)+(n[s+1]<<16)+(n[s+2]<<8)+(n[s+3]||0)}function pi(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Q(n,s)*cm+Q(n,s+4)}function hm(n){for(var s="avc1.",i,t=0;t<3;t++)i=n[t].toString(16),i.length<2&&(i="0".concat(i)),s+=i;return s}function Eu(n){if(!Array.isArray(n)){for(var s=[],i="",t=0;t<n.length;t++)t%2&&(i=n[t-1]+n[t],s.push(parseInt(i,16)),i="");return s}return n.map(function(e){return parseInt(e,16)})}var Rt=function(){function n(){St(this,n)}return wt(n,null,[{key:"findBox",value:function(i,t){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=[];if(!i)return r;for(var o=0,a="",u=0;i.length>7;){if(o=Q(i),a=String.fromCharCode.apply(null,i.subarray(4,8)),u=8,o===1?(o=pi(i,8),u+=8):o||(o=i.length),!t[0]||a===t[0]){var l=i.subarray(0,o);if(t.length<2)r.push({start:e,size:o,headerSize:u,type:a,data:l});else return n.findBox(l.subarray(u),t.slice(1),e+u)}e+=o,i=i.subarray(o)}return r}},{key:"tfhd",value:function(i){return ye(i,!0,function(t,e){t.trackId=Q(e);var r=4,o=t.flags&255&1,a=t.flags&255&2,u=t.flags&255&8,l=t.flags&255&16,c=t.flags&255&32;o&&(r+=4,t.baseDataOffset=Q(e,r),r+=4),a&&(t.sampleDescriptionIndex=Q(e,r),r+=4),u&&(t.defaultSampleDuration=Q(e,r),r+=4),l&&(t.defaultSampleSize=Q(e,r),r+=4),c&&(t.defaultSampleFlags=Q(e,r))})}},{key:"sidx",value:function(i){return ye(i,!0,function(t,e){var r=0;t.reference_ID=Q(e,r),r+=4,t.timescale=Q(e,r),r+=4,t.version===0?(t.earliest_presentation_time=Q(e,r),r+=4,t.first_offset=Q(e,r),r+=4):(t.earliest_presentation_time=pi(e,r),r+=8,t.first_offset=pi(e,r),r+=8),r+=2,t.references=[];var o=Fe(e,r);r+=2;for(var a=0;a<o;a++){var u={};t.references.push(u);var l=Q(e,r);r+=4,u.reference_type=l>>31&1,u.referenced_size=l&2147483647,u.subsegment_duration=Q(e,r),r+=4,l=Q(e,r),r+=4,u.starts_with_SAP=l>>31&1,u.SAP_type=l>>28&7,u.SAP_delta_time=l&268435455}})}},{key:"moov",value:function(i){return ye(i,!1,function(t,e,r){t.mvhd=n.mvhd(n.findBox(e,["mvhd"],r)[0]),t.trak=n.findBox(e,["trak"],r).map(function(o){return n.trak(o)}),t.pssh=n.pssh(n.findBox(e,["pssh"],r)[0])})}},{key:"mvhd",value:function(i){return ye(i,!0,function(t,e){var r=0;t.version===1?(t.timescale=Q(e,16),t.duration=pi(e,20),r+=28):(t.timescale=Q(e,8),t.duration=Q(e,12),r+=16),t.nextTrackId=Q(e,r+76)})}},{key:"trak",value:function(i){return ye(i,!1,function(t,e,r){t.tkhd=n.tkhd(n.findBox(e,["tkhd"],r)[0]),t.mdia=n.mdia(n.findBox(e,["mdia"],r)[0])})}},{key:"tkhd",value:function(i){return ye(i,!0,function(t,e){var r=0;t.version===1?(t.trackId=Q(e,16),t.duration=pi(e,24),r+=32):(t.trackId=Q(e,8),t.duration=Q(e,16),r+=20),t.width=Q(e,r+52),t.height=Q(e,r+56)})}},{key:"mdia",value:function(i){return ye(i,!1,function(t,e,r){t.mdhd=n.mdhd(n.findBox(e,["mdhd"],r)[0]),t.hdlr=n.hdlr(n.findBox(e,["hdlr"],r)[0]),t.minf=n.minf(n.findBox(e,["minf"],r)[0])})}},{key:"mdhd",value:function(i){return ye(i,!0,function(t,e){var r=0;t.version===1?(t.timescale=Q(e,16),t.duration=pi(e,20),r+=28):(t.timescale=Q(e,8),t.duration=Q(e,12),r+=16);var o=Fe(e,r);t.language=String.fromCharCode((o>>10&31)+96,(o>>5&31)+96,(o&31)+96)})}},{key:"hdlr",value:function(i){return ye(i,!0,function(t,e){t.version===0&&(t.handlerType=String.fromCharCode.apply(null,e.subarray(4,8)))})}},{key:"minf",value:function(i){return ye(i,!1,function(t,e,r){t.vmhd=n.vmhd(n.findBox(e,["vmhd"],r)[0]),t.smhd=n.smhd(n.findBox(e,["smhd"],r)[0]),t.stbl=n.stbl(n.findBox(e,["stbl"],r)[0])})}},{key:"vmhd",value:function(i){return ye(i,!0,function(t,e){t.graphicsmode=Fe(e),t.opcolor=[Fe(e,2),Fe(e,4),Fe(e,6)]})}},{key:"smhd",value:function(i){return ye(i,!0,function(t,e){t.balance=Fe(e)})}},{key:"stbl",value:function(i){return ye(i,!1,function(t,e,r){var o,a,u;t.stsd=n.stsd(n.findBox(e,["stsd"],r)[0]),t.stts=n.stts(n.findBox(e,["stts"],r)[0]),t.ctts=n.ctts(n.findBox(e,["ctts"],r)[0]),t.stsc=n.stsc(n.findBox(e,["stsc"],r)[0]),t.stsz=n.stsz(n.findBox(e,["stsz"],r)[0]),t.stco=n.stco(n.findBox(e,["stco"],r)[0]),t.stco||(t.co64=n.co64(n.findBox(e,["co64"],r)[0]),t.stco=t.co64);var l=(o=t.stsd.entries[0])===null||o===void 0||(a=o.sinf)===null||a===void 0||(u=a.schi)===null||u===void 0?void 0:u.tenc.default_IV_size;t.stss=n.stss(n.findBox(e,["stss"],r)[0]),t.senc=n.senc(n.findBox(e,["senc"],r)[0],l)})}},{key:"senc",value:function(i){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;return ye(i,!0,function(e,r){var o=0,a=Q(r,o);o+=4,e.samples=[];for(var u=0;u<a;u++){var l={};l.InitializationVector=[];for(var c=0;c<t;c++)l.InitializationVector[c]=r[o+c];if(o+=t,e.flags&2){l.subsamples=[];var f=Fe(r,o);o+=2;for(var h=0;h<f;h++){var d={};d.BytesOfClearData=Fe(r,o),o+=2,d.BytesOfProtectedData=Q(r,o),o+=4,l.subsamples.push(d)}}e.samples.push(l)}})}},{key:"pssh",value:function(i){return ye(i,!0,function(t,e){for(var r=[],o=[],a=0,u=0;u<16;u++)o.push(xs(e[a+u]));if(a+=16,t.version>0){var l=Q(e,a);a+=4;for(var c=0;c<(""+l).length;c++)for(var f=0;f<16;f++){var h=e[a];a+=1,r.push(xs(h))}}var d=Q(e,a);t.data_size=d,a+=4,t.kid=r,t.system_id=o,t.buffer=e})}},{key:"stsd",value:function(i){return ye(i,!0,function(t,e,r){t.entryCount=Q(e),t.entries=n.findBox(e.subarray(4),[],r+4).map(function(o){switch(o.type){case"avc1":case"avc2":case"avc3":case"avc4":return n.avc1(o);case"hvc1":case"hev1":return n.hvc1(o);case"mp4a":return n.mp4a(o);case"alaw":case"ulaw":return n.alaw(o);case"enca":return ye(o,!1,function(a,u,l){a.channelCount=Fe(u,16),a.samplesize=Fe(u,18),a.sampleRate=Q(u,24)/65536,u=u.subarray(28),a.sinf=n.sinf(n.findBox(u,["sinf"],l)[0]),a.esds=n.esds(n.findBox(u,["esds"],l)[0])});case"encv":return ye(o,!1,function(a,u,l){a.width=Fe(u,24),a.height=Fe(u,26),a.horizresolution=Q(u,28),a.vertresolution=Q(u,32),u=u.subarray(78),a.sinf=n.sinf(n.findBox(u,["sinf"],l)[0]),a.avcC=n.avcC(n.findBox(u,["avcC"],l)[0]),a.hvcC=n.hvcC(n.findBox(u,["hvcC"],l)[0]),a.pasp=n.pasp(n.findBox(u,["pasp"],l)[0])})}}).filter(Boolean)})}},{key:"tenc",value:function(i){return ye(i,!1,function(t,e){var r=6;t.default_IsEncrypted=e[r],r+=1,t.default_IV_size=e[r],r+=1,t.default_KID=[];for(var o=0;o<16;o++)t.default_KID.push(xs(e[r])),r+=1})}},{key:"schi",value:function(i){return ye(i,!1,function(t,e,r){t.tenc=n.tenc(n.findBox(e,["tenc"],r)[0])})}},{key:"sinf",value:function(i){return ye(i,!1,function(t,e,r){t.schi=n.schi(n.findBox(e,["schi"],r)[0]),t.frma=n.frma(n.findBox(e,["frma"],r)[0])})}},{key:"frma",value:function(i){return ye(i,!1,function(t,e){t.data_format="";for(var r=0;r<4;r++)t.data_format+=String.fromCharCode(e[r])})}},{key:"avc1",value:function(i){return ye(i,!1,function(t,e,r){var o=Su(t,e),a=e.subarray(o);r+=o,t.avcC=n.avcC(n.findBox(a,["avcC"],r)[0]),t.pasp=n.pasp(n.findBox(a,["pasp"],r)[0])})}},{key:"avcC",value:function(i){return ye(i,!1,function(t,e){t.data=i.data,t.configurationVersion=e[0],t.AVCProfileIndication=e[1],t.profileCompatibility=e[2],t.AVCLevelIndication=e[3],t.codec=hm([e[1],e[2],e[3]]),t.lengthSizeMinusOne=e[4]&3,t.spsLength=e[5]&31,t.sps=[];for(var r=6,o=0;o<t.spsLength;o++){var a=Fe(e,r);r+=2,t.sps.push(e.subarray(r,r+a)),r+=a}t.ppsLength=e[r],r+=1,t.pps=[];for(var u=0;u<t.ppsLength;u++){var l=Fe(e,r);r+=2,t.pps.push(e.subarray(r,r+=l)),r+=l}})}},{key:"hvc1",value:function(i){return ye(i,!1,function(t,e,r){var o=Su(t,e),a=e.subarray(o);r+=o,t.hvcC=n.hvcC(n.findBox(a,["hvcC"],r)[0]),t.pasp=n.pasp(n.findBox(a,["pasp"],r)[0])})}},{key:"hvcC",value:function(i){return ye(i,!1,function(t,e){t.data=i.data,t.codec="hev1.1.6.L93.B0",t.configurationVersion=e[0];var r=e[1];t.generalProfileSpace=r>>6,t.generalTierFlag=(r&32)>>5,t.generalProfileIdc=r&31,t.generalProfileCompatibility=Q(e,2),t.generalConstraintIndicatorFlags=e.subarray(6,12),t.generalLevelIdc=e[12],t.avgFrameRate=Fe(e,19),t.numOfArrays=e[22],t.vps=[],t.sps=[],t.pps=[];for(var o=23,a=0,u=0,l=0,c=0;c<t.numOfArrays;c++){a=e[o]&63,u=Fe(e,o+1),o+=3;for(var f=[],h=0;h<u;h++)l=Fe(e,o),o+=2,f.push(e.subarray(o,o+l)),o+=l;if(a===32){var d;(d=t.vps).push.apply(d,f)}else if(a===33){var g;(g=t.sps).push.apply(g,f)}else if(a===34){var v;(v=t.pps).push.apply(v,f)}}})}},{key:"pasp",value:function(i){return ye(i,!1,function(t,e){t.hSpacing=Q(e),t.vSpacing=Q(e,4)})}},{key:"mp4a",value:function(i){return ye(i,!1,function(t,e,r){var o=wu(t,e);t.esds=n.esds(n.findBox(e.subarray(o),["esds"],r+o)[0])})}},{key:"esds",value:function(i){return ye(i,!0,function(t,e){t.codec="mp4a.";for(var r=0,o=0,a=0,u=0;e.length;){for(r=0,u=e[r],o=e[r+1],r+=2;o&128;)a=(o&127)<<7,o=e[r],r+=1;if(a+=o&127,u===3)e=e.subarray(r+3);else if(u===4)t.codec+=(e[r].toString(16)+".").padStart(3,"0"),e=e.subarray(r+13);else if(u===5){var l=t.config=e.subarray(r,r+a),c=(l[0]&248)>>3;c===31&&l.length>=2&&(c=32+((l[0]&7)<<3)+((l[1]&224)>>5)),t.objectType=c,t.codec+=c.toString(16),t.codec[t.codec.length-1]==="."&&(t.codec=t.codec.substring(0,t.codec.length-1));return}else{t.codec[t.codec.length-1]==="."&&(t.codec=t.codec.substring(0,t.codec.length-1));return}}})}},{key:"alaw",value:function(i){return ye(i,!1,function(t,e){wu(t,e)})}},{key:"stts",value:function(i){return ye(i,!0,function(t,e){for(var r=Q(e),o=[],a=4,u=0;u<r;u++)o.push({count:Q(e,a),delta:Q(e,a+4)}),a+=8;t.entryCount=r,t.entries=o})}},{key:"ctts",value:function(i){return ye(i,!0,function(t,e){var r=Q(e),o=[],a=4;if(t.version===1)for(var u=0;u<r;u++)o.push({count:Q(e,a),offset:Q(e,a+4)}),a+=8;else for(var l=0;l<r;l++)o.push({count:Q(e,a),offset:-(~Q(e,a+4)+1)}),a+=8;t.entryCount=r,t.entries=o})}},{key:"stsc",value:function(i){return ye(i,!0,function(t,e){for(var r=Q(e),o=[],a=4,u=0;u<r;u++)o.push({firstChunk:Q(e,a),samplesPerChunk:Q(e,a+4),sampleDescriptionIndex:Q(e,a+8)}),a+=12;t.entryCount=r,t.entries=o})}},{key:"stsz",value:function(i){return ye(i,!0,function(t,e){var r=Q(e),o=Q(e,4),a=[];if(!r)for(var u=8,l=0;l<o;l++)a.push(Q(e,u)),u+=4;t.sampleSize=r,t.sampleCount=o,t.entrySizes=a})}},{key:"stco",value:function(i){return ye(i,!0,function(t,e){for(var r=Q(e),o=[],a=4,u=0;u<r;u++)o.push(Q(e,a)),a+=4;t.entryCount=r,t.entries=o})}},{key:"co64",value:function(i){return ye(i,!0,function(t,e){for(var r=Q(e),o=[],a=4,u=0;u<r;u++)o.push(pi(e,a)),a+=8;t.entryCount=r,t.entries=o})}},{key:"stss",value:function(i){return ye(i,!0,function(t,e){for(var r=Q(e),o=[],a=4,u=0;u<r;u++)o.push(Q(e,a)),a+=4;t.entryCount=r,t.entries=o})}},{key:"moof",value:function(i){return ye(i,!1,function(t,e,r){t.mfhd=n.mfhd(n.findBox(e,["mfhd"],r)[0]),t.traf=n.findBox(e,["traf"],r).map(function(o){return n.traf(o)})})}},{key:"mfhd",value:function(i){return ye(i,!0,function(t,e){t.sequenceNumber=Q(e)})}},{key:"traf",value:function(i){return ye(i,!1,function(t,e,r){t.tfhd=n.tfhd(n.findBox(e,["tfhd"],r)[0]),t.tfdt=n.tfdt(n.findBox(e,["tfdt"],r)[0]),t.trun=n.trun(n.findBox(e,["trun"],r)[0])})}},{key:"trun",value:function(i){return ye(i,!0,function(t,e){var r=t.version,o=t.flags,a=e.length,u=t.sampleCount=Q(e),l=4;if(a>l&&o&1&&(t.dataOffset=-(~Q(e,l)+1),l+=4),a>l&&o&4&&(t.firstSampleFlags=Q(e,l),l+=4),t.samples=[],a>l)for(var c,f=0;f<u;f++)c={},o&256&&(c.duration=Q(e,l),l+=4),o&512&&(c.size=Q(e,l),l+=4),o&1024&&(c.flags=Q(e,l),l+=4),o&2048&&(r?c.cts=-(~Q(e,l+4)+1):c.cts=Q(e,l),l+=4),t.samples.push(c)})}},{key:"tfdt",value:function(i){return ye(i,!0,function(t,e){t.version===1?t.baseMediaDecodeTime=pi(e):t.baseMediaDecodeTime=Q(e)})}},{key:"probe",value:function(i){return!!n.findBox(i,["ftyp"])}},{key:"parseSampleFlags",value:function(i){return{isLeading:(i[0]&12)>>>2,dependsOn:i[0]&3,isDependedOn:(i[1]&192)>>>6,hasRedundancy:(i[1]&48)>>>4,paddingValue:(i[1]&14)>>>1,isNonSyncSample:i[1]&1,degradationPriority:i[2]<<8|i[3]}}},{key:"moovToTrack",value:function(i,t,e){var r,o,a=i.trak;if(!(!a||!a.length)){var u=a.find(function(L){var B,$;return((B=L.mdia)===null||B===void 0||($=B.hdlr)===null||$===void 0?void 0:$.handlerType)==="vide"}),l=a.find(function(L){var B,$;return((B=L.mdia)===null||B===void 0||($=B.hdlr)===null||$===void 0?void 0:$.handlerType)==="soun"});if(u&&t){var c,f,h,d,g,v,m,S=t,w=(c=u.tkhd)===null||c===void 0?void 0:c.trackId;w!=null&&(S.id=u.tkhd.trackId),S.tkhdDuration=u.tkhd.duration,S.mvhdDurtion=i.mvhd.duration,S.mvhdTimecale=i.mvhd.timescale,S.timescale=S.formatTimescale=u.mdia.mdhd.timescale,S.duration=u.mdia.mdhd.duration||S.mvhdDurtion/S.mvhdTimecale*S.timescale;var _=u.mdia.minf.stbl.stsd.entries[0];if(S.width=_.width,S.height=_.height,_.pasp&&(S.sarRatio=[_.pasp.hSpacing,_.pasp.vSpacing]),_.hvcC)S.codecType=Mr.HEVC,S.codec=_.hvcC.codec,S.vps=_.hvcC.vps,S.sps=_.hvcC.sps,S.pps=_.hvcC.pps,S.hvcC=_.hvcC.data;else if(_.avcC)S.codec=_.avcC.codec,S.sps=_.avcC.sps,S.pps=_.avcC.pps;else throw new Error("unknown video stsd entry");if(S.present=!0,S.ext={},S.ext.stss=(f=u.mdia)===null||f===void 0||(h=f.minf)===null||h===void 0||(d=h.stbl)===null||d===void 0?void 0:d.stss,S.ext.ctts=(g=u.mdia)===null||g===void 0||(v=g.minf)===null||v===void 0||(m=v.stbl)===null||m===void 0?void 0:m.ctts,_&&_.type==="encv"){var P,I,j,O,Z,te,F,re;S.isVideoEncryption=!0,_.default_KID=(P=_.sinf)===null||P===void 0||(I=P.schi)===null||I===void 0?void 0:I.tenc.default_KID,_.default_IsEncrypted=(j=_.sinf)===null||j===void 0||(O=j.schi)===null||O===void 0?void 0:O.tenc.default_IsEncrypted,_.default_IV_size=(Z=_.sinf)===null||Z===void 0||(te=Z.schi)===null||te===void 0?void 0:te.tenc.default_IV_size,S.videoSenc=u.mdia.minf.stbl.senc&&u.mdia.minf.stbl.senc.samples,_.data_format=(F=_.sinf)===null||F===void 0||(re=F.frma)===null||re===void 0?void 0:re.data_format,S.useEME=i.useEME,S.kidValue=i.kidValue,S.pssh=i.pssh,S.encv=_}}if(l&&e){var E,b,C,N,k,M,G,ce,he,K=e,me=(E=l.tkhd)===null||E===void 0?void 0:E.trackId;me!=null&&(K.id=l.tkhd.trackId),K.tkhdDuration=l.tkhd.duration,K.mvhdDurtion=i.mvhd.duration,K.mvhdTimecale=i.mvhd.timescale,K.timescale=K.formatTimescale=l.mdia.mdhd.timescale,K.duration=l.mdia.mdhd.duration||K.mvhdDurtion/K.mvhdTimecale*K.timescale;var ne=l.mdia.minf.stbl.stsd.entries[0];switch(K.sampleSize=ne.sampleSize,K.sampleRate=ne.sampleRate,K.channelCount=ne.channelCount,K.present=!0,ne.type){case"alaw":K.codecType=K.codec=Nr.G711PCMA,K.sampleRate=8e3;break;case"ulaw":K.codecType=K.codec=Nr.G711PCMU,K.sampleRate=8e3;break;default:K.sampleDuration=Pn.getFrameDuration(K.sampleRate,K.timescale),K.sampleRateIndex=Pn.getRateIndexByRate(K.sampleRate),K.objectType=((r=ne.esds)===null||r===void 0?void 0:r.objectType)||2,ne.esds&&(K.config=Array.from(ne.esds.config)),K.codec=((o=ne.esds)===null||o===void 0?void 0:o.codec)||"mp4a.40.2";break}if(K.sampleDuration=Pn.getFrameDuration(K.sampleRate,K.timescale),K.objectType=((b=ne.esds)===null||b===void 0?void 0:b.objectType)||2,ne.esds&&(ne.esds.config?K.config=Array.from(ne.esds.config):console.warn("esds config is null")),K.codec=((C=ne.esds)===null||C===void 0?void 0:C.codec)||"mp4a.40.2",K.sampleRateIndex=Pn.getRateIndexByRate(K.sampleRate),K.ext={},K.ext.stss=(N=l.mdia)===null||N===void 0||(k=N.minf)===null||k===void 0||(M=k.stbl)===null||M===void 0?void 0:M.stss,K.ext.ctts=(G=l.mdia)===null||G===void 0||(ce=G.minf)===null||ce===void 0||(he=ce.stbl)===null||he===void 0?void 0:he.ctts,K.present=!0,ne&&ne.type==="enca"){var qe,Ve,Me,A,q,U,ee,we;K.isAudioEncryption=!0,ne.data_format=(qe=ne.sinf)===null||qe===void 0||(Ve=qe.frma)===null||Ve===void 0?void 0:Ve.data_format,ne.default_KID=(Me=ne.sinf)===null||Me===void 0||(A=Me.schi)===null||A===void 0?void 0:A.tenc.default_KID,ne.default_IsEncrypted=(q=ne.sinf)===null||q===void 0||(U=q.schi)===null||U===void 0?void 0:U.tenc.default_IsEncrypted,ne.default_IV_size=(ee=ne.sinf)===null||ee===void 0||(we=ee.schi)===null||we===void 0?void 0:we.tenc.default_IV_size,K.audioSenc=l.mdia.minf.stbl.senc&&l.mdia.minf.stbl.senc.samples,K.useEME=i.useEME,K.kidValue=i.kidValue,K.enca=ne}}if(e&&(e.isVideoEncryption=t?t.isVideoEncryption:!1),t&&(t.isAudioEncryption=e?e.isAudioEncryption:!1),t!=null&&t.encv||e!=null&&e.enca){var Oe,y,T=t==null||(Oe=t.encv)===null||Oe===void 0?void 0:Oe.default_KID,x=e==null||(y=e.enca)===null||y===void 0?void 0:y.default_KID,H=T||x?(T||x).join(""):null;t&&(t.kid=H),e&&(e.kid=H)}return t&&(t.flags=3841),e&&(e.flags=1793),{videoTrack:t,audioTrack:e}}}},{key:"evaluateDefaultDuration",value:function(i,t,e){var r,o=t==null||(r=t.samples)===null||r===void 0?void 0:r.length;if(!o)return 1024;var a=1024*o/t.timescale;return a*i.timescale/e}},{key:"moofToSamples",value:function(i,t,e){var r={};return i.mfhd&&(t&&(t.sequenceNumber=i.mfhd.sequenceNumber),e&&(e.sequenceNumber=i.mfhd.sequenceNumber)),i.traf.forEach(function(o){var a=o.tfhd,u=o.tfdt,l=o.trun;if(!(!a||!l)){u&&(t&&t.id===a.trackId&&(t.baseMediaDecodeTime=u.baseMediaDecodeTime),e&&e.id===a.trackId&&(e.baseMediaDecodeTime=u.baseMediaDecodeTime));var c=a.defaultSampleSize||0,f=a.defaultSampleDuration||n.evaluateDefaultDuration(t,e,l.samples.length||l.sampleCount),h=l.dataOffset||0,d=0,g=-1;if(!l.samples.length&&l.sampleCount){r[a.trackId]=[];for(var v=0;v<l.sampleCount;v++)r[a.trackId].push({offset:h,dts:d,duration:f,size:c}),d+=f,h+=c}else r[a.trackId]=l.samples.map(function(m,S){return m={offset:h,dts:d,pts:d+(m.cts||0),duration:m.duration||f,size:m.size||c,gopId:g,keyframe:S===0||m.flags!==null&&m.flags!==void 0&&(m.flags&65536)>>>0!==65536},m.keyframe&&(g++,m.gopId=g),d+=m.duration,h+=m.size,m})}}),r}},{key:"moovToSamples",value:function(i){var t=i.trak;if(!(!t||!t.length)){var e=t.find(function(F){var re,E;return((re=F.mdia)===null||re===void 0||(E=re.hdlr)===null||E===void 0?void 0:E.handlerType)==="vide"}),r=t.find(function(F){var re,E;return((re=F.mdia)===null||re===void 0||(E=re.hdlr)===null||E===void 0?void 0:E.handlerType)==="soun"});if(!(!e&&!r)){var o,a;if(e){var u,l,c=(u=e.mdia)===null||u===void 0||(l=u.minf)===null||l===void 0?void 0:l.stbl;if(!c)return;var f=c.stts,h=c.stsc,d=c.stsz,g=c.stco,v=c.stss,m=c.ctts;if(!f||!h||!d||!g||!v)return;o=Tu(f,h,d,g,m,v)}if(r){var S,w,_,P=(S=r.mdia)===null||S===void 0||(w=S.minf)===null||w===void 0?void 0:w.stbl;if(!P)return;var I=(_=r.mdia.mdhd)===null||_===void 0?void 0:_.timescale,j=P.stts,O=P.stsc,Z=P.stsz,te=P.stco;if(!I||!j||!O||!Z||!te)return;a=Tu(j,O,Z,te)}return{videoSamples:o,audioSamples:a}}}}}]),n}();function Tu(n,s,i,t,e,r){var o=[],a=e==null?void 0:e.entries,u=s.entries,l=t.entries,c=i.entrySizes,f=r==null?void 0:r.entries,h;f&&(h={},f.forEach(function(O){h[O-1]=!0}));var d;a&&(d=[],a.forEach(function(O){for(var Z=O.count,te=O.offset,F=0;F<Z;F++)d.push(te)}));var g,v=-1,m=0,S=0,w=0,_=0,P=0,I=u[0].samplesPerChunk,j=u[1]?u[1].firstChunk-1:1/0;return n.entries.forEach(function(O){for(var Z=O.count,te=O.delta,F=0;F<Z;F++)g={dts:m,duration:te,size:c[S]||i.sampleSize,offset:l[w]+P,index:S},f&&(g.keyframe=h[S],g.keyframe&&v++,g.gopId=v),d&&S<d.length&&(g.pts=g.dts+d[S]),o.push(g),m+=te,S++,S<I?P+=g.size:(w++,P=0,w>=j&&(_++,j=u[_+1]?u[_+1].firstChunk-1:1/0),I+=u[_].samplesPerChunk)}),o}function Su(n,s){return n.dataReferenceIndex=Fe(s,6),n.width=Fe(s,24),n.height=Fe(s,26),n.horizresolution=Q(s,28),n.vertresolution=Q(s,32),n.frameCount=Fe(s,40),n.depth=Fe(s,74),78}function wu(n,s){return n.dataReferenceIndex=Fe(s,6),n.channelCount=Fe(s,16),n.sampleSize=Fe(s,18),n.sampleRate=Q(s,24)/65536,28}function ye(n,s,i){if(n){if(n.size!==n.data.length)throw new Error("box ".concat(n.type," size !== data.length"));var t={start:n.start,size:n.size,headerSize:n.headerSize,type:n.type};return s&&(t.version=n.data[n.headerSize],t.flags=fm(n.data,n.headerSize+1),t.headerSize+=4),i(t,n.data.subarray(t.headerSize),t.start+t.headerSize),t}}var dm=function(s,i,t){for(var e=String(t),r=i>>0,o=Math.ceil(r/e.length),a=[],u=String(s);o--;)a.push(e);return a.join("").substring(0,r-u.length)+u},xs=function(){for(var s=[],i=arguments.length,t=new Array(i),e=0;e<i;e++)t[e]=arguments[e];return t.forEach(function(r){s.push(dm(Number(r).toString(16),2,0))}),s[0]};function gm(n){for(var s=0,i=arguments.length,t=new Array(i>1?i-1:0),e=1;e<i;e++)t[e-1]=arguments[e];t.forEach(function(a){s+=a.length});var r=new n(s),o=0;return t.forEach(function(a){r.set(a,o),o+=a.length}),r}var Qe=function(){function n(){St(this,n),this.buffer=new Uint8Array(0)}return wt(n,[{key:"write",value:function(){for(var i=this,t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];e.forEach(function(o){o?i.buffer=gm(Uint8Array,i.buffer,o):window.console.warn(o)})}}],[{key:"writeUint16",value:function(i){return new Uint8Array([i>>8&255,i&255])}},{key:"writeUint32",value:function(i){return new Uint8Array([i>>24,i>>16&255,i>>8&255,i&255])}}]),n}(),Cu=Math.pow(2,32)-1,be=function(){function n(){St(this,n)}return wt(n,null,[{key:"box",value:function(i){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];e=e.filter(Boolean);var o=8+e.reduce(function(l,c){return l+c.byteLength},0),a=new Uint8Array(o);a[0]=o>>24&255,a[1]=o>>16&255,a[2]=o>>8&255,a[3]=o&255,a.set(i,4);var u=8;return e.forEach(function(l){a.set(l,u),u+=l.byteLength}),a}},{key:"ftyp",value:function(i){var t=i.find(function(e){return e.type===cn.VIDEO&&e.codecType===Mr.HEVC});return t?n.FTYPHEV1:n.FTYPAVC1}},{key:"initSegment",value:function(i){var t=n.ftyp(i),e=Jt(t,n.moov(i));return e}},{key:"pssh",value:function(i){var t=new Uint8Array([1,0,0,0].concat([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75],[0,0,0,1],Eu(i.kid),[0,0,0,0]));return n.box(n.types.pssh,t)}},{key:"moov",value:function(i){if(i[0].useEME&&(i[0].encv||i[0].enca)){i[0].pssh||(i[0].pssh={kid:i[0].kid});var t=this.pssh(i[0].pssh);return n.box.apply(n,[n.types.moov,n.mvhd(i[0].mvhdDurtion||i[0].duration,i[0].mvhdTimecale||i[0].timescale),n.mvex(i)].concat(Et(i.map(function(e){return n.trak(e)})),[t]))}else return n.box.apply(n,[n.types.moov,n.mvhd(i[0].mvhdDurtion||i[0].duration,i[0].mvhdTimecale||i[0].timescale)].concat(Et(i.map(function(e){return n.trak(e)})),[n.mvex(i)]))}},{key:"mvhd",value:function(i){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:9e4,e=n.box(n.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,t>>24&255,t>>16&255,t>>8&255,t&255,i>>24&255,i>>16&255,i>>8&255,i&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]));return e}},{key:"trak",value:function(i){var t=n.box(n.types.trak,n.tkhd(i.id,i.tkhdDuration||0,i.width,i.height),n.mdia(i));return t}},{key:"tkhd",value:function(i,t){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n.box(n.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,i>>24&255,i>>16&255,i>>8&255,i&255,0,0,0,0,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,e>>8&255,e&255,0,0,r>>8&255,r&255,0,0]));return o}},{key:"mdia",value:function(i){var t=n.box(n.types.mdia,n.mdhd(i.duration,i.timescale),n.hdlr(i.type),n.minf(i));return t}},{key:"mdhd",value:function(i){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:9e4,e=n.box(n.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,t>>24&255,t>>16&255,t>>8&255,t&255,i>>24&255,i>>16&255,i>>8&255,i&255,85,196,0,0]));return e}},{key:"hdlr",value:function(i){var t=n.box(n.types.hdlr,n.HDLR_TYPES[i]);return t}},{key:"minf",value:function(i){var t=n.box(n.types.minf,i.type===cn.VIDEO?n.VMHD:n.SMHD,n.DINF,n.stbl(i));return t}},{key:"stbl",value:function(i){var t=[];i&&i.ext&&i.ext.stss&&t.push(n.stss(i.ext.stss.entries));var e=n.box(n.types.stbl,n.stsd(i),n.STTS,t[0],n.STSC,n.STSZ,n.STCO);return e}},{key:"stsd",value:function(i){var t;i.type==="audio"?i.useEME&&i.enca?t=n.enca(i):t=n.mp4a(i):i.useEME&&i.encv?t=n.encv(i):t=n.avc1hev1(i);var e=n.box(n.types.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),t);return e}},{key:"enca",value:function(i){var t=i.enca.channelCount,e=i.enca.sampleRate,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t,0,16,0,0,0,0,e>>8&255,e&255,0,0]),o=n.esds(i.config),a=n.sinf(i.enca);return n.box(n.types.enca,r,o,a)}},{key:"encv",value:function(i){var t,e,r=i.sps.length>0?i.sps[0]:[],o=i.pps.length>0?i.pps[0]:[],a=i.width,u=i.height,l=i.sarRatio[0],c=i.sarRatio[1],f=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,a>>8&255,a&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),h=new Uint8Array((t=(e=[1,r[1],r[2],r[3],255,225,r.length>>>8&255,r.length&255]).concat.apply(e,Et(r)).concat([1,o.length>>>8&255,o.length&255])).concat.apply(t,Et(o))),d=new Uint8Array([0,0,88,57,0,15,200,192,0,4,86,72]),g=n.sinf(i.encv),v=new Uint8Array([l>>24,l>>16&255,l>>8&255,l&255,c>>24,c>>16&255,c>>8&255,c&255]);return n.box(n.types.encv,f,n.box(n.types.avcC,h),n.box(n.types.btrt,d),g,n.box(n.types.pasp,v))}},{key:"schi",value:function(i){var t=new Uint8Array([]),e=n.tenc(i);return n.box(n.types.schi,t,e)}},{key:"tenc",value:function(i){var t=new Uint8Array([0,0,0,0,0,0,i.default_IsEncrypted&255,i.default_IV_size&255].concat(Eu(i.default_KID)));return n.box(n.types.tenc,t)}},{key:"sinf",value:function(i){var t=new Uint8Array([]),e=new Uint8Array([i.data_format.charCodeAt(0),i.data_format.charCodeAt(1),i.data_format.charCodeAt(2),i.data_format.charCodeAt(3)]),r=new Uint8Array([0,0,0,0,99,101,110,99,0,1,0,0]),o=n.schi(i);return n.box(n.types.sinf,t,n.box(n.types.frma,e),n.box(n.types.schm,r),o)}},{key:"avc1hev1",value:function(i){var t=i.codecType===Mr.HEVC,e=t?n.types.hvc1:n.types.avc1,r=t?n.hvcC(i):n.avcC(i),o=[new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,i.width>>8&255,i.width&255,i.height>>8&255,i.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),r];return t?o.push(n.box(n.types.fiel,new Uint8Array([1,0]))):i.sarRatio&&i.sarRatio.length>1&&o.push(n.pasp(i.sarRatio)),n.box.apply(n,[e].concat(o))}},{key:"avcC",value:function(i){var t,e,r=[],o=[],a;return i.sps.forEach(function(u){a=u.byteLength,r.push(a>>>8&255),r.push(a&255),r.push.apply(r,Et(u))}),i.pps.forEach(function(u){a=u.byteLength,o.push(a>>>8&255),o.push(a&255),o.push.apply(o,Et(u))}),n.box(n.types.avcC,new Uint8Array((t=(e=[1,r[3],r[4],r[5],255,224|i.sps.length]).concat.apply(e,r).concat([i.pps.length])).concat.apply(t,o)))}},{key:"hvcC",value:function(i){var t=i.hvcC;if(t instanceof ArrayBuffer||t instanceof Uint8Array)return t;var e=i.vps,r=i.sps,o=i.pps,a;if(t){var u=t.generalProfileCompatibilityFlags,l=t.generalConstraintIndicatorFlags,c=(e.length&&1)+(r.length&&1)+(o.length&&1);a=[1,t.generalProfileSpace<<6|t.generalTierFlag<<5|t.generalProfileIdc,u>>>24,u>>>16,u>>>8,u,l[0],l[1],l[2],l[3],l[4],l[5],t.generalLevelIdc,240,0,252,t.chromaFormatIdc|252,t.bitDepthLumaMinus8|248,t.bitDepthChromaMinus8|248,0,0,t.numTemporalLayers<<3|t.temporalIdNested<<2|3,c];var f=function(d){var g;a.push(d.length>>8,d.length),(g=a).push.apply(g,Et(d))};e.length&&(a.push(160,0,e.length),e.forEach(f)),r.length&&(a.push(161,0,r.length),r.forEach(f)),o.length&&(a.push(162,0,o.length),o.forEach(f))}else a=[1,1,96,0,0,0,144,0,0,0,0,0,93,240,0,252,253,248,248,0,0,15,3,160,0,1,0,24,64,1,12,1,255,255,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,153,152,9,161,0,1,0,45,66,1,1,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,160,2,128,128,45,22,89,153,164,147,43,154,128,128,128,130,0,0,3,0,2,0,0,3,0,50,16,162,0,1,0,7,68,1,193,114,180,98,64];return n.box(n.types.hvcC,new Uint8Array(a))}},{key:"pasp",value:function(i){var t=Qv(i,2),e=t[0],r=t[1];return n.box(n.types.pasp,new Uint8Array([e>>24,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255]))}},{key:"mp4a",value:function(i){return n.box(n.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i.channelCount,0,16,0,0,0,0,i.sampleRate>>8&255,i.sampleRate&255,0,0]),i.config.length?n.esds(i.config):void 0)}},{key:"esds",value:function(i){var t=i.length,e=n.box(n.types.esds,new Uint8Array([0,0,0,0,3,23+t,0,0,0,4,15+t,64,21,0,6,0,0,0,218,192,0,0,218,192,5].concat([t]).concat(i).concat([6,1,2])));return e}},{key:"mvex",value:function(i){var t=n.box.apply(n,[n.types.mvex].concat(Et(i.map(function(e){return n.trex(e.id)}))));return t}},{key:"trex",value:function(i){var t=n.box(n.types.trex,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]));return t}},{key:"trex1",value:function(i){var t=n.box(n.types.trex,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255,0,0,0,1,0,0,2,0,0,0,0,0,0,1,0,0]));return t}},{key:"trex2",value:function(i){var t=n.box(n.types.trex,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255,0,0,0,1,0,0,4,0,0,0,0,0,2,0,0,0]));return t}},{key:"moof",value:function(i){var t=n.box.apply(n,[n.types.moof,n.mfhd(i[0].samples?i[0].samples[0].gopId:0)].concat(Et(i.map(function(e){return n.traf(e)}))));return t}},{key:"mfhd",value:function(i){var t=n.box(n.types.mfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255]));return t}},{key:"traf",value:function(i){var t=n.tfhd(i.id),e=n.tfdt(i,i.baseMediaDecodeTime),r=0,o;if(i.isVideo&&i.videoSenc&&(o=i.videoSenc,o.forEach(function(b){r=r+8,b.subsamples&&b.subsamples.length&&(r=r+2,r=r+b.subsamples.length*6)})),i.videoSencLength=r,!i.useEME||!i.isVideoEncryption&&!i.isAudioEncryption){var a=n.sdtp(i),u=76;return n.box(n.types.traf,t,e,a,n.trun(i.samples,a.byteLength+u))}else if(i.isVideoEncryption)if(i.isVideo){var l=n.saiz(i),c=n.saio(i),f=n.trun1(i),h=n.senc(i),d=n.box(n.types.traf,t,e,l,c,f,h);return d}else if(i.isAudioEncryption){var m=n.sbgp(),S=n.saiz(i),w=n.saio(i),_=n.senc(i),P=n.trun1(i),I=n.box(n.types.traf,t,e,m,S,w,_,P);return I}else{var g=n.sbgp(),v=n.trun1(i);return n.box(n.types.traf,t,e,g,v)}else if(i.isVideo){var j=n.trun1(i);return n.box(n.types.traf,t,e,j)}else{var O=n.sbgp(),Z=n.saiz(i),te=n.saio(i),F=n.senc(i),re=n.trun1(i),E=n.box(n.types.traf,t,e,O,Z,te,F,re);return E}}},{key:"sdtp",value:function(i){var t=new Qe;return i.samples.forEach(function(e){t.write(new Uint8Array(i.isVideo?[e.keyframe?32:16]:[16]))}),n.box(n.types.sdtp,this.extension(0,0),t.buffer)}},{key:"trun1",value:function(i){var t=new Qe,e=Qe.writeUint32(i.samples.length),r=null;if(i.isVideo){var o=i.videoSencLength;r=Qe.writeUint32(i.samples.length*16+o+149),!i.isVideoEncryption&&i.isAudioEncryption&&(r=Qe.writeUint32(i.samples.length*16+92))}else{var a=i.samples.length*12+124;i.isAudioEncryption&&(a=i.samples.length*12+8*i.audioSenc.length+177),r=Qe.writeUint32(a)}return i.samples.forEach(function(u){t.write(Qe.writeUint32(u.duration)),t.write(Qe.writeUint32(u.size)),t.write(Qe.writeUint32(u.keyframe?33554432:65536)),i.isVideo&&t.write(Qe.writeUint32(u.cts?u.cts:0))}),n.box(n.types.trun,this.extension(0,i.flags),e,r,t.buffer)}},{key:"senc",value:function(i){var t=new Qe,e=i.samples.length,r=i.isVideo?16:8,o=i.isVideo?2:0,a=[],u=0;return i.isVideo?(a=i.videoSenc,u=i.videoSencLength):a=i.audioSenc,u=u||r*e,t.write(Qe.writeUint32(16+u),n.types.senc,this.extension(0,o)),t.write(Qe.writeUint32(e)),a.forEach(function(l){for(var c=0;c<l.InitializationVector.length;c++)t.write(new Uint8Array([l.InitializationVector[c]]));l.subsamples&&l.subsamples.length&&(t.write(Qe.writeUint16(l.subsamples.length)),l.subsamples.forEach(function(f){t.write(Qe.writeUint16(f.BytesOfClearData)),t.write(Qe.writeUint32(f.BytesOfProtectedData))}))}),t.buffer}},{key:"saio",value:function(i){var t=i.samples.length*12+141;!i.isVideo&&i.isAudioEncryption&&(t=149);var e=new Uint8Array([1,0,0,0,0,0,0,1,0,0,0,0,t>>24&255,t>>16&255,t>>8&255,t&255]);return n.box(n.types.saio,e)}},{key:"saiz",value:function(i){var t=i.samples.length,e=new Uint8Array([0,0,0,0,16,t>>24&255,t>>16&255,t>>8&255,t&255]);return n.box(n.types.saiz,e)}},{key:"sbgp",value:function(){var i=new Uint8Array([114,111,108,108,0,0,0,1,0,0,1,25,0,0,0,1]);return n.box(n.types.sbgp,this.extension(0,0),i)}},{key:"extension",value:function(i,t){return new Uint8Array([i,t>>16&255,t>>8&255,t&255])}},{key:"tfhd",value:function(i){return n.box(n.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255]))}},{key:"tfdt",value:function(i,t){var e=Math.floor(t/(Cu+1)),r=Math.floor(t%(Cu+1));return i.useEME&&(i.isVideoEncryption||i.isAudioEncryption)?n.box(n.types.tfdt,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,r&255])):n.box(n.types.tfdt,new Uint8Array([1,0,0,0,e>>24,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255]))}},{key:"trun",value:function(i,t){var e=i.length,r=12+16*e;t+=8+r;var o=new Uint8Array(r);o.set([0,0,15,1,e>>>24&255,e>>>16&255,e>>>8&255,e&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0);for(var a=0;a<e;a++){var u=i[a],l=u.duration,c=u.size,f=u.flag,h=f===void 0?{}:f,d=u.cts,g=d===void 0?0:d;o.set([l>>>24&255,l>>>16&255,l>>>8&255,l&255,c>>>24&255,c>>>16&255,c>>>8&255,c&255,h.isLeading<<2|(h.dependsOn===null||h.dependsOn===void 0?1:h.dependsOn),h.isDependedOn<<6|h.hasRedundancy<<4|h.paddingValue<<1|(h.isNonSyncSample===null||h.isNonSyncSample===void 0?1:h.isNonSyncSample),h.degradationPriority&61440,h.degradationPriority&15,g>>>24&255,g>>>16&255,g>>>8&255,g&255],12+16*a)}return n.box(n.types.trun,o)}},{key:"moovMP4",value:function(i){return n.box.apply(n,[n.types.moov,n.mvhd(i[0].duration,i[0].timescale)].concat(Et(i.map(function(t){return n.trackMP4(t)}))))}},{key:"trackMP4",value:function(i){return n.box(n.types.trak,n.tkhd(i.id,i.duration,i.width,i.height),n.mdiaMP4(i))}},{key:"mdiaMP4",value:function(i){return n.box(n.types.mdia,n.mdhd(i.duration,i.timescale),n.hdlr(i.type),n.minfMP4(i))}},{key:"minfMP4",value:function(i){return n.box(n.types.minf,i.type===cn.VIDEO?n.VMHD:n.SMHD,n.DINF,n.stblMP4(i))}},{key:"stblMP4",value:function(i){var t=i.ext,e=[n.stsd(i),n.stts(t.stts),n.stsc(t.stsc),n.stsz(t.stsz),n.stco(t.stco)];return t.stss.length&&e.push(n.stss(t.stss)),t.ctts.length&&e.push(n.ctts(t.ctts)),n.box.apply(n,[n.types.stbl].concat(e))}},{key:"stts",value:function(i){var t=i.length,e=new Uint8Array(8*t),r=0;return i.forEach(function(o){var a=o.value,u=o.count;e.set([u>>24,u>>16&255,u>>8&255,u&255,a>>24,a>>16&255,a>>8&255,a&255],r),r+=8}),n.box(n.types.stts,Jt(new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255]),e))}},{key:"stsc",value:function(i){var t=i.length,e=new Uint8Array(12*t),r=0;return i.forEach(function(o){var a=o.firstChunk,u=o.samplesPerChunk,l=o.sampleDescIndex;e.set([a>>24,a>>16&255,a>>8&255,a&255,u>>24,u>>16&255,u>>8&255,u&255,l>>24,l>>16&255,l>>8&255,l&255],r),r+=12}),n.box(n.types.stsc,Jt(new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255]),e))}},{key:"stsz",value:function(i){var t=i.length,e=new Uint8Array(4*t),r=0;return i.forEach(function(o){e.set([o>>24,o>>16&255,o>>8&255,o&255],r),r+=4}),n.box(n.types.stsz,Jt(new Uint8Array([0,0,0,0,0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255]),e))}},{key:"stco",value:function(i){var t=i.length,e=new Uint8Array(4*t),r=0;return i.forEach(function(o){e.set([o>>24,o>>16&255,o>>8&255,o&255],r),r+=4}),n.box(n.types.stco,Jt(new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255]),e))}},{key:"stss",value:function(i){var t=i.length,e=new Uint8Array(4*t),r=0;return i.forEach(function(o){e.set([o>>24,o>>16&255,o>>8&255,o&255],r),r+=4}),n.box(n.types.stss,Jt(new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255]),e))}},{key:"ctts",value:function(i){var t=i.length,e=new Uint8Array(8*t),r=0;return i.forEach(function(o){var a=o.value,u=o.count;e.set([u>>24,u>>16&255,u>>8&255,u&255,a>>24,a>>16&255,a>>8&255,a&255],r),r+=8}),n.box(n.types.ctts,Jt(new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255]),e))}},{key:"styp",value:function(){return n.box(n.types.styp,new Uint8Array([109,115,100,104,0,0,0,0,109,115,100,104,109,115,105,120]))}},{key:"sidx",value:function(i){var t=i.timescale,e=i.samples[0].duration,r=e*i.samples.length,o=i.samples[0].sampleOffset*e,a=8;i.samples.forEach(function(h){a+=h.size});var u=0;if(i.isVideo){var l=0,c;i.videoSenc&&(c=i.videoSenc),i.isVideo&&c.forEach(function(h){l=l+8,h.subsamples&&h.subsamples.length&&(l=l+2,l=l+h.subsamples.length*6)}),i.videoSencLength=l,u=a+141+i.samples.length*16+l,i.useEME&&i.isAudioEncryption&&!i.isVideoEncryption&&(u=a+i.samples.length*16+84)}else u=a+116+i.samples.length*12,i.useEME&&i.isAudioEncryption&&(u=a+169+i.samples.length*12+8*i.audioSenc.length);var f=new Uint8Array([0,0,0,0,0,0,0,i.id&255,t>>24&255,t>>16&255,t>>8&255,t&255,o>>24&255,o>>16&255,o>>8&255,o&255,0,0,0,0,0,0,0,1,0,u>>16&255,u>>8&255,u&255,r>>24&255,r>>16&255,r>>8&255,r&255,144,0,0,0]);return n.box(n.types.sidx,f)}},{key:"mdat",value:function(i){var t=n.box(n.types.mdat,i);return t}}]),n}();W(be,"types",["avc1","avcC","hvc1","hvcC","dinf","dref","esds","ftyp","hdlr","mdat","mdhd","mdia","mfhd","minf","moof","moov","mp4a","mvex","mvhd","pasp","stbl","stco","stsc","stsd","stsz","stts","tfdt","tfhd","traf","trak","trex","tkhd","vmhd","smhd","ctts","stss","styp","pssh","sidx","sbgp","saiz","saio","senc","trun","encv","enca","sinf","btrt","frma","tenc","schm","schi","mehd","fiel","sdtp"].reduce(function(n,s){return n[s]=[s.charCodeAt(0),s.charCodeAt(1),s.charCodeAt(2),s.charCodeAt(3)],n},Object.create(null)));W(be,"HDLR_TYPES",{video:new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),audio:new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0])});W(be,"FTYPAVC1",be.box(be.types.ftyp,new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49])));W(be,"FTYPHEV1",be.box(be.types.ftyp,new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,104,101,118,49])));W(be,"DINF",be.box(be.types.dinf,be.box(be.types.dref,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]))));W(be,"VMHD",be.box(be.types.vmhd,new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])));W(be,"SMHD",be.box(be.types.smhd,new Uint8Array([0,0,0,0,0,0,0,0])));W(be,"StblTable",new Uint8Array([0,0,0,0,0,0,0,0]));W(be,"STTS",be.box(be.types.stts,be.StblTable));W(be,"STSC",be.box(be.types.stsc,be.StblTable));W(be,"STSZ",be.box(be.types.stsz,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0])));W(be,"STCO",be.box(be.types.stco,be.StblTable));var Wo=function(){function n(s,i){St(this,n),this.name=s||"",this._prefix="[".concat(this.name,"]"),n.disabled=i}return wt(n,[{key:"debug",value:function(){var i;if(!n.disabled){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];(i=console).debug.apply(i,[this._prefix].concat(e))}}},{key:"log",value:function(){var i;if(!n.disabled){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];(i=console).log.apply(i,[this._prefix].concat(e))}}},{key:"warn",value:function(){var i;if(!n.disabled){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];(i=console).warn.apply(i,[this._prefix].concat(e))}}},{key:"error",value:function(){var i;if(!n.disabled){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];(i=console).error.apply(i,[this._prefix].concat(e))}}},{key:"table",value:function(){var i;n.disabled||(console.group(this._prefix),(i=console).table.apply(i,arguments),console.groupEnd())}}],[{key:"enable",value:function(){n.disabled=!1}},{key:"disable",value:function(){n.disabled=!0}}]),n}();W(Wo,"disabled",!0);var pm=function(){function n(s,i,t){St(this,n),this.videoTrack=s,this.audioTrack=i;var e=/Chrome\/([^.]+)/.exec(navigator.userAgent);this.forceFirstIDR=e&&Number(e[1])<50,this.log=new Wo("FMP4Remuxer",t&&t.openLog?!t.openLog:!0)}return wt(n,[{key:"remux",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=this.videoTrack,r=this.audioTrack,o=e.exist(),a=r.exist(),u,l,c,f=[];i&&(t&&t.initMerge?(o&&f.push(this.videoTrack),a&&f.push(this.audioTrack),c=be.initSegment(f)):(o&&(u=be.initSegment([this.videoTrack])),a&&(l=be.initSegment([this.audioTrack]))));var h,d;return o&&e.hasSample()&&(h=this._remuxVideo()),a&&r.hasSample()&&(d=this._remuxAudio()),e.samples=[],r.samples=[],{initSegment:c,videoInitSegment:u,audioInitSegment:l,videoSegment:h,audioSegment:d}}},{key:"_remuxVideo",value:function(){var i=this.videoTrack;this.forceFirstIDR&&(i.samples[0].flag={dependsOn:2,isNonSyncSample:0});var t=i.samples,e=0;t.forEach(function(g){e+=g.units.reduce(function(v,m){return v+m.byteLength},0),e+=g.units.length*4});for(var r=new Uint8Array(e),o=new DataView(r.buffer),a=function(v,m){m=t[u];var S=0;m.units.forEach(function(w){o.setUint32(v,w.byteLength),v+=4,r.set(w,v),v+=w.byteLength,S+=4+w.byteLength}),m.size=S,c=v,f=m},u=0,l=t.length,c=0,f;u<l;u++)a(c,f);var h=be.mdat(r),d=be.moof([i]);return Jt(d,h)}},{key:"_remuxAudio",value:function(){var i=this.audioTrack,t=new Uint8Array(i.samples.reduce(function(o,a){return o+a.size},0));i.samples.reduce(function(o,a){return t.set(a.data,o),o+a.size},0);var e=be.mdat(t),r=be.moof([i]);return Jt(r,e)}},{key:"reset",value:function(){this.videoTrack.reset(),this.audioTrack.reset()}}]),n}(),ku=20,vm=function(){function n(s,i,t,e){var r=this;St(this,n),W(this,"_videoSamples",[]),W(this,"_audioSamples",[]),W(this,"_lastRemainBuffer",[]),W(this,"_lastRemainBufferStartPos",0),this.videoTrack=new sm,this.audioTrack=new om,this.metadataTrack=t||new am,this.log=new Wo("MP4Demuxer",e&&e.openLog?!e.openLog:!0),s&&s.forEach(function(o){var a;(a=r._videoSamples).push.apply(a,Et(o.frames))}),i&&i.forEach(function(o){var a;(a=r._audioSamples).push.apply(a,Et(o.frames))})}return wt(n,[{key:"parseSamples",value:function(i){if(!i)throw new Error("moov is required");if(!this.videoTrack.codec&&!this.audioTrack.codec&&(Rt.moovToTrack(i,this.videoTrack,this.audioTrack),this.videoSenc=this.videoTrack.videoSenc,this.audioSenc=this.audioTrack.audioSenc),!this._audioSamples.length&&!this._videoSamples.length){var t=Rt.moovToSamples(i);if(!t)throw new Error("cannot parse samples from moov box");this._videoSamples=t.videoSamples||[],this._audioSamples=t.audioSamples||[]}}},{key:"demux",value:function(i,t,e,r,o){this.parseSamples(o);var a=this.videoTrack,u=this.audioTrack;a.samples=[],u.samples=[];var l,c,f;if(e){for(var h,d=0,g=e[0],v=e[1];g<=v;g++){if(l=this._videoSamples[g],!l)throw new Error("cannot found video frame #".concat(g));f=l.offset-t,c=i.subarray(f,f+l.size),h=new _u(l.pts||l.dts,l.dts),h.duration=l.duration,h.gopId=l.gopId,l.keyframe&&h.setToKeyframe();for(var m=0,S=c.length-1;m<S;)d=Q(c,m),m+=4,h.units.push(c.subarray(m,m+d)),m+=d;a.samples.push(h)}a.baseMediaDecodeTime=a.samples[0].dts}if(r){for(var w=r[0],_=r[1];w<=_;w++){if(l=this._audioSamples[w],!l)throw new Error("cannot found video frame #".concat(w));f=l.offset-t,c=i.subarray(f,f+l.size),u.samples.push(new bu(l.dts,c,l.duration))}u.baseMediaDecodeTime=u.samples[0].dts}return{videoTrack:a,audioTrack:u,metadataTrack:this.metadataTrack}}},{key:"demuxPart",value:function(i,t,e,r,o,a,u,l){if(this.parseSamples(o),this.videoTrack.useEME=a,this.audioTrack.useEME=a,this._lastRemainBuffer&&this._lastRemainBuffer.byteLength>0&&t>this._lastRemainBufferStartPos&&t<=this._lastRemainBufferStartPos+this._lastRemainBuffer.byteLength)for(var c=0;c<ku;)try{var f=this._lastRemainBuffer.subarray(0,t-this._lastRemainBufferStartPos),h=new Uint8Array(i.byteLength+f.byteLength);h.set(f,0),h.set(new Uint8Array(i),f.byteLength),i=h,t-=f.byteLength,this._lastRemainBuffer=null,this._lastRemainBufferStartPos=0;break}catch(b){if(c<ku)c++;else throw new Error("new Uint8Array error:,"+b.errorMessage)}var d=this.videoTrack,g=this.audioTrack;d.samples=[],g.samples=[],d.videoSenc=null,g.audioSenc=null;var v,m,S,w=0,_=0;if(this._videoSamples.length>0&&e.length>0){for(var P,I=i.byteLength+t,j=e[0];j<=e[1];j++){if(v=this._videoSamples[j],!v)throw new Error("cannot found video frame #".concat(j));v.offset>=t&&v.offset+v.size<=I&&(S=v.offset-t,w=S+v.size,m=i.subarray(S,w),P=new _u(v.pts||v.dts,v.dts),P.duration=v.duration,P.gopId=v.gopId,P.sampleOffset=v.index,v.keyframe&&P.setToKeyframe(),P.data=m,P.size=v.size,d.samples.push(P))}d.samples.length>0&&(d.gopId=d.samples[0].gopId,d.baseMediaDecodeTime=d.samples[0].dts,d.startPts=d.samples[0].pts/d.timescale,d.endPts=d.samples[d.samples.length-1].pts/d.timescale,this.videoSenc&&(d.videoSenc=this.videoSenc.slice(d.samples[0].sampleOffset,d.samples[0].sampleOffset+d.samples.length),d.kidValue=u))}if(this._audioSamples.length>0&&r.length>0){for(var O=r[0];O<=r[1];O++){if(v=this._audioSamples[O],!v)throw new Error("cannot found video frame #".concat(O));v.offset>=t&&v.offset+v.size<=i.byteLength+t&&(S=v.offset-t,_=S+v.size,m=i.subarray(S,_),g.samples.push(new bu(v.dts,m,v.duration,v.index)))}g.samples.length>0&&(g.gopId=g.samples[0].gopId||d.gopId,g.baseMediaDecodeTime=g.samples[0].dts,g.startPts=g.samples[0].pts/g.timescale,g.endPts=g.samples[g.samples.length-1].pts/g.timescale,this.audioSenc&&(g.audioSenc=this.audioSenc.slice(g.samples[0].sampleOffset,g.samples[0].sampleOffset+g.samples.length),g.kidValue=u))}this.decoderData(d,g,l);for(var Z=0,te=0;te<d.samples.length;te++)for(var F=0,re=d.samples[te].data,E=re.length-1;F<E;)Z=Q(re,F),F+=4,d.samples[te].units.push(re.subarray(F,F+Z)),F+=Z;return this._lastRemainBuffer=i.subarray(Math.max(w,_)),this._lastRemainBuffer.byteLength>0?this._lastRemainBufferStartPos=t+i.byteLength-this._lastRemainBuffer.byteLength:this._lastRemainBufferStartPos=0,{videoTrack:d,audioTrack:g,metadataTrack:this.metadataTrack}}},{key:"reset",value:function(){this._videoSamples=[],this._audioSamples=[],this._lastRemainBuffer=null,this._lastRemainBufferStartPos=0,this.videoTrack.reset(),this.audioTrack.reset(),this.metadataTrack.reset()}},{key:"decoderData",value:function(i,t,e){i.useEME||t.useEME}}],[{key:"probe",value:function(i){return Rt.probe(i)}}]),n}(),Gc="3.0.0-alpha.34";function Pu(n,s){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);s&&(t=t.filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),i.push.apply(i,t)}return i}function eo(n){for(var s=1;s<arguments.length;s++){var i=arguments[s]!=null?arguments[s]:{};s%2?Pu(Object(i),!0).forEach(function(t){Y(n,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Pu(Object(i)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(i,t))})}return n}function Ge(){Ge=function(){return n};var n={},s=Object.prototype,i=s.hasOwnProperty,t=Object.defineProperty||function(E,b,C){E[b]=C.value},e=typeof Symbol=="function"?Symbol:{},r=e.iterator||"@@iterator",o=e.asyncIterator||"@@asyncIterator",a=e.toStringTag||"@@toStringTag";function u(E,b,C){return Object.defineProperty(E,b,{value:C,enumerable:!0,configurable:!0,writable:!0}),E[b]}try{u({},"")}catch{u=function(b,C,N){return b[C]=N}}function l(E,b,C,N){var k=b&&b.prototype instanceof h?b:h,M=Object.create(k.prototype),G=new te(N||[]);return t(M,"_invoke",{value:I(E,C,G)}),M}function c(E,b,C){try{return{type:"normal",arg:E.call(b,C)}}catch(N){return{type:"throw",arg:N}}}n.wrap=l;var f={};function h(){}function d(){}function g(){}var v={};u(v,r,function(){return this});var m=Object.getPrototypeOf,S=m&&m(m(F([])));S&&S!==s&&i.call(S,r)&&(v=S);var w=g.prototype=h.prototype=Object.create(v);function _(E){["next","throw","return"].forEach(function(b){u(E,b,function(C){return this._invoke(b,C)})})}function P(E,b){function C(k,M,G,ce){var he=c(E[k],E,M);if(he.type!=="throw"){var K=he.arg,me=K.value;return me&&typeof me=="object"&&i.call(me,"__await")?b.resolve(me.__await).then(function(ne){C("next",ne,G,ce)},function(ne){C("throw",ne,G,ce)}):b.resolve(me).then(function(ne){K.value=ne,G(K)},function(ne){return C("throw",ne,G,ce)})}ce(he.arg)}var N;t(this,"_invoke",{value:function(k,M){function G(){return new b(function(ce,he){C(k,M,ce,he)})}return N=N?N.then(G,G):G()}})}function I(E,b,C){var N="suspendedStart";return function(k,M){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(k==="throw")throw M;return re()}for(C.method=k,C.arg=M;;){var G=C.delegate;if(G){var ce=j(G,C);if(ce){if(ce===f)continue;return ce}}if(C.method==="next")C.sent=C._sent=C.arg;else if(C.method==="throw"){if(N==="suspendedStart")throw N="completed",C.arg;C.dispatchException(C.arg)}else C.method==="return"&&C.abrupt("return",C.arg);N="executing";var he=c(E,b,C);if(he.type==="normal"){if(N=C.done?"completed":"suspendedYield",he.arg===f)continue;return{value:he.arg,done:C.done}}he.type==="throw"&&(N="completed",C.method="throw",C.arg=he.arg)}}}function j(E,b){var C=b.method,N=E.iterator[C];if(N===void 0)return b.delegate=null,C==="throw"&&E.iterator.return&&(b.method="return",b.arg=void 0,j(E,b),b.method==="throw")||C!=="return"&&(b.method="throw",b.arg=new TypeError("The iterator does not provide a '"+C+"' method")),f;var k=c(N,E.iterator,b.arg);if(k.type==="throw")return b.method="throw",b.arg=k.arg,b.delegate=null,f;var M=k.arg;return M?M.done?(b[E.resultName]=M.value,b.next=E.nextLoc,b.method!=="return"&&(b.method="next",b.arg=void 0),b.delegate=null,f):M:(b.method="throw",b.arg=new TypeError("iterator result is not an object"),b.delegate=null,f)}function O(E){var b={tryLoc:E[0]};1 in E&&(b.catchLoc=E[1]),2 in E&&(b.finallyLoc=E[2],b.afterLoc=E[3]),this.tryEntries.push(b)}function Z(E){var b=E.completion||{};b.type="normal",delete b.arg,E.completion=b}function te(E){this.tryEntries=[{tryLoc:"root"}],E.forEach(O,this),this.reset(!0)}function F(E){if(E){var b=E[r];if(b)return b.call(E);if(typeof E.next=="function")return E;if(!isNaN(E.length)){var C=-1,N=function k(){for(;++C<E.length;)if(i.call(E,C))return k.value=E[C],k.done=!1,k;return k.value=void 0,k.done=!0,k};return N.next=N}}return{next:re}}function re(){return{value:void 0,done:!0}}return d.prototype=g,t(w,"constructor",{value:g,configurable:!0}),t(g,"constructor",{value:d,configurable:!0}),d.displayName=u(g,a,"GeneratorFunction"),n.isGeneratorFunction=function(E){var b=typeof E=="function"&&E.constructor;return!!b&&(b===d||(b.displayName||b.name)==="GeneratorFunction")},n.mark=function(E){return Object.setPrototypeOf?Object.setPrototypeOf(E,g):(E.__proto__=g,u(E,a,"GeneratorFunction")),E.prototype=Object.create(w),E},n.awrap=function(E){return{__await:E}},_(P.prototype),u(P.prototype,o,function(){return this}),n.AsyncIterator=P,n.async=function(E,b,C,N,k){k===void 0&&(k=Promise);var M=new P(l(E,b,C,N),k);return n.isGeneratorFunction(b)?M:M.next().then(function(G){return G.done?G.value:M.next()})},_(w),u(w,a,"Generator"),u(w,r,function(){return this}),u(w,"toString",function(){return"[object Generator]"}),n.keys=function(E){var b=Object(E),C=[];for(var N in b)C.push(N);return C.reverse(),function k(){for(;C.length;){var M=C.pop();if(M in b)return k.value=M,k.done=!1,k}return k.done=!0,k}},n.values=F,te.prototype={constructor:te,reset:function(E){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(Z),!E)for(var b in this)b.charAt(0)==="t"&&i.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=void 0)},stop:function(){this.done=!0;var E=this.tryEntries[0].completion;if(E.type==="throw")throw E.arg;return this.rval},dispatchException:function(E){if(this.done)throw E;var b=this;function C(he,K){return M.type="throw",M.arg=E,b.next=he,K&&(b.method="next",b.arg=void 0),!!K}for(var N=this.tryEntries.length-1;N>=0;--N){var k=this.tryEntries[N],M=k.completion;if(k.tryLoc==="root")return C("end");if(k.tryLoc<=this.prev){var G=i.call(k,"catchLoc"),ce=i.call(k,"finallyLoc");if(G&&ce){if(this.prev<k.catchLoc)return C(k.catchLoc,!0);if(this.prev<k.finallyLoc)return C(k.finallyLoc)}else if(G){if(this.prev<k.catchLoc)return C(k.catchLoc,!0)}else{if(!ce)throw new Error("try statement without catch or finally");if(this.prev<k.finallyLoc)return C(k.finallyLoc)}}}},abrupt:function(E,b){for(var C=this.tryEntries.length-1;C>=0;--C){var N=this.tryEntries[C];if(N.tryLoc<=this.prev&&i.call(N,"finallyLoc")&&this.prev<N.finallyLoc){var k=N;break}}k&&(E==="break"||E==="continue")&&k.tryLoc<=b&&b<=k.finallyLoc&&(k=null);var M=k?k.completion:{};return M.type=E,M.arg=b,k?(this.method="next",this.next=k.finallyLoc,f):this.complete(M)},complete:function(E,b){if(E.type==="throw")throw E.arg;return E.type==="break"||E.type==="continue"?this.next=E.arg:E.type==="return"?(this.rval=this.arg=E.arg,this.method="return",this.next="end"):E.type==="normal"&&b&&(this.next=b),f},finish:function(E){for(var b=this.tryEntries.length-1;b>=0;--b){var C=this.tryEntries[b];if(C.finallyLoc===E)return this.complete(C.completion,C.afterLoc),Z(C),f}},catch:function(E){for(var b=this.tryEntries.length-1;b>=0;--b){var C=this.tryEntries[b];if(C.tryLoc===E){var N=C.completion;if(N.type==="throw"){var k=N.arg;Z(C)}return k}}throw new Error("illegal catch attempt")},delegateYield:function(E,b,C){return this.delegate={iterator:F(E),resultName:b,nextLoc:C},this.method==="next"&&(this.arg=void 0),f}},n}function gn(n){"@babel/helpers - typeof";return gn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},gn(n)}function xu(n,s,i,t,e,r,o){try{var a=n[r](o),u=a.value}catch(l){i(l);return}a.done?s(u):Promise.resolve(u).then(t,e)}function oi(n){return function(){var s=this,i=arguments;return new Promise(function(t,e){var r=n.apply(s,i);function o(u){xu(r,t,e,o,a,"next",u)}function a(u){xu(r,t,e,o,a,"throw",u)}o(void 0)})}}function li(n,s){if(!(n instanceof s))throw new TypeError("Cannot call a class as a function")}function Ru(n,s){for(var i=0;i<s.length;i++){var t=s[i];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(n,Yc(t.key),t)}}function ci(n,s,i){return s&&Ru(n.prototype,s),i&&Ru(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n}function Y(n,s,i){return s=Yc(s),s in n?Object.defineProperty(n,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[s]=i,n}function Qn(n,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(s&&s.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),s&&Yn(n,s)}function Ui(n){return Ui=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},Ui(n)}function Yn(n,s){return Yn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Yn(n,s)}function Kc(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vr(n,s,i){return Kc()?vr=Reflect.construct.bind():vr=function(e,r,o){var a=[null];a.push.apply(a,r);var u=Function.bind.apply(e,a),l=new u;return o&&Yn(l,o.prototype),l},vr.apply(null,arguments)}function mm(n){return Function.toString.call(n).indexOf("[native code]")!==-1}function Fr(n){var s=typeof Map=="function"?new Map:void 0;return Fr=function(t){if(t===null||!mm(t))return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(typeof s<"u"){if(s.has(t))return s.get(t);s.set(t,e)}function e(){return vr(t,arguments,Ui(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Yn(e,t)},Fr(n)}function ym(n,s){if(n==null)return{};var i={},t=Object.keys(n),e,r;for(r=0;r<t.length;r++)e=t[r],!(s.indexOf(e)>=0)&&(i[e]=n[e]);return i}function _m(n,s){if(n==null)return{};var i=ym(n,s),t,e;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);for(e=0;e<r.length;e++)t=r[e],!(s.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(n,t)&&(i[t]=n[t])}return i}function le(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function bm(n,s){if(s&&(typeof s=="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return le(n)}function Zn(n){var s=Kc();return function(){var t=Ui(n),e;if(s){var r=Ui(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return bm(this,e)}}function Em(n,s){for(;!Object.prototype.hasOwnProperty.call(n,s)&&(n=Ui(n),n!==null););return n}function mr(){return typeof Reflect<"u"&&Reflect.get?mr=Reflect.get.bind():mr=function(s,i,t){var e=Em(s,i);if(e){var r=Object.getOwnPropertyDescriptor(e,i);return r.get?r.get.call(arguments.length<3?s:t):r.value}},mr.apply(this,arguments)}function Tm(n,s){if(n){if(typeof n=="string")return Iu(n,s);var i=Object.prototype.toString.call(n).slice(8,-1);if(i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set")return Array.from(n);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Iu(n,s)}}function Iu(n,s){(s==null||s>n.length)&&(s=n.length);for(var i=0,t=new Array(s);i<s;i++)t[i]=n[i];return t}function Sm(n,s){var i=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!i){if(Array.isArray(n)||(i=Tm(n))||s){i&&(n=i);var t=0,e=function(){};return{s:e,n:function(){return t>=n.length?{done:!0}:{done:!1,value:n[t++]}},e:function(u){throw u},f:e}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var r=!0,o=!1,a;return{s:function(){i=i.call(n)},n:function(){var u=i.next();return r=u.done,u},e:function(u){o=!0,a=u},f:function(){try{!r&&i.return!=null&&i.return()}finally{if(o)throw a}}}}function wm(n,s){if(typeof n!="object"||n===null)return n;var i=n[Symbol.toPrimitive];if(i!==void 0){var t=i.call(n,s||"default");if(typeof t!="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}function Yc(n){var s=wm(n,"string");return typeof s=="symbol"?s:String(s)}var Sn=function(){function n(){li(this,n)}return ci(n,null,[{key:"start",value:function(i){return!i||!i.length||i.length===1&&i.end(0)-i.start(0)<1e-6||i.length===1&&i.start(0)<0?0:i.start(0)}},{key:"end",value:function(i){return!i||!i.length||i.length===1&&i.end(0)-i.start(0)<1e-6?0:i.end(i.length-1)}},{key:"get",value:function(i){if(i)try{return i.buffered}catch{}}},{key:"buffers",value:function(i,t){if(!i||!i.length)return[];for(var e=[],r=0,o=i.length;r<o;r++){var a=e.length;if(!a||!t)e.push([i.start(r),i.end(r)]);else{var u=e[a-1],l=u[1],c=i.start(r);if(c-l<=t){var f=i.end(r);f>l&&(u[1]=f)}else e.push([i.start(r),i.end(r)])}}return e}},{key:"totalLength",value:function(i){return!i||!i.length?0:i.reduce(function(t,e){return t+=e[1]-e[0]},0)}},{key:"info",value:function(i){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(!i||!i.length)return{start:0,end:0,buffers:[]};for(var r=0,o=0,a=0,u=0,l=0,c=0,f=0,h=n.buffers(i,e),d=0,g=h.length;d<g;d++){var v=h[d];if(t+e>=v[0]&&t<=v[1])r=v[0],o=v[1],a=d;else if(t+e<v[0]){u=v[0],l=v[1];break}else t+e>v[1]&&(c=v[0],f=v[1])}return{start:r,end:o,index:a,buffers:h,nextStart:u,nextEnd:l,prevStart:c,prevEnd:f,currentTime:t,behind:t-r,remaining:o?o-t:0,length:n.totalLength&&n.totalLength(h)}}}]),n}(),Cm=typeof window<"u",at,se={MANIFEST:"manifest",NETWORK:"network",NETWORK_TIMEOUT:"network_timeout",NETWORK_FORBIDDEN:"network_forbidden",NETWORK_NOTFOUND:"network_notfound",NETWROK_RANGE_NOT_SATISFIABLE:"network_range_not_satisfiable",DEMUX:"demux",REMUX:"remux",MEDIA:"media",DRM:"drm",OTHER:"other",RUNTIME:"runtime",SUB_TYPES:{FLV:"FLV",HLS:"HLS",MP4:"MP4",FMP4:"FMP4",MSE_ADD_SB:"MSE_ADD_SB",MSE_APPEND_BUFFER:"MSE_APPEND_BUFFER",MSE_OTHER:"MSE_OTHER",MSE_FULL:"MSE_FULL",OPTION:"OPTION",DASH:"DASH",LICENSE:"LICENSE",CUSTOM_LICENSE:"CUSTOM_LICENSE",MSE_HIJACK:"MSE_HIJACK",EME_HIJACK:"EME_HIJACK",SIDX:"SIDX",NO_CANPLAY_ERROR:"NO_CANPLAY_ERROR",BUFFERBREAK_ERROR:"BUFFERBREAK_ERROR",WAITING_TIMEOUT_ERROR:"WAITING_TIMEOUT_ERROR",MEDIA_ERR_ABORTED:"MEDIA_ERR_ABORTED",MEDIA_ERR_NETWORK:"MEDIA_ERR_NETWORK",MEDIA_ERR_DECODE:"MEDIA_ERR_DECODE",MEDIA_ERR_SRC_NOT_SUPPORTED:"MEDIA_ERR_SRC_NOT_SUPPORTED",MEDIA_ERR_CODEC_NOT_SUPPORTED:"MEDIA_ERR_CODEC_NOT_SUPPORTED",MEDIA_ERR_URL_EMPTY:"MEDIA_ERR_URL_EMPTY"}},je=(at={},Y(at,se.MANIFEST,{HLS:1100,DASH:1200}),Y(at,se.NETWORK,2100),Y(at,se.NETWORK_TIMEOUT,2101),Y(at,se.NETWORK_FORBIDDEN,2103),Y(at,se.NETWORK_NOTFOUND,2104),Y(at,se.NETWROK_RANGE_NOT_SATISFIABLE,2116),Y(at,se.DEMUX,{FLV:3100,HLS:3200,MP4:3300,FMP4:3400,SIDX:3410}),Y(at,se.REMUX,{FMP4:4100,MP4:4200}),Y(at,se.MEDIA,{MEDIA_ERR_ABORTED:5101,MEDIA_ERR_NETWORK:5102,MEDIA_ERR_DECODE:5103,MEDIA_ERR_SRC_NOT_SUPPORTED:5104,MEDIA_ERR_CODEC_NOT_SUPPORTED:5105,MEDIA_ERR_URL_EMPTY:5106,MSE_ADD_SB:5200,MSE_APPEND_BUFFER:5201,MSE_OTHER:5202,MSE_FULL:5203,MSE_HIJACK:5204,EME_HIJACK:5301}),Y(at,se.DRM,{LICENSE:7100,CUSTOM_LICENSE:7200}),Y(at,se.OTHER,8e3),Y(at,se.RUNTIME,{NO_CANPLAY_ERROR:9001,BUFFERBREAK_ERROR:9002,WAITING_TIMEOUT_ERROR:9003}),at),ur=function(n){Qn(i,n);var s=Zn(i);function i(t,e,r,o,a){var u;return li(this,i),u=s.call(this,a||(r==null?void 0:r.message)),u.errorType=t===se.NETWORK_TIMEOUT?se.NETWORK:t,u.originError=r,u.ext=o,u.errorCode=je[t][e]||je[t],u.errorMessage=u.message,u.errorCode||(u.errorType=se.OTHER,u.errorCode=je[u.errorType]),u}return ci(i,null,[{key:"create",value:function(e,r,o,a,u){return e instanceof i?e:(e instanceof Error&&(o=e,e=""),e||(e=se.OTHER),new i(e,r,o,a,u))}},{key:"network",value:function(e){var r;return new i(e!=null&&e.isTimeout?se.NETWORK_TIMEOUT:se.NETWORK,null,e instanceof Error?e:null,{url:e==null?void 0:e.url,response:e==null?void 0:e.response,httpCode:e==null||(r=e.response)===null||r===void 0?void 0:r.status})}}]),i}(Fr(Error)),lr={DEBUG:1,LOG:2,WARN:3,ERROR:4},km=200*1024,Pm=["Boolean","Number","String","Undefined","Null","Date","Object"],pn=function(){function n(s,i){li(this,n),this.name=s||"",this._prefix="[".concat(this.name,"]"),this.logCacheLevel=(i==null?void 0:i.logCacheLevel)||3,this.logMaxSize=(i==null?void 0:i.logMaxSize)||km,this.logSize=0,this.logTextArray=[]}return ci(n,[{key:"debug",value:function(){for(var i,t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.logCache.apply(this,[lr.DEBUG].concat(e)),!n.disabled&&(i=console).debug.apply(i,[this._prefix,wn()].concat(e))}},{key:"log",value:function(){for(var i,t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.logCache.apply(this,[lr.LOG].concat(e)),!n.disabled&&(i=console).log.apply(i,[this._prefix,wn()].concat(e))}},{key:"warn",value:function(){for(var i,t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.logCache.apply(this,[lr.WARN].concat(e)),!n.disabled&&(i=console).warn.apply(i,[this._prefix,wn()].concat(e))}},{key:"error",value:function(){for(var i,t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.logCache.apply(this,[lr.ERROR].concat(e)),!n.disabled&&(i=console).error.apply(i,[this._prefix,wn()].concat(e))}},{key:"logCache",value:function(i){if(!(i<this.logCacheLevel)){var t="";try{for(var e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];var a=r.map(function(l){return $c(l)});t=this._prefix+wn()+JSON.stringify(a)}catch{return}if(i>=this.logCacheLevel&&(this.logSize+=t.length,this.logTextArray.push(t)),this.logSize>this.logMaxSize){var u=this.logTextArray.shift();this.logSize-=u.length}}}},{key:"getLogCache",value:function(){var i=this.logTextArray.join(`
`);return this.reset(),i}},{key:"reset",value:function(){this.logTextArray=[],this.logSize=0}},{key:"table",value:function(){var i;n.disabled||(console.group(this._prefix),(i=console).table.apply(i,arguments),console.groupEnd())}},{key:"setLogLevel",value:function(i){this.logCacheLevel=i}}],[{key:"enable",value:function(){n.disabled=!1}},{key:"disable",value:function(){n.disabled=!0}}]),n}();Y(pn,"disabled",!0);function wn(){return new Date().toLocaleString()}function xm(n){if(gn(n)!=="object")return n;var s=Object.prototype.toString.call(n).slice(8,-1);switch(s){case"Array":case"Uint8Array":case"ArrayBuffer":return s+"["+n.length+"]";case"Object":return"{}";default:return s}}function $c(n,s,i){i||(i=1),s||(s=2);var t={};if(!n||gn(n)!=="object")return n;var e=Object.prototype.toString.call(n).slice(8,-1);if(!Pm.includes(e))return e;if(!(i>s)){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i===s?t[r]=xm(n[r]):gn(n[r])==="object"?t[r]=$c(n[r],s,i+1):t[r]=n[r]);return t}}function rn(){var n,s,i=new Promise(function(t,e){n=t,s=e});return i.used=!1,i.resolve=function(){return i.used=!0,n.apply(void 0,arguments)},i.reject=function(){return i.used=!0,s.apply(void 0,arguments)},i}function en(){try{return parseInt(performance.now(),10)}catch{return new Date().getTime()}}var Rm={stringify:function(s){try{return JSON.stringify(s)}catch{return""}},parse:function(s){try{return JSON.parse(s)}catch{return}}};function Au(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;try{return Cm?n&&typeof ManagedMediaSource<"u"?ManagedMediaSource:window.MediaSource:null}catch{}}function Rs(n){return/ManagedMediaSource/gi.test(Object.prototype.toString.call(n))}function Im(n){var s=[];if(n instanceof TimeRanges)for(var i=0;i<n.length;i++)s.push({start:n.start(i),end:n.end(i)});return s}var cr={APPEND:"appendBuffer",REMOVE:"removeBuffer",UPDATE_DURATION:"updateDuration"},Pt=function(){function n(s,i){var t=this;li(this,n),Y(this,"media",null),Y(this,"mediaSource",null),Y(this,"_openPromise",rn()),Y(this,"_queue",Object.create(null)),Y(this,"_sourceBuffer",Object.create(null)),Y(this,"_mseFullFlag",{}),Y(this,"_st",0),Y(this,"_opst",0),Y(this,"_logger",null),Y(this,"_config",null),Y(this,"_url",null),Y(this,"_onStartStreaming",function(){t._logger.debug("startstreaming")}),Y(this,"_onEndStreaming",function(){t._logger.debug("endstreaming")}),Y(this,"_onSBUpdateEnd",function(e){var r=t._queue[e];if(r){var o=r[0];if((o==null?void 0:o.opName)!==cr.UPDATE_DURATION&&r.shift(),o){var a,u=en()-t._opst;t._logger.debug("UpdateEnd(".concat(e,"/").concat(o.opName,")"),Rm.stringify(Im((a=t._sourceBuffer[e])===null||a===void 0?void 0:a.buffered)),u,o.context),o.promise.resolve({name:o.opName,context:o.context,costtime:u}),t._startQueue(e)}}}),Y(this,"_onSBUpdateError",function(e,r){var o=t._queue[e];if(o){var a=o[0];a&&(t._logger.error("UpdateError",e,a.opName,a.context),a.promise.reject(new ur(se.MEDIA,se.SUB_TYPES.MSE_APPEND_BUFFER,r)))}}),this._config=Object.assign(n.getDefaultConfig(),i),s&&this.bindMedia(s),this._logger=new pn("MSE"),this._config.openLog&&pn.enable()}return ci(n,[{key:"isOpened",get:function(){var i;return((i=this.mediaSource)===null||i===void 0?void 0:i.readyState)==="open"}},{key:"hasOpTasks",get:function(){var i=this,t=!1;return Object.keys(this._queue).forEach(function(e){var r=i._queue[e];Array.isArray(r)&&(t||(t=r.length>0))}),t}},{key:"url",get:function(){return this._url}},{key:"duration",get:function(){var i;return((i=this.mediaSource)===null||i===void 0?void 0:i.duration)||-1}},{key:"isEnded",get:function(){return this.mediaSource?this.mediaSource.readyState==="ended":!1}},{key:"streaming",get:function(){return Rs(this.mediaSource)?this.mediaSource.streaming:!0}},{key:"isFull",value:function(i){return i?this._mseFullFlag[i]:this._mseFullFlag[n.VIDEO]}},{key:"updateDuration",value:function(i){var t=this,e=this.mediaSource&&this.mediaSource.duration>i;if(this.mediaSource&&this.mediaSource.duration>i){var r=0;if(Object.keys(this._sourceBuffer).forEach(function(o){try{r=Math.max(t.bufferEnd(o)||0,r)}catch{}}),i<r)return Promise.resolve()}return this._enqueueBlockingOp(function(){if(t.isEnded){t._logger.debug("setDuration but ended");return}t.mediaSource&&(t.mediaSource.duration=i,t._logger.debug("setDuration",i))},cr.UPDATE_DURATION,{isReduceDuration:e})}},{key:"open",value:function(){var i=this;if(this._openPromise.used&&!this.isOpened&&this.mediaSource){var t=this.mediaSource,e=function r(){var o=en()-i._st;i._logger.debug("sourceopen",o),t.removeEventListener("sourceopen",r),i._openPromise.resolve({costtime:o})};t.addEventListener("sourceopen",e),this._openPromise=rn()}return this._openPromise}},{key:"bindMedia",value:function(){var s=oi(Ge().mark(function t(e){var r=this,o,a,u,l;return Ge().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(this.mediaSource||this.media)){f.next=3;break}return f.next=3,this.unbindMedia();case 3:if(o=Au(this._config.preferMMS),!(!e||!o)){f.next=6;break}throw new Error("Param media or MediaSource does not exist");case 6:return this.media=e,a=this.mediaSource=new o,u=Rs(a),this._st=en(),l=function h(){var d=en()-r._st;r._logger.debug("sourceopen"),a.removeEventListener("sourceopen",h),URL.revokeObjectURL(e.src),r._openPromise.resolve({costtime:d})},a.addEventListener("sourceopen",l),u&&(a.addEventListener("startstreaming",this._onStartStreaming),a.addEventListener("endstreaming",this._onEndStreaming)),this._url=URL.createObjectURL(a),e.src=this._url,e.disableRemotePlayback=u,f.abrupt("return",this._openPromise);case 17:case"end":return f.stop()}},t,this)}));function i(t){return s.apply(this,arguments)}return i}()},{key:"unbindMedia",value:function(){var s=oi(Ge().mark(function t(){var e=this,r,o,a;return Ge().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this._openPromise.used||this._openPromise.resolve(),r=this.mediaSource,r){if(Object.keys(this._queue).forEach(function(c){var f=e._queue[c];f&&f.forEach(function(h){var d,g;return(d=h.promise)===null||d===void 0||(g=d.resolve)===null||g===void 0?void 0:g.call(d)})}),o=!!this.media&&this.media.readyState>=1,a=r.readyState==="open",o&&a)try{r.endOfStream()}catch{}Object.keys(this._sourceBuffer).forEach(function(c){try{r.removeSourceBuffer(e._sourceBuffer[c])}catch{}}),Rs(r)&&(r.removeEventListener("startstreaming",this._onStartStreaming),r.removeEventListener("endstreaming",this._onEndStreaming))}if(this.media){this.media.disableRemotePlayback=!1,this.media.removeAttribute("src");try{this.media.load()}catch{}this.media=null}this.mediaSource=null,this._openPromise=rn(),this._queue=Object.create(null),this._sourceBuffer=Object.create(null);case 8:case"end":return l.stop()}},t,this)}));function i(){return s.apply(this,arguments)}return i}()},{key:"createSource",value:function(i,t){if(!(this._sourceBuffer[i]||!this.mediaSource)){var e;try{e=this._sourceBuffer[i]=this.mediaSource.addSourceBuffer(t)}catch(r){throw new ur(se.MEDIA,se.SUB_TYPES.MSE_ADD_SB,r)}e.mimeType=t,e.addEventListener("updateend",this._onSBUpdateEnd.bind(this,i)),e.addEventListener("error",this._onSBUpdateError.bind(this,i))}}},{key:"changeType",value:function(i,t){var e=this,r=this._sourceBuffer[i];return!this.mediaSource||!r||r.mimeType===t?Promise.resolve():typeof r.changeType!="function"?Promise.reject():this._enqueueOp(i,function(){r.changeType(t),r.mimeType=t,e._onSBUpdateEnd(i)},"changeType",{mimeType:t})}},{key:"createOrChangeSource",value:function(i,t){return this.createSource(i,t),this.changeType(i,t)}},{key:"append",value:function(i,t,e){var r=this;return!t||!t.byteLength||!this._sourceBuffer[i]?Promise.resolve():this._enqueueOp(i,function(){var o;!r.mediaSource||r.media.error||(r._logger.debug("MSE APPEND START",e),r._opst=en(),(o=r._sourceBuffer[i])===null||o===void 0||o.appendBuffer(t))},cr.APPEND,e)}},{key:"remove",value:function(i,t,e,r){var o=this,a=!1;return this._mseFullFlag[i]&&(a=!0),this._enqueueOp(i,function(){if(!(!o.mediaSource||o.media.error)){var u=o._sourceBuffer[i];if(t>=e||!u){o._onSBUpdateEnd(i);return}o._opst=en(),o._logger.debug("MSE REMOVE START",i,t,e,r),u.remove(t,e)}},cr.REMOVE,r,a)}},{key:"clearBuffer",value:function(i,t){var e=this,r;return Object.keys(this._sourceBuffer).forEach(function(o){r=e.remove(o,i,t)}),r||Promise.resolve()}},{key:"clearAllBuffer",value:function(){var i=this,t;return Object.keys(this._sourceBuffer).forEach(function(e){var r=i._sourceBuffer[e];t=i.remove(e,0,Sn.end(Sn.get(r)))}),t}},{key:"clearOpQueues",value:function(i,t){var e;this._logger.debug("MSE clearOpQueue START");var r=this._queue[i];if(t&&r){this._queue[i]=[];return}if(!(!r||!r[i]||r.length<5)){var o=[];r.forEach(function(a){a.context&&a.context.isinit&&o.push(a)}),this._queue[i]=r.slice(0,2),o.length>0&&(e=this._queue[i]).push.apply(e,o)}}},{key:"endOfStream",value:function(i){var t=this;return!this.mediaSource||this.mediaSource.readyState!=="open"?Promise.resolve():this._enqueueBlockingOp(function(){var e=t.mediaSource;!e||e.readyState!=="open"||(t._logger.debug("MSE endOfStream START"),i?e.endOfStream(i):e.endOfStream())},"endOfStream")}},{key:"setLiveSeekableRange",value:function(i,t){var e=this.mediaSource;i<0||t<i||!(e!=null&&e.setLiveSeekableRange)||e.readyState!=="open"||e.setLiveSeekableRange(i,t)}},{key:"getSourceBuffer",value:function(i){return this._sourceBuffer[i]}},{key:"buffered",value:function(i){return Sn.get(this._sourceBuffer[i])}},{key:"bufferStart",value:function(i){return Sn.start(this.buffered(i))}},{key:"bufferEnd",value:function(i){return Sn.end(this.buffered(i))}},{key:"_enqueueOp",value:function(i,t,e,r,o){var a=this;if(!this.mediaSource)return Promise.resolve();var u=this._queue[i]=this._queue[i]||[],l={exec:t,promise:rn(),opName:e,context:r};return o?(u.splice(0,0,l),this._mseFullFlag[i]=!1,this._startQueue(i)):u.push(l),this.isOpened||this.isEnded?u.length===1&&this._startQueue(i):this._openPromise.then(function(){u.length===1&&a._startQueue(i)}),l.promise}},{key:"_enqueueBlockingOp",value:function(){var s=oi(Ge().mark(function t(e,r,o){var a=this,u,l;return Ge().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(this.mediaSource){f.next=2;break}return f.abrupt("return",Promise.resolve());case 2:if(u=Object.keys(this._sourceBuffer),u.length){f.next=5;break}return f.abrupt("return",e());case 5:return l=[],u.forEach(function(h){var d=a._queue[h],g=rn();l.push(g),d.push({exec:function(){g.resolve()},promise:g,opName:r,context:o}),d.length===1&&a._startQueue(h)}),f.abrupt("return",Promise.all(l).then(function(){try{return e()}finally{u.forEach(function(h){var d=a._queue[h],g=a._sourceBuffer[h];d==null||d.shift(),(!g||!g.updating)&&a._startQueue(h)})}}));case 8:case"end":return f.stop()}},t,this)}));function i(t,e,r){return s.apply(this,arguments)}return i}()},{key:"_startQueue",value:function(i){var t=this._queue[i];if(t){var e=t[0];if(e&&!this._mseFullFlag[i])try{e.exec()}catch(r){r&&r.message&&r.message.indexOf("SourceBuffer is full")>=0?(this._mseFullFlag[i]=!0,this._logger.error("[MSE error],  context,",e.context," ,name,",e.opName,",err,SourceBuffer is full"),e.promise.reject(new ur(se.MEDIA,se.SUB_TYPES.MSE_FULL,r))):(this._logger.error(r),e.promise.reject(new ur(se.MEDIA,se.SUB_TYPES.MSE_OTHER,r)),t.shift(),this._startQueue(i))}}}},{key:"setTimeoffset",value:function(i,t,e){var r=this;return this._enqueueOp(i,function(){t<0&&(t+=.001),r._sourceBuffer[i].timestampOffset=t,r._onSBUpdateEnd(i)},"setTimeoffset",e)}},{key:"abort",value:function(i,t){var e=this;return this.isOpened?this._enqueueOp(i,function(){e._sourceBuffer[i].abort(),e._onSBUpdateEnd(i)},"abort",t):Promise.resolve()}}],[{key:"isSupported",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:'video/mp4; codecs="avc1.42E01E,mp4a.40.2"',t=Au();if(!t)return!1;try{return t.isTypeSupported(i)}catch(e){return this._logger.error(i,e),!1}}},{key:"isMMSOnly",value:function(){return typeof ManagedMediaSource<"u"&&typeof MediaSource>"u"}},{key:"getDefaultConfig",value:function(){return{openLog:!1,preferMMS:!1}}}]),n}();Y(Pt,"VIDEO","video");Y(Pt,"AUDIO","audio");var Ai={FETCH:"fetch",XHR:"xhr"},$n={ARRAY_BUFFER:"arraybuffer",TEXT:"text",JSON:"json"},zt=function(n){Qn(i,n);var s=Zn(i);function i(t,e,r,o){var a;return li(this,i),a=s.call(this,o),Y(le(a),"retryCount",0),Y(le(a),"isTimeout",!1),Y(le(a),"loaderType",Ai.FETCH),Y(le(a),"startTime",0),Y(le(a),"endTime",0),Y(le(a),"options",{}),a.url=t,a.request=e,a.response=r,a}return ci(i)}(Fr(Error)),qc=Object.prototype.toString;function Am(n){return n!==null&&gn(n)==="object"}function Lu(n){if(qc.call(n)!=="[object Object]")return!1;var s=Object.getPrototypeOf(n);return s===null||s===Object.prototype}function Lm(n){return qc.call(n)==="[object Date]"}function Xc(n){if(!(!n||n[0]===null||n[0]===void 0||n[0]===0&&(n[1]===null||n[1]===void 0))){var s="bytes="+n[0]+"-";return n[1]&&(s+=n[1]),s}}function Ou(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Jc(n,s){if(n){if(!s)return n;var i,t=Object.keys(s).map(function(r){if(i=s[r],i!=null)return Array.isArray(i)?r=r+"[]":i=[i],i.map(function(o){return Lm(o)?o=o.toISOString():Am(o)&&(o=JSON.stringify(o)),"".concat(Ou(r),"=").concat(Ou(o))}).join("&")}).filter(Boolean).join("&");if(t){var e=n.indexOf("#");e!==-1&&(n=n.slice(0,e)),n+=(n.indexOf("?")===-1?"?":"&")+t}return n}}function to(n,s,i,t,e,r,o,a,u,l,c){e=e!=null?parseFloat(e):null,t=parseInt(t||"0",10),Number.isNaN(t)&&(t=0);var f={range:u,vid:l,index:a,contentLength:t,age:e,startTime:r,firstByteTime:o,endTime:Date.now(),priOptions:c};return{data:n,done:s,options:f,response:i}}function io(n,s){return Math.round(n*8*1e3/s/1024)}var Hi={ERROR:"error",TTFB:"core.ttfb",LOAD_START:"core.loadstart",LOAD_RESPONSE_HEADERS:"core.loadresponseheaders",LOAD_COMPLETE:"core.loadcomplete",LOAD_RETRY:"core.loadretry",SOURCEBUFFER_CREATED:"core.sourcebuffercreated",MEDIASOURCE_OPENED:"core.mediasourceopened",ANALYZE_DURATION_EXCEEDED:"core.analyzedurationexceeded",REMOVE_BUFFER:"core.removebuffer",BUFFEREOS:"core.buffereos",KEYFRAME:"core.keyframe",CHASEFRAME:"core.chaseframe",METADATA_PARSED:"core.metadataparsed",SEI:"core.sei",SEI_IN_TIME:"core.seiintime",FLV_SCRIPT_DATA:"core.flvscriptdata",LOWDECODE:"core.lowdecode",SWITCH_URL_SUCCESS:"core.switchurlsuccess",SWITCH_URL_FAILED:"core.switchurlfailed",SPEED:"core.speed",HLS_MANIFEST_LOADED:"core.hlsmanifestloaded",HLS_LEVEL_LOADED:"core.hlslevelloaded",DEMUXED_TRACK:"core.demuxedtrack",STREAM_EXCEPTION:"core.streamexception",LARGE_AV_FIRST_FRAME_GAP_DETECT:"LARGE_AV_FIRST_FRAME_GAP_DETECT",LARGE_VIDEO_DTS_GAP_DETECT:"LARGE_VIDEO_DTS_GAP_DETECT",LARGE_AUDIO_DTS_GAP_DETECT:"LARGE_AUDIO_DTS_GAP_DETECT",AUDIO_GAP_DETECT:"AUDIO_GAP_DETECT",AUDIO_OVERLAP_DETECT:"AUDIO_OVERLAP_DETECT",MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT:"MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT",REAL_TIME_SPEED:"real_time_speed"},Du=2*1024*1024,no=function(n){Qn(i,n);var s=Zn(i);function i(){var t;return li(this,i),t=s.call(this),Y(le(t),"_abortController",null),Y(le(t),"_timeoutTimer",null),Y(le(t),"_reader",null),Y(le(t),"_response",null),Y(le(t),"_aborted",!1),Y(le(t),"_index",-1),Y(le(t),"_range",null),Y(le(t),"_receivedLength",0),Y(le(t),"_running",!1),Y(le(t),"_logger",null),Y(le(t),"_vid",""),Y(le(t),"_onProcessMinLen",0),Y(le(t),"_onCancel",null),Y(le(t),"_priOptions",null),t}return ci(i,[{key:"load",value:function(e){var r,o=this,a=e.url,u=e.vid,l=e.timeout,c=e.responseType,f=e.onProgress,h=e.index,d=e.onTimeout,g=e.onCancel,v=e.range,m=e.transformResponse,S=e.request,w=e.params,_=e.logger,P=e.method,I=e.headers,j=e.body,O=e.mode,Z=e.credentials,te=e.cache,F=e.redirect,re=e.referrer,E=e.referrerPolicy,b=e.onProcessMinLen,C=e.priOptions;this._logger=_,this._aborted=!1,this._onProcessMinLen=b,this._onCancel=g,this._abortController=typeof AbortController<"u"&&new AbortController,this._running=!0,this._index=h,this._range=v||[0,0],this._vid=u||a,this._priOptions=C||{};var N={method:P,headers:I,body:j,mode:O,credentials:Z,cache:te,redirect:F,referrer:re,referrerPolicy:E,signal:(r=this._abortController)===null||r===void 0?void 0:r.signal},k=!1;clearTimeout(this._timeoutTimer),a=Jc(a,w);var M=Xc(v);M&&(S?I=S.headers:I=N.headers=N.headers||(Headers?new Headers:{}),Headers&&I instanceof Headers?I.append("Range",M):I.Range=M),l&&(this._timeoutTimer=setTimeout(function(){if(k=!0,o.cancel(),d){var ce=new zt(a,N,null,"timeout");ce.isTimeout=!0,d(ce,{index:o._index,range:o._range,vid:o._vid,priOptions:o._priOptions})}},l));var G=Date.now();return this._logger.debug("[fetch load start], index,",h,",range,",v),new Promise(function(ce,he){fetch(S||a,S?void 0:N).then(function(){var K=oi(Ge().mark(function me(ne){var qe,Ve,Me,A;return Ge().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(clearTimeout(o._timeoutTimer),o._response=ne,!(o._aborted||!o._running)){U.next=4;break}return U.abrupt("return");case 4:if(m&&(ne=m(ne,a)||ne),ne.ok){U.next=7;break}throw new zt(a,N,ne,"bad network response");case 7:if(qe=Date.now(),c!==$n.TEXT){U.next=15;break}return U.next=11,ne.text();case 11:Ve=U.sent,o._running=!1,U.next=37;break;case 15:if(c!==$n.JSON){U.next=22;break}return U.next=18,ne.json();case 18:Ve=U.sent,o._running=!1,U.next=37;break;case 22:if(!f){U.next=29;break}return o.resolve=ce,o.reject=he,o._loadChunk(ne,f,G,qe),U.abrupt("return");case 29:return U.next=31,ne.arrayBuffer();case 31:Ve=U.sent,Ve=new Uint8Array(Ve),o._running=!1,Me=Date.now()-G,A=io(Ve.byteLength,Me),o.emit(Hi.REAL_TIME_SPEED,{speed:A,len:Ve.byteLength,time:Me,vid:o._vid,index:o._index,range:o._range,priOptions:o._priOptions});case 37:o._logger.debug("[fetch load end], index,",h,",range,",v),ce(to(Ve,!0,ne,ne.headers.get("Content-Length"),ne.headers.get("age"),G,qe,h,v,o._vid,o._priOptions));case 39:case"end":return U.stop()}},me)}));return function(me){return K.apply(this,arguments)}}()).catch(function(K){var me;clearTimeout(o._timeoutTimer),o._running=!1,!(o._aborted&&!k)&&(K=K instanceof zt?K:new zt(a,N,null,(me=K)===null||me===void 0?void 0:me.message),K.startTime=G,K.endTime=Date.now(),K.isTimeout=k,K.options={index:o._index,range:o._range,vid:o._vid,priOptions:o._priOptions},he(K))})})}},{key:"cancel",value:function(){var t=oi(Ge().mark(function r(){return Ge().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!this._aborted){a.next=2;break}return a.abrupt("return");case 2:if(this._aborted=!0,this._running=!1,!this._response){a.next=14;break}if(a.prev=5,!this._reader){a.next=9;break}return a.next=9,this._reader.cancel();case 9:a.next=13;break;case 11:a.prev=11,a.t0=a.catch(5);case 13:this._response=this._reader=null;case 14:if(this._abortController){try{this._abortController.abort()}catch{}this._abortController=null}this._onCancel&&this._onCancel({index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions});case 16:case"end":return a.stop()}},r,this,[[5,11]])}));function e(){return t.apply(this,arguments)}return e}()},{key:"_loadChunk",value:function(e,r,o,a){var u=this;if(!e.body||!e.body.getReader){this._running=!1;var l=new zt(e.url,"",e,"onProgress of bad response.body.getReader");l.options={index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions},this.reject(l);return}this._onProcessMinLen>0&&(this._cache=new Uint8Array(Du),this._writeIdx=0);var c=this._reader=e.body.getReader(),f,h,d,g=function(){var v=oi(Ge().mark(function m(){var S,w,_,P,I,j,O,Z;return Ge().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return h=Date.now(),F.prev=1,F.next=4,c.read();case 4:f=F.sent,d=Date.now(),F.next=13;break;case 8:return F.prev=8,F.t0=F.catch(1),d=Date.now(),u._aborted||(u._running=!1,F.t0.options={index:u._index,range:u._range,vid:u._vid,priOptions:u._priOptions},u.reject(F.t0)),F.abrupt("return");case 13:if(w=((S=u._range)===null||S===void 0?void 0:S.length)>0?u._range[0]:0,_=w+u._receivedLength,!u._aborted){F.next=19;break}return u._running=!1,r(void 0,!1,{range:[_,_],vid:u._vid,index:u._index,startTime:h,endTime:d,st:o,firstByteTime:a,priOptions:u._priOptions},e),F.abrupt("return");case 19:P=f.value?f.value.byteLength:0,u._receivedLength+=P,u._logger.debug("【fetchLoader,onProgress call】,task,",u._range,", start,",_,", end,",w+u._receivedLength,", done,",f.done),u._onProcessMinLen>0?u._writeIdx+P>=u._onProcessMinLen||f.done?(I=new Uint8Array(u._writeIdx+P),I.set(u._cache.slice(0,u._writeIdx),0),P>0&&I.set(f.value,u._writeIdx),u._writeIdx=0,u._logger.debug("【fetchLoader,onProgress enough】,done,",f.done,",len,",I.byteLength,", writeIdx,",u._writeIdx)):P>0&&u._writeIdx+P<Du?(u._cache.set(f.value,u._writeIdx),u._writeIdx+=P,u._logger.debug("【fetchLoader,onProgress cache】,len,",P,", writeIdx,",u._writeIdx)):P>0&&(j=new Uint8Array(u._writeIdx+P+2048),u._logger.debug("【fetchLoader,onProgress extra start】,size,",u._writeIdx+P+2048,", datalen,",P,", writeIdx,",u._writeIdx),j.set(u._cache.slice(0,u._writeIdx),0),P>0&&j.set(f.value,u._writeIdx),u._writeIdx+=P,delete u._cache,u._cache=j,u._logger.debug("【fetchLoader,onProgress extra end】,len,",P,", writeIdx,",u._writeIdx)):I=f.value,(I&&I.byteLength>0||f.done)&&r(I,f.done,{range:[u._range[0]+u._receivedLength-(I?I.byteLength:0),u._range[0]+u._receivedLength],vid:u._vid,index:u._index,startTime:h,endTime:d,st:o,firstByteTime:a,priOptions:u._priOptions},e),f.done?(O=Date.now()-o,Z=io(u._receivedLength,O),u.emit(Hi.REAL_TIME_SPEED,{speed:Z,len:u._receivedLength,time:O,vid:u._vid,index:u._index,range:u._range,priOptions:u._priOptions}),u._running=!1,u._logger.debug("[fetchLoader onProgress end],task,",u._range,",done,",f.done),u.resolve(to(f,!0,e,e.headers.get("Content-Length"),e.headers.get("age"),o,a,u._index,u._range,u._vid,u._priOptions))):g();case 25:case"end":return F.stop()}},m,null,[[1,8]])}));return function(){return v.apply(this,arguments)}}();g()}},{key:"receiveLen",get:function(){return this._receivedLength}},{key:"running",get:function(){return this._running},set:function(e){this._running=e}}],[{key:"isSupported",value:function(){return typeof fetch<"u"}}]),i}(Vi);function Om(n){return eo({loaderType:Ai.FETCH,retry:0,retryDelay:0,timeout:0,request:null,onTimeout:void 0,onProgress:void 0,onRetryError:void 0,transformRequest:void 0,transformResponse:void 0,transformError:void 0,responseType:$n.TEXT,range:void 0,url:"",params:void 0,method:"GET",headers:{},body:void 0,mode:void 0,credentials:void 0,cache:void 0,redirect:void 0,referrer:void 0,referrerPolicy:void 0,integrity:void 0,onProcessMinLen:0},n)}var Dm=function(n){Qn(i,n);var s=Zn(i);function i(){var t;return li(this,i),t=s.call(this),Y(le(t),"_xhr",null),Y(le(t),"_aborted",!1),Y(le(t),"_timeoutTimer",null),Y(le(t),"_range",null),Y(le(t),"_receivedLength",0),Y(le(t),"_url",null),Y(le(t),"_onProgress",null),Y(le(t),"_index",-1),Y(le(t),"_headers",null),Y(le(t),"_currentChunkSizeKB",384),Y(le(t),"_timeout",null),Y(le(t),"_xhr",null),Y(le(t),"_withCredentials",null),Y(le(t),"_startTime",-1),Y(le(t),"_loadCompleteResolve",null),Y(le(t),"_loadCompleteReject",null),Y(le(t),"_runing",!1),Y(le(t),"_logger",!1),Y(le(t),"_vid",""),Y(le(t),"_responseType",void 0),Y(le(t),"_credentials",void 0),Y(le(t),"_method",void 0),Y(le(t),"_transformResponse",void 0),Y(le(t),"_firstRtt",void 0),Y(le(t),"_onCancel",null),Y(le(t),"_priOptions",null),t}return ci(i,[{key:"load",value:function(e){var r=this;clearTimeout(this._timeoutTimer),this._logger=e.logger,this._range=e.range,this._onProgress=e.onProgress,this._index=e.index,this._headers=e.headers,this._withCredentials=e.credentials==="include"||e.credentials==="same-origin",this._body=e.body||null,e.method&&(this._method=e.method),this._timeout=e.timeout||null,this._runing=!0,this._vid=e.vid||e.url,this._responseType=e.responseType,this._firstRtt=-1,this._onTimeout=e.onTimeout,this._onCancel=e.onCancel,this._request=e.request,this._priOptions=e.priOptions||{},this._logger.debug("【xhrLoader task】, range",this._range),this._url=Jc(e.url,e.params);var o=Date.now();return new Promise(function(a,u){r._loadCompleteResolve=a,r._loadCompleteReject=u,r._startLoad()}).catch(function(a){if(clearTimeout(r._timeoutTimer),r._runing=!1,!r._aborted)throw a=a instanceof zt?a:new zt(r._url,r._request),a.startTime=o,a.endTime=Date.now(),a.options={index:r._index,vid:r._vid,priOptions:r._priOptions},a})}},{key:"_startLoad",value:function(){var e=null;if(this._responseType===$n.ARRAY_BUFFER&&this._range&&this._range.length>1)if(this._onProgress){this._firstRtt=-1;var r=this._currentChunkSizeKB*1024,o=this._range[0]+this._receivedLength,a=this._range[1];r<this._range[1]-o&&(a=o+r),e=[o,a],this._logger.debug("[xhr_loader->],tast :",this._range,", SubRange, ",e)}else e=this._range,this._logger.debug("[xhr_loader->],tast :",this._range,", allRange, ",e);this._internalOpen(e)}},{key:"_internalOpen",value:function(e){var r=this;try{this._startTime=Date.now();var o=this._xhr=new XMLHttpRequest;o.open(this._method||"GET",this._url,!0),o.responseType=this._responseType,this._timeout&&(o.timeout=this._timeout),o.withCredentials=this._withCredentials,o.onload=this._onLoad.bind(this),o.onreadystatechange=this._onReadyStatechange.bind(this),o.onerror=function(l){var c,f,h;r._running=!1;var d=new zt(r._url,r._request,l==null||(c=l.currentTarget)===null||c===void 0?void 0:c.response,"xhr.onerror.status:"+(l==null||(f=l.currentTarget)===null||f===void 0?void 0:f.status)+",statusText,"+(l==null||(h=l.currentTarget)===null||h===void 0?void 0:h.statusText));d.options={index:r._index,range:r._range,vid:r._vid,priOptions:r._priOptions},r._loadCompleteReject(d)},o.ontimeout=function(l){r.cancel();var c=new zt(r._url,r._request,{status:408},"timeout");r._onTimeout&&(c.isTimeout=!0,r._onTimeout(c,{index:r._index,range:r._range,vid:r._vid,priOptions:r._priOptions})),c.options={index:r._index,range:r._range,vid:r._vid,priOptions:r._priOptions},r._loadCompleteReject(c)};var a=this._headers||{},u=Xc(e);u&&(a.Range=u),a&&Object.keys(a).forEach(function(l){o.setRequestHeader(l,a[l])}),this._logger.debug("[xhr.send->] tast,",this._range,",load sub range, ",e),o.send(this._body)}catch(l){l.options={index:this._index,range:e,vid:this._vid,priOptions:this._priOptions},this._loadCompleteReject(l)}}},{key:"_onReadyStatechange",value:function(e){var r=e.target;r.readyState===2&&this._firstRtt<0&&(this._firstRtt=Date.now())}},{key:"_onLoad",value:function(e){var r,o=e.target.status;if(o<200||o>299){var a=new zt(this._url,null,eo(eo({},e.target.response),{},{status:o}),"bad response,status:"+o);return a.options={index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions},this._loadCompleteReject(a)}var u=null,l=!1,c,f=((r=this._range)===null||r===void 0?void 0:r.length)>0?this._range[0]:0;if(this._responseType===$n.ARRAY_BUFFER){var h,d=new Uint8Array(e.target.response);if(c=f+this._receivedLength,d&&d.byteLength>0){this._receivedLength+=d.byteLength;var g=Date.now()-this._startTime,v=io(this._receivedLength,g);this.emit(Hi.REAL_TIME_SPEED,{speed:v,len:this._receivedLength,time:g,vid:this._vid,index:this._index,range:[c,f+this._receivedLength],priOptions:this._priOptions})}u=d,((h=this._range)===null||h===void 0?void 0:h.length)>1&&this._range[1]&&this._receivedLength<this._range[1]-this._range[0]?l=!1:l=!0,this._logger.debug("[xhr load done->], tast :",this._range,", start",c,"end ",f+this._receivedLength,",dataLen,",d?d.byteLength:0,",receivedLength",this._receivedLength,",index,",this._index,", done,",l)}else l=!0,u=e.target.response;var m={ok:o>=200&&o<300,status:o,statusText:this._xhr.statusText,url:this._xhr.responseURL,headers:this._getHeaders(this._xhr),body:this._xhr.response};this._transformResponse&&(m=this._transformResponse(m,this._url)||m),this._onProgress&&this._onProgress(u,l,{index:this._index,vid:this._vid,range:[c,f+this._receivedLength],startTime:this._startTime,endTime:Date.now(),priOptions:this._priOptions},m),l?(this._runing=!1,this._loadCompleteResolve&&this._loadCompleteResolve(to(this._onProgress?null:u,l,m,m.headers["content-length"],m.headers.age,this._startTime,this._firstRtt,this._index,this._range,this._vid,this._priOptions))):this._startLoad()}},{key:"cancel",value:function(){if(!this._aborted&&(this._aborted=!0,this._runing=!1,mr(Ui(i.prototype),"removeAllListeners",this).call(this),this._onCancel&&this._onCancel({index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions}),this._xhr))return this._xhr.abort()}},{key:"receiveLen",get:function(){return this._receivedLength}},{key:"running",get:function(){return this._running},set:function(e){this._running=e}},{key:"_getHeaders",value:function(e){var r=e.getAllResponseHeaders().trim().split(`\r
`),o={},a=Sm(r),u;try{for(a.s();!(u=a.n()).done;){var l=u.value,c=l.split(": ");o[c[0].toLowerCase()]=c.slice(1).join(": ")}}catch(f){a.e(f)}finally{a.f()}return o}}],[{key:"isSupported",value:function(){return typeof XMLHttpRequest<"u"}}]),i}(Vi),Mm=["retry","retryDelay","onRetryError","transformError"],Nm=function(){function n(s,i){li(this,n),this.promise=rn(),this.alive=!!i.onProgress,!i.logger&&(i.logger=new pn("Loader")),this._loaderType=s,this._loader=s===Ai.FETCH&&typeof fetch<"u"?new no:new Dm,this._config=i,this._retryCount=0,this._retryTimer=null,this._canceled=!1,this._retryCheckFunc=i.retryCheckFunc,this._logger=i.logger}return ci(n,[{key:"exec",value:function(){var i=this,t=this._config,e=t.retry,r=t.retryDelay,o=t.onRetryError,a=t.transformError,u=_m(t,Mm),l=function(){var c=oi(Ge().mark(function f(){var h,d,g;return Ge().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.prev=0,m.next=3,i._loader.load(u);case 3:h=m.sent,i.promise.resolve(h),m.next=27;break;case 7:if(m.prev=7,m.t0=m.catch(0),i._loader.running=!1,i._logger.debug("[task request catch err]",m.t0),!i._canceled){m.next=13;break}return m.abrupt("return");case 13:if(m.t0.loaderType=i._loaderType,m.t0.retryCount=i._retryCount,d=m.t0,a&&(d=a(d)||d),o&&i._retryCount>0&&o(d,i._retryCount,{index:u.index,vid:u.vid,range:u.range,priOptions:u.priOptions}),i._retryCount++,g=!0,i._retryCheckFunc&&(g=i._retryCheckFunc(m.t0)),!(g&&i._retryCount<=e)){m.next=26;break}return clearTimeout(i._retryTimer),i._logger.debug("[task request setTimeout],retry",i._retryCount,",retry range,",u.range),i._retryTimer=setTimeout(l,r),m.abrupt("return");case 26:i.promise.reject(d);case 27:case"end":return m.stop()}},f,null,[[0,7]])}));return function(){return c.apply(this,arguments)}}();return l(),this.promise}},{key:"cancel",value:function(){var s=oi(Ge().mark(function t(){return Ge().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return clearTimeout(this._retryTimer),this._canceled=!0,this._loader.running=!1,r.abrupt("return",this._loader.cancel());case 4:case"end":return r.stop()}},t,this)}));function i(){return s.apply(this,arguments)}return i}()},{key:"running",get:function(){return this._loader&&this._loader.running}},{key:"loader",get:function(){return this._loader}}]),n}();function Mu(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];if(s=s.filter(Boolean),s.length<2)return s[0];var t=new Uint8Array(s.reduce(function(r,o){return r+o.byteLength},0)),e=0;return s.forEach(function(r){t.set(r,e),e+=r.byteLength}),t}function Fm(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new Promise(function(s){return setTimeout(s,n)})}var Bm=function(n){Qn(i,n);var s=Zn(i);function i(t){var e;return li(this,i),e=s.call(this,t),Y(le(e),"type",Ai.FETCH),Y(le(e),"_queue",[]),Y(le(e),"_alive",[]),Y(le(e),"_currentTask",null),Y(le(e),"_finnalUrl",""),Y(le(e),"_config",void 0),e._config=Om(t),(e._config.loaderType===Ai.XHR||!no.isSupported())&&(e.type=Ai.XHR),e.log=t.logger,e}return ci(i,[{key:"isFetch",value:function(){return this.type===Ai.FETCH}},{key:"load",value:function(e){var r=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};typeof e=="string"||!e?o.url=e||o.url||this._config.url:o=e,o=Object.assign({},this._config,o),o.params&&(o.params=Object.assign({},o.params)),o.headers&&Lu(o.headers)&&(o.headers=Object.assign({},o.headers)),o.body&&Lu(o.body)&&(o.body=Object.assign({},o.body)),o.transformRequest&&(o=o.transformRequest(o)||o),o.logger=this.log;var a=new Nm(this.type,o);return a.loader.on(Hi.REAL_TIME_SPEED,function(u){r.emit(Hi.REAL_TIME_SPEED,u)}),this._queue.push(a),this._queue.length===1&&(!this._currentTask||!this._currentTask.running)&&this._processTask(),a.promise}},{key:"cancel",value:function(){var t=oi(Ge().mark(function r(){var o;return Ge().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return o=this._queue.map(function(l){return l.cancel()}).concat(this._alive.map(function(l){return l.cancel()})),this._currentTask&&o.push(this._currentTask.cancel()),this._queue=[],this._alive=[],u.next=6,Promise.all(o);case 6:return u.next=8,Fm();case 8:case"end":return u.stop()}},r,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"_processTask",value:function(){var e=this;if(this._currentTask=this._queue.shift(),!!this._currentTask){this._currentTask.alive&&this._alive.push(this._currentTask);var r=this._currentTask.exec().catch(function(o){});r&&typeof r.finally=="function"&&r.finally(function(){var o,a;(o=e._currentTask)!==null&&o!==void 0&&o.alive&&((a=e._alive)===null||a===void 0?void 0:a.length)>0&&(e._alive=e._alive.filter(function(u){return u&&u!==e._currentTask})),e._processTask()})}}}],[{key:"isFetchSupport",value:function(){return no.isSupported()}}]),i}(Vi);const xt={416:je[se.NETWROK_RANGE_NOT_SATISFIABLE],403:je[se.NETWORK_FORBIDDEN],404:je[se.NETWORK_NOTFOUND],timeout:je[se.NETWORK_TIMEOUT],"4xx":`${je[se.NETWORK]}4XX`,"5xx":`${je[se.NETWORK]}5XX`,networkError:je[se.NETWORK],contentError:`${je[se.NETWORK]}contentError`,mse:je[se.MEDIA][se.SUB_TYPES.MSE_OTHER],mseOpen:je[se.MEDIA][se.SUB_TYPES.MSE_ADD_SB],mseAppend:je[se.MEDIA][se.SUB_TYPES.MSE_APPEND_BUFFER],mse_hijack:je[se.MEDIA][se.SUB_TYPES.MSE_HIJACK],eme_hijack:je[se.MEDIA][se.SUB_TYPES.EME_HIJACK],metaError:je[se.DEMUX][se.SUB_TYPES.MP4],muxError:je[se.REMUX][se.SUB_TYPES.FMP4],other:je[se.OTHER],waitTimeout:je[se.RUNTIME][se.SUB_TYPES.BUFFERBREAK_ERROR],waitTimeoutWithHidden:je[se.RUNTIME][se.SUB_TYPES.WAITING_TIMEOUT_ERROR],drm:je[se.DRM][se.SUB_TYPES.LICENSE]},sn=se;function Um(n){return xt[n]||n}class Hm{constructor(s,i,t){let e=0,r=0;t&&t.range&&t.range.length>1&&(e=t.range[0],r=t.range[1]);const o=Um(i);return{errorCode:o,errorType:s,errorMessage:(t==null?void 0:t.httpText)||(t==null?void 0:t.message),url:t==null?void 0:t.url,httpCode:i,version:Gc,rangeStart:e,rangeEnd:r,ext:t,mediaError:{code:o,message:(t==null?void 0:t.httpText)||(t==null?void 0:t.message)}}}}class jm{constructor(s,i,t){return{errorCode:i,errorType:s,version:Gc,errorMessage:t.msg,ext:t,mediaError:{code:i,message:t.msg}}}}const Vt={};Vt.nowTime=function(){try{return parseInt(performance.now(),10)}catch{return new Date().getTime()}};Vt.concatData=function(n,s){const i=[];let t=0;n&&i.push(n),s&&i.push(s),i.every(o=>(o&&(t+=o.byteLength),!0));const e=new Uint8Array(t);let r=0;return i.every(o=>(o&&(e.set(o,r),r+=o.byteLength),!0)),e};function Vm(n){return n.media&&(n=n.media),!n||!(n instanceof HTMLMediaElement)?!1:/^blob/.test(n.currentSrc)||/^blob/.test(n.src)}const zm={"x-cache":"x_cache","x-response-sinfo":"server_ip","x-response-cinfo":"x-response-cinfo","content-range":"content-range","content-length":"content-length","content-type":"content-type"},Wm=2;function Gm(n){const s=zm["content-range"];if(n&&n.get&&n.get(s)){const t=n.get(s).split("/");if((t==null?void 0:t.length)===Wm)return t[1]}return null}function Km(n){const s="Content-Length";return n&&n.get&&n.get(s)?n.get(s):null}function Nu(n){try{n&&n.src&&(n.removeAttribute("src"),n.load())}catch{}}function Fu(n,s){const i=n.media||n.video;n._detachSourceEvents(i),s instanceof Array?n._attachSourceEvents(i,s):s?i.src=s:i.removeAttribute("src")}function Ym(n,s){var i=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(i!=null){var t,e,r,o,a=[],u=!0,l=!1;try{if(r=(i=i.call(n)).next,s!==0)for(;!(u=(t=r.call(i)).done)&&(a.push(t.value),a.length!==s);u=!0);}catch(c){l=!0,e=c}finally{try{if(!u&&i.return!=null&&(o=i.return(),Object(o)!==o))return}finally{if(l)throw e}}return a}}function Bu(n,s){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);s&&(t=t.filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),i.push.apply(i,t)}return i}function ro(n){for(var s=1;s<arguments.length;s++){var i=arguments[s]!=null?arguments[s]:{};s%2?Bu(Object(i),!0).forEach(function(t){lt(n,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Bu(Object(i)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(i,t))})}return n}function De(){De=function(){return n};var n={},s=Object.prototype,i=s.hasOwnProperty,t=Object.defineProperty||function(E,b,C){E[b]=C.value},e=typeof Symbol=="function"?Symbol:{},r=e.iterator||"@@iterator",o=e.asyncIterator||"@@asyncIterator",a=e.toStringTag||"@@toStringTag";function u(E,b,C){return Object.defineProperty(E,b,{value:C,enumerable:!0,configurable:!0,writable:!0}),E[b]}try{u({},"")}catch{u=function(b,C,N){return b[C]=N}}function l(E,b,C,N){var k=b&&b.prototype instanceof h?b:h,M=Object.create(k.prototype),G=new te(N||[]);return t(M,"_invoke",{value:I(E,C,G)}),M}function c(E,b,C){try{return{type:"normal",arg:E.call(b,C)}}catch(N){return{type:"throw",arg:N}}}n.wrap=l;var f={};function h(){}function d(){}function g(){}var v={};u(v,r,function(){return this});var m=Object.getPrototypeOf,S=m&&m(m(F([])));S&&S!==s&&i.call(S,r)&&(v=S);var w=g.prototype=h.prototype=Object.create(v);function _(E){["next","throw","return"].forEach(function(b){u(E,b,function(C){return this._invoke(b,C)})})}function P(E,b){function C(k,M,G,ce){var he=c(E[k],E,M);if(he.type!=="throw"){var K=he.arg,me=K.value;return me&&typeof me=="object"&&i.call(me,"__await")?b.resolve(me.__await).then(function(ne){C("next",ne,G,ce)},function(ne){C("throw",ne,G,ce)}):b.resolve(me).then(function(ne){K.value=ne,G(K)},function(ne){return C("throw",ne,G,ce)})}ce(he.arg)}var N;t(this,"_invoke",{value:function(k,M){function G(){return new b(function(ce,he){C(k,M,ce,he)})}return N=N?N.then(G,G):G()}})}function I(E,b,C){var N="suspendedStart";return function(k,M){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(k==="throw")throw M;return re()}for(C.method=k,C.arg=M;;){var G=C.delegate;if(G){var ce=j(G,C);if(ce){if(ce===f)continue;return ce}}if(C.method==="next")C.sent=C._sent=C.arg;else if(C.method==="throw"){if(N==="suspendedStart")throw N="completed",C.arg;C.dispatchException(C.arg)}else C.method==="return"&&C.abrupt("return",C.arg);N="executing";var he=c(E,b,C);if(he.type==="normal"){if(N=C.done?"completed":"suspendedYield",he.arg===f)continue;return{value:he.arg,done:C.done}}he.type==="throw"&&(N="completed",C.method="throw",C.arg=he.arg)}}}function j(E,b){var C=b.method,N=E.iterator[C];if(N===void 0)return b.delegate=null,C==="throw"&&E.iterator.return&&(b.method="return",b.arg=void 0,j(E,b),b.method==="throw")||C!=="return"&&(b.method="throw",b.arg=new TypeError("The iterator does not provide a '"+C+"' method")),f;var k=c(N,E.iterator,b.arg);if(k.type==="throw")return b.method="throw",b.arg=k.arg,b.delegate=null,f;var M=k.arg;return M?M.done?(b[E.resultName]=M.value,b.next=E.nextLoc,b.method!=="return"&&(b.method="next",b.arg=void 0),b.delegate=null,f):M:(b.method="throw",b.arg=new TypeError("iterator result is not an object"),b.delegate=null,f)}function O(E){var b={tryLoc:E[0]};1 in E&&(b.catchLoc=E[1]),2 in E&&(b.finallyLoc=E[2],b.afterLoc=E[3]),this.tryEntries.push(b)}function Z(E){var b=E.completion||{};b.type="normal",delete b.arg,E.completion=b}function te(E){this.tryEntries=[{tryLoc:"root"}],E.forEach(O,this),this.reset(!0)}function F(E){if(E){var b=E[r];if(b)return b.call(E);if(typeof E.next=="function")return E;if(!isNaN(E.length)){var C=-1,N=function k(){for(;++C<E.length;)if(i.call(E,C))return k.value=E[C],k.done=!1,k;return k.value=void 0,k.done=!0,k};return N.next=N}}return{next:re}}function re(){return{value:void 0,done:!0}}return d.prototype=g,t(w,"constructor",{value:g,configurable:!0}),t(g,"constructor",{value:d,configurable:!0}),d.displayName=u(g,a,"GeneratorFunction"),n.isGeneratorFunction=function(E){var b=typeof E=="function"&&E.constructor;return!!b&&(b===d||(b.displayName||b.name)==="GeneratorFunction")},n.mark=function(E){return Object.setPrototypeOf?Object.setPrototypeOf(E,g):(E.__proto__=g,u(E,a,"GeneratorFunction")),E.prototype=Object.create(w),E},n.awrap=function(E){return{__await:E}},_(P.prototype),u(P.prototype,o,function(){return this}),n.AsyncIterator=P,n.async=function(E,b,C,N,k){k===void 0&&(k=Promise);var M=new P(l(E,b,C,N),k);return n.isGeneratorFunction(b)?M:M.next().then(function(G){return G.done?G.value:M.next()})},_(w),u(w,a,"Generator"),u(w,r,function(){return this}),u(w,"toString",function(){return"[object Generator]"}),n.keys=function(E){var b=Object(E),C=[];for(var N in b)C.push(N);return C.reverse(),function k(){for(;C.length;){var M=C.pop();if(M in b)return k.value=M,k.done=!1,k}return k.done=!0,k}},n.values=F,te.prototype={constructor:te,reset:function(E){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(Z),!E)for(var b in this)b.charAt(0)==="t"&&i.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=void 0)},stop:function(){this.done=!0;var E=this.tryEntries[0].completion;if(E.type==="throw")throw E.arg;return this.rval},dispatchException:function(E){if(this.done)throw E;var b=this;function C(he,K){return M.type="throw",M.arg=E,b.next=he,K&&(b.method="next",b.arg=void 0),!!K}for(var N=this.tryEntries.length-1;N>=0;--N){var k=this.tryEntries[N],M=k.completion;if(k.tryLoc==="root")return C("end");if(k.tryLoc<=this.prev){var G=i.call(k,"catchLoc"),ce=i.call(k,"finallyLoc");if(G&&ce){if(this.prev<k.catchLoc)return C(k.catchLoc,!0);if(this.prev<k.finallyLoc)return C(k.finallyLoc)}else if(G){if(this.prev<k.catchLoc)return C(k.catchLoc,!0)}else{if(!ce)throw new Error("try statement without catch or finally");if(this.prev<k.finallyLoc)return C(k.finallyLoc)}}}},abrupt:function(E,b){for(var C=this.tryEntries.length-1;C>=0;--C){var N=this.tryEntries[C];if(N.tryLoc<=this.prev&&i.call(N,"finallyLoc")&&this.prev<N.finallyLoc){var k=N;break}}k&&(E==="break"||E==="continue")&&k.tryLoc<=b&&b<=k.finallyLoc&&(k=null);var M=k?k.completion:{};return M.type=E,M.arg=b,k?(this.method="next",this.next=k.finallyLoc,f):this.complete(M)},complete:function(E,b){if(E.type==="throw")throw E.arg;return E.type==="break"||E.type==="continue"?this.next=E.arg:E.type==="return"?(this.rval=this.arg=E.arg,this.method="return",this.next="end"):E.type==="normal"&&b&&(this.next=b),f},finish:function(E){for(var b=this.tryEntries.length-1;b>=0;--b){var C=this.tryEntries[b];if(C.finallyLoc===E)return this.complete(C.completion,C.afterLoc),Z(C),f}},catch:function(E){for(var b=this.tryEntries.length-1;b>=0;--b){var C=this.tryEntries[b];if(C.tryLoc===E){var N=C.completion;if(N.type==="throw"){var k=N.arg;Z(C)}return k}}throw new Error("illegal catch attempt")},delegateYield:function(E,b,C){return this.delegate={iterator:F(E),resultName:b,nextLoc:C},this.method==="next"&&(this.arg=void 0),f}},n}function Uu(n,s,i,t,e,r,o){try{var a=n[r](o),u=a.value}catch(l){i(l);return}a.done?s(u):Promise.resolve(u).then(t,e)}function dt(n){return function(){var s=this,i=arguments;return new Promise(function(t,e){var r=n.apply(s,i);function o(u){Uu(r,t,e,o,a,"next",u)}function a(u){Uu(r,t,e,o,a,"throw",u)}o(void 0)})}}function Go(n,s){if(!(n instanceof s))throw new TypeError("Cannot call a class as a function")}function $m(n,s){for(var i=0;i<s.length;i++){var t=s[i];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(n,Zc(t.key),t)}}function Ko(n,s,i){return s&&$m(n.prototype,s),Object.defineProperty(n,"prototype",{writable:!1}),n}function lt(n,s,i){return s=Zc(s),s in n?Object.defineProperty(n,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[s]=i,n}function qm(n,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(s&&s.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),s&&so(n,s)}function Br(n){return Br=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},Br(n)}function so(n,s){return so=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},so(n,s)}function Xm(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Jm(n,s){if(n==null)return{};var i={},t=Object.keys(n),e,r;for(r=0;r<t.length;r++)e=t[r],!(s.indexOf(e)>=0)&&(i[e]=n[e]);return i}function Qm(n,s){if(n==null)return{};var i=Jm(n,s),t,e;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);for(e=0;e<r.length;e++)t=r[e],!(s.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(n,t)&&(i[t]=n[t])}return i}function gt(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Zm(n,s){if(s&&(typeof s=="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gt(n)}function ey(n){var s=Xm();return function(){var t=Br(n),e;if(s){var r=Br(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Zm(this,e)}}function ty(n,s){return ry(n)||Ym(n,s)||Qc(n,s)||ay()}function iy(n){return ny(n)||sy(n)||Qc(n)||oy()}function ny(n){if(Array.isArray(n))return oo(n)}function ry(n){if(Array.isArray(n))return n}function sy(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function Qc(n,s){if(n){if(typeof n=="string")return oo(n,s);var i=Object.prototype.toString.call(n).slice(8,-1);if(i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set")return Array.from(n);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return oo(n,s)}}function oo(n,s){(s==null||s>n.length)&&(s=n.length);for(var i=0,t=new Array(s);i<s;i++)t[i]=n[i];return t}function oy(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ay(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uy(n,s){if(typeof n!="object"||n===null)return n;var i=n[Symbol.toPrimitive];if(i!==void 0){var t=i.call(n,s||"default");if(typeof t!="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}function Zc(n){var s=uy(n,"string");return typeof s=="symbol"?s:String(s)}function ly(n){return ro({vid:"",moovEnd:8e4,segmentDuration:2,maxDownloadInfoSize:30,responseType:"arraybuffer",cache:null},n)}var fr=Ko(function n(s,i){Go(this,n),this.type="file",this.message=s,this.data=i}),cy=function(){function n(){Go(this,n),lt(this,"_data",Object.create(null))}return Ko(n,[{key:"set",value:function(i,t){this._data[i]=t}},{key:"get",value:function(i){return this._data[i]}},{key:"clear",value:function(){this._data=Object.create(null)}}]),n}();function Is(n,s){var i=n.trak;if(!(!i||!i.length)){var t=i.find(function(E){var b,C;return((b=E.mdia)===null||b===void 0||(C=b.hdlr)===null||C===void 0?void 0:C.handlerType)==="vide"}),e=i.find(function(E){var b,C;return((b=E.mdia)===null||b===void 0||(C=b.hdlr)===null||C===void 0?void 0:C.handlerType)==="soun"});if(!(!t&&!e)){var r=[],o=[],a;if(t){var u,l,c,f=(u=t.mdia)===null||u===void 0||(l=u.minf)===null||l===void 0?void 0:l.stbl;if(!f)return;var h=(c=t.mdia.mdhd)===null||c===void 0?void 0:c.timescale,d=f.stts,g=f.stsc,v=f.stsz,m=f.stco,S=f.stss,w=f.ctts;if(!h||!d||!g||!v||!m||!S)return;r=Hu(s,h,d,g,v,m,S,w),a=r.map(function(E){return E.duration})}if(e){var _,P,I,j=(_=e.mdia)===null||_===void 0||(P=_.minf)===null||P===void 0?void 0:P.stbl;if(!j)return;var O=(I=e.mdia.mdhd)===null||I===void 0?void 0:I.timescale,Z=j.stts,te=j.stsc,F=j.stsz,re=j.stco;if(!O||!Z||!te||!F||!re)return;o=Hu(s,O,Z,te,F,re,null,null,a)}return{videoSegments:r,audioSegments:o}}}}function Hu(n,s,i,t,e,r,o,a,u){var l=[],c=[],f=[],h=t.entries,d=r.entries,g=e.entrySizes,v=o==null?void 0:o.entries,m=a==null?void 0:a.entries,S;m&&(S=[],m.forEach(function(q){for(var U=q.count,ee=q.offset,we=0;we<U;we++)S.push(ee)}));var w;v&&(w={},v.forEach(function(q){w[q-1]=!0}));var _,P,I=0,j=0,O=0,Z=0,te=0,F=h[0].samplesPerChunk,re=h[1]?h[1].firstChunk-1:1/0,E=0,b=-1;i.entries.forEach(function(q){var U=q.count,ee=q.delta;P=ee;for(var we=0;we<U;we++)_={dts:E,startTime:I,duration:P,size:g[j]||e.sampleSize,offset:d[O]+te,index:j},v&&(_.keyframe=w[j],_.keyframe?(b++,c.push([_]),f.push(_.duration)):(c[c.length-1].push(_),f[c.length-1]+=_.duration),_.gopId=b),S&&j<S.length&&(_.pts=E+S[j]),j===0&&(_.pts=0),l.push(_),I+=P,E+=ee,j++,j<F?te+=_.size:(O++,te=0,O>=re&&(Z++,re=h[Z+1]?h[Z+1].firstChunk-1:1/0),F+=h[Z].samplesPerChunk)});var C=l.length;if(!(!C||o&&!l[0].keyframe)){var N=[],k=[],M=0,G,ce=0,he=function(U){var ee;G=k[k.length-1],N.push({index:N.length,startTime:((ee=N[N.length-1])===null||ee===void 0?void 0:ee.endTime)||k[0].startTime/s,endTime:(G.startTime+G.duration)/s,duration:U,range:[k[0].offset,G.offset+G.size],frames:k}),M=0,k=[]};if(o)for(var K=n*s,me=0,ne=c.length;me<ne;me++){var qe;M+=f[me],(qe=k).push.apply(qe,iy(c[me])),me+1<ne?(me===0||M>K)&&he(M/s):he(M/s)}else{u=u||[];for(var Ve=u[0]||n,Me=0;Me<C;Me++){k.push(l[Me]),M+=l[Me].duration;var A=M/s;(Me+1>=C||A+ce>=Ve)&&(ce+=A-Ve,he(A),Ve=u[N.length]||n)}}return N}}function ju(n){var s="",i="",t=0,e=0,r=0,o=0,a=0,u=0,l=0;n.mvhd&&(a=n.mvhd.duration/n.mvhd.timescale);var c=n.trak;if(c){var f=c.find(function(N){var k,M;return((k=N.mdia)===null||k===void 0||(M=k.hdlr)===null||M===void 0?void 0:M.handlerType)==="vide"}),h=c.find(function(N){var k,M;return((k=N.mdia)===null||k===void 0||(M=k.hdlr)===null||M===void 0?void 0:M.handlerType)==="soun"}),d=null,g;if(f){var v,m,S;if(d=(v=f.mdia)===null||v===void 0||(m=v.minf)===null||m===void 0||(S=m.stbl)===null||S===void 0?void 0:S.stsd.entries[0],d){var w,_,P;if(t=d.width,e=d.height,u=(w=f.mdia)===null||w===void 0||(_=w.mdhd)===null||_===void 0?void 0:_.timescale,s=(P=d.avcC||d.hvcC)===null||P===void 0?void 0:P.codec,d.type==="encv"){var I,j;g=(I=d.sinf)===null||I===void 0||(j=I.schi)===null||j===void 0?void 0:j.tenc.default_KID}}}if(h){var O,Z,te;if(d=(O=h.mdia)===null||O===void 0||(Z=O.minf)===null||Z===void 0||(te=Z.stbl)===null||te===void 0?void 0:te.stsd.entries[0],d){var F,re,E;if(r=d.channelCount,o=d.sampleRate,i=(F=d.esds)===null||F===void 0?void 0:F.codec,l=(re=h.mdia)===null||re===void 0||(E=re.mdhd)===null||E===void 0?void 0:E.timescale,d.type==="enca"){var b,C;g=g||((b=d.sinf)===null||b===void 0||(C=b.schi)===null||C===void 0?void 0:C.tenc.default_KID)}}}return{kid:g?g.join(""):null,videoCodec:s,audioCodec:i,width:t,height:e,videoTimescale:u,audioChannelCount:r,audioSampleRate:o,duration:a,audioTimescale:l,moov:n}}}function Vu(n){return typeof n=="number"&&!Number.isNaN(n)}var fy=["vid","cache"],hy=function(n){qm(i,n);var s=ey(i);function i(t){var e;Go(this,i),e=s.call(this),lt(gt(e),"vid",""),lt(gt(e),"url",""),lt(gt(e),"meta",{}),lt(gt(e),"downloadInfo",[]),lt(gt(e),"videoSegments",[]),lt(gt(e),"audioSegments",[]),lt(gt(e),"cache",null),lt(gt(e),"_currentSegmentIndex",-1),lt(gt(e),"_currentLoadingSegmentIndex",-1),lt(gt(e),"buffer",void 0),lt(gt(e),"_error",void 0),lt(gt(e),"_transformError",function(l){return l}),e._config=ly(t);var r=e._config,o=r.vid,a=r.cache,u=Qm(r,fy);return e.cache=a||new cy,e.vid=o||u.url,e.url=u.url,u.transformError=e._transformError,e.logger=new pn("MP4Loader_"+e.vid),t.openLog&&pn.enable(),u.logger=e.logger,e._loader=new Bm(u),e._loader.on(Hi.REAL_TIME_SPEED,function(l){e.emit(Hi.REAL_TIME_SPEED,l)}),e}return Ko(i,[{key:"isMetaLoaded",get:function(){return this.videoSegments.length||this.audioSegments.length}},{key:"setCurrentSegment",value:function(e){Vu(e)&&(this._currentSegmentIndex=e)}},{key:"isLastSegment",value:function(e){if(Vu(e)){var r,o,a=((r=this.videoSegments[this.videoSegments.length-1])===null||r===void 0?void 0:r.index)||((o=this.audioSegments[this.audioSegments.length-1])===null||o===void 0?void 0:o.index)||0;return e>=a}return!1}},{key:"isSegmentLoading",value:function(e){return e===this._currentLoadingSegmentIndex}},{key:"changeUrl",value:function(){var t=dt(De().mark(function r(o){var a,u,l,c=arguments;return De().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return a=c.length>1&&c[1]!==void 0?c[1]:o,u=c.length>2?c[2]:void 0,l=c.length>3?c[3]:void 0,h.next=5,this.reset(l);case 5:o&&(this.url=o),a&&(this.vid=a),u&&(this._config.moovEnd=u);case 8:case"end":return h.stop()}},r,this)}));function e(r){return t.apply(this,arguments)}return e}()},{key:"getOrLoadMeta",value:function(){var t=dt(De().mark(function r(o){return De().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.isMetaLoaded){u.next=3;break}return u.next=3,this.loadMeta(o);case 3:return u.abrupt("return",this.meta);case 4:case"end":return u.stop()}},r,this)}));function e(r){return t.apply(this,arguments)}return e}()},{key:"loadMetaProcess",value:function(){var t=dt(De().mark(function r(o,a,u,l){var c=this,f,h,d,g;return De().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return f=ty(a,2),h=f[0],d=f[1],this._error=!1,this.logger.debug("[loadMetaProcess start], range,",[h,d]),g=function(){var S=dt(De().mark(function w(_,P,I,j){var O,Z,te,F,re,E,b,C;return De().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(c.meta&&I!==null&&I!==void 0&&I.range&&I.range.length>0&&I.range[1]>=d&&(P=!0,c.logger.debug("[loadMetaProcess],data done,setstate true,[",h,d,"]")),P&&I!==null&&I!==void 0&&I.range&&I.range.length>0&&I.range[1]<d&&(P=!1,c.logger.debug("[loadMetaProcess],data not done,setstate false,[",h,d,"]")),c.logger.debug("[loadMetaProcess],task,[",h,d,"], range,",I.range,",dataLen,",_?_.byteLength:void 0,", state,",P,",err,",c._error),!c._error&&_&&_.byteLength>0&&u(_,P,I,null,j),!(c.meta.moov||c._error)){k.next=6;break}return k.abrupt("return");case 6:if(!(_&&_.byteLength>0)){k.next=44;break}if(c.buffer=Mu(c.buffer,_),O=Rt.findBox(c.buffer,["moov"])[0],O){k.next=23;break}if(Z=Rt.findBox(c.buffer,["mdat"])[0],!P){k.next=23;break}if(Z){k.next=18;break}return c._error=!0,u(null,P,I,{err:"cannot find moov or mdat box"},j),k.abrupt("return");case 18:return te=Z.start+Z.size,k.next=21,c.loadData([te,""],o,l);case 21:F=k.sent,F&&(O=Rt.findBox(F.data,["moov"])[0]);case 23:if(!(O&&P&&O.size>O.data.length)){k.next=27;break}return c.logger.debug("[loadMetaProcess],moov not all, range,",I.range[1],",dataLen,",c.buffer.byteLength,", state,",P),k.next=27,c.loadMetaProcess(o,[I.range[1],O.start+O.size-1],u);case 27:if(!(O&&O.size<=O.data.length&&!c.meta.moov)){k.next=44;break}if(re=Rt.moov(O),re){k.next=33;break}return c._error=!0,u(null,P,I,{err:"cannot parse moov box"},j),k.abrupt("return");case 33:if(E=Is(re,c._config.segmentDuration),E){k.next=38;break}return c._error=!0,u(null,P,I,{err:"cannot parse segments"},j),k.abrupt("return");case 38:c.meta=ju(re),b=E.videoSegments,C=E.audioSegments,c.videoSegments=b,c.audioSegments=C,c.logger.debug("[loadMetaProcess] moov ok"),u(void 0,P,{meta:{meta:c.meta,videoSegments:b,audioSegments:C}},null,j);case 44:case"end":return k.stop()}},w)}));return function(_,P,I,j){return S.apply(this,arguments)}}(),m.next=6,this.loadData([h,d||this._config.moovEnd],o,ro({onProgress:g},l));case 6:case"end":return m.stop()}},r,this)}));function e(r,o,a,u){return t.apply(this,arguments)}return e}()},{key:"loadMeta",value:function(){var t=dt(De().mark(function r(o,a,u){var l,c,f,h,d,g,v,m,S;return De().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return l=[],this.logger.debug("[loadMeta start]"),_.next=4,this.loadData([0,a||this._config.moovEnd],o,u);case 4:if(c=_.sent,c){_.next=7;break}return _.abrupt("return");case 7:if(l.push(c),f=Rt.findBox(c.data,["moov"])[0],f){_.next=23;break}if(h=Rt.findBox(c.data,["mdat"])[0],h){_.next=13;break}throw new fr("cannot find moov or mdat box",c.data);case 13:return d=h.start+h.size,_.next=16,this.loadData([d],o,u);case 16:if(c=_.sent,c){_.next=19;break}return _.abrupt("return");case 19:if(l.push(c),f=Rt.findBox(c.data,["moov"],d)[0],f){_.next=23;break}throw new fr("cannot find moov box",c.data);case 23:if(!(f.size>f.data.length)){_.next=31;break}return _.next=26,this.loadData([c.data.length,f.start+f.size-1],o,u);case 26:if(c=_.sent,c){_.next=29;break}return _.abrupt("return");case 29:l.push(c),f.data=Mu(f.data,c.data);case 31:if(g=Rt.moov(f),g){_.next=34;break}throw new fr("cannot parse moov box",f.data);case 34:if(v=Is(g,this._config.segmentDuration),v){_.next=37;break}throw new fr("cannot parse segments",f.data);case 37:return this.meta=ju(g),m=v.videoSegments,S=v.audioSegments,this.videoSegments=m,this.audioSegments=S,this.logger.debug("[load moov end!!!!!]"),_.abrupt("return",{meta:this.meta,videoSegments:m,audioSegments:S,responses:l});case 43:case"end":return _.stop()}},r,this)}));function e(r,o,a){return t.apply(this,arguments)}return e}()},{key:"loadCacheMeta",value:function(e,r){var o=e.moov,a=Is(o,this._config.segmentDuration),u=a.videoSegments,l=a.audioSegments;this.videoSegments=u,this.audioSegments=l,this._currentSegmentIndex=r,this.meta=e}},{key:"getSegmentByTime",value:function(e){var r,o;return this.videoSegments.length?(r=this.videoSegments.find(function(a){return a.startTime<=e&&a.endTime>e}),r&&(o=this.audioSegments[r.index])):o=this.audioSegments.find(function(a){return a.startTime<=e&&a.endTime>e}),{video:r,audio:o}}},{key:"loadSegmentByTime",value:function(){var t=dt(De().mark(function r(o,a){var u,l,c,f,h,d=arguments;return De().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(u=d.length>2&&d[2]!==void 0?d[2]:!0,l=d.length>3&&d[3]!==void 0?d[3]:{},this.isMetaLoaded){v.next=5;break}return v.next=5,this.loadMeta(a);case 5:return c=this.getSegmentByTime(o),f=c.video,h=c.audio,v.abrupt("return",this._loadSegment(f,h,a,u,l));case 7:case"end":return v.stop()}},r,this)}));function e(r,o){return t.apply(this,arguments)}return e}()},{key:"loadNextSegment",value:function(){var t=dt(De().mark(function r(o){var a,u,l,c,f=arguments;return De().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(a=f.length>1&&f[1]!==void 0?f[1]:!0,u=f.length>2&&f[2]!==void 0?f[2]:{},this.isMetaLoaded){d.next=5;break}return d.next=5,this.loadMeta();case 5:return l=this.videoSegments[this._currentSegmentIndex+1],c=this.audioSegments[this._currentSegmentIndex+1],d.abrupt("return",this._loadSegment(l,c,o,a,u));case 8:case"end":return d.stop()}},r,this)}));function e(r){return t.apply(this,arguments)}return e}()},{key:"preload",value:function(){var t=dt(De().mark(function r(o){var a=this,u,l,c,f,h,d,g;return De().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(this.isMetaLoaded){m.next=3;break}return m.next=3,this.loadMeta(!0);case 3:if(!(!o||o<0)){m.next=5;break}return m.abrupt("return");case 5:if(u=this.getSegmentByTime(o),l=u.video,c=u.audio,f=Math.max((l==null?void 0:l.index)||0,(c==null?void 0:c.index)||0),f){m.next=9;break}return m.abrupt("return");case 9:return h=this.videoSegments.slice(0,f),d=this.audioSegments.slice(0,f),g=function(){var S=dt(De().mark(function w(_){return De().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(!(_>f)){I.next=2;break}return I.abrupt("return");case 2:return I.next=4,a._loadSegment(h[_],d[_],!0,!1);case 4:return I.next=6,g(_+1);case 6:case"end":return I.stop()}},w)}));return function(_){return S.apply(this,arguments)}}(),m.next=14,g(0);case 14:case"end":return m.stop()}},r,this)}));function e(r){return t.apply(this,arguments)}return e}()},{key:"cancel",value:function(){return this._loader.cancel()}},{key:"reset",value:function(){var t=dt(De().mark(function r(){var o,a=arguments;return De().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(o=a.length>0&&a[0]!==void 0?a[0]:!1,o){l.next=5;break}return this.logger.debug("[MP4loader reset func call loader.cancel]"),l.next=5,this._loader.cancel();case 5:this.vid=this.url="",this.meta={},this.downloadInfo=[],this.videoSegments=[],this.audioSegments=[],this._currentSegmentIndex=-1,this._currentLoadingSegmentIndex=-1;case 12:case"end":return l.stop()}},r,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"destroy",value:function(){var t=dt(De().mark(function r(){return De().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.reset();case 2:this.cache.clear();case 3:case"end":return a.stop()}},r,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"_loadSegment",value:function(){var t=dt(De().mark(function r(o,a,u,l,c){var f,h;return De().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!(!o&&!a)){g.next=2;break}return g.abrupt("return");case 2:return f=(o==null?void 0:o.index)||(a==null?void 0:a.index)||0,this._currentLoadingSegmentIndex=f,g.prev=4,g.next=7,this.loadData([Math.min((o==null?void 0:o.range[0])||1/0,(a==null?void 0:a.range[0])||1/0),Math.max((o==null?void 0:o.range[1])||0,(a==null?void 0:a.range[1])||0)],u,c);case 7:h=g.sent;case 8:return g.prev=8,this._currentLoadingSegmentIndex=-1,g.finish(8);case 11:if(h){g.next=13;break}return g.abrupt("return");case 13:return l&&(this._currentSegmentIndex=f),h.video=o,h.audio=a,g.abrupt("return",h);case 17:case"end":return g.stop()}},r,this,[[4,,8,11]])}));function e(r,o,a,u,l){return t.apply(this,arguments)}return e}()},{key:"loadData",value:function(){var t=dt(De().mark(function r(o,a,u){var l,c,f,h;return De().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return l=this._getCacheKey(o),g.next=3,this.cache.get(l);case 3:if(c=g.sent,c){g.next=11;break}return h=u&&u.url?u.url:this.url,g.next=8,this._loader.load(h,ro({range:o,vid:this.vid},u));case 8:f=g.sent,g.next=12;break;case 11:f={data:c,state:!0,options:{fromCache:!0,range:o,vid:this.vid}};case 12:if(f){g.next=14;break}return g.abrupt("return");case 14:return c||(f.data&&this.downloadInfo.push({startTime:f.startTime,endTime:f.endTime,size:f.data.byteLength,range:o}),this.downloadInfo&&this.downloadInfo.length>this._config.maxDownloadInfoSize&&(this.downloadInfo=this.downloadInfo.slice(-this._config.maxDownloadInfoSize))),g.abrupt("return",f);case 17:case"end":return g.stop()}},r,this)}));function e(r,o,a){return t.apply(this,arguments)}return e}()},{key:"_getCacheKey",value:function(e){return(this.vid||this.url)+":"+e}}]),i}(Vi);const ef=vy(),dy=yr();my();function gy(){try{return typeof localStorage<"u"&&"setItem"in window.localStorage&&!!window.localStorage.setItem}catch{return!1}}function py(){const n="_localstorage_support_test";try{return window.localStorage.setItem(n,!0),window.localStorage.removeItem(n),!1}catch{return!0}}function yr(){if(ef)try{return!!window.localStorage.getItem("playerlog")}catch{return!1}return!1}function vy(){return gy()&&!py()}function tf(n,...s){dy&&console.log&&console.log("[logger]",Vt.nowTime(),n,...s)}function my(){if(ef)try{return!!window.localStorage.getItem("playertestlog")}catch{return!1}return!1}var yy=Object.defineProperty,_y=(n,s,i)=>s in n?yy(n,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[s]=i,by=(n,s,i)=>(_y(n,s+"",i),i);const Ke={ERROR:"error",META_READY:"metaReady",MOOV_REQ_PROGRESS:"moov_request_Progress",UPDATE_LOAD_IDX:"update_load_fragmentIdx"};class Yo extends Vi{constructor(s,i){super(),by(this,"onprogressDataArrive",async(t,e,r)=>{if(t&&t.byteLength>0){const o=this.timeRange[r.index].range;o&&r.range[1]>=o[1]&&!e&&(e=!0),this.log("[mp4.loadFragment onprogressDataArrive ] receive data, >>> index,",r.index,",range,",JSON.stringify(r.range),", dataLen,",t.byteLength),this._mux(t,r.range[0],r.index,e)}e&&(this.timeRange[r.index].downloaded=!0,this.bufferLoadedPos=-1,this.log("[FragLoadDowned],fragmentIdx,",r.index,",rangeEnd,",r.range[1]))}),this.url=s,this.options=Yo.getDefaultConfig(),Object.keys(i).map(t=>{i[t]!==void 0&&i[t]!==null&&(this.options[t]=i[t])}),this.timeRange=[],this.CHUNK_SIZE=this.options.chunkSize,this.bufferLoaded=new Uint8Array(0),this.bufferLoadedPos=0,this.meta=null,this.videoTrak=null,this.audioTrak=null,this.canDownload=!0,this._loadSuccessCallBack=null,this._isPending=!1,this._metaLoading=!1,this.MP4Loader=new hy({segmentDuration:this.options.segmentDuration,url:s,vid:i.vid,retry:this.options.retryCount,retryDelay:this.options.retryDelay,timeout:this.options.timeout,...i.reqOptions,openLog:yr()}),this.MP4Demuxer=null,this.FMP4Remuxer=null,this._needInitSegment=!0,this._switchBitRate=!1,this.enableWorker=this.options.enableWorker,this.enableWorker||(this.MP4Demuxer=null,this.FMP4Remuxer=null),this.seekTime=-1,this.changeBitRateTime=-1}static getDefaultConfig(){return{segmentDuration:5,onProcessMinLen:1024,chunkSize:8e5,retryCount:3,retryDelay:1e3,timeout:3e3,enableWorker:!1,playerId:"",vid:"",ext:{}}}async changeBitRate(s){this.url=s.url,await this.MP4Loader.changeUrl(this.url,this.options.vid+Date.now(),this.CHUNK_SIZE),this._switchBitRate=!0,this.log("[switchBitrate] changeUrl, bitRate,",this.url)}log(s,...i){const{options:t}=this,e=t&&t.vid?`[MP4] ${t.vid} ${s}`:`[MP4] ${s}`;tf(e,...i)}async errorHandler(s,i,t={}){const{response:e,message:r}=s,o=this.options?this.options.vid:"";let a=null;this._isPending=!0,e?(a=new Hm("network",e.status,{httpText:e.httpText,message:r,url:e.url}),this.emit(Ke.ERROR,a)):(console.error(`[MP4] [${o}] errorHandler,`,s),a=s,this.emit(Ke.ERROR,a))}async init(){this.url&&await this.MP4Loader.changeUrl(this.url,this.options.vid+Date.now(),this.CHUNK_SIZE),await this.getMetaInfo()}getTimeRange(){const s=[];let i=null;for(let t=0;this.videoTrak&&t<this.videoTrak.length;t++)i={startTime:this.videoTrak[t].startTime,endTime:this.videoTrak[t].endTime,downloaded:!1,isLoading:!1},s.push(i);if(this.audioTrak&&this.audioTrak.length>s.length)for(let t=s.length;t<this.audioTrak.length;t++)i={startTime:Math.max(this.audioTrak[t].startTime,i?i.endTime:0),endTime:Math.max(this.audioTrak[t].endTime,i?i.endTime:0),downloaded:!1,isLoading:!1},s.push(i);return s}async getMetaInfo(s=!0){try{this._metaLoading=!0,this.log("getMetaInfo start"),this.bufferLoaded=new Uint8Array(0);let i=0;const t=async(e,r,o,a,u)=>{const l=u?Number(Gm(u.headers)):0,c=u?Number(Km(u.headers)):0;if(this.log("getMetaInfo onProgressHandle, dataLen,",e?e.byteLength:-1,", state,",r,",range,",JSON.stringify(o.range)),console.log("getMetaInfo onProgressHandle, dataLen,",r,",state","range",JSON.stringify(o.range),c,l),a){this.emit(Ke.ERROR,a);return}if(e&&o.range[0]===i&&(this.bufferLoaded=Xv(Uint8Array,this.bufferLoaded,new Uint8Array(e)),i+=e.byteLength),o.meta&&!this.meta){const h=o.meta;this.videoTrak=h.videoSegments,this.audioTrak=h.audioSegments,this.timeRange=this.getTimeRange(),this.meta={...h.meta,ext:{videoTrak:this.videoTrak,audioTrak:this.audioTrak}},h.bufferLoaded=this.bufferLoaded,this.log("meta reach"),s&&this.emit(Ke.META_READY,this.meta)}this.meta&&r&&(this.log("[getMetaInfo req end]"),this._metaLoading=!1),this.meta&&(e||r)&&(this.log("emit moov_req_progress"),this.emit(Ke.MOOV_REQ_PROGRESS));const f=(o==null?void 0:o.range)||[];l>0&&!this.meta&&f&&f.length>1&&f[1]>=l&&(this.log("getMetaInfo_error_nometa"),this.emit(Ke.ERROR,{message:"getMetaInfo_error_nometa"}))};await this.MP4Loader.loadMetaProcess(this.MP4Loader.cache,[0,this.CHUNK_SIZE],t)}catch(i){console.error("[MP4] trigger errorHandler getMetaInfo",i==null?void 0:i.message),this.loadError(i,"getMetaInfo")}}getFragmentIdx(s){let i,t;if(this.videoTrak.length){if(i=this.videoTrak.find(e=>e.startTime<=s&&e.endTime>s),t=this.audioTrak.find(e=>e.startTime<=s&&e.endTime>s),i&&t)return Math.min(i.index,t.index);if(i||t)return i?i.index:t.index;{let e=Number.MAX_VALUE;return this.videoTrak&&this.videoTrak.length>0&&(e=this.videoTrak.length-1),this.audioTrak&&this.audioTrak.length>0&&(e=Math.min(this.audioTrak.length-1,e)),e}}else return t=this.audioTrak.find(e=>e.startTime<=s&&e.endTime>s),t?t.index:0}async _checkHasMeta(){this.log(" loadMeta start"),this._metaLoading=!0;try{const s=await this.MP4Loader.loadMeta(this.MP4Loader.cache,Math.round(this.CHUNK_SIZE/2));return this._metaLoading=!1,this.videoTrak=s.videoSegments,this.audioTrak=s.audioSegments,this.meta={...s.meta,ext:{videoTrak:this.videoTrak,audioTrak:this.audioTrak}},this.timeRange=this.getTimeRange(),this.bufferLoaded=new Uint8Array(0),s.bufferLoaded=this.bufferLoaded,!0}catch(s){return console.error(s),this._metaLoading=!1,this.emit(Ke.ERROR,s),console.error(s),!1}}resetFragmentLoadState(s){for(let i=0;i<this.timeRange.length;i++)i<s?(this.timeRange[i].downloaded=!0,this.timeRange[i].isLoading=!0):(this.timeRange[i].downloaded=!1,this.timeRange[i].isLoading=!1)}getFragRange(s){let i=null;this.videoTrak&&(i=s<this.videoTrak.length?this.videoTrak[s]:this.videoTrak[this.videoTrak.length-1]);let t=null;this.audioTrak&&(t=s<this.audioTrak.length?this.audioTrak[s]:this.audioTrak[this.audioTrak.length-1]);let e=0,r=0;this.videoTrak&&s>=this.videoTrak.length-1&&(e=-1),this.audioTrak&&s>=this.audioTrak.length-1&&(r=-1);const o=[Math.min((i==null?void 0:i.range[0])||1/0,(t==null?void 0:t.range[0])||1/0),Math.max((i==null?void 0:i.range[1])+e||0,(t==null?void 0:t.range[1])+r||0)];return s<this.timeRange.length&&(this.timeRange[s].range=o),o}async load(s,i){if(this._loadSuccessCallBack=i,this._switchBitRate&&!this._metaLoading){this.log("[switchBitrate], switch bitRate start load, time,",s>=this.videoTrak.length?this.audioTrak[s].startTime:this.videoTrak[s].startTime,", fragIndex,",s);const e=await this._checkHasMeta();this.changeBitRateTime>0&&(this.timeRange[s].startTime<=this.changeBitRateTime&&this.changeBitRateTime<this.timeRange[s].endTime?this.log("[switchBitrate], not need update load fragIndex",s,",stTime,",this.changeBitRateTime):(s=this.getFragmentIdx(this.changeBitRateTime),this.log("[switchBitrate], need update load fragIndex",s,",stTime,",this.changeBitRateTime,",newBitrateTimeRange,",this.timeRange[s].startTime,"-",this.timeRange[s].endTime),this.emit(Ke.UPDATE_LOAD_IDX,s)),this.seekTime=this.changeBitRateTime,this.changeBitRateTime=-1),this.resetFragmentLoadState(s),this.log("[switchBitrate], reset timerange state,",s),this._needInitSegment=!0,this.resetTansmuxer(),e&&(this._switchBitRate=!1)}if(this._switchBitRate&&this._metaLoading)return;const t=this.getFragRange(s);if(this.log("loadFragment,",s,",range,",JSON.stringify(t)),this.seekTime>0){const e=this.getSubRange(s,this.seekTime,t);this.loadFragment(s,e),this.seekTime=-1}else this.loadFragment(s,t)}getSubRange(s,i,t){var e,r;let o=t[0],a=t[0];if(this.log(">>>>>getSubRange time,",i,JSON.stringify(t)),((e=this.videoTrak)==null?void 0:e.length)>0){const c=s<this.videoTrak.length?this.videoTrak[s]:this.videoTrak[this.videoTrak.length-1],f=c.frames.filter(Ey),h=this.meta.videoTimescale;this.log(">>>>>getSubRange video, startTime,",c.startTime,",endTime,",c.endTime);const d=f.find((g,v)=>{const m=g.startTime/h,S=v+1<f.length?f[v+1].startTime/h:c.endTime+.8;if(i>=m&&i<S)return this.log(">>>>>getSubRange video end, startTime,",m,",endTime,",S,",startRange,",o,", keyFrameIndex,",g.index),g});o=(d==null?void 0:d.offset)||o}let u=1;if(((r=this.audioTrak)==null?void 0:r.length)>0){const c=s<this.audioTrak.length?this.audioTrak[s]:this.audioTrak[this.audioTrak.length-1],f=c.frames,h=this.meta.audioTimescale;u=Math.floor((i*h-f[0].startTime)/c.frames[0].duration),u=Math.min(f.length-1,u);let d=u>0?f[u-1].startTime/h:f[0].startTime/h;for(;u>=0;){if(u>0&&d>i){u-=1,d=f[u].startTime/h;continue}const g=(f[u].startTime+f[u].duration)/h;if(d<=i&&i<g&&t[0]<f[u].offset){a=f[u].offset,this.log(">>>>>getSubRange audio end, startTime,",d,",endTime,",g,",startRange,",a,", index,",u);break}d=g,u++}}const l=[Math.min(a,o),t[1]];return this.log(">>>>>getSubRange finalRange ",JSON.stringify(l),",oldRange,",JSON.stringify(t)),l}_mux(s,i,t,e){const r=this.getSamplesRange(t,"video"),o=this.getSamplesRange(t,"audio"),a=[i,i+s.byteLength];try{this.MP4Demuxer||(this.MP4Demuxer=new vm(this.videoTrak,this.audioTrak,null,{openLog:yr()}));const u=this.MP4Demuxer.demuxPart(s,i,r,o,this.meta.moov,this.useEME,this.kidValue);!this.FMP4Remuxer&&(!this.checkCodecH265()||this.options.supportHevc)&&(this.FMP4Remuxer=new pm(this.MP4Demuxer.videoTrack,this.MP4Demuxer.audioTrack,{openLog:yr()}));let l;this.log("[mux], videoTimeRange,",u.videoTrack?[u.videoTrack.startPts,u.videoTrack.endPts]:null,",audioTimeRange,",u.audioTrack?[u.audioTrack.startPts,u.audioTrack.endPts]:null);const c=Math.min(u.videoTrack.startPts,u.audioTrack.startPts),f=Math.max(u.videoTrack.endPts,u.audioTrack.endPts),h=[c,f];if(this.FMP4Remuxer){const d=this.FMP4Remuxer.remux(this._needInitSegment,{initMerge:!0,range:a});d.initSegment&&(this._needInitSegment=!1),l={buffer:Vt.concatData(d.audioSegment,d.videoSegment),range:a,state:e,context:{range:a,fragIndex:t,timeRange:h},initSeg:d.initSegment}}else l={videoTrack:u.videoTrack,audioTrack:u.audioTrack,buffer:null,range:a,state:e,context:{range:a,fragIndex:t,timeRange:h}};this._loadSuccessCallBack&&this._loadSuccessCallBack(l)}catch(u){console.error("mux err:",u);const l=new jm(sn.remux,xt.muxError,{msg:JSON.stringify(u)});this.errorHandler(l,"mux",{fragIndex:t,range:[i,i+s.byteLength]})}}getSamplesRange(s,i){const t=[];switch(i){case"video":if(this.videoTrak&&s<this.videoTrak.length){const e=this.videoTrak[s].frames;t.push(e[0].index),t.push(e[e.length-1].index)}break;case"audio":if(this.audioTrak&&s<this.audioTrak.length){const e=this.audioTrak[s].frames;t.push(e[0].index),t.push(e[e.length-1].index)}break;default:console.warn("[getSamplesRange] type ",i," is invalid");break}return t}async loadFragment(s,i){if(!(this._isPending||i.length>0&&i[0]===0&&i[1]===0||this.timeRange[s].isLoading))if(this.log("[MP4.loadFragment] ,fragIndex,",s,",range ",i,",len ,",i[1]-i[0],", bufferLoaded_Len,",this.bufferLoaded.byteLength),i.length>=2&&i[1]&&i[1]>0&&i[1]<=this.bufferLoaded.byteLength){this.timeRange[s].isLoading=!0;const t=Math.max(i[0],this.bufferLoadedPos),e=new Uint8Array(this.bufferLoaded.slice(t,i[1]));this.log("[mp4.loadFragment] has all data: ",t,i[1]),this.timeRange[s].downloaded=!0,this.bufferLoadedPos=-1,this._mux(e,t,s,!0)}else if(i.length>=2&&i[0]&&i[0]<=this.bufferLoaded.byteLength){if(!this.timeRange[s].isLoading){const t=Math.max(i[0],this.bufferLoadedPos),e=new Uint8Array(this.bufferLoaded.slice(t,i[1]));if(e.byteLength>0){this.bufferLoadedPos=t+e.byteLength,this.log("[mp4.loadFragment] has part data: ",t,t+e.byteLength),this._mux(e,t,s,i[1]<=this.bufferLoadedPos);return}!this._metaLoading&&!this.timeRange[s].isLoading&&(this.log("[mp4.loadFragment] ready to load part data >>> ",this.bufferLoaded.byteLength,i[1]),this.timeRange[s].isLoading=!0,await this.startLoad([this.bufferLoaded.byteLength,i[1]],s))}}else(!this._metaLoading||i[0]>=this.CHUNK_SIZE)&&!this.timeRange[s].isLoading&&(this.timeRange[s].isLoading=!0,this.log("[mp4.loadFragment],ready to load all data ,segmentIdx, ",s,",range >>> ",JSON.stringify(i)),await this.startLoad(i,s))}async startLoad(s,i){try{await this.MP4Loader.loadData(s,this.MP4Loader.cache,{index:i,onProgress:this.onprogressDataArrive,onProcessMinLen:this.options.onProcessMinLen,url:this.url})}catch(t){console.error("[MP4] trigger errorHandler startLoad",s,i,t==null?void 0:t.message),this.timeRange[i].isLoading=!1,this.loadError(t,"startLoad",{range:s,fragIndex:i})}}loadError(s,i,t){var e;!s.response&&(s.response={}),s.isTimeout?s.response.status="timeout":(e=s==null?void 0:s.response)!=null&&e.status||(s.response.status="networkError"),this.errorHandler(s,i,t)}async cancelLoading(){await this.MP4Loader&&this.MP4Loader.cancel()}async update(s){this.url=s,this.MP4Loader&&this.MP4Loader.changeUrl(s),this.MP4Loader&&this.MP4Loader.changeUrl(s)}restart(){this._isPending=!1,this.meta||this.init()}checkCodecH265(){return this.meta&&(this.meta.videoCodec.indexOf("hvc1")>-1||this.meta.videoCodec.indexOf("hev1")>-1)}destroy(){this.hasDestroyed||(this.resetTansmuxer(),this._isPending=!1,this._metaLoading=!1,this.bufferLoadedPos=0,this.bufferLoaded=new Uint8Array(0),this.MP4Loader&&(this.MP4Loader.cancel(),this.MP4Loader.destroy()),this.hasDestroyed=!0)}resetTansmuxer(){this.MP4Demuxer&&this.MP4Demuxer.reset(),this.MP4Demuxer=null,this.FMP4Remuxer&&this.FMP4Remuxer.reset(),this.FMP4Remuxer=null}}function Ey(n){if(n.keyframe)return n}class Ty{constructor(s){this.onTick_=s,this.cancelPending_=null}tickAfter(s,i=null){this.stop();let t=!0,e=null;this.cancelPending_=()=>{window.clearTimeout(e),t=!1};const r=()=>{t&&(this.onTick_(),i&&i())};return e=window.setTimeout(r,s*1e3),this}tickEvery(s){this.tickAfter(s,()=>{this.tickEvery(s)})}stop(){this.cancelPending_&&(this.cancelPending_(),this.cancelPending_=null)}}class Sy{constructor(){let s,i;const e=new Promise((r,o)=>{s=r,i=o});return e.resolve=function(r){s(r),e.state="fulfilled"},e.reject=function(r){i(r),e.state="rejected",e.isBreak=r==="DESTROYED"},e.state="pending",e}resolve(s){}reject(s){}}var wy=Object.defineProperty,Cy=(n,s,i)=>s in n?wy(n,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[s]=i,kt=(n,s,i)=>(Cy(n,typeof s!="symbol"?s+"":s,i),i);const ky="DESTROYED";let zu=null,As=null,Ls=null,Wu=null;class Py extends Yt{constructor(s){super(s),kt(this,"_onMp4DataCallBack",()=>{this._isMseInit&&this._onTimeUpdate()}),kt(this,"_onMp4MetaReady",i=>{const{config:t}=this,e=this.mp4.checkCodecH265();try{if(e&&!this.config.supportHevc){const r="browser not support HEVC",o=new ti(this.player,{errorType:"runtime",errorTypeCode:sn.runtime,errorCode:xt.h265Error,errorMessage:r,vid:t.vid,mediaError:{code:xt.h265Error,message:r}});this._errorHandler(o)}else this._initMse(i),this._initPromise.resolve()}catch(r){console.error(r);const o=new ti(this.player,{errorType:"runtime",errorTypeCode:sn.runtime,errorCode:xt.mse,errorMessage:r==null?void 0:r.message,vid:t.vid,mediaError:{code:xt.other1,message:r==null?void 0:r.message}});this._errorHandler(o);return}this._loadData()}),kt(this,"_onMp4Error",i=>{const{vid:t}=this.playerConfig;console.error("[Index] _onMp4Error",t,i),this._errorHandler(i)}),kt(this,"_loadDataSuccess",i=>{if(!(this.isDestroy||!this.mse)){this.log("[loadFragment] _loadDataSuccess ",JSON.stringify(i.context.range),",dataLen,",i.buffer?i.buffer.byteLength:0,i.state);try{i.initSeg&&(this._appendInitSeg(i.initSeg),(!i.buffer||i.buffer.byteLength<1)&&(this.log("no data, must load data"),this._onTimeUpdate()));const{buffer:t,state:e,context:r}=i;if(this.mse&&e&&(!t||t.byteLength<=0)&&r.fragIndex===this.mp4.timeRange.length-1){const o=this.player.buffered;o&&o.length>0&&(this.bufferEndTime=o.end(o.length-1)),this._isEnded(),this.log("loaded ended !!!==>>>",JSON.stringify(r.range),", fragIndex,",r.fragIndex,", bufferEndTime,",this.bufferEndTime,",meta_duration,",this.mp4.meta.duration)}if(this.mse&&e&&r.fragIndex===this.mp4.timeRange.length-1&&(!t||t.byteLength<=0)){const o=this.player.buffered;o&&o.length>0&&(this.bufferEndTime=o.end(o.length-1)),this._isEnded(),this.log("load ended !!!==>>>",this.playerConfig.vid,JSON.stringify(r.range),", fragIndex,",r.fragIndex,", bufferEndTime,",this.bufferEndTime,",meta_duration,",this.mp4.meta.duration)}t&&this.mse&&t&&t.byteLength>0&&this._appendBuffer(Pt.VIDEO,t,r,e)}catch(t){console.error("appendBuffer error: ",t),this.log("appendBuffer error",t);const e=new ti(this.player,{errorType:"runtime",errorTypeCode:sn.runtime,errorCode:xt.mse,vid:this.player.config.vid,errorMessage:t.message,mediaError:{code:xt.mse,message:t.message}});this._errorHandler(e)}i!=null&&i.state&&this._onTimeUpdate()}}),kt(this,"_onWaiting",()=>{const{player:i,config:t}=this;clearTimeout(this._waitInBufferTimer),this._waitInBufferTimer=null;const e=i.currentTime,r=i.bufferedPoint;r.end>0&&r.end-i.currentTime>=2&&this._waitAdjustTimeCnt<t.waitJampBufferMaxCnt&&(this._waitInBufferTimer=setTimeout(()=>{this._waitAdjustTimeCnt++,i.currentTime=i.currentTime+.5,this.log("[waitInBufferTimeout], waitAdjustTimeCnt,",this._waitAdjustTimeCnt,",curtime,",e,Vt.nowTime())},t.waitingInBufferTimeOut))}),kt(this,"_onSeeking",async()=>{const{player:i,mp4:t}=this,e=i.currentTime;if(this.log("[seekTime], curTime,",e,",buffer,",i.buffered2.bufferedList),!t||!t.meta)return;this.endofstream=!1,t.bufferLoadedPos=-1,t._metaLoading=!1;const r=i.bufferedPoint;let o=!1,a=0;if(r.end>0){if(o=!0,t.meta.duration-r.end<.5){this._startProgress(),this.log("[seeking in buffered range], buffer end,",r.end,", duration,",t.meta.duration);return}if(a=t.getFragmentIdx(r.end),this._curLoadSegmentIdx===a){this._startProgress(),this.log("[seeking in buffered range], seek fragIndex is current load segmentIdx",a);return}t.seekTime=r.end,a<0&&(a=this._curLoadSegmentIdx),this.log("[seeking in buffered range], seekTime ",e,",bufferRange,",r.start,"-",r.end,", fragIndex,",a)}if(!o){t.seekTime=e,a=t.getFragmentIdx(e),a<0&&(a=this._curLoadSegmentIdx),this.log("[seekTime out buffer range], curTime,",e,", Idx,",a);const{mse:u}=this;if(u&&u.isFull()){const l=i.buffered2.bufferedList,c=l[l.length-1];u.clearOpQueues(Pt.VIDEO),this._checkRemoveSourceBuffer([c.start,c.end],i.currentTime,!0,!0)}}t.changeBitRateTime>=0&&(t.changeBitRateTime=t.seekTime,this.log("[seekTime set changeBitRateTime ], curTime,",e,", changeBitRateTime,",t.changeBitRateTime)),await t.cancelLoading(),t.resetFragmentLoadState(a),this._curLoadSegmentIdx=a,this._onTimeUpdate(),this._startProgress(),this._isEnded()}),kt(this,"changeDefineCanPlay",(i,t,e,r)=>{const{player:o}=this;if(o.ended){o.currentTime=0;return}this.log("[oldChangeDefinition],this._changeDefState,",this._changeDefState),o.currentTime=this._changeDefState?this._changeDefState.currentTime:i,(this._changeDefState?this._changeDefState.paused:t)?o.pause():o.play(),this._changeDefState=null,o.emit(xr,{from:e,to:r})}),kt(this,"changeDefinition",async(i,t)=>{const{player:e,config:r,mp4:o}=this;t||(t=e.curDefinition),this._MSEError=!1;const{definitionList:a}=e;let u=null;for(let d=0;d<a.length;d++){const g=a[d].definition;if(g===i.definition||g===Number(i.definition)){u=a[d];break}}if(!u){console.error("there is no definition for ",i);return}if(r.witchBitRateWay){this.oldChangeDefinition(u,t);return}if(this.useVideoLoad){Ls.call(this.player,u,t);return}e.emit(Jr,{from:t,to:u});const l=e.currentTime;let c=o.getFragmentIdx(l);c<0&&(c=this._curLoadSegmentIdx),this.log("switchBitrate:point,fragIndex,",c,",startTime,",o.timeRange[c].startTime,",currentTime,",e.currentTime),o&&(this.mp4.changeBitRateTime=l,await o.cancelLoading(),o._metaLoading&&(o._metaLoading=!1)),this._removeBuffeEndTime=o.timeRange[c].startTime,this._isChangeDefinition=!0;const f=e.getBufferedRange(e.buffered);f[1]>0&&f[1]-e.currentTime>5&&(this.mse.clearOpQueues(Pt.VIDEO),this.mse.remove(Pt.VIDEO,e.currentTime+5,f[1])),this.log("switchBitrate: resetFragmentLoadState,",c),o.resetFragmentLoadState(c),this._curLoadSegmentIdx=c,this._handlerUrl(u.url),e.config.url=u.url;const h={...u,url:this.config._mainURL};await this.mp4.changeBitRate(h),this._onTimeUpdate(),e.emit("RESOLUTION_UPDATE",h)}),kt(this,"_replayHook",()=>{var i;return(i=this.player)==null||i.play(),!1}),kt(this,"_retryHook",()=>(this.beforePlayerInit(),!1)),kt(this,"_errorMiddleware",(i,t)=>{const{error:e}=i||{},{video:r}=this.player||{};e&&e.message&&e.message.indexOf("CHUNK_DEMUXER_ERROR_APPEND_FAILED")>-1?this._errorHandler(e):r&&!this.useVideoLoad&&Vm(r)?this._errorHandler(e):t(i.eventName,i==null?void 0:i.error)}),this.compatibleConfig(this.playerConfig),this.mp4=null,this.mse=null,this._waitAdjustTimeCnt=0,this._lastCheckTime=Vt.nowTime(),this._removeBuffeEndTime=0,this._pendingPromises=[]}static get pluginName(){return"mp4Plugin"}static get defaultConfig(){return{maxBufferLength:40,minBufferLength:5,disableBufferBreakCheck:!1,waitingTimeOut:15e3,waitingInBufferTimeOut:5e3,waitJampBufferMaxCnt:3,tickInSeconds:.1,reqOptions:null,closeDowngrade:!1}}static get version(){return"3.0.0-alpha.34"}compatibleConfig(s){const i=Object.keys(s);let t=null;for(let o=0;o<i.length;o++){const a=i[o].toLowerCase();if(a==="mp4player"||a==="m4aplayer"){t=s[i[o]];break}}t&&(this.config={...this.config,...t});let{reqOptions:e,headers:r}=this.config;r&&(!e||!e.headers)&&(this.config.reqOptions={...e,headers:r})}afterCreate(){window.__mp4player=this;try{Yt.defineGetterOrSetter(this.player,{__url:{get:()=>{try{return this.mse?this.mse.url:this.config.url}catch(s){return console.error(s),null}}}})}catch(s){console.error(s)}this._proxyPlayer()}attachEvents(){this.off(Di,this._onSeeking),this.on(Di,this._onSeeking),this.on(Bi,this._onWaiting),this.off(Ni,this.switchURL),this.on(Ni,this.switchURL)}detachEvents(){this.off(Di,this._onSeeking),this.off(Bi,this._onWaiting),this.off(Ni,this.switchURL)}_proxyPlayer(){typeof this.player.playNext=="function"&&(zu=this.player.playNext),this.player.playNext=(...s)=>{this.playNext(...s)},As=this.player._startInit,Wu=this.player.switchURL,Ls=this.player.changeDefinition,this.player._startInit=this._playerStartInit.bind(this),this.player.switchURL=this.switchURL.bind(this),this.player.changeDefinition=this.changeDefinition.bind(this),this.player.useHooks("replay",this._replayHook),this.player.useHooks("retry",this._retryHook),this.player.setEventsMiddleware({error:this._errorMiddleware})}_playerStartInit(s){var i;const{config:t,playerConfig:e}=this;t.supportHevc===void 0&&(i=Te)!=null&&i.isHevcSupported&&Te.isHevcSupported()&&(t.supportHevc=!0),this._handlerUrl(e.url);const r=this.initMp4();this._initPromise=r,this._addPendingPromise(this._initPromise),this.mse&&p.typeOf(s)==="String"&&/^blob/.test(s)&&s!==this.mse.url&&(s=e.url),r.then(()=>{this.mse&&(s=this.mse.url),this.attachEvents(),this._startProgress()}).catch(o=>{console.error(o);const a=this._initPromise?this._initPromise.isBreak:!1;if(this.isDestroy||a)return;let u=o;u.errorCode||(u=new ti(this.player,{errorType:sn.RUNTIME,errorCode:(o==null?void 0:o.errorCode)||xt.other,vid:this.playerConfig.vid,errorMessage:(o==null?void 0:o.errorMessage)||(o==null?void 0:o.message),mediaError:{code:(o==null?void 0:o.httpCode)||xt.other,message:(o==null?void 0:o.errorMessage)||(o==null?void 0:o.message),errorType:o==null?void 0:o.errorType}}),u.url=s),this.useVideoLoad=!0,this.player.vtype="MP4_1",this.player.emit("playCatch",this.player.vtype,u)}).finally(()=>{if(!this._initPromise)return;const{isBreak:o}=this._initPromise;o||(this._initPromise&&this._removePendingPromise(this._initPromise),this._initPromise=null,!this.isDestroy&&!o&&As.call(this.player,s))})}initMp4(){const{player:s,config:i}=this;s.config.vid||(s.config.vid=Date.now());const t=new Sy;this.mp4&&(this.mp4.off(Ke.META_READY,this._onMp4MetaReady),this.mp4.off(Ke.ERROR,this._onMp4Error),this.mp4.off(Ke.MOOV_REQ_PROGRESS,this._onMp4DataCallBack),this.mp4.destroy(),this.mp4=null);const e=i._mainURL;return this.mp4=new Yo(e,{...this.config,vid:s.config.vid}),this.mp4.on(Ke.META_READY,this._onMp4MetaReady),this.mp4.on(Ke.ERROR,this._onMp4Error),this.mp4.on(Ke.MOOV_REQ_PROGRESS,this._onMp4DataCallBack),this.mp4.on(Ke.UPDATE_LOAD_IDX,r=>{this._curLoadSegmentIdx=r,this.log("[update curLoadSegmentIdx]",r)}),this.mp4.init(),t}_handlerUrl(s){const{config:i,playerConfig:t}=this;let e;const r=[];if(p.typeOf(s)==="String")e=s,t.backupURL&&r.push(t.backupURL);else if(p.typeOf(s)==="Array"&&s.length>0&&(e=s[0].src,s.length>1))for(let o=1;o<s.length;o++)r.push(s[o].src);if(!e&&r.length===0)return!1;i._mainURL=e,i._backupURL=r}setConfig(s){this.config=Object.assign(this.config,s)}playNext(s){const{player:i}=this;this._defInited=!1,i.resetState(),i._currentTime=0,i._duration=0,i.isPlaying=!1,this._MSEError=!1,i.pause(),this._reset(),i.setConfig(s),this.log("[Index] playNext",s),i.play(),this.emit("playnext")}checkDegrade(s){const{closeDowngrade:i}=this.config;return!i||s.httpCode==="networkError"}_errorHandler(s){var i,t;const{player:e,config:r,playerConfig:o}=this;if(!e||this.useVideoLoad)return;const{_backupURL:a}=r;if(a&&a.length>0){const c=a[0];this.mp4.update(c),this.mp4.restart(),a.splice(0,1);return}!s.url&&((i=this.mp4)!=null&&i.url)&&(s.url=this.mp4.url);const u=e.paused;if(console.error("final error !!!!, ",r.vid,s,(t=this.player.video)==null?void 0:t.error),this.player.vtype="MP4_2",this.player.emit("playCatch",this.player.vtype,s),this.checkDegrade(s)){this._initPromise&&this._removeAndRejectInitPromise(s),this._reset();const c=this.mp4?this.mp4.url:o.url;this._startDegradedPlayback(s,u,c)}else{this.player.pause(),this._reset();const{currentTime:c}=e;this.destroyMSE(),e.currentTime=c,this.emit("error",s)}}_startDegradedPlayback(s,i,t){const{player:e,playerConfig:r}=this;this.useVideoLoad=!0,this.destroyMSE(),this._currentTime=e._currentTime,this.__onmetadataHandle=()=>{this._currentTime&&(e.currentTime=this._currentTime),i?this.player.pause():this.player.play(),(e.media||e.video).removeEventListener("loadedmetadata",this.__onmetadataHandle),this.__onmetadataHandle=null};const o=e.media||e.video;o.addEventListener("loadedmetadata",this.__onmetadataHandle),Nu(o),r.url=t,Fu(e,t)}_addPendingPromise(s){this._pendingPromises.push(s)}_removePendingPromise(s){const i=this._pendingPromises.indexOf(s);i>-1&&this._pendingPromises.splice(i,1)}_cancelPendingPromises(){this._pendingPromises.length>0&&this._pendingPromises.forEach(s=>{s.reject(ky)}),this._pendingPromises=[]}_removeAndRejectInitPromise(s){this._initPromise&&(this._removePendingPromise(this._initPromise),this._initPromise.reject(s))}async _initMse(s){this.mse&&(await this.mse.unbindMedia(),this.mse=null);const i=this.mp4&&this.mp4.checkCodecH265(),t=!!s.videoCodec,e=!!s.audioCodec;let r;t&&e?r=i?'video/mp4; codecs="hev1.1.6.L93.B0, mp4a.40.5"':'video/mp4; codecs="avc1.64001E, mp4a.40.5"':t?r=i?'video/mp4; codecs="hev1.1.6.L93.B0"':'video/mp4; codecs="avc1.64001E"':r='video/mp4; codecs="mp4a.40.5"';const o={[Pt.VIDEO]:{mimeType:"video/mp4",codec:r}};this.mse=new Pt,this.mse.bindMedia(this.player.video).then(()=>{const u=Object.keys(o);try{for(let l=0;l<u.length;l++){const c=u[l];this.mse.createSource(c,o[c].codec)}}catch(l){console.error("MSE error: ",l),this._errorHandler(l)}this._isMseInit=!0,this._onTimeUpdate()})}async destroyMSE(){var s;await((s=this.mse)==null?void 0:s.unbindMedia()),this.mse=null}_onTimeUpdate(){const{mse:s,mp4:i,player:t,config:e}=this;if(!i)return;const r=i.timeRange,o=t.getBufferedRange(t.buffered2);if(s&&i&&i.canDownload){Vt.nowTime()-this._lastCheckTime>1e3&&(this._lastCheckTime=Vt.nowTime(),this._loadStuckCheck(),this._checkRemoveSourceBuffer(o,t.currentTime));const a=t.paused?t.currentTime+e.minBufferLength:t.currentTime+e.maxBufferLength;o[1]-a<0&&r.every((u,l)=>{if(u.downloaded)return!0;if(!this._isChangeDefinition&&u.endTime-u.startTime>1&&this._isInBuffer(u))return u.downloaded=!0,u.isLoading=!0,this.log(`onTimeUpdate, ${l} download segment, has buffer`,u.startTime,u.endTime),!0;u.startTime-t.currentTime<e.maxBufferLength&&(this._curLoadSegmentIdx=l,this.log("[onTimeUpdate],load index==>>>, ",l,",IdxTimeRange, ",u.startTime,"-",u.endTime,",buffEnd, ",o[1],",playCurTime,",t.currentTime,", bufferLen,",o[1]-t.currentTime,",bufferRangeList,",this.player.buffered2?this.player.buffered2.bufferedList:null),this._loadData())}),this._isEnded()}this.checkRemoveOldBitrateBuffer()}checkRemoveOldBitrateBuffer(){const{mse:s,player:i}=this;s&&this._removeBuffeEndTime>0&&i.currentTime>this._removeBuffeEndTime+1&&(this.log("remove old bitrate buffer",this._removeBuffeEndTime),s.remove(Pt.VIDEO,0,this._removeBuffeEndTime-1),this._removeBuffeEndTime=0)}_isInBuffer(s,i=0){let t=!1;const e=this.player.video.buffered;for(let r=0;r<e.length;r++){const o=e.start(r)-i,a=e.end(r)+i;if(o<=s.startTime&&s.endTime<=a){t=!0;break}}return t}async _loadData(){if(!this.mp4||!this._isMseInit){this.log("loadData, player.mp4 null",this._isMseInit);return}try{await this.mp4.load(this._curLoadSegmentIdx,this._loadDataSuccess)}catch(s){console.error("[Index] _loadData error",this.playerConfig.vid,s),this._errorHandler(s)}}_appendInitSeg(s){!this.mp4||!this.mse||this.mse.append(Pt.VIDEO,s,{vid:this.playerConfig.vid,range:null,dataLen:s.byteLength,isinit:!0}).then(i=>{this.log("appendInitSeg end ==>>>",i.context?i.context:null,", costTime,",i.costtime)})}_appendBuffer(s,i,t={},e){const{mse:r,config:o}=this;r.append(s,i,{vid:o.vid,fragIndex:t.fragIndex,range:t.range,dataLen:i.byteLength,state:e}).then(a=>{if(a&&(this.log("player appendBuffer end ==>>>",a.context?a.context:null,", costTime,",a.costtime,", opt,",a.name,",bufferRange,",this.player.getBufferedRange()),this.mse&&t.state&&t.fragIndex===this.mp4.timeRange.length-1)){const u=this.player.buffered;u&&u.length>0&&(this.bufferEndTime=u.end(u.length-1)),this._isEnded(),this.log("loaded ended !!!==>>>",t.range,", fragIndex,",t.fragIndex,", bufferEndTime,",this.bufferEndTime,",meta_duration,",this.mp4.meta.duration)}}).catch(a=>{if(console.log("[MSE error]",a),a&&(r!=null&&r.isFull())){const u=this.player.getBufferedRange(this.player.buffered2);this._checkRemoveSourceBuffer(u,this.player.currentTime,!0)}})}_checkRemoveSourceBuffer(s,i,t){const{mse:e,mp4:r,player:o}=this;if(!(!e||!r||!o)&&(t&&(clearTimeout(this._removeBufferTimer),this._removeBufferTimer=null),s||(s=o.getBufferedRange(o.buffered2)),i||(i=o.currentTime),!(!t&&Vt.nowTime()-this._checkRemoveBufferLastTime<=this.config.removeBufferLen||this.endofstream)&&(this._checkRemoveBufferLastTime=Vt.nowTime(),s&&s[0]>=0&&(i-s[0]>this.config.removeBufferLen||e.isFull())))){const a=s[1],u=r.getFragmentIdx(a);if(u>=0&&r.timeRange[u].startTime<i){const l=Math.floor(Math.min(r.timeRange[u].startTime,s[1]));s[0]<l?(this.log("[checkremoveSourceBuffer], remove range==>>>",s[0],l),e.remove(Pt.VIDEO,s[0],l)):e.isFull()&&!this._removeBufferTimer&&(this._removeBufferTimer=setTimeout(()=>{this._checkRemoveSourceBuffer(null,null,!0)},10*1e3))}}}_isEnded(){const{player:s,mp4:i}=this,t=s.bufferedPoint,e=t?t.end:0;return!this.endofstream&&this.mse&&i.meta.duration-s.currentTime<.5&&(this.log("[check player isEnded],deal mse.endOfStream, currentTime,",s.currentTime,", bufferend,",e,", duration,",i.meta.duration),this.endofstream=!0,this.mse.endOfStream()),i&&i.meta&&i.meta.duration-s.currentTime<.5?(this._stopProgress(),this.log("[check player isEnded],stopProgress and endOfStream,currentTime, ",s.currentTime,", bufferend,",e,", duration,",i.meta.duration),this.mse&&this.mse.endOfStream(),!0):!1}switchURL(s){if(this.useVideoLoad){const{player:i}=this,{currentTime:t}=i;Fu(i,s),i.once("canplay",()=>{i.currentTime=t}),i.play()}else this.changeDefinition(s)}oldChangeDefinition(s,i){const{config:t,player:e}=this;this.log("[oldChangeDefinition],currentTime,",e.currentTime,",from,",i,",to,",s);const{currentTime:r,paused:o}=e;this._changeDefState||(this._changeDefState={currentTime:r,paused:o},this.log("[oldChangeDefinition],currentTime,",e.currentTime,",pause,",o)),e.config.url=s.url,t.focusUserDefinition=!0,e.currentTime=0,e.pause(),this._reset(),this._isMseInit=!1,this._changeDefineCanPlay&&e.off("canplay",this._changeDefineCanPlay),this._changeDefineCanPlay=()=>{this.changeDefineCanPlay(r,o,i,s),this._changeDefineCanPlay=null},e.once("canplay",this._changeDefineCanPlay),this.player.video.load(),this.initMp4()}_loadStuckCheck(){const{config:s,player:i,playerConfig:t}=this;s.disableBufferBreakCheck||(i.currentTime-(this._lastCurrentTime||0)>.1||i.paused?(this._bufferBreakFlag===1||this._bufferBreakFlag===2)&&(this.log("视频没有卡死,重置卡死标记"),this._bufferBreakFlag=0,clearTimeout(this._bufferBreakTimer),this._bufferBreakFlag=null):this._bufferBreakFlag||(this._bufferBreakFlag=1,this.log(`卡死计时开始! 持续${s.waitingTimeOut}毫秒则确认卡死`),this._bufferBreakTimer=setTimeout(()=>{this.isDestroy||(this._bufferBreakFlag===1&&(this._bufferBreakFlag=2,this.log("确认卡死!!!"),this._errorHandler(new ti(this.player,{errorType:"runtime",errorTypeCode:sn.runtime,errorCode:xt.waitTimeout,errorMessage:"wait_timeout",vid:t.vid}))),this._bufferBreakTimer=null)},s.waitingTimeOut)),this._lastCurrentTime=i.currentTime)}get isDestroy(){return!this.player}_stopProgress(){this._hasStartProgress=!1,this._requestTimer&&(this._requestTimer.stop(),this._requestTimer=null),this._bufferBreakTimer&&(clearTimeout(this._bufferBreakTimer),this._bufferBreakTimer=null,this._bufferBreakFlag=void 0)}_startProgress(){this._hasStartProgress||(this._stopProgress(),this._requestTimer=new Ty(()=>{this._requestTimer&&this._onTimeUpdate()}),this._requestTimer.tickEvery(this.config.tickInSeconds),this._hasStartProgress=!0)}log(s,...i){const{playerConfig:t}=this,e=t&&t.vid?`[Index]${t.vid} ${s}`:`[Index] ${s}`;tf(e,...i)}_reset(){this._isMseInit=!1,this.endofstream=!1,this._curLoadSegmentIdx=0,this._removeBuffeEndTime=0,this._isChangeDefinition=!1,this._stopProgress(),this.mp4&&(this.mp4.off(Ke.META_READY,this._onMp4MetaReady),this.mp4.off(Ke.ERROR,this._onMp4Error),this.mp4.off(Ke.MOOV_REQ_PROGRESS,this._onMp4DataCallBack),this.mp4.destroy(),this.mp4=null),this.mse&&(this.mse.unbindMedia(),this.mse=null),Nu(this.player.video)}destroy(){const{player:s}=this;s.removeHooks("replay",this._replayHook),s.removeHooks("retry",this._retryHook),s.removeEventsMiddleware({error:this._errorMiddleware}),this.detachEvents(),this._reset(),this.player.playNext=zu,this.player._startInit=As,this.player.changeDefinition=Ls,this.player.switchURL=Wu,this._bufferBreakTimer&&clearInterval(this._bufferBreakTimer),this._removeBufferTimer&&(clearTimeout(this._removeBufferTimer),this._removeBufferTimer=null),this._waitInBufferTimer&&(clearTimeout(this._waitInBufferTimer),this._waitInBufferTimer=null)}}const xy={__name:"home",setup(n){return kl(()=>{window.addEventListener("contextmenu",s=>{s.preventDefault()},!1),new Mt({id:"vs",url:"/api/video/stream",videoInit:!1,playbackRate:!1,leavePlayerTime:100,playsinline:!0,lang:"en",plugins:[Py],commonStyles:{progressColor:"#fff",playedColor:"#fff",volumeColor:"#fff"}})}),(s,i)=>(Gl(),Bh("div",null,i[0]||(i[0]=[ko("div",{class:"videoPlayer",id:"vs"},null,-1)])))}},Ry=hc(xy,[["__scopeId","data-v-9ae37fe3"]]),Iy=kg({history:ng("/"),routes:[{path:"/",name:"home",component:Ry},{path:"/traces/:id",name:"traces",component:()=>Lg(()=>import("./traces-B7H4Y5qr.js"),__vite__mapDeps([0,1]))}]}),$o=Ed(Rg);$o.use(kd());$o.use(Iy);$o.mount("#app");export{hc as _,ko as a,Bh as c,Gl as o};
