const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/traces-DJCymNes.js","assets/traces-B3dI40fp.css"])))=>i.map(i=>d[i]);
/**
* @vue/shared v3.5.12
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Ls(i){const n=Object.create(null);for(const e of i.split(","))n[e]=1;return e=>e in n}(function(){const i=document.createElement("link").relList;if(!(i&&i.supports&&i.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const r of t.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0})}function n(e){if(e.ep)return;e.ep=!0;const t=function(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}(e);fetch(e.href,t)}})();const Ue={},li=[],sn=()=>{},Mh=()=>!1,Yr=i=>i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&(i.charCodeAt(2)>122||i.charCodeAt(2)<97),Os=i=>i.startsWith("onUpdate:"),Ze=Object.assign,Is=(i,n)=>{const e=i.indexOf(n);e>-1&&i.splice(e,1)},Nh=Object.prototype.hasOwnProperty,De=(i,n)=>Nh.call(i,n),ke=Array.isArray,ci=i=>$r(i)==="[object Map]",wl=i=>$r(i)==="[object Set]",Se=i=>typeof i=="function",Xe=i=>typeof i=="string",On=i=>typeof i=="symbol",We=i=>i!==null&&typeof i=="object",Tl=i=>(We(i)||Se(i))&&Se(i.then)&&Se(i.catch),xl=Object.prototype.toString,$r=i=>xl.call(i),Sl=i=>$r(i)==="[object Object]",Rs=i=>Xe(i)&&i!=="NaN"&&i[0]!=="-"&&""+parseInt(i,10)===i,Ri=Ls(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Xr=i=>{const n=Object.create(null);return e=>n[e]||(n[e]=i(e))},Fh=/-(\w)/g,Sn=Xr(i=>i.replace(Fh,(n,e)=>e?e.toUpperCase():"")),Bh=/\B([A-Z])/g,qn=Xr(i=>i.replace(Bh,"-$1").toLowerCase()),Cl=Xr(i=>i.charAt(0).toUpperCase()+i.slice(1)),uo=Xr(i=>i?`on${Cl(i)}`:""),Tn=(i,n)=>!Object.is(i,n),lo=(i,...n)=>{for(let e=0;e<i.length;e++)i[e](...n)},El=(i,n,e,t=!1)=>{Object.defineProperty(i,n,{configurable:!0,enumerable:!1,writable:t,value:e})},Uh=i=>{const n=parseFloat(i);return isNaN(n)?i:n};let ua;const Er=()=>ua||(ua=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function As(i){if(ke(i)){const n={};for(let e=0;e<i.length;e++){const t=i[e],r=Xe(t)?zh(t):As(t);if(r)for(const o in r)n[o]=r[o]}return n}if(Xe(i)||We(i))return i}const jh=/;(?![^(]*\))/g,Hh=/:([^]+)/,Vh=/\/\*[^]*?\*\//g;function zh(i){const n={};return i.replace(Vh,"").split(jh).forEach(e=>{if(e){const t=e.split(Hh);t.length>1&&(n[t[0].trim()]=t[1].trim())}}),n}function Ds(i){let n="";if(Xe(i))n=i;else if(ke(i))for(let e=0;e<i.length;e++){const t=Ds(i[e]);t&&(n+=t+" ")}else if(We(i))for(const e in i)i[e]&&(n+=e+" ");return n.trim()}const Wh=Ls("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function Pl(i){return!!i||i===""}const Ll=i=>!(!i||i.__v_isRef!==!0),Ol=i=>Xe(i)?i:i==null?"":ke(i)||We(i)&&(i.toString===xl||!Se(i.toString))?Ll(i)?Ol(i.value):JSON.stringify(i,Il,2):String(i),Il=(i,n)=>Ll(n)?Il(i,n.value):ci(n)?{[`Map(${n.size})`]:[...n.entries()].reduce((e,[t,r],o)=>(e[co(t,o)+" =>"]=r,e),{})}:wl(n)?{[`Set(${n.size})`]:[...n.values()].map(e=>co(e))}:On(n)?co(n):!We(n)||ke(n)||Sl(n)?n:String(n),co=(i,n="")=>{var e;return On(i)?`Symbol(${(e=i.description)!=null?e:n})`:i};/**
* @vue/reactivity v3.5.12
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let bt,He;class Rl{constructor(n=!1){this.detached=n,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=bt,!n&&bt&&(this.index=(bt.scopes||(bt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){let n,e;if(this._isPaused=!0,this.scopes)for(n=0,e=this.scopes.length;n<e;n++)this.scopes[n].pause();for(n=0,e=this.effects.length;n<e;n++)this.effects[n].pause()}}resume(){if(this._active&&this._isPaused){let n,e;if(this._isPaused=!1,this.scopes)for(n=0,e=this.scopes.length;n<e;n++)this.scopes[n].resume();for(n=0,e=this.effects.length;n<e;n++)this.effects[n].resume()}}run(n){if(this._active){const e=bt;try{return bt=this,n()}finally{bt=e}}}on(){bt=this}off(){bt=this.parent}stop(n){if(this._active){let e,t;for(e=0,t=this.effects.length;e<t;e++)this.effects[e].stop();for(e=0,t=this.cleanups.length;e<t;e++)this.cleanups[e]();if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].stop(!0);if(!this.detached&&this.parent&&!n){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0,this._active=!1}}}const ho=new WeakSet;class Al{constructor(n){this.fn=n,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,bt&&bt.active&&bt.effects.push(this)}pause(){this.flags|=64}resume(){64&this.flags&&(this.flags&=-65,ho.has(this)&&(ho.delete(this),this.trigger()))}notify(){2&this.flags&&!(32&this.flags)||8&this.flags||Ml(this)}run(){if(!(1&this.flags))return this.fn();this.flags|=2,la(this),Nl(this);const n=He,e=Ft;He=this,Ft=!0;try{return this.fn()}finally{Fl(this),He=n,Ft=e,this.flags&=-3}}stop(){if(1&this.flags){for(let n=this.deps;n;n=n.nextDep)Fs(n);this.deps=this.depsTail=void 0,la(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){64&this.flags?ho.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){es(this)&&this.run()}get dirty(){return es(this)}}let Ai,Di,Dl=0;function Ml(i,n=!1){if(i.flags|=8,n)return i.next=Di,void(Di=i);i.next=Ai,Ai=i}function Ms(){Dl++}function Ns(){if(--Dl>0)return;if(Di){let n=Di;for(Di=void 0;n;){const e=n.next;n.next=void 0,n.flags&=-9,n=e}}let i;for(;Ai;){let n=Ai;for(Ai=void 0;n;){const e=n.next;if(n.next=void 0,n.flags&=-9,1&n.flags)try{n.trigger()}catch(t){i||(i=t)}n=e}}if(i)throw i}function Nl(i){for(let n=i.deps;n;n=n.nextDep)n.version=-1,n.prevActiveLink=n.dep.activeLink,n.dep.activeLink=n}function Fl(i){let n,e=i.depsTail,t=e;for(;t;){const r=t.prevDep;t.version===-1?(t===e&&(e=r),Fs(t),Gh(t)):n=t,t.dep.activeLink=t.prevActiveLink,t.prevActiveLink=void 0,t=r}i.deps=n,i.depsTail=e}function es(i){for(let n=i.deps;n;n=n.nextDep)if(n.dep.version!==n.version||n.dep.computed&&(Bl(n.dep.computed)||n.dep.version!==n.version))return!0;return!!i._dirty}function Bl(i){if(4&i.flags&&!(16&i.flags)||(i.flags&=-17,i.globalVersion===Wi))return;i.globalVersion=Wi;const n=i.dep;if(i.flags|=2,n.version>0&&!i.isSSR&&i.deps&&!es(i))return void(i.flags&=-3);const e=He,t=Ft;He=i,Ft=!0;try{Nl(i);const r=i.fn(i._value);(n.version===0||Tn(r,i._value))&&(i._value=r,n.version++)}catch(r){throw n.version++,r}finally{He=e,Ft=t,Fl(i),i.flags&=-3}}function Fs(i,n=!1){const{dep:e,prevSub:t,nextSub:r}=i;if(t&&(t.nextSub=r,i.prevSub=void 0),r&&(r.prevSub=t,i.nextSub=void 0),e.subs===i&&(e.subs=t,!t&&e.computed)){e.computed.flags&=-5;for(let o=e.computed.deps;o;o=o.nextDep)Fs(o,!0)}n||--e.sc||!e.map||e.map.delete(e.key)}function Gh(i){const{prevDep:n,nextDep:e}=i;n&&(n.nextDep=e,i.prevDep=void 0),e&&(e.prevDep=n,i.nextDep=void 0)}let Ft=!0;const Ul=[];function Cn(){Ul.push(Ft),Ft=!1}function En(){const i=Ul.pop();Ft=i===void 0||i}function la(i){const{cleanup:n}=i;if(i.cleanup=void 0,n){const e=He;He=void 0;try{n()}finally{He=e}}}let Wi=0;class Kh{constructor(n,e){this.sub=n,this.dep=e,this.version=e.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Bs{constructor(n){this.computed=n,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(n){if(!He||!Ft||He===this.computed)return;let e=this.activeLink;if(e===void 0||e.sub!==He)e=this.activeLink=new Kh(He,this),He.deps?(e.prevDep=He.depsTail,He.depsTail.nextDep=e,He.depsTail=e):He.deps=He.depsTail=e,jl(e);else if(e.version===-1&&(e.version=this.version,e.nextDep)){const t=e.nextDep;t.prevDep=e.prevDep,e.prevDep&&(e.prevDep.nextDep=t),e.prevDep=He.depsTail,e.nextDep=void 0,He.depsTail.nextDep=e,He.depsTail=e,He.deps===e&&(He.deps=t)}return e}trigger(n){this.version++,Wi++,this.notify(n)}notify(n){Ms();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{Ns()}}}function jl(i){if(i.dep.sc++,4&i.sub.flags){const n=i.dep.computed;if(n&&!i.dep.subs){n.flags|=20;for(let t=n.deps;t;t=t.nextDep)jl(t)}const e=i.dep.subs;e!==i&&(i.prevSub=e,e&&(e.nextSub=i)),i.dep.subs=i}}const ts=new WeakMap,Un=Symbol(""),ns=Symbol(""),Gi=Symbol("");function rt(i,n,e){if(Ft&&He){let t=ts.get(i);t||ts.set(i,t=new Map);let r=t.get(e);r||(t.set(e,r=new Bs),r.map=t,r.key=e),r.track()}}function en(i,n,e,t,r,o){const s=ts.get(i);if(!s)return void Wi++;const a=u=>{u&&u.trigger()};if(Ms(),n==="clear")s.forEach(a);else{const u=ke(i),l=u&&Rs(e);if(u&&e==="length"){const c=Number(t);s.forEach((h,d)=>{(d==="length"||d===Gi||!On(d)&&d>=c)&&a(h)})}else switch((e!==void 0||s.has(void 0))&&a(s.get(e)),l&&a(s.get(Gi)),n){case"add":u?l&&a(s.get("length")):(a(s.get(Un)),ci(i)&&a(s.get(ns)));break;case"delete":u||(a(s.get(Un)),ci(i)&&a(s.get(ns)));break;case"set":ci(i)&&a(s.get(Un))}}Ns()}function Zn(i){const n=Ae(i);return n===i?n:(rt(n,0,Gi),Pt(i)?n:n.map(ot))}function Jr(i){return rt(i=Ae(i),0,Gi),i}const qh={__proto__:null,[Symbol.iterator](){return fo(this,Symbol.iterator,ot)},concat(...i){return Zn(this).concat(...i.map(n=>ke(n)?Zn(n):n))},entries(){return fo(this,"entries",i=>(i[1]=ot(i[1]),i))},every(i,n){return Yt(this,"every",i,n,void 0,arguments)},filter(i,n){return Yt(this,"filter",i,n,e=>e.map(ot),arguments)},find(i,n){return Yt(this,"find",i,n,ot,arguments)},findIndex(i,n){return Yt(this,"findIndex",i,n,void 0,arguments)},findLast(i,n){return Yt(this,"findLast",i,n,ot,arguments)},findLastIndex(i,n){return Yt(this,"findLastIndex",i,n,void 0,arguments)},forEach(i,n){return Yt(this,"forEach",i,n,void 0,arguments)},includes(...i){return po(this,"includes",i)},indexOf(...i){return po(this,"indexOf",i)},join(i){return Zn(this).join(i)},lastIndexOf(...i){return po(this,"lastIndexOf",i)},map(i,n){return Yt(this,"map",i,n,void 0,arguments)},pop(){return bi(this,"pop")},push(...i){return bi(this,"push",i)},reduce(i,...n){return ca(this,"reduce",i,n)},reduceRight(i,...n){return ca(this,"reduceRight",i,n)},shift(){return bi(this,"shift")},some(i,n){return Yt(this,"some",i,n,void 0,arguments)},splice(...i){return bi(this,"splice",i)},toReversed(){return Zn(this).toReversed()},toSorted(i){return Zn(this).toSorted(i)},toSpliced(...i){return Zn(this).toSpliced(...i)},unshift(...i){return bi(this,"unshift",i)},values(){return fo(this,"values",ot)}};function fo(i,n,e){const t=Jr(i),r=t[n]();return t===i||Pt(i)||(r._next=r.next,r.next=()=>{const o=r._next();return o.value&&(o.value=e(o.value)),o}),r}const Yh=Array.prototype;function Yt(i,n,e,t,r,o){const s=Jr(i),a=s!==i&&!Pt(i),u=s[n];if(u!==Yh[n]){const h=u.apply(i,o);return a?ot(h):h}let l=e;s!==i&&(a?l=function(h,d){return e.call(this,ot(h),d,i)}:e.length>2&&(l=function(h,d){return e.call(this,h,d,i)}));const c=u.call(s,l,t);return a&&r?r(c):c}function ca(i,n,e,t){const r=Jr(i);let o=e;return r!==i&&(Pt(i)?e.length>3&&(o=function(s,a,u){return e.call(this,s,a,u,i)}):o=function(s,a,u){return e.call(this,s,ot(a),u,i)}),r[n](o,...t)}function po(i,n,e){const t=Ae(i);rt(t,0,Gi);const r=t[n](...e);return r!==-1&&r!==!1||!is(e[0])?r:(e[0]=Ae(e[0]),t[n](...e))}function bi(i,n,e=[]){Cn(),Ms();const t=Ae(i)[n].apply(i,e);return Ns(),En(),t}const $h=Ls("__proto__,__v_isRef,__isVue"),Hl=new Set(Object.getOwnPropertyNames(Symbol).filter(i=>i!=="arguments"&&i!=="caller").map(i=>Symbol[i]).filter(On));function Xh(i){On(i)||(i=String(i));const n=Ae(this);return rt(n,0,i),n.hasOwnProperty(i)}class Vl{constructor(n=!1,e=!1){this._isReadonly=n,this._isShallow=e}get(n,e,t){const r=this._isReadonly,o=this._isShallow;if(e==="__v_isReactive")return!r;if(e==="__v_isReadonly")return r;if(e==="__v_isShallow")return o;if(e==="__v_raw")return t===(r?o?od:Kl:o?Gl:Wl).get(n)||Object.getPrototypeOf(n)===Object.getPrototypeOf(t)?n:void 0;const s=ke(n);if(!r){let u;if(s&&(u=qh[e]))return u;if(e==="hasOwnProperty")return Xh}const a=Reflect.get(n,e,at(n)?n:t);return(On(e)?Hl.has(e):$h(e))?a:(r||rt(n,0,e),o?a:at(a)?s&&Rs(e)?a:a.value:We(a)?r?Yl(a):Xi(a):a)}}class zl extends Vl{constructor(n=!1){super(!1,n)}set(n,e,t,r){let o=n[e];if(!this._isShallow){const u=zn(o);if(Pt(t)||zn(t)||(o=Ae(o),t=Ae(t)),!ke(n)&&at(o)&&!at(t))return!u&&(o.value=t,!0)}const s=ke(n)&&Rs(e)?Number(e)<n.length:De(n,e),a=Reflect.set(n,e,t,at(n)?n:r);return n===Ae(r)&&(s?Tn(t,o)&&en(n,"set",e,t):en(n,"add",e,t)),a}deleteProperty(n,e){const t=De(n,e);n[e];const r=Reflect.deleteProperty(n,e);return r&&t&&en(n,"delete",e,void 0),r}has(n,e){const t=Reflect.has(n,e);return On(e)&&Hl.has(e)||rt(n,0,e),t}ownKeys(n){return rt(n,0,ke(n)?"length":Un),Reflect.ownKeys(n)}}class Jh extends Vl{constructor(n=!1){super(!0,n)}set(n,e){return!0}deleteProperty(n,e){return!0}}const Zh=new zl,Qh=new Jh,ed=new zl(!0),go=i=>i,rr=i=>Reflect.getPrototypeOf(i);function or(i){return function(...n){return i!=="delete"&&(i==="clear"?void 0:this)}}function td(i,n){const e={get(t){const r=this.__v_raw,o=Ae(r),s=Ae(t);i||(Tn(t,s)&&rt(o,0,t),rt(o,0,s));const{has:a}=rr(o),u=n?go:i?mo:ot;return a.call(o,t)?u(r.get(t)):a.call(o,s)?u(r.get(s)):void(r!==o&&r.get(t))},get size(){const t=this.__v_raw;return!i&&rt(Ae(t),0,Un),Reflect.get(t,"size",t)},has(t){const r=this.__v_raw,o=Ae(r),s=Ae(t);return i||(Tn(t,s)&&rt(o,0,t),rt(o,0,s)),t===s?r.has(t):r.has(t)||r.has(s)},forEach(t,r){const o=this,s=o.__v_raw,a=Ae(s),u=n?go:i?mo:ot;return!i&&rt(a,0,Un),s.forEach((l,c)=>t.call(r,u(l),u(c),o))}};return Ze(e,i?{add:or("add"),set:or("set"),delete:or("delete"),clear:or("clear")}:{add(t){n||Pt(t)||zn(t)||(t=Ae(t));const r=Ae(this);return rr(r).has.call(r,t)||(r.add(t),en(r,"add",t,t)),this},set(t,r){n||Pt(r)||zn(r)||(r=Ae(r));const o=Ae(this),{has:s,get:a}=rr(o);let u=s.call(o,t);u||(t=Ae(t),u=s.call(o,t));const l=a.call(o,t);return o.set(t,r),u?Tn(r,l)&&en(o,"set",t,r):en(o,"add",t,r),this},delete(t){const r=Ae(this),{has:o,get:s}=rr(r);let a=o.call(r,t);a||(t=Ae(t),a=o.call(r,t)),s&&s.call(r,t);const u=r.delete(t);return a&&en(r,"delete",t,void 0),u},clear(){const t=Ae(this),r=t.size!==0,o=t.clear();return r&&en(t,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(t=>{e[t]=function(r,o,s){return function(...a){const u=this.__v_raw,l=Ae(u),c=ci(l),h=r==="entries"||r===Symbol.iterator&&c,d=r==="keys"&&c,f=u[r](...a),p=s?go:o?mo:ot;return!o&&rt(l,0,d?ns:Un),{next(){const{value:m,done:v}=f.next();return v?{value:m,done:v}:{value:h?[p(m[0]),p(m[1])]:p(m),done:v}},[Symbol.iterator](){return this}}}}(t,i,n)}),e}function Us(i,n){const e=td(i,n);return(t,r,o)=>r==="__v_isReactive"?!i:r==="__v_isReadonly"?i:r==="__v_raw"?t:Reflect.get(De(e,r)&&r in t?e:t,r,o)}const nd={get:Us(!1,!1)},id={get:Us(!1,!0)},rd={get:Us(!0,!1)},Wl=new WeakMap,Gl=new WeakMap,Kl=new WeakMap,od=new WeakMap;function sd(i){return i.__v_skip||!Object.isExtensible(i)?0:function(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}((n=>$r(n).slice(8,-1))(i))}function Xi(i){return zn(i)?i:js(i,!1,Zh,nd,Wl)}function ql(i){return js(i,!1,ed,id,Gl)}function Yl(i){return js(i,!0,Qh,rd,Kl)}function js(i,n,e,t,r){if(!We(i)||i.__v_raw&&(!n||!i.__v_isReactive))return i;const o=r.get(i);if(o)return o;const s=sd(i);if(s===0)return i;const a=new Proxy(i,s===2?t:e);return r.set(i,a),a}function hi(i){return zn(i)?hi(i.__v_raw):!(!i||!i.__v_isReactive)}function zn(i){return!(!i||!i.__v_isReadonly)}function Pt(i){return!(!i||!i.__v_isShallow)}function is(i){return!!i&&!!i.__v_raw}function Ae(i){const n=i&&i.__v_raw;return n?Ae(n):i}function $l(i){return!De(i,"__v_skip")&&Object.isExtensible(i)&&El(i,"__v_skip",!0),i}const ot=i=>We(i)?Xi(i):i,mo=i=>We(i)?Yl(i):i;function at(i){return!!i&&i.__v_isRef===!0}function Pr(i){return Xl(i,!1)}function Xl(i,n){return at(i)?i:new ad(i,n)}class ad{constructor(n,e){this.dep=new Bs,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=e?n:Ae(n),this._value=e?n:ot(n),this.__v_isShallow=e}get value(){return this.dep.track(),this._value}set value(n){const e=this._rawValue,t=this.__v_isShallow||Pt(n)||zn(n);n=t?n:Ae(n),Tn(n,e)&&(this._rawValue=n,this._value=t?n:ot(n),this.dep.trigger())}}function xn(i){return at(i)?i.value:i}const ud={get:(i,n,e)=>n==="__v_raw"?i:xn(Reflect.get(i,n,e)),set:(i,n,e,t)=>{const r=i[n];return at(r)&&!at(e)?(r.value=e,!0):Reflect.set(i,n,e,t)}};function Jl(i){return hi(i)?i:new Proxy(i,ud)}class ld{constructor(n,e,t){this.fn=n,this.setter=e,this._value=void 0,this.dep=new Bs(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Wi-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!e,this.isSSR=t}notify(){if(this.flags|=16,!(8&this.flags)&&He!==this)return Ml(this,!0),!0}get value(){const n=this.dep.track();return Bl(this),n&&(n.version=this.dep.version),this._value}set value(n){this.setter&&this.setter(n)}}const sr={},ar=new WeakMap;let An;function cd(i,n,e=Ue){const{immediate:t,deep:r,once:o,scheduler:s,augmentJob:a,call:u}=e,l=C=>r?C:Pt(C)||r===!1||r===0?tn(C,1):tn(C);let c,h,d,f,p=!1,m=!1;if(at(i)?(h=()=>i.value,p=Pt(i)):hi(i)?(h=()=>l(i),p=!0):ke(i)?(m=!0,p=i.some(C=>hi(C)||Pt(C)),h=()=>i.map(C=>at(C)?C.value:hi(C)?l(C):Se(C)?u?u(C,2):C():void 0)):h=Se(i)?n?u?()=>u(i,2):i:()=>{if(d){Cn();try{d()}finally{En()}}const C=An;An=c;try{return u?u(i,3,[f]):i(f)}finally{An=C}}:sn,n&&r){const C=h,E=r===!0?1/0:r;h=()=>tn(C(),E)}const v=bt,y=()=>{c.stop(),v&&Is(v.effects,c)};if(o&&n){const C=n;n=(...E)=>{C(...E),y()}}let w=m?new Array(i.length).fill(sr):sr;const S=C=>{if(1&c.flags&&(c.dirty||C))if(n){const E=c.run();if(r||p||(m?E.some((R,W)=>Tn(R,w[W])):Tn(E,w))){d&&d();const R=An;An=c;try{const W=[E,w===sr?void 0:m&&w[0]===sr?[]:w,f];u?u(n,3,W):n(...W),w=E}finally{An=R}}}else c.run()};return a&&a(S),c=new Al(h),c.scheduler=s?()=>s(S,!1):S,f=C=>function(E,R=!1,W=An){if(W){let J=ar.get(W);J||ar.set(W,J=[]),J.push(E)}}(C,!1,c),d=c.onStop=()=>{const C=ar.get(c);if(C){if(u)u(C,4);else for(const E of C)E();ar.delete(c)}},n?t?S(!0):w=c.run():s?s(S.bind(null,!0),!0):c.run(),y.pause=c.pause.bind(c),y.resume=c.resume.bind(c),y.stop=y,y}function tn(i,n=1/0,e){if(n<=0||!We(i)||i.__v_skip||(e=e||new Set).has(i))return i;if(e.add(i),n--,at(i))tn(i.value,n,e);else if(ke(i))for(let t=0;t<i.length;t++)tn(i[t],n,e);else if(wl(i)||ci(i))i.forEach(t=>{tn(t,n,e)});else if(Sl(i)){for(const t in i)tn(i[t],n,e);for(const t of Object.getOwnPropertySymbols(i))Object.prototype.propertyIsEnumerable.call(i,t)&&tn(i[t],n,e)}return i}/**
* @vue/runtime-core v3.5.12
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Ji(i,n,e,t){try{return t?i(...t):i()}catch(r){Zr(r,n,e)}}function Kt(i,n,e,t){if(Se(i)){const r=Ji(i,n,e,t);return r&&Tl(r)&&r.catch(o=>{Zr(o,n,e)}),r}if(ke(i)){const r=[];for(let o=0;o<i.length;o++)r.push(Kt(i[o],n,e,t));return r}}function Zr(i,n,e,t=!0){n&&n.vnode;const{errorHandler:r,throwUnhandledErrorInProduction:o}=n&&n.appContext.config||Ue;if(n){let s=n.parent;const a=n.proxy,u=`https://vuejs.org/error-reference/#runtime-${e}`;for(;s;){const l=s.ec;if(l){for(let c=0;c<l.length;c++)if(l[c](i,a,u)===!1)return}s=s.parent}if(r)return Cn(),Ji(r,null,10,[i,a,u]),void En()}(function(s,a,u,l=!0,c=!1){if(c)throw s})(i,0,0,t,o)}const ct=[];let Ht=-1;const di=[];let _n=null,ri=0;const Zl=Promise.resolve();let Lr=null;function Ql(i){const n=Lr||Zl;return i?n.then(this?i.bind(this):i):n}function Hs(i){if(!(1&i.flags)){const n=Mi(i),e=ct[ct.length-1];!e||!(2&i.flags)&&n>=Mi(e)?ct.push(i):ct.splice(function(t){let r=Ht+1,o=ct.length;for(;r<o;){const s=r+o>>>1,a=ct[s],u=Mi(a);u<t||u===t&&2&a.flags?r=s+1:o=s}return r}(n),0,i),i.flags|=1,ec()}}function ec(){Lr||(Lr=Zl.then(nc))}function ha(i,n,e=Ht+1){for(;e<ct.length;e++){const t=ct[e];if(t&&2&t.flags){if(i&&t.id!==i.uid)continue;ct.splice(e,1),e--,4&t.flags&&(t.flags&=-2),t(),4&t.flags||(t.flags&=-2)}}}function tc(i){if(di.length){const n=[...new Set(di)].sort((e,t)=>Mi(e)-Mi(t));if(di.length=0,_n)return void _n.push(...n);for(_n=n,ri=0;ri<_n.length;ri++){const e=_n[ri];4&e.flags&&(e.flags&=-2),8&e.flags||e(),e.flags&=-2}_n=null,ri=0}}const Mi=i=>i.id==null?2&i.flags?-1:1/0:i.id;function nc(i){try{for(Ht=0;Ht<ct.length;Ht++){const n=ct[Ht];!n||8&n.flags||(4&n.flags&&(n.flags&=-2),Ji(n,n.i,n.i?15:14),4&n.flags||(n.flags&=-2))}}finally{for(;Ht<ct.length;Ht++){const n=ct[Ht];n&&(n.flags&=-2)}Ht=-1,ct.length=0,tc(),Lr=null,(ct.length||di.length)&&nc()}}let kt=null,ic=null;function Or(i){const n=kt;return kt=i,ic=i&&i.type.__scopeId||null,n}function hd(i,n){if(kt===null)return i;const e=to(kt),t=i.dirs||(i.dirs=[]);for(let r=0;r<n.length;r++){let[o,s,a,u=Ue]=n[r];o&&(Se(o)&&(o={mounted:o,updated:o}),o.deep&&tn(s),t.push({dir:o,instance:e,value:s,oldValue:void 0,arg:a,modifiers:u}))}return i}function Dn(i,n,e,t){const r=i.dirs,o=n&&n.dirs;for(let s=0;s<r.length;s++){const a=r[s];o&&(a.oldValue=o[s].value);let u=a.dir[t];u&&(Cn(),Kt(u,e,8,[i.el,a,i,n]),En())}}const dd=Symbol("_vte");function Vs(i,n){6&i.shapeFlag&&i.component?(i.transition=n,Vs(i.component.subTree,n)):128&i.shapeFlag?(i.ssContent.transition=n.clone(i.ssContent),i.ssFallback.transition=n.clone(i.ssFallback)):i.transition=n}/*! #__NO_SIDE_EFFECTS__ */function rc(i,n){return Se(i)?Ze({name:i.name},n,{setup:i}):i}function oc(i){i.ids=[i.ids[0]+i.ids[2]+++"-",0,0]}function rs(i,n,e,t,r=!1){if(ke(i))return void i.forEach((p,m)=>rs(p,n&&(ke(n)?n[m]:n),e,t,r));if(Oi(t)&&!r)return;const o=4&t.shapeFlag?to(t.component):t.el,s=r?null:o,{i:a,r:u}=i,l=n&&n.r,c=a.refs===Ue?a.refs={}:a.refs,h=a.setupState,d=Ae(h),f=h===Ue?()=>!1:p=>De(d,p);if(l!=null&&l!==u&&(Xe(l)?(c[l]=null,f(l)&&(h[l]=null)):at(l)&&(l.value=null)),Se(u))Ji(u,a,12,[s,c]);else{const p=Xe(u),m=at(u);if(p||m){const v=()=>{if(i.f){const y=p?f(u)?h[u]:c[u]:u.value;r?ke(y)&&Is(y,o):ke(y)?y.includes(o)||y.push(o):p?(c[u]=[o],f(u)&&(h[u]=c[u])):(u.value=[o],i.k&&(c[i.k]=u.value))}else p?(c[u]=s,f(u)&&(h[u]=s)):m&&(u.value=s,i.k&&(c[i.k]=s))};s?(v.id=-1,yt(v,e)):v()}}}Er().requestIdleCallback,Er().cancelIdleCallback;const Oi=i=>!!i.type.__asyncLoader,sc=i=>i.type.__isKeepAlive;function fd(i,n){ac(i,"a",n)}function pd(i,n){ac(i,"da",n)}function ac(i,n,e=st){const t=i.__wdc||(i.__wdc=()=>{let r=e;for(;r;){if(r.isDeactivated)return;r=r.parent}return i()});if(Qr(n,t,e),e){let r=e.parent;for(;r&&r.parent;)sc(r.parent.vnode)&&gd(t,n,e,r),r=r.parent}}function gd(i,n,e,t){const r=Qr(n,i,t,!0);lc(()=>{Is(t[n],r)},e)}function Qr(i,n,e=st,t=!1){if(e){const r=e[i]||(e[i]=[]),o=n.__weh||(n.__weh=(...s)=>{Cn();const a=Zi(e),u=Kt(n,e,i,s);return a(),En(),u});return t?r.unshift(o):r.push(o),o}}const hn=i=>(n,e=st)=>{qi&&i!=="sp"||Qr(i,(...t)=>n(...t),e)},md=hn("bm"),uc=hn("m"),vd=hn("bu"),yd=hn("u"),_d=hn("bum"),lc=hn("um"),bd=hn("sp"),kd=hn("rtg"),wd=hn("rtc");function Td(i,n=st){Qr("ec",i,n)}const xd=Symbol.for("v-ndc");function Sd(i,n,e,t){let r;const o=e,s=ke(i);if(s||Xe(i)){let a=!1;s&&hi(i)&&(a=!Pt(i),i=Jr(i)),r=new Array(i.length);for(let u=0,l=i.length;u<l;u++)r[u]=n(a?ot(i[u]):i[u],u,void 0,o)}else if(typeof i=="number"){r=new Array(i);for(let a=0;a<i;a++)r[a]=n(a+1,a,void 0,o)}else if(We(i))if(i[Symbol.iterator])r=Array.from(i,(a,u)=>n(a,u,void 0,o));else{const a=Object.keys(i);r=new Array(a.length);for(let u=0,l=a.length;u<l;u++){const c=a[u];r[u]=n(i[c],c,u,o)}}else r=[];return r}const os=i=>i?Sc(i)?to(i):os(i.parent):null,Ni=Ze(Object.create(null),{$:i=>i,$el:i=>i.vnode.el,$data:i=>i.data,$props:i=>i.props,$attrs:i=>i.attrs,$slots:i=>i.slots,$refs:i=>i.refs,$parent:i=>os(i.parent),$root:i=>os(i.root),$host:i=>i.ce,$emit:i=>i.emit,$options:i=>zs(i),$forceUpdate:i=>i.f||(i.f=()=>{Hs(i.update)}),$nextTick:i=>i.n||(i.n=Ql.bind(i.proxy)),$watch:i=>Nd.bind(i)}),vo=(i,n)=>i!==Ue&&!i.__isScriptSetup&&De(i,n),Cd={get({_:i},n){if(n==="__v_skip")return!0;const{ctx:e,setupState:t,data:r,props:o,accessCache:s,type:a,appContext:u}=i;let l;if(n[0]!=="$"){const f=s[n];if(f!==void 0)switch(f){case 1:return t[n];case 2:return r[n];case 4:return e[n];case 3:return o[n]}else{if(vo(t,n))return s[n]=1,t[n];if(r!==Ue&&De(r,n))return s[n]=2,r[n];if((l=i.propsOptions[0])&&De(l,n))return s[n]=3,o[n];if(e!==Ue&&De(e,n))return s[n]=4,e[n];ss&&(s[n]=0)}}const c=Ni[n];let h,d;return c?(n==="$attrs"&&rt(i.attrs,0,""),c(i)):(h=a.__cssModules)&&(h=h[n])?h:e!==Ue&&De(e,n)?(s[n]=4,e[n]):(d=u.config.globalProperties,De(d,n)?d[n]:void 0)},set({_:i},n,e){const{data:t,setupState:r,ctx:o}=i;return vo(r,n)?(r[n]=e,!0):t!==Ue&&De(t,n)?(t[n]=e,!0):!De(i.props,n)&&(n[0]!=="$"||!(n.slice(1)in i))&&(o[n]=e,!0)},has({_:{data:i,setupState:n,accessCache:e,ctx:t,appContext:r,propsOptions:o}},s){let a;return!!e[s]||i!==Ue&&De(i,s)||vo(n,s)||(a=o[0])&&De(a,s)||De(t,s)||De(Ni,s)||De(r.config.globalProperties,s)},defineProperty(i,n,e){return e.get!=null?i._.accessCache[n]=0:De(e,"value")&&this.set(i,n,e.value,null),Reflect.defineProperty(i,n,e)}};function da(i){return ke(i)?i.reduce((n,e)=>(n[e]=null,n),{}):i}let ss=!0;function Ed(i){const n=zs(i),e=i.proxy,t=i.ctx;ss=!1,n.beforeCreate&&fa(n.beforeCreate,i,"bc");const{data:r,computed:o,methods:s,watch:a,provide:u,inject:l,created:c,beforeMount:h,mounted:d,beforeUpdate:f,updated:p,activated:m,deactivated:v,beforeDestroy:y,beforeUnmount:w,destroyed:S,unmounted:C,render:E,renderTracked:R,renderTriggered:W,errorCaptured:J,serverPrefetch:se,expose:U,inheritAttrs:ae,components:b,directives:k,filters:T}=n;if(l&&function(P,B){ke(P)&&(P=as(P));for(const Q in P){const he=P[Q];let H;H=We(he)?"default"in he?an(he.from||Q,he.default,!0):an(he.from||Q):an(he),at(H)?Object.defineProperty(B,Q,{enumerable:!0,configurable:!0,get:()=>H.value,set:L=>H.value=L}):B[Q]=H}}(l,t,null),s)for(const P in s){const B=s[P];Se(B)&&(t[P]=B.bind(e))}if(r){const P=r.call(e,e);We(P)&&(i.data=Xi(P))}if(ss=!0,o)for(const P in o){const B=o[P],Q=Se(B)?B.bind(e,e):Se(B.get)?B.get.bind(e,e):sn,he=!Se(B)&&Se(B.set)?B.set.bind(e):sn,H=Nt({get:Q,set:he});Object.defineProperty(t,P,{enumerable:!0,configurable:!0,get:()=>H.value,set:L=>H.value=L})}if(a)for(const P in a)cc(a[P],t,e,P);if(u){const P=Se(u)?u.call(e):u;Reflect.ownKeys(P).forEach(B=>{yr(B,P[B])})}function N(P,B){ke(B)?B.forEach(Q=>P(Q.bind(e))):B&&P(B.bind(e))}if(c&&fa(c,i,"c"),N(md,h),N(uc,d),N(vd,f),N(yd,p),N(fd,m),N(pd,v),N(Td,J),N(wd,R),N(kd,W),N(_d,w),N(lc,C),N(bd,se),ke(U))if(U.length){const P=i.exposed||(i.exposed={});U.forEach(B=>{Object.defineProperty(P,B,{get:()=>e[B],set:Q=>e[B]=Q})})}else i.exposed||(i.exposed={});E&&i.render===sn&&(i.render=E),ae!=null&&(i.inheritAttrs=ae),b&&(i.components=b),k&&(i.directives=k),se&&oc(i)}function fa(i,n,e){Kt(ke(i)?i.map(t=>t.bind(n.proxy)):i.bind(n.proxy),n,e)}function cc(i,n,e,t){let r=t.includes(".")?_c(e,t):()=>e[t];if(Xe(i)){const o=n[i];Se(o)&&_r(r,o)}else if(Se(i))_r(r,i.bind(e));else if(We(i))if(ke(i))i.forEach(o=>cc(o,n,e,t));else{const o=Se(i.handler)?i.handler.bind(e):n[i.handler];Se(o)&&_r(r,o,i)}}function zs(i){const n=i.type,{mixins:e,extends:t}=n,{mixins:r,optionsCache:o,config:{optionMergeStrategies:s}}=i.appContext,a=o.get(n);let u;return a?u=a:r.length||e||t?(u={},r.length&&r.forEach(l=>Ir(u,l,s,!0)),Ir(u,n,s)):u=n,We(n)&&o.set(n,u),u}function Ir(i,n,e,t=!1){const{mixins:r,extends:o}=n;o&&Ir(i,o,e,!0),r&&r.forEach(s=>Ir(i,s,e,!0));for(const s in n)if(!(t&&s==="expose")){const a=Pd[s]||e&&e[s];i[s]=a?a(i[s],n[s]):n[s]}return i}const Pd={data:pa,props:ga,emits:ga,methods:ki,computed:ki,beforeCreate:ut,created:ut,beforeMount:ut,mounted:ut,beforeUpdate:ut,updated:ut,beforeDestroy:ut,beforeUnmount:ut,destroyed:ut,unmounted:ut,activated:ut,deactivated:ut,errorCaptured:ut,serverPrefetch:ut,components:ki,directives:ki,watch:function(i,n){if(!i)return n;if(!n)return i;const e=Ze(Object.create(null),i);for(const t in n)e[t]=ut(i[t],n[t]);return e},provide:pa,inject:function(i,n){return ki(as(i),as(n))}};function pa(i,n){return n?i?function(){return Ze(Se(i)?i.call(this,this):i,Se(n)?n.call(this,this):n)}:n:i}function as(i){if(ke(i)){const n={};for(let e=0;e<i.length;e++)n[i[e]]=i[e];return n}return i}function ut(i,n){return i?[...new Set([].concat(i,n))]:n}function ki(i,n){return i?Ze(Object.create(null),i,n):n}function ga(i,n){return i?ke(i)&&ke(n)?[...new Set([...i,...n])]:Ze(Object.create(null),da(i),da(n??{})):n}function hc(){return{app:null,config:{isNativeTag:Mh,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Ld=0;function Od(i,n){return function(e,t=null){Se(e)||(e=Ze({},e)),t==null||We(t)||(t=null);const r=hc(),o=new WeakSet,s=[];let a=!1;const u=r.app={_uid:Ld++,_component:e,_props:t,_container:null,_context:r,_instance:null,version:Kd,get config(){return r.config},set config(l){},use:(l,...c)=>(o.has(l)||(l&&Se(l.install)?(o.add(l),l.install(u,...c)):Se(l)&&(o.add(l),l(u,...c))),u),mixin:l=>(r.mixins.includes(l)||r.mixins.push(l),u),component:(l,c)=>c?(r.components[l]=c,u):r.components[l],directive:(l,c)=>c?(r.directives[l]=c,u):r.directives[l],mount(l,c,h){if(!a){const d=u._ceVNode||Tt(e,t);return d.appContext=r,h===!0?h="svg":h===!1&&(h=void 0),c&&n?n(d,l):i(d,l,h),a=!0,u._container=l,l.__vue_app__=u,to(d.component)}},onUnmount(l){s.push(l)},unmount(){a&&(Kt(s,u._instance,16),i(null,u._container),delete u._container.__vue_app__)},provide:(l,c)=>(r.provides[l]=c,u),runWithContext(l){const c=fi;fi=u;try{return l()}finally{fi=c}}};return u}}let fi=null;function yr(i,n){if(st){let e=st.provides;const t=st.parent&&st.parent.provides;t===e&&(e=st.provides=Object.create(t)),e[i]=n}}function an(i,n,e=!1){const t=st||kt;if(t||fi){const r=fi?fi._context.provides:t?t.parent==null?t.vnode.appContext&&t.vnode.appContext.provides:t.parent.provides:void 0;if(r&&i in r)return r[i];if(arguments.length>1)return e&&Se(n)?n.call(t&&t.proxy):n}}const dc={},ma=()=>Object.create(dc),fc=i=>Object.getPrototypeOf(i)===dc;function va(i,n,e,t){const[r,o]=i.propsOptions;let s,a=!1;if(n)for(let u in n){if(Ri(u))continue;const l=n[u];let c;r&&De(r,c=Sn(u))?o&&o.includes(c)?(s||(s={}))[c]=l:e[c]=l:Rr(i.emitsOptions,u)||u in t&&l===t[u]||(t[u]=l,a=!0)}if(o){const u=Ae(e),l=s||Ue;for(let c=0;c<o.length;c++){const h=o[c];e[h]=us(r,u,h,l[h],i,!De(l,h))}}return a}function us(i,n,e,t,r,o){const s=i[e];if(s!=null){const a=De(s,"default");if(a&&t===void 0){const u=s.default;if(s.type!==Function&&!s.skipFactory&&Se(u)){const{propsDefaults:l}=r;if(e in l)t=l[e];else{const c=Zi(r);t=l[e]=u.call(null,n),c()}}else t=u;r.ce&&r.ce._setProp(e,t)}s[0]&&(o&&!a?t=!1:!s[1]||t!==""&&t!==qn(e)||(t=!0))}return t}const Id=new WeakMap;function pc(i,n,e=!1){const t=e?Id:n.propsCache,r=t.get(i);if(r)return r;const o=i.props,s={},a=[];let u=!1;if(!Se(i)){const c=h=>{u=!0;const[d,f]=pc(h,n,!0);Ze(s,d),f&&a.push(...f)};!e&&n.mixins.length&&n.mixins.forEach(c),i.extends&&c(i.extends),i.mixins&&i.mixins.forEach(c)}if(!o&&!u)return We(i)&&t.set(i,li),li;if(ke(o))for(let c=0;c<o.length;c++){const h=Sn(o[c]);ya(h)&&(s[h]=Ue)}else if(o)for(const c in o){const h=Sn(c);if(ya(h)){const d=o[c],f=s[h]=ke(d)||Se(d)?{type:d}:Ze({},d),p=f.type;let m=!1,v=!0;if(ke(p))for(let y=0;y<p.length;++y){const w=p[y],S=Se(w)&&w.name;if(S==="Boolean"){m=!0;break}S==="String"&&(v=!1)}else m=Se(p)&&p.name==="Boolean";f[0]=m,f[1]=v,(m||De(f,"default"))&&a.push(h)}}const l=[s,a];return We(i)&&t.set(i,l),l}function ya(i){return i[0]!=="$"&&!Ri(i)}const gc=i=>i[0]==="_"||i==="$stable",Ws=i=>ke(i)?i.map(Wt):[Wt(i)],Rd=(i,n,e)=>{if(n._n)return n;const t=function(r,o=kt){if(!o||r._n)return r;const s=(...a)=>{s._d&&xa(-1);const u=Or(o);let l;try{l=r(...a)}finally{Or(u),s._d&&xa(1)}return l};return s._n=!0,s._c=!0,s._d=!0,s}((...r)=>Ws(n(...r)),e);return t._c=!1,t},_a=(i,n,e)=>{const t=i._ctx;for(const r in i){if(gc(r))continue;const o=i[r];if(Se(o))n[r]=Rd(0,o,t);else if(o!=null){const s=Ws(o);n[r]=()=>s}}},ba=(i,n)=>{const e=Ws(n);i.slots.default=()=>e},ka=(i,n,e)=>{for(const t in n)(e||t!=="_")&&(i[t]=n[t])},yt=function(i,n){n&&n.pendingBranch?ke(i)?n.effects.push(...i):n.effects.push(i):(ke(e=i)?di.push(...e):_n&&e.id===-1?_n.splice(ri+1,0,e):1&e.flags||(di.push(e),e.flags|=1),ec());var e};function Ad(i){return function(n){Er().__VUE__=!0;const{insert:e,remove:t,patchProp:r,createElement:o,createText:s,createComment:a,setText:u,setElementText:l,parentNode:c,nextSibling:h,setScopeId:d=sn,insertStaticContent:f}=n,p=(_,x,I,z=null,F=null,A=null,K=void 0,Y=null,V=!!x.dynamicChildren)=>{if(_===x)return;_&&!Ti(_,x)&&(z=Le(_),L(_,F,A,!0),_=null),x.patchFlag===-2&&(V=!1,x.dynamicChildren=null);const{type:D,ref:te,shapeFlag:q}=x;switch(D){case eo:m(_,x,I,z);break;case Wn:v(_,x,I,z);break;case bo:_==null&&y(x,I,z,K);break;case zt:ae(_,x,I,z,F,A,K,Y,V);break;default:1&q?C(_,x,I,z,F,A,K,Y,V):6&q?b(_,x,I,z,F,A,K,Y,V):(64&q||128&q)&&D.process(_,x,I,z,F,A,K,Y,V,ce)}te!=null&&F&&rs(te,_&&_.ref,A,x||_,!x)},m=(_,x,I,z)=>{if(_==null)e(x.el=s(x.children),I,z);else{const F=x.el=_.el;x.children!==_.children&&u(F,x.children)}},v=(_,x,I,z)=>{_==null?e(x.el=a(x.children||""),I,z):x.el=_.el},y=(_,x,I,z)=>{[_.el,_.anchor]=f(_.children,x,I,z,_.el,_.anchor)},w=({el:_,anchor:x},I,z)=>{let F;for(;_&&_!==x;)F=h(_),e(_,I,z),_=F;e(x,I,z)},S=({el:_,anchor:x})=>{let I;for(;_&&_!==x;)I=h(_),t(_),_=I;t(x)},C=(_,x,I,z,F,A,K,Y,V)=>{x.type==="svg"?K="svg":x.type==="math"&&(K="mathml"),_==null?E(x,I,z,F,A,K,Y,V):J(_,x,F,A,K,Y,V)},E=(_,x,I,z,F,A,K,Y)=>{let V,D;const{props:te,shapeFlag:q,transition:ie,dirs:oe}=_;if(V=_.el=o(_.type,A,te&&te.is,te),8&q?l(V,_.children):16&q&&W(_.children,V,null,z,F,yo(_,A),K,Y),oe&&Dn(_,null,z,"created"),R(V,_,_.scopeId,K,z),te){for(const ee in te)ee==="value"||Ri(ee)||r(V,ee,null,te[ee],A,z);"value"in te&&r(V,"value",null,te.value,A),(D=te.onVnodeBeforeMount)&&jt(D,z,_)}oe&&Dn(_,null,z,"beforeMount");const be=function(ee,ue){return(!ee||ee&&!ee.pendingBranch)&&ue&&!ue.persisted}(F,ie);be&&ie.beforeEnter(V),e(V,x,I),((D=te&&te.onVnodeMounted)||be||oe)&&yt(()=>{D&&jt(D,z,_),be&&ie.enter(V),oe&&Dn(_,null,z,"mounted")},F)},R=(_,x,I,z,F)=>{if(I&&d(_,I),z)for(let A=0;A<z.length;A++)d(_,z[A]);if(F){let A=F.subTree;if(x===A||kc(A.type)&&(A.ssContent===x||A.ssFallback===x)){const K=F.vnode;R(_,K,K.scopeId,K.slotScopeIds,F.parent)}}},W=(_,x,I,z,F,A,K,Y,V=0)=>{for(let D=V;D<_.length;D++){const te=_[D]=Y?bn(_[D]):Wt(_[D]);p(null,te,x,I,z,F,A,K,Y)}},J=(_,x,I,z,F,A,K)=>{const Y=x.el=_.el;let{patchFlag:V,dynamicChildren:D,dirs:te}=x;V|=16&_.patchFlag;const q=_.props||Ue,ie=x.props||Ue;let oe;if(I&&Mn(I,!1),(oe=ie.onVnodeBeforeUpdate)&&jt(oe,I,x,_),te&&Dn(x,_,I,"beforeUpdate"),I&&Mn(I,!0),(q.innerHTML&&ie.innerHTML==null||q.textContent&&ie.textContent==null)&&l(Y,""),D?se(_.dynamicChildren,D,Y,I,z,yo(x,F),A):K||B(_,x,Y,null,I,z,yo(x,F),A,!1),V>0){if(16&V)U(Y,q,ie,I,F);else if(2&V&&q.class!==ie.class&&r(Y,"class",null,ie.class,F),4&V&&r(Y,"style",q.style,ie.style,F),8&V){const be=x.dynamicProps;for(let ee=0;ee<be.length;ee++){const ue=be[ee],Ge=q[ue],Ne=ie[ue];Ne===Ge&&ue!=="value"||r(Y,ue,Ge,Ne,F,I)}}1&V&&_.children!==x.children&&l(Y,x.children)}else K||D!=null||U(Y,q,ie,I,F);((oe=ie.onVnodeUpdated)||te)&&yt(()=>{oe&&jt(oe,I,x,_),te&&Dn(x,_,I,"updated")},z)},se=(_,x,I,z,F,A,K)=>{for(let Y=0;Y<x.length;Y++){const V=_[Y],D=x[Y],te=V.el&&(V.type===zt||!Ti(V,D)||70&V.shapeFlag)?c(V.el):I;p(V,D,te,null,z,F,A,K,!0)}},U=(_,x,I,z,F)=>{if(x!==I){if(x!==Ue)for(const A in x)Ri(A)||A in I||r(_,A,x[A],null,F,z);for(const A in I){if(Ri(A))continue;const K=I[A],Y=x[A];K!==Y&&A!=="value"&&r(_,A,Y,K,F,z)}"value"in I&&r(_,"value",x.value,I.value,F)}},ae=(_,x,I,z,F,A,K,Y,V)=>{const D=x.el=_?_.el:s(""),te=x.anchor=_?_.anchor:s("");let{patchFlag:q,dynamicChildren:ie,slotScopeIds:oe}=x;oe&&(Y=Y?Y.concat(oe):oe),_==null?(e(D,I,z),e(te,I,z),W(x.children||[],I,te,F,A,K,Y,V)):q>0&&64&q&&ie&&_.dynamicChildren?(se(_.dynamicChildren,ie,I,F,A,K,Y),(x.key!=null||F&&x===F.subTree)&&mc(_,x,!0)):B(_,x,I,te,F,A,K,Y,V)},b=(_,x,I,z,F,A,K,Y,V)=>{x.slotScopeIds=Y,_==null?512&x.shapeFlag?F.ctx.activate(x,I,z,K,V):k(x,I,z,F,A,K,V):T(_,x,V)},k=(_,x,I,z,F,A,K)=>{const Y=_.component=function(V,D,te){const q=V.type,ie=(D?D.appContext:V.appContext)||zd,oe={uid:Wd++,vnode:V,type:q,parent:D,appContext:ie,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Rl(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:D?D.provides:Object.create(ie.provides),ids:D?D.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:pc(q,ie),emitsOptions:bc(q,ie),emit:null,emitted:null,propsDefaults:Ue,inheritAttrs:q.inheritAttrs,ctx:Ue,data:Ue,props:Ue,attrs:Ue,slots:Ue,refs:Ue,setupState:Ue,setupContext:null,suspense:te,suspenseId:te?te.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return oe.ctx={_:oe},oe.root=D?D.root:oe,oe.emit=Bd.bind(null,oe),V.ce&&V.ce(oe),oe}(_,z,F);if(sc(_)&&(Y.ctx.renderer=ce),function(V,D=!1,te=!1){D&&ls(D);const{props:q,children:ie}=V.vnode,oe=Sc(V);(function(ee,ue,Ge,Ne=!1){const Ke={},ze=ma();ee.propsDefaults=Object.create(null),va(ee,ue,Ke,ze);for(const $e in ee.propsOptions[0])$e in Ke||(Ke[$e]=void 0);Ge?ee.props=Ne?Ke:ql(Ke):ee.type.props?ee.props=Ke:ee.props=ze,ee.attrs=ze})(V,q,oe,D),((ee,ue,Ge)=>{const Ne=ee.slots=ma();if(32&ee.vnode.shapeFlag){const Ke=ue._;Ke?(ka(Ne,ue,Ge),Ge&&El(Ne,"_",Ke,!0)):_a(ue,Ne)}else ue&&ba(ee,ue)})(V,ie,te);const be=oe?function(ee,ue){const Ge=ee.type;ee.accessCache=Object.create(null),ee.proxy=new Proxy(ee.ctx,Cd);const{setup:Ne}=Ge;if(Ne){Cn();const Ke=ee.setupContext=Ne.length>1?function(Ie){const et=Qe=>{Ie.exposed=Qe||{}};return{attrs:new Proxy(Ie.attrs,Gd),slots:Ie.slots,emit:Ie.emit,expose:et}}(ee):null,ze=Zi(ee),$e=Ji(Ne,ee,0,[ee.props,Ke]),Rn=Tl($e);if(En(),ze(),!Rn&&!ee.sp||Oi(ee)||oc(ee),Rn){if($e.then(Sa,Sa),ue)return $e.then(Ie=>{Ea(ee,Ie,ue)}).catch(Ie=>{Zr(Ie,ee,0)});ee.asyncDep=$e}else Ea(ee,$e,ue)}else Cc(ee,ue)}(V,D):void 0;D&&ls(!1)}(Y,!1,K),Y.asyncDep){if(F&&F.registerDep(Y,N,K),!_.el){const V=Y.subTree=Tt(Wn);v(null,V,x,I)}}else N(Y,_,x,I,F,A,K)},T=(_,x,I)=>{const z=x.component=_.component;if(function(F,A,K){const{props:Y,children:V,component:D}=F,{props:te,children:q,patchFlag:ie}=A,oe=D.emitsOptions;if(A.dirs||A.transition)return!0;if(!(K&&ie>=0))return!(!V&&!q||q&&q.$stable)||Y!==te&&(Y?!te||Ta(Y,te,oe):!!te);if(1024&ie)return!0;if(16&ie)return Y?Ta(Y,te,oe):!!te;if(8&ie){const be=A.dynamicProps;for(let ee=0;ee<be.length;ee++){const ue=be[ee];if(te[ue]!==Y[ue]&&!Rr(oe,ue))return!0}}return!1}(_,x,I)){if(z.asyncDep&&!z.asyncResolved)return void P(z,x,I);z.next=x,z.update()}else x.el=_.el,z.vnode=x},N=(_,x,I,z,F,A,K)=>{const Y=()=>{if(_.isMounted){let{next:q,bu:ie,u:oe,parent:be,vnode:ee}=_;{const ze=vc(_);if(ze)return q&&(q.el=ee.el,P(_,q,K)),void ze.asyncDep.then(()=>{_.isUnmounted||Y()})}let ue,Ge=q;Mn(_,!1),q?(q.el=ee.el,P(_,q,K)):q=ee,ie&&lo(ie),(ue=q.props&&q.props.onVnodeBeforeUpdate)&&jt(ue,be,q,ee),Mn(_,!0);const Ne=_o(_),Ke=_.subTree;_.subTree=Ne,p(Ke,Ne,c(Ke.el),Le(Ke),_,F,A),q.el=Ne.el,Ge===null&&function({vnode:ze,parent:$e},Rn){for(;$e;){const Ie=$e.subTree;if(Ie.suspense&&Ie.suspense.activeBranch===ze&&(Ie.el=ze.el),Ie!==ze)break;(ze=$e.vnode).el=Rn,$e=$e.parent}}(_,Ne.el),oe&&yt(oe,F),(ue=q.props&&q.props.onVnodeUpdated)&&yt(()=>jt(ue,be,q,ee),F)}else{let q;const{el:ie,props:oe}=x,{bm:be,m:ee,parent:ue,root:Ge,type:Ne}=_,Ke=Oi(x);if(Mn(_,!1),be&&lo(be),!Ke&&(q=oe&&oe.onVnodeBeforeMount)&&jt(q,ue,x),Mn(_,!0),ie&&Oe){const ze=()=>{_.subTree=_o(_),Oe(ie,_.subTree,_,F,null)};Ke&&Ne.__asyncHydrate?Ne.__asyncHydrate(ie,_,ze):ze()}else{Ge.ce&&Ge.ce._injectChildStyle(Ne);const ze=_.subTree=_o(_);p(null,ze,I,z,_,F,A),x.el=ze.el}if(ee&&yt(ee,F),!Ke&&(q=oe&&oe.onVnodeMounted)){const ze=x;yt(()=>jt(q,ue,ze),F)}(256&x.shapeFlag||ue&&Oi(ue.vnode)&&256&ue.vnode.shapeFlag)&&_.a&&yt(_.a,F),_.isMounted=!0,x=I=z=null}};_.scope.on();const V=_.effect=new Al(Y);_.scope.off();const D=_.update=V.run.bind(V),te=_.job=V.runIfDirty.bind(V);te.i=_,te.id=_.uid,V.scheduler=()=>Hs(te),Mn(_,!0),D()},P=(_,x,I)=>{x.component=_;const z=_.vnode.props;_.vnode=x,_.next=null,function(F,A,K,Y){const{props:V,attrs:D,vnode:{patchFlag:te}}=F,q=Ae(V),[ie]=F.propsOptions;let oe=!1;if(!(Y||te>0)||16&te){let be;va(F,A,V,D)&&(oe=!0);for(const ee in q)A&&(De(A,ee)||(be=qn(ee))!==ee&&De(A,be))||(ie?!K||K[ee]===void 0&&K[be]===void 0||(V[ee]=us(ie,q,ee,void 0,F,!0)):delete V[ee]);if(D!==q)for(const ee in D)A&&De(A,ee)||(delete D[ee],oe=!0)}else if(8&te){const be=F.vnode.dynamicProps;for(let ee=0;ee<be.length;ee++){let ue=be[ee];if(Rr(F.emitsOptions,ue))continue;const Ge=A[ue];if(ie)if(De(D,ue))Ge!==D[ue]&&(D[ue]=Ge,oe=!0);else{const Ne=Sn(ue);V[Ne]=us(ie,q,Ne,Ge,F,!1)}else Ge!==D[ue]&&(D[ue]=Ge,oe=!0)}}oe&&en(F.attrs,"set","")}(_,x.props,z,I),((F,A,K)=>{const{vnode:Y,slots:V}=F;let D=!0,te=Ue;if(32&Y.shapeFlag){const q=A._;q?K&&q===1?D=!1:ka(V,A,K):(D=!A.$stable,_a(A,V)),te=A}else A&&(ba(F,A),te={default:1});if(D)for(const q in V)gc(q)||te[q]!=null||delete V[q]})(_,x.children,I),Cn(),ha(_),En()},B=(_,x,I,z,F,A,K,Y,V=!1)=>{const D=_&&_.children,te=_?_.shapeFlag:0,q=x.children,{patchFlag:ie,shapeFlag:oe}=x;if(ie>0){if(128&ie)return void he(D,q,I,z,F,A,K,Y,V);if(256&ie)return void Q(D,q,I,z,F,A,K,Y,V)}8&oe?(16&te&&Ee(D,F,A),q!==D&&l(I,q)):16&te?16&oe?he(D,q,I,z,F,A,K,Y,V):Ee(D,F,A,!0):(8&te&&l(I,""),16&oe&&W(q,I,z,F,A,K,Y,V))},Q=(_,x,I,z,F,A,K,Y,V)=>{x=x||li;const D=(_=_||li).length,te=x.length,q=Math.min(D,te);let ie;for(ie=0;ie<q;ie++){const oe=x[ie]=V?bn(x[ie]):Wt(x[ie]);p(_[ie],oe,I,null,F,A,K,Y,V)}D>te?Ee(_,F,A,!0,!1,q):W(x,I,z,F,A,K,Y,V,q)},he=(_,x,I,z,F,A,K,Y,V)=>{let D=0;const te=x.length;let q=_.length-1,ie=te-1;for(;D<=q&&D<=ie;){const oe=_[D],be=x[D]=V?bn(x[D]):Wt(x[D]);if(!Ti(oe,be))break;p(oe,be,I,null,F,A,K,Y,V),D++}for(;D<=q&&D<=ie;){const oe=_[q],be=x[ie]=V?bn(x[ie]):Wt(x[ie]);if(!Ti(oe,be))break;p(oe,be,I,null,F,A,K,Y,V),q--,ie--}if(D>q){if(D<=ie){const oe=ie+1,be=oe<te?x[oe].el:z;for(;D<=ie;)p(null,x[D]=V?bn(x[D]):Wt(x[D]),I,be,F,A,K,Y,V),D++}}else if(D>ie)for(;D<=q;)L(_[D],F,A,!0),D++;else{const oe=D,be=D,ee=new Map;for(D=be;D<=ie;D++){const Ie=x[D]=V?bn(x[D]):Wt(x[D]);Ie.key!=null&&ee.set(Ie.key,D)}let ue,Ge=0;const Ne=ie-be+1;let Ke=!1,ze=0;const $e=new Array(Ne);for(D=0;D<Ne;D++)$e[D]=0;for(D=oe;D<=q;D++){const Ie=_[D];if(Ge>=Ne){L(Ie,F,A,!0);continue}let et;if(Ie.key!=null)et=ee.get(Ie.key);else for(ue=be;ue<=ie;ue++)if($e[ue-be]===0&&Ti(Ie,x[ue])){et=ue;break}et===void 0?L(Ie,F,A,!0):($e[et-be]=D+1,et>=ze?ze=et:Ke=!0,p(Ie,x[et],I,null,F,A,K,Y,V),Ge++)}const Rn=Ke?function(Ie){const et=Ie.slice(),Qe=[0];let pn,ao,Ct,gn,nr;const Dh=Ie.length;for(pn=0;pn<Dh;pn++){const ir=Ie[pn];if(ir!==0){if(ao=Qe[Qe.length-1],Ie[ao]<ir){et[pn]=ao,Qe.push(pn);continue}for(Ct=0,gn=Qe.length-1;Ct<gn;)nr=Ct+gn>>1,Ie[Qe[nr]]<ir?Ct=nr+1:gn=nr;ir<Ie[Qe[Ct]]&&(Ct>0&&(et[pn]=Qe[Ct-1]),Qe[Ct]=pn)}}for(Ct=Qe.length,gn=Qe[Ct-1];Ct-- >0;)Qe[Ct]=gn,gn=et[gn];return Qe}($e):li;for(ue=Rn.length-1,D=Ne-1;D>=0;D--){const Ie=be+D,et=x[Ie],Qe=Ie+1<te?x[Ie+1].el:z;$e[D]===0?p(null,et,I,Qe,F,A,K,Y,V):Ke&&(ue<0||D!==Rn[ue]?H(et,I,Qe,2):ue--)}}},H=(_,x,I,z,F=null)=>{const{el:A,type:K,transition:Y,children:V,shapeFlag:D}=_;if(6&D)return void H(_.component.subTree,x,I,z);if(128&D)return void _.suspense.move(x,I,z);if(64&D)return void K.move(_,x,I,ce);if(K===zt){e(A,x,I);for(let te=0;te<V.length;te++)H(V[te],x,I,z);return void e(_.anchor,x,I)}if(K===bo)return void w(_,x,I);if(z!==2&&1&D&&Y)if(z===0)Y.beforeEnter(A),e(A,x,I),yt(()=>Y.enter(A),F);else{const{leave:te,delayLeave:q,afterLeave:ie}=Y,oe=()=>e(A,x,I),be=()=>{te(A,()=>{oe(),ie&&ie()})};q?q(A,oe,be):be()}else e(A,x,I)},L=(_,x,I,z=!1,F=!1)=>{const{type:A,props:K,ref:Y,children:V,dynamicChildren:D,shapeFlag:te,patchFlag:q,dirs:ie,cacheIndex:oe}=_;if(q===-2&&(F=!1),Y!=null&&rs(Y,null,I,_,!0),oe!=null&&(x.renderCache[oe]=void 0),256&te)return void x.ctx.deactivate(_);const be=1&te&&ie,ee=!Oi(_);let ue;if(ee&&(ue=K&&K.onVnodeBeforeUnmount)&&jt(ue,x,_),6&te)re(_.component,I,z);else{if(128&te)return void _.suspense.unmount(I,z);be&&Dn(_,null,x,"beforeUnmount"),64&te?_.type.remove(_,x,I,ce,z):D&&!D.hasOnce&&(A!==zt||q>0&&64&q)?Ee(D,x,I,!1,!0):(A===zt&&384&q||!F&&16&te)&&Ee(V,x,I),z&&M(_)}(ee&&(ue=K&&K.onVnodeUnmounted)||be)&&yt(()=>{ue&&jt(ue,x,_),be&&Dn(_,null,x,"unmounted")},I)},M=_=>{const{type:x,el:I,anchor:z,transition:F}=_;if(x===zt)return void G(I,z);if(x===bo)return void S(_);const A=()=>{t(I),F&&!F.persisted&&F.afterLeave&&F.afterLeave()};if(1&_.shapeFlag&&F&&!F.persisted){const{leave:K,delayLeave:Y}=F,V=()=>K(I,A);Y?Y(_.el,A,V):V()}else A()},G=(_,x)=>{let I;for(;_!==x;)I=h(_),t(_),_=I;t(x)},re=(_,x,I)=>{const{bum:z,scope:F,job:A,subTree:K,um:Y,m:V,a:D}=_;wa(V),wa(D),z&&lo(z),F.stop(),A&&(A.flags|=8,L(K,_,x,I)),Y&&yt(Y,x),yt(()=>{_.isUnmounted=!0},x),x&&x.pendingBranch&&!x.isUnmounted&&_.asyncDep&&!_.asyncResolved&&_.suspenseId===x.pendingId&&(x.deps--,x.deps===0&&x.resolve())},Ee=(_,x,I,z=!1,F=!1,A=0)=>{for(let K=A;K<_.length;K++)L(_[K],x,I,z,F)},Le=_=>{if(6&_.shapeFlag)return Le(_.component.subTree);if(128&_.shapeFlag)return _.suspense.next();const x=h(_.anchor||_.el),I=x&&x[dd];return I?h(I):x};let le=!1;const ge=(_,x,I)=>{_==null?x._vnode&&L(x._vnode,null,null,!0):p(x._vnode||null,_,x,null,null,null,I),x._vnode=_,le||(le=!0,ha(),tc(),le=!1)},ce={p,um:L,m:H,r:M,mt:k,mc:W,pc:B,pbc:se,n:Le,o:n};let ve,Oe;return{render:ge,hydrate:ve,createApp:Od(ge,ve)}}(i)}function yo({type:i,props:n},e){return e==="svg"&&i==="foreignObject"||e==="mathml"&&i==="annotation-xml"&&n&&n.encoding&&n.encoding.includes("html")?void 0:e}function Mn({effect:i,job:n},e){e?(i.flags|=32,n.flags|=4):(i.flags&=-33,n.flags&=-5)}function mc(i,n,e=!1){const t=i.children,r=n.children;if(ke(t)&&ke(r))for(let o=0;o<t.length;o++){const s=t[o];let a=r[o];1&a.shapeFlag&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[o]=bn(r[o]),a.el=s.el),e||a.patchFlag===-2||mc(s,a)),a.type===eo&&(a.el=s.el)}}function vc(i){const n=i.subTree.component;if(n)return n.asyncDep&&!n.asyncResolved?n:vc(n)}function wa(i){if(i)for(let n=0;n<i.length;n++)i[n].flags|=8}const Dd=Symbol.for("v-scx"),Md=()=>an(Dd);function _r(i,n,e){return yc(i,n,e)}function yc(i,n,e=Ue){const{immediate:t,deep:r,flush:o,once:s}=e,a=Ze({},e),u=n&&t||!n&&o!=="post";let l;if(qi){if(o==="sync"){const f=Md();l=f.__watcherHandles||(f.__watcherHandles=[])}else if(!u){const f=()=>{};return f.stop=sn,f.resume=sn,f.pause=sn,f}}const c=st;a.call=(f,p,m)=>Kt(f,c,p,m);let h=!1;o==="post"?a.scheduler=f=>{yt(f,c&&c.suspense)}:o!=="sync"&&(h=!0,a.scheduler=(f,p)=>{p?f():Hs(f)}),a.augmentJob=f=>{n&&(f.flags|=4),h&&(f.flags|=2,c&&(f.id=c.uid,f.i=c))};const d=cd(i,n,a);return qi&&(l?l.push(d):u&&d()),d}function Nd(i,n,e){const t=this.proxy,r=Xe(i)?i.includes(".")?_c(t,i):()=>t[i]:i.bind(t,t);let o;Se(n)?o=n:(o=n.handler,e=n);const s=Zi(this),a=yc(r,o.bind(t),e);return s(),a}function _c(i,n){const e=n.split(".");return()=>{let t=i;for(let r=0;r<e.length&&t;r++)t=t[e[r]];return t}}const Fd=(i,n)=>n==="modelValue"||n==="model-value"?i.modelModifiers:i[`${n}Modifiers`]||i[`${Sn(n)}Modifiers`]||i[`${qn(n)}Modifiers`];function Bd(i,n,...e){if(i.isUnmounted)return;const t=i.vnode.props||Ue;let r=e;const o=n.startsWith("update:"),s=o&&Fd(t,n.slice(7));let a;s&&(s.trim&&(r=e.map(c=>Xe(c)?c.trim():c)),s.number&&(r=e.map(Uh)));let u=t[a=uo(n)]||t[a=uo(Sn(n))];!u&&o&&(u=t[a=uo(qn(n))]),u&&Kt(u,i,6,r);const l=t[a+"Once"];if(l){if(i.emitted){if(i.emitted[a])return}else i.emitted={};i.emitted[a]=!0,Kt(l,i,6,r)}}function bc(i,n,e=!1){const t=n.emitsCache,r=t.get(i);if(r!==void 0)return r;const o=i.emits;let s={},a=!1;if(!Se(i)){const u=l=>{const c=bc(l,n,!0);c&&(a=!0,Ze(s,c))};!e&&n.mixins.length&&n.mixins.forEach(u),i.extends&&u(i.extends),i.mixins&&i.mixins.forEach(u)}return o||a?(ke(o)?o.forEach(u=>s[u]=null):Ze(s,o),We(i)&&t.set(i,s),s):(We(i)&&t.set(i,null),null)}function Rr(i,n){return!(!i||!Yr(n))&&(n=n.slice(2).replace(/Once$/,""),De(i,n[0].toLowerCase()+n.slice(1))||De(i,qn(n))||De(i,n))}function _o(i){const{type:n,vnode:e,proxy:t,withProxy:r,propsOptions:[o],slots:s,attrs:a,emit:u,render:l,renderCache:c,props:h,data:d,setupState:f,ctx:p,inheritAttrs:m}=i,v=Or(i);let y,w;try{if(4&e.shapeFlag){const C=r||t,E=C;y=Wt(l.call(E,C,c,h,f,d,p)),w=a}else{const C=n;y=Wt(C.length>1?C(h,{attrs:a,slots:s,emit:u}):C(h,null)),w=n.props?a:Ud(a)}}catch(C){Fi.length=0,Zr(C,i,1),y=Tt(Wn)}let S=y;if(w&&m!==!1){const C=Object.keys(w),{shapeFlag:E}=S;C.length&&7&E&&(o&&C.some(Os)&&(w=jd(w,o)),S=gi(S,w,!1,!0))}return e.dirs&&(S=gi(S,null,!1,!0),S.dirs=S.dirs?S.dirs.concat(e.dirs):e.dirs),e.transition&&Vs(S,e.transition),y=S,Or(v),y}const Ud=i=>{let n;for(const e in i)(e==="class"||e==="style"||Yr(e))&&((n||(n={}))[e]=i[e]);return n},jd=(i,n)=>{const e={};for(const t in i)Os(t)&&t.slice(9)in n||(e[t]=i[t]);return e};function Ta(i,n,e){const t=Object.keys(n);if(t.length!==Object.keys(i).length)return!0;for(let r=0;r<t.length;r++){const o=t[r];if(n[o]!==i[o]&&!Rr(e,o))return!0}return!1}const kc=i=>i.__isSuspense,zt=Symbol.for("v-fgt"),eo=Symbol.for("v-txt"),Wn=Symbol.for("v-cmt"),bo=Symbol.for("v-stc"),Fi=[];let wt=null;function Bn(i=!1){Fi.push(wt=i?null:[])}let Ki=1;function xa(i){Ki+=i,i<0&&wt&&(wt.hasOnce=!0)}function wc(i){return i.dynamicChildren=Ki>0?wt||li:null,Fi.pop(),wt=Fi[Fi.length-1]||null,Ki>0&&wt&&wt.push(i),i}function wi(i,n,e,t,r,o){return wc(ht(i,n,e,t,r,o,!0))}function Tc(i,n,e,t,r){return wc(Tt(i,n,e,t,r,!0))}function Ar(i){return!!i&&i.__v_isVNode===!0}function Ti(i,n){return i.type===n.type&&i.key===n.key}const xc=({key:i})=>i??null,br=({ref:i,ref_key:n,ref_for:e})=>(typeof i=="number"&&(i=""+i),i!=null?Xe(i)||at(i)||Se(i)?{i:kt,r:i,k:n,f:!!e}:i:null);function ht(i,n=null,e=null,t=0,r=null,o=i===zt?0:1,s=!1,a=!1){const u={__v_isVNode:!0,__v_skip:!0,type:i,props:n,key:n&&xc(n),ref:n&&br(n),scopeId:ic,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:t,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:kt};return a?(Gs(u,e),128&o&&i.normalize(u)):e&&(u.shapeFlag|=Xe(e)?8:16),Ki>0&&!s&&wt&&(u.patchFlag>0||6&o)&&u.patchFlag!==32&&wt.push(u),u}const Tt=function(i,n=null,e=null,t=0,r=null,o=!1){if(i&&i!==xd||(i=Wn),Ar(i)){const u=gi(i,n,!0);return e&&Gs(u,e),Ki>0&&!o&&wt&&(6&u.shapeFlag?wt[wt.indexOf(i)]=u:wt.push(u)),u.patchFlag=-2,u}s=i,Se(s)&&"__vccOpts"in s&&(i=i.__vccOpts);var s;if(n){n=function(c){return c?is(c)||fc(c)?Ze({},c):c:null}(n);let{class:u,style:l}=n;u&&!Xe(u)&&(n.class=Ds(u)),We(l)&&(is(l)&&!ke(l)&&(l=Ze({},l)),n.style=As(l))}const a=Xe(i)?1:kc(i)?128:(u=>u.__isTeleport)(i)?64:We(i)?4:Se(i)?2:0;return ht(i,n,e,t,r,a,o,!0)};function gi(i,n,e=!1,t=!1){const{props:r,ref:o,patchFlag:s,children:a,transition:u}=i,l=n?function(...h){const d={};for(let f=0;f<h.length;f++){const p=h[f];for(const m in p)if(m==="class")d.class!==p.class&&(d.class=Ds([d.class,p.class]));else if(m==="style")d.style=As([d.style,p.style]);else if(Yr(m)){const v=d[m],y=p[m];!y||v===y||ke(v)&&v.includes(y)||(d[m]=v?[].concat(v,y):y)}else m!==""&&(d[m]=p[m])}return d}(r||{},n):r,c={__v_isVNode:!0,__v_skip:!0,type:i.type,props:l,key:l&&xc(l),ref:n&&n.ref?e&&o?ke(o)?o.concat(br(n)):[o,br(n)]:br(n):o,scopeId:i.scopeId,slotScopeIds:i.slotScopeIds,children:a,target:i.target,targetStart:i.targetStart,targetAnchor:i.targetAnchor,staticCount:i.staticCount,shapeFlag:i.shapeFlag,patchFlag:n&&i.type!==zt?s===-1?16:16|s:s,dynamicProps:i.dynamicProps,dynamicChildren:i.dynamicChildren,appContext:i.appContext,dirs:i.dirs,transition:u,component:i.component,suspense:i.suspense,ssContent:i.ssContent&&gi(i.ssContent),ssFallback:i.ssFallback&&gi(i.ssFallback),el:i.el,anchor:i.anchor,ctx:i.ctx,ce:i.ce};return u&&t&&Vs(c,u.clone(c)),c}function Hd(i=" ",n=0){return Tt(eo,null,i,n)}function Vd(i="",n=!1){return n?(Bn(),Tc(Wn,null,i)):Tt(Wn,null,i)}function Wt(i){return i==null||typeof i=="boolean"?Tt(Wn):ke(i)?Tt(zt,null,i.slice()):Ar(i)?bn(i):Tt(eo,null,String(i))}function bn(i){return i.el===null&&i.patchFlag!==-1||i.memo?i:gi(i)}function Gs(i,n){let e=0;const{shapeFlag:t}=i;if(n==null)n=null;else if(ke(n))e=16;else if(typeof n=="object"){if(65&t){const r=n.default;return void(r&&(r._c&&(r._d=!1),Gs(i,r()),r._c&&(r._d=!0)))}{e=32;const r=n._;r||fc(n)?r===3&&kt&&(kt.slots._===1?n._=1:(n._=2,i.patchFlag|=1024)):n._ctx=kt}}else Se(n)?(n={default:n,_ctx:kt},e=32):(n=String(n),64&t?(e=16,n=[Hd(n)]):e=8);i.children=n,i.shapeFlag|=e}function jt(i,n,e,t=null){Kt(i,n,7,[e,t])}const zd=hc();let Wd=0,st=null,Dr,ls;{const i=Er(),n=(e,t)=>{let r;return(r=i[e])||(r=i[e]=[]),r.push(t),o=>{r.length>1?r.forEach(s=>s(o)):r[0](o)}};Dr=n("__VUE_INSTANCE_SETTERS__",e=>st=e),ls=n("__VUE_SSR_SETTERS__",e=>qi=e)}const Zi=i=>{const n=st;return Dr(i),i.scope.on(),()=>{i.scope.off(),Dr(n)}},Sa=()=>{st&&st.scope.off(),Dr(null)};function Sc(i){return 4&i.vnode.shapeFlag}let Ca,qi=!1;function Ea(i,n,e){Se(n)?i.type.__ssrInlineRender?i.ssrRender=n:i.render=n:We(n)&&(i.setupState=Jl(n)),Cc(i,e)}function Cc(i,n,e){const t=i.type;if(!i.render){if(!n&&Ca&&!t.render){const r=t.template||zs(i).template;if(r){const{isCustomElement:o,compilerOptions:s}=i.appContext.config,{delimiters:a,compilerOptions:u}=t,l=Ze(Ze({isCustomElement:o,delimiters:a},s),u);t.render=Ca(r,l)}}i.render=t.render||sn}{const r=Zi(i);Cn();try{Ed(i)}finally{En(),r()}}}const Gd={get:(i,n)=>(rt(i,0,""),i[n])};function to(i){return i.exposed?i.exposeProxy||(i.exposeProxy=new Proxy(Jl($l(i.exposed)),{get:(n,e)=>e in n?n[e]:e in Ni?Ni[e](i):void 0,has:(n,e)=>e in n||e in Ni})):i.proxy}const Nt=(i,n)=>function(t,r,o=!1){let s,a;return Se(t)?s=t:(s=t.get,a=t.set),new ld(s,a,o)}(i,0,qi);function Ec(i,n,e){const t=arguments.length;return t===2?We(n)&&!ke(n)?Ar(n)?Tt(i,null,[n]):Tt(i,n):Tt(i,null,n):(t>3?e=Array.prototype.slice.call(arguments,2):t===3&&Ar(e)&&(e=[e]),Tt(i,n,e))}const Kd="3.5.12";/**
* @vue/runtime-dom v3.5.12
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let cs;const Pa=typeof window<"u"&&window.trustedTypes;if(Pa)try{cs=Pa.createPolicy("vue",{createHTML:i=>i})}catch{}const Pc=cs?i=>cs.createHTML(i):i=>i,Xt=typeof document<"u"?document:null,La=Xt&&Xt.createElement("template"),qd={insert:(i,n,e)=>{n.insertBefore(i,e||null)},remove:i=>{const n=i.parentNode;n&&n.removeChild(i)},createElement:(i,n,e,t)=>{const r=n==="svg"?Xt.createElementNS("http://www.w3.org/2000/svg",i):n==="mathml"?Xt.createElementNS("http://www.w3.org/1998/Math/MathML",i):e?Xt.createElement(i,{is:e}):Xt.createElement(i);return i==="select"&&t&&t.multiple!=null&&r.setAttribute("multiple",t.multiple),r},createText:i=>Xt.createTextNode(i),createComment:i=>Xt.createComment(i),setText:(i,n)=>{i.nodeValue=n},setElementText:(i,n)=>{i.textContent=n},parentNode:i=>i.parentNode,nextSibling:i=>i.nextSibling,querySelector:i=>Xt.querySelector(i),setScopeId(i,n){i.setAttribute(n,"")},insertStaticContent(i,n,e,t,r,o){const s=e?e.previousSibling:n.lastChild;if(r&&(r===o||r.nextSibling))for(;n.insertBefore(r.cloneNode(!0),e),r!==o&&(r=r.nextSibling););else{La.innerHTML=Pc(t==="svg"?`<svg>${i}</svg>`:t==="mathml"?`<math>${i}</math>`:i);const a=La.content;if(t==="svg"||t==="mathml"){const u=a.firstChild;for(;u.firstChild;)a.appendChild(u.firstChild);a.removeChild(u)}n.insertBefore(a,e)}return[s?s.nextSibling:n.firstChild,e?e.previousSibling:n.lastChild]}},Yd=Symbol("_vtc"),Mr=Symbol("_vod"),Lc=Symbol("_vsh"),$d={beforeMount(i,{value:n},{transition:e}){i[Mr]=i.style.display==="none"?"":i.style.display,e&&n?e.beforeEnter(i):xi(i,n)},mounted(i,{value:n},{transition:e}){e&&n&&e.enter(i)},updated(i,{value:n,oldValue:e},{transition:t}){!n!=!e&&(t?n?(t.beforeEnter(i),xi(i,!0),t.enter(i)):t.leave(i,()=>{xi(i,!1)}):xi(i,n))},beforeUnmount(i,{value:n}){xi(i,n)}};function xi(i,n){i.style.display=n?i[Mr]:"none",i[Lc]=!n}const Xd=Symbol(""),Jd=/(^|;)\s*display\s*:/,Oa=/\s*!important$/;function kr(i,n,e){if(ke(e))e.forEach(t=>kr(i,n,t));else if(e==null&&(e=""),n.startsWith("--"))i.setProperty(n,e);else{const t=function(r,o){const s=ko[o];if(s)return s;let a=Sn(o);if(a!=="filter"&&a in r)return ko[o]=a;a=Cl(a);for(let u=0;u<Ia.length;u++){const l=Ia[u]+a;if(l in r)return ko[o]=l}return o}(i,n);Oa.test(e)?i.setProperty(qn(t),e.replace(Oa,""),"important"):i[t]=e}}const Ia=["Webkit","Moz","ms"],ko={},Ra="http://www.w3.org/1999/xlink";function Aa(i,n,e,t,r,o=Wh(n)){t&&n.startsWith("xlink:")?e==null?i.removeAttributeNS(Ra,n.slice(6,n.length)):i.setAttributeNS(Ra,n,e):e==null||o&&!Pl(e)?i.removeAttribute(n):i.setAttribute(n,o?"":On(e)?String(e):e)}function Da(i,n,e,t,r){if(n==="innerHTML"||n==="textContent")return void(e!=null&&(i[n]=n==="innerHTML"?Pc(e):e));const o=i.tagName;if(n==="value"&&o!=="PROGRESS"&&!o.includes("-")){const a=o==="OPTION"?i.getAttribute("value")||"":i.value,u=e==null?i.type==="checkbox"?"on":"":String(e);return a===u&&"_value"in i||(i.value=u),e==null&&i.removeAttribute(n),void(i._value=e)}let s=!1;if(e===""||e==null){const a=typeof i[n];a==="boolean"?e=Pl(e):e==null&&a==="string"?(e="",s=!0):a==="number"&&(e=0,s=!0)}try{i[n]=e}catch{}s&&i.removeAttribute(r||n)}const Ma=Symbol("_vei");function Zd(i,n,e,t,r=null){const o=i[Ma]||(i[Ma]={}),s=o[n];if(t&&s)s.value=t;else{const[a,u]=function(l){let c;if(Na.test(l)){let d;for(c={};d=l.match(Na);)l=l.slice(0,l.length-d[0].length),c[d[0].toLowerCase()]=!0}return[l[2]===":"?l.slice(3):qn(l.slice(2)),c]}(n);if(t){const l=o[n]=function(c,h){const d=f=>{if(f._vts){if(f._vts<=d.attached)return}else f._vts=Date.now();Kt(function(p,m){if(ke(m)){const v=p.stopImmediatePropagation;return p.stopImmediatePropagation=()=>{v.call(p),p._stopped=!0},m.map(y=>w=>!w._stopped&&y&&y(w))}return m}(f,d.value),h,5,[f])};return d.value=c,d.attached=ef(),d}(t,r);(function(c,h,d,f){c.addEventListener(h,d,f)})(i,a,l,u)}else s&&(function(l,c,h,d){l.removeEventListener(c,h,d)}(i,a,s,u),o[n]=void 0)}}const Na=/(?:Once|Passive|Capture)$/;let wo=0;const Qd=Promise.resolve(),ef=()=>wo||(Qd.then(()=>wo=0),wo=Date.now()),Fa=i=>i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&i.charCodeAt(2)>96&&i.charCodeAt(2)<123,tf=Ze({patchProp:(i,n,e,t,r,o)=>{const s=r==="svg";n==="class"?function(a,u,l){const c=a[Yd];c&&(u=(u?[u,...c]:[...c]).join(" ")),u==null?a.removeAttribute("class"):l?a.setAttribute("class",u):a.className=u}(i,t,s):n==="style"?function(a,u,l){const c=a.style,h=Xe(l);let d=!1;if(l&&!h){if(u)if(Xe(u))for(const f of u.split(";")){const p=f.slice(0,f.indexOf(":")).trim();l[p]==null&&kr(c,p,"")}else for(const f in u)l[f]==null&&kr(c,f,"");for(const f in l)f==="display"&&(d=!0),kr(c,f,l[f])}else if(h){if(u!==l){const f=c[Xd];f&&(l+=";"+f),c.cssText=l,d=Jd.test(l)}}else u&&a.removeAttribute("style");Mr in a&&(a[Mr]=d?c.display:"",a[Lc]&&(c.display="none"))}(i,e,t):Yr(n)?Os(n)||Zd(i,n,0,t,o):(n[0]==="."?(n=n.slice(1),1):n[0]==="^"?(n=n.slice(1),0):function(a,u,l,c){if(c)return u==="innerHTML"||u==="textContent"||!!(u in a&&Fa(u)&&Se(l));if(u==="spellcheck"||u==="draggable"||u==="translate"||u==="form"||u==="list"&&a.tagName==="INPUT"||u==="type"&&a.tagName==="TEXTAREA")return!1;if(u==="width"||u==="height"){const h=a.tagName;if(h==="IMG"||h==="VIDEO"||h==="CANVAS"||h==="SOURCE")return!1}return Fa(u)&&Xe(l)?!1:u in a}(i,n,t,s))?(Da(i,n,t),i.tagName.includes("-")||n!=="value"&&n!=="checked"&&n!=="selected"||Aa(i,n,t,s,0,n!=="value")):!i._isVueCE||!/[A-Z]/.test(n)&&Xe(t)?(n==="true-value"?i._trueValue=t:n==="false-value"&&(i._falseValue=t),Aa(i,n,t,s)):Da(i,Sn(n),t,0,n)}},qd);let Ba;/*!
 * pinia v2.2.6
 * (c) 2024 Eduardo San Martin Morote
 * @license MIT
 */const nf=Symbol();var Ua,To;(To=Ua||(Ua={})).direct="direct",To.patchObject="patch object",To.patchFunction="patch function";/*!
  * vue-router v4.4.5
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const oi=typeof document<"u";function ja(i){return typeof i=="object"||"displayName"in i||"props"in i||"__vccOpts"in i}const Fe=Object.assign;function xo(i,n){const e={};for(const t in n){const r=n[t];e[t]=Ut(r)?r.map(i):i(r)}return e}const Bi=()=>{},Ut=Array.isArray,Oc=/#/g,rf=/&/g,of=/\//g,sf=/=/g,af=/\?/g,Ic=/\+/g,uf=/%5B/g,lf=/%5D/g,Rc=/%5E/g,cf=/%60/g,Ac=/%7B/g,hf=/%7C/g,Dc=/%7D/g,df=/%20/g;function Ks(i){return encodeURI(""+i).replace(hf,"|").replace(uf,"[").replace(lf,"]")}function So(i){return Ks(i).replace(Ic,"%2B").replace(df,"+").replace(Oc,"%23").replace(rf,"%26").replace(cf,"`").replace(Ac,"{").replace(Dc,"}").replace(Rc,"^")}function ff(i){return i==null?"":function(n){return Ks(n).replace(Oc,"%23").replace(af,"%3F")}(i).replace(of,"%2F")}function Yi(i){try{return decodeURIComponent(""+i)}catch{}return""+i}const pf=/\/$/;function Co(i,n,e="/"){let t,r={},o="",s="";const a=n.indexOf("#");let u=n.indexOf("?");return a<u&&a>=0&&(u=-1),u>-1&&(t=n.slice(0,u),o=n.slice(u+1,a>-1?a:n.length),r=i(o)),a>-1&&(t=t||n.slice(0,a),s=n.slice(a,n.length)),t=function(l,c){if(l.startsWith("/"))return l;if(!l)return c;const h=c.split("/"),d=l.split("/"),f=d[d.length-1];f!==".."&&f!=="."||d.push("");let p,m,v=h.length-1;for(p=0;p<d.length;p++)if(m=d[p],m!=="."){if(m!=="..")break;v>1&&v--}return h.slice(0,v).join("/")+"/"+d.slice(p).join("/")}(t??n,e),{fullPath:t+(o&&"?")+o+s,path:t,query:r,hash:Yi(s)}}function Ha(i,n){return n&&i.toLowerCase().startsWith(n.toLowerCase())?i.slice(n.length)||"/":i}function pi(i,n){return(i.aliasOf||i)===(n.aliasOf||n)}function Mc(i,n){if(Object.keys(i).length!==Object.keys(n).length)return!1;for(const e in i)if(!gf(i[e],n[e]))return!1;return!0}function gf(i,n){return Ut(i)?Va(i,n):Ut(n)?Va(n,i):i===n}function Va(i,n){return Ut(n)?i.length===n.length&&i.every((e,t)=>e===n[t]):i.length===1&&i[0]===n}const mn={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Ui,za,ji,Eo;function mf(i){if(!i)if(oi){const n=document.querySelector("base");i=(i=n&&n.getAttribute("href")||"/").replace(/^\w+:\/\/[^\/]+/,"")}else i="/";return i[0]!=="/"&&i[0]!=="#"&&(i="/"+i),i.replace(pf,"")}(za=Ui||(Ui={})).pop="pop",za.push="push",(Eo=ji||(ji={})).back="back",Eo.forward="forward",Eo.unknown="";const vf=/^[^#]+#/;function yf(i,n){return i.replace(vf,"#")+n}const Nr=()=>({left:window.scrollX,top:window.scrollY});function _f(i){let n;if("el"in i){const e=i.el,t=typeof e=="string"&&e.startsWith("#"),r=typeof e=="string"?t?document.getElementById(e.slice(1)):document.querySelector(e):e;if(!r)return;n=function(o,s){const a=document.documentElement.getBoundingClientRect(),u=o.getBoundingClientRect();return{behavior:s.behavior,left:u.left-a.left-(s.left||0),top:u.top-a.top-(s.top||0)}}(r,i)}else n=i;"scrollBehavior"in document.documentElement.style?window.scrollTo(n):window.scrollTo(n.left!=null?n.left:window.scrollX,n.top!=null?n.top:window.scrollY)}function Wa(i,n){return(history.state?history.state.position-n:-1)+i}const Po=new Map;function Nc(i,n){const{pathname:e,search:t,hash:r}=n,o=i.indexOf("#");if(o>-1){let s=r.includes(i.slice(o))?i.slice(o).length:1,a=r.slice(s);return a[0]!=="/"&&(a="/"+a),Ha(a,"")}return Ha(e,i)+t+r}function Ga(i,n,e,t=!1,r=!1){return{back:i,current:n,forward:e,replaced:t,position:window.history.length,scroll:r?Nr():null}}function bf(i){const{history:n,location:e}=window,t={value:Nc(i,e)},r={value:n.state};function o(s,a,u){const l=i.indexOf("#"),c=l>-1?(e.host&&document.querySelector("base")?i:i.slice(l))+s:location.protocol+"//"+location.host+i+s;try{n[u?"replaceState":"pushState"](a,"",c),r.value=a}catch{e[u?"replace":"assign"](c)}}return r.value||o(t.value,{back:null,current:t.value,forward:null,position:n.length-1,replaced:!0,scroll:null},!0),{location:t,state:r,push:function(s,a){const u=Fe({},r.value,n.state,{forward:s,scroll:Nr()});o(u.current,u,!0),o(s,Fe({},Ga(t.value,s,null),{position:u.position+1},a),!1),t.value=s},replace:function(s,a){o(s,Fe({},n.state,Ga(r.value.back,s,r.value.forward,!0),a,{position:r.value.position}),!0),t.value=s}}}function Fc(i){return typeof i=="string"||typeof i=="symbol"}const Bc=Symbol("");var Ka,Qn;function mi(i,n){return Fe(new Error,{type:i,[Bc]:!0},n)}function $t(i,n){return i instanceof Error&&Bc in i&&(n==null||!!(i.type&n))}(Qn=Ka||(Ka={}))[Qn.aborted=4]="aborted",Qn[Qn.cancelled=8]="cancelled",Qn[Qn.duplicated=16]="duplicated";const qa="[^/]+?",kf={sensitive:!1,strict:!1,start:!0,end:!0},wf=/[.+*?^${}()[\]/\\]/g;function Tf(i,n){let e=0;for(;e<i.length&&e<n.length;){const t=n[e]-i[e];if(t)return t;e++}return i.length<n.length?i.length===1&&i[0]===80?-1:1:i.length>n.length?n.length===1&&n[0]===80?1:-1:0}function Ya(i,n){let e=0;const t=i.score,r=n.score;for(;e<t.length&&e<r.length;){const o=Tf(t[e],r[e]);if(o)return o;e++}if(Math.abs(r.length-t.length)===1){if($a(t))return 1;if($a(r))return-1}return r.length-t.length}function $a(i){const n=i[i.length-1];return i.length>0&&n[n.length-1]<0}const xf={type:0,value:""},Sf=/[a-zA-Z0-9_]/;function Cf(i,n,e){const t=function(o,s){const a=Fe({},kf,s),u=[];let l=a.start?"^":"";const c=[];for(const d of o){const f=d.length?[]:[90];a.strict&&!d.length&&(l+="/");for(let p=0;p<d.length;p++){const m=d[p];let v=40+(a.sensitive?.25:0);if(m.type===0)p||(l+="/"),l+=m.value.replace(wf,"\\$&"),v+=40;else if(m.type===1){const{value:y,repeatable:w,optional:S,regexp:C}=m;c.push({name:y,repeatable:w,optional:S});const E=C||qa;if(E!==qa){v+=10;try{new RegExp(`(${E})`)}catch(W){throw new Error(`Invalid custom RegExp for param "${y}" (${E}): `+W.message)}}let R=w?`((?:${E})(?:/(?:${E}))*)`:`(${E})`;p||(R=S&&d.length<2?`(?:/${R})`:"/"+R),S&&(R+="?"),l+=R,v+=20,S&&(v+=-8),w&&(v+=-20),E===".*"&&(v+=-50)}f.push(v)}u.push(f)}if(a.strict&&a.end){const d=u.length-1;u[d][u[d].length-1]+=.7000000000000001}a.strict||(l+="/?"),a.end?l+="$":a.strict&&(l+="(?:/|$)");const h=new RegExp(l,a.sensitive?"":"i");return{re:h,score:u,keys:c,parse:function(d){const f=d.match(h),p={};if(!f)return null;for(let m=1;m<f.length;m++){const v=f[m]||"",y=c[m-1];p[y.name]=v&&y.repeatable?v.split("/"):v}return p},stringify:function(d){let f="",p=!1;for(const m of o){p&&f.endsWith("/")||(f+="/"),p=!1;for(const v of m)if(v.type===0)f+=v.value;else if(v.type===1){const{value:y,repeatable:w,optional:S}=v,C=y in d?d[y]:"";if(Ut(C)&&!w)throw new Error(`Provided param "${y}" is an array but it is not repeatable (* or + modifiers)`);const E=Ut(C)?C.join("/"):C;if(!E){if(!S)throw new Error(`Missing required param "${y}"`);m.length<2&&(f.endsWith("/")?f=f.slice(0,-1):p=!0)}f+=E}}return f||"/"}}}(function(o){if(!o)return[[]];if(o==="/")return[[xf]];if(!o.startsWith("/"))throw new Error(`Invalid path "${o}"`);function s(w){throw new Error(`ERR (${a})/"${p}": ${w}`)}let a=0,u=a;const l=[];let c;function h(){c&&l.push(c),c=[]}let d,f=0,p="",m="";function v(){p&&(a===0?c.push({type:0,value:p}):a===1||a===2||a===3?(c.length>1&&(d==="*"||d==="+")&&s(`A repeatable param (${p}) must be alone in its segment. eg: '/:ids+.`),c.push({type:1,value:p,regexp:m,repeatable:d==="*"||d==="+",optional:d==="*"||d==="?"})):s("Invalid state to consume buffer"),p="")}function y(){p+=d}for(;f<o.length;)if(d=o[f++],d!=="\\"||a===2)switch(a){case 0:d==="/"?(p&&v(),h()):d===":"?(v(),a=1):y();break;case 4:y(),a=u;break;case 1:d==="("?a=2:Sf.test(d)?y():(v(),a=0,d!=="*"&&d!=="?"&&d!=="+"&&f--);break;case 2:d===")"?m[m.length-1]=="\\"?m=m.slice(0,-1)+d:a=3:m+=d;break;case 3:v(),a=0,d!=="*"&&d!=="?"&&d!=="+"&&f--,m="";break;default:s("Unknown state")}else u=a,a=4;return a===2&&s(`Unfinished custom RegExp for param "${p}"`),v(),h(),l}(i.path),e),r=Fe(t,{record:i,parent:n,children:[],alias:[]});return n&&!r.record.aliasOf==!n.record.aliasOf&&n.children.push(r),r}function Ef(i,n){const e=[],t=new Map;function r(a,u,l){const c=!l,h=Ja(a);h.aliasOf=l&&l.record;const d=Qa(n,a),f=[h];if("alias"in a){const v=typeof a.alias=="string"?[a.alias]:a.alias;for(const y of v)f.push(Ja(Fe({},h,{components:l?l.record.components:h.components,path:y,aliasOf:l?l.record:h})))}let p,m;for(const v of f){const{path:y}=v;if(u&&y[0]!=="/"){const w=u.record.path,S=w[w.length-1]==="/"?"":"/";v.path=u.record.path+(y&&S+y)}if(p=Cf(v,u,d),l?l.alias.push(p):(m=m||p,m!==p&&m.alias.push(p),c&&a.name&&!Za(p)&&o(a.name)),eu(p)&&s(p),h.children){const w=h.children;for(let S=0;S<w.length;S++)r(w[S],p,l&&l.children[S])}l=l||p}return m?()=>{o(m)}:Bi}function o(a){if(Fc(a)){const u=t.get(a);u&&(t.delete(a),e.splice(e.indexOf(u),1),u.children.forEach(o),u.alias.forEach(o))}else{const u=e.indexOf(a);u>-1&&(e.splice(u,1),a.record.name&&t.delete(a.record.name),a.children.forEach(o),a.alias.forEach(o))}}function s(a){const u=function(l,c){let h=0,d=c.length;for(;h!==d;){const p=h+d>>1;Ya(l,c[p])<0?d=p:h=p+1}const f=function(p){let m=p;for(;m=m.parent;)if(eu(m)&&Ya(p,m)===0)return m}(l);return f&&(d=c.lastIndexOf(f,d-1)),d}(a,e);e.splice(u,0,a),a.record.name&&!Za(a)&&t.set(a.record.name,a)}return n=Qa({strict:!1,end:!0,sensitive:!1},n),i.forEach(a=>r(a)),{addRoute:r,resolve:function(a,u){let l,c,h,d={};if("name"in a&&a.name){if(l=t.get(a.name),!l)throw mi(1,{location:a});h=l.record.name,d=Fe(Xa(u.params,l.keys.filter(m=>!m.optional).concat(l.parent?l.parent.keys.filter(m=>m.optional):[]).map(m=>m.name)),a.params&&Xa(a.params,l.keys.map(m=>m.name))),c=l.stringify(d)}else if(a.path!=null)c=a.path,l=e.find(m=>m.re.test(c)),l&&(d=l.parse(c),h=l.record.name);else{if(l=u.name?t.get(u.name):e.find(m=>m.re.test(u.path)),!l)throw mi(1,{location:a,currentLocation:u});h=l.record.name,d=Fe({},u.params,a.params),c=l.stringify(d)}const f=[];let p=l;for(;p;)f.unshift(p.record),p=p.parent;return{name:h,path:c,params:d,matched:f,meta:Lf(f)}},removeRoute:o,clearRoutes:function(){e.length=0,t.clear()},getRoutes:function(){return e},getRecordMatcher:function(a){return t.get(a)}}}function Xa(i,n){const e={};for(const t of n)t in i&&(e[t]=i[t]);return e}function Ja(i){const n={path:i.path,redirect:i.redirect,name:i.name,meta:i.meta||{},aliasOf:i.aliasOf,beforeEnter:i.beforeEnter,props:Pf(i),children:i.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in i?i.components||null:i.component&&{default:i.component}};return Object.defineProperty(n,"mods",{value:{}}),n}function Pf(i){const n={},e=i.props||!1;if("component"in i)n.default=e;else for(const t in i.components)n[t]=typeof e=="object"?e[t]:e;return n}function Za(i){for(;i;){if(i.record.aliasOf)return!0;i=i.parent}return!1}function Lf(i){return i.reduce((n,e)=>Fe(n,e.meta),{})}function Qa(i,n){const e={};for(const t in i)e[t]=t in n?n[t]:i[t];return e}function eu({record:i}){return!!(i.name||i.components&&Object.keys(i.components).length||i.redirect)}function Of(i){const n={};if(i===""||i==="?")return n;const e=(i[0]==="?"?i.slice(1):i).split("&");for(let t=0;t<e.length;++t){const r=e[t].replace(Ic," "),o=r.indexOf("="),s=Yi(o<0?r:r.slice(0,o)),a=o<0?null:Yi(r.slice(o+1));if(s in n){let u=n[s];Ut(u)||(u=n[s]=[u]),u.push(a)}else n[s]=a}return n}function tu(i){let n="";for(let e in i){const t=i[e];if(e=So(e).replace(sf,"%3D"),t==null){t!==void 0&&(n+=(n.length?"&":"")+e);continue}(Ut(t)?t.map(r=>r&&So(r)):[t&&So(t)]).forEach(r=>{r!==void 0&&(n+=(n.length?"&":"")+e,r!=null&&(n+="="+r))})}return n}function If(i){const n={};for(const e in i){const t=i[e];t!==void 0&&(n[e]=Ut(t)?t.map(r=>r==null?null:""+r):t==null?t:""+t)}return n}const Rf=Symbol(""),nu=Symbol(""),qs=Symbol(""),Uc=Symbol(""),hs=Symbol("");function Si(){let i=[];return{add:function(n){return i.push(n),()=>{const e=i.indexOf(n);e>-1&&i.splice(e,1)}},list:()=>i.slice(),reset:function(){i=[]}}}function kn(i,n,e,t,r,o=s=>s()){const s=t&&(t.enterCallbacks[r]=t.enterCallbacks[r]||[]);return()=>new Promise((a,u)=>{const l=d=>{var f;d===!1?u(mi(4,{from:e,to:n})):d instanceof Error?u(d):typeof(f=d)=="string"||f&&typeof f=="object"?u(mi(2,{from:n,to:d})):(s&&t.enterCallbacks[r]===s&&typeof d=="function"&&s.push(d),a())},c=o(()=>i.call(t&&t.instances[r],n,e,l));let h=Promise.resolve(c);i.length<3&&(h=h.then(l)),h.catch(d=>u(d))})}function Lo(i,n,e,t,r=o=>o()){const o=[];for(const s of i)for(const a in s.components){let u=s.components[a];if(n==="beforeRouteEnter"||s.instances[a])if(ja(u)){const l=(u.__vccOpts||u)[n];l&&o.push(kn(l,e,t,s,a,r))}else{let l=u();o.push(()=>l.then(c=>{if(!c)throw new Error(`Couldn't resolve component "${a}" at "${s.path}"`);const h=(d=c).__esModule||d[Symbol.toStringTag]==="Module"||d.default&&ja(d.default)?c.default:c;var d;s.mods[a]=c,s.components[a]=h;const f=(h.__vccOpts||h)[n];return f&&kn(f,e,t,s,a,r)()}))}}return o}function iu(i){const n=an(qs),e=an(Uc),t=Nt(()=>{const a=xn(i.to);return n.resolve(a)}),r=Nt(()=>{const{matched:a}=t.value,{length:u}=a,l=a[u-1],c=e.matched;if(!l||!c.length)return-1;const h=c.findIndex(pi.bind(null,l));if(h>-1)return h;const d=ru(a[u-2]);return u>1&&ru(l)===d&&c[c.length-1].path!==d?c.findIndex(pi.bind(null,a[u-2])):h}),o=Nt(()=>r.value>-1&&function(a,u){for(const l in u){const c=u[l],h=a[l];if(typeof c=="string"){if(c!==h)return!1}else if(!Ut(h)||h.length!==c.length||c.some((d,f)=>d!==h[f]))return!1}return!0}(e.params,t.value.params)),s=Nt(()=>r.value>-1&&r.value===e.matched.length-1&&Mc(e.params,t.value.params));return{route:t,href:Nt(()=>t.value.href),isActive:o,isExactActive:s,navigate:function(a={}){return function(u){if(!(u.metaKey||u.altKey||u.ctrlKey||u.shiftKey)&&!u.defaultPrevented&&!(u.button!==void 0&&u.button!==0)){if(u.currentTarget&&u.currentTarget.getAttribute){const l=u.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(l))return}return u.preventDefault&&u.preventDefault(),!0}}(a)?n[xn(i.replace)?"replace":"push"](xn(i.to)).catch(Bi):Promise.resolve()}}}const Af=rc({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:iu,setup(i,{slots:n}){const e=Xi(iu(i)),{options:t}=an(qs),r=Nt(()=>({[ou(i.activeClass,t.linkActiveClass,"router-link-active")]:e.isActive,[ou(i.exactActiveClass,t.linkExactActiveClass,"router-link-exact-active")]:e.isExactActive}));return()=>{const o=n.default&&n.default(e);return i.custom?o:Ec("a",{"aria-current":e.isExactActive?i.ariaCurrentValue:null,href:e.href,onClick:e.navigate,class:r.value},o)}}});function ru(i){return i?i.aliasOf?i.aliasOf.path:i.path:""}const ou=(i,n,e)=>i??n??e,Df=rc({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(i,{attrs:n,slots:e}){const t=an(hs),r=Nt(()=>i.route||t.value),o=an(nu,0),s=Nt(()=>{let l=xn(o);const{matched:c}=r.value;let h;for(;(h=c[l])&&!h.components;)l++;return l}),a=Nt(()=>r.value.matched[s.value]);yr(nu,Nt(()=>s.value+1)),yr(Rf,a),yr(hs,r);const u=Pr();return _r(()=>[u.value,a.value,i.name],([l,c,h],[d,f,p])=>{c&&(c.instances[h]=l,f&&f!==c&&l&&l===d&&(c.leaveGuards.size||(c.leaveGuards=f.leaveGuards),c.updateGuards.size||(c.updateGuards=f.updateGuards))),!l||!c||f&&pi(c,f)&&d||(c.enterCallbacks[h]||[]).forEach(m=>m(l))},{flush:"post"}),()=>{const l=r.value,c=i.name,h=a.value,d=h&&h.components[c];if(!d)return su(e.default,{Component:d,route:l});const f=h.props[c],p=f?f===!0?l.params:typeof f=="function"?f(l):f:null,m=Ec(d,Fe({},p,n,{onVnodeUnmounted:v=>{v.component.isUnmounted&&(h.instances[c]=null)},ref:u}));return su(e.default,{Component:m,route:l})||m}}});function su(i,n){if(!i)return null;const e=i(n);return e.length===1?e[0]:e}const jc=Df,Hc=(i,n)=>{const e=i.__vccOpts||i;for(const[t,r]of n)e[t]=r;return e},Mf=Hc({__name:"App",setup:i=>(n,e)=>(Bn(),Tc(xn(jc)))},[["__scopeId","data-v-5d9d88c2"]]),au={};function uu(i,n){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);n&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),e.push.apply(e,t)}return e}function Ye(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?uu(Object(e),!0).forEach(function(t){j(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):uu(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}function pt(i){return(pt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(i)}function fe(i,n){if(!(i instanceof n))throw new TypeError("Cannot call a class as a function")}function lu(i,n){for(var e=0;e<n.length;e++){var t=n[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(i,zc(t.key),t)}}function pe(i,n,e){return n&&lu(i.prototype,n),e&&lu(i,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function j(i,n,e){return(n=zc(n))in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}function ye(i,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(n&&n.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),n&&Vc(i,n)}function we(i){return(we=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)})(i)}function Vc(i,n){return(Vc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(i,n)}function O(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function Ys(i,n){if(n&&(typeof n=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return O(i)}function _e(i){var n=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var e,t=we(i);if(n){var r=we(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Ys(this,e)}}function Ce(){return Ce=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(i,n,e){var t=function(o,s){for(;!Object.prototype.hasOwnProperty.call(o,s)&&(o=we(o))!==null;);return o}(i,n);if(t){var r=Object.getOwnPropertyDescriptor(t,n);return r.get?r.get.call(arguments.length<3?i:e):r.value}},Ce.apply(this,arguments)}function Bt(i){return function(n){if(Array.isArray(n))return Oo(n)}(i)||function(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}(i)||function(n,e){if(n){if(typeof n=="string")return Oo(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Oo(n,e)}}(i)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Oo(i,n){(n==null||n>i.length)&&(n=i.length);for(var e=0,t=new Array(n);e<n;e++)t[e]=i[e];return t}function zc(i){var n=function(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var o=r.call(e,t||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}(i,"string");return typeof n=="symbol"?n:String(n)}function no(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Wc={exports:{}};(function(i){var n=Object.prototype.hasOwnProperty,e="~";function t(){}function r(u,l,c){this.fn=u,this.context=l,this.once=c||!1}function o(u,l,c,h,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new r(c,h||u,d),p=e?e+l:l;return u._events[p]?u._events[p].fn?u._events[p]=[u._events[p],f]:u._events[p].push(f):(u._events[p]=f,u._eventsCount++),u}function s(u,l){--u._eventsCount==0?u._events=new t:delete u._events[l]}function a(){this._events=new t,this._eventsCount=0}Object.create&&(t.prototype=Object.create(null),new t().__proto__||(e=!1)),a.prototype.eventNames=function(){var u,l,c=[];if(this._eventsCount===0)return c;for(l in u=this._events)n.call(u,l)&&c.push(e?l.slice(1):l);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(u){var l=e?e+u:u,c=this._events[l];if(!c)return[];if(c.fn)return[c.fn];for(var h=0,d=c.length,f=new Array(d);h<d;h++)f[h]=c[h].fn;return f},a.prototype.listenerCount=function(u){var l=e?e+u:u,c=this._events[l];return c?c.fn?1:c.length:0},a.prototype.emit=function(u,l,c,h,d,f){var p=e?e+u:u;if(!this._events[p])return!1;var m,v,y=this._events[p],w=arguments.length;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),w){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,l),!0;case 3:return y.fn.call(y.context,l,c),!0;case 4:return y.fn.call(y.context,l,c,h),!0;case 5:return y.fn.call(y.context,l,c,h,d),!0;case 6:return y.fn.call(y.context,l,c,h,d,f),!0}for(v=1,m=new Array(w-1);v<w;v++)m[v-1]=arguments[v];y.fn.apply(y.context,m)}else{var S,C=y.length;for(v=0;v<C;v++)switch(y[v].once&&this.removeListener(u,y[v].fn,void 0,!0),w){case 1:y[v].fn.call(y[v].context);break;case 2:y[v].fn.call(y[v].context,l);break;case 3:y[v].fn.call(y[v].context,l,c);break;case 4:y[v].fn.call(y[v].context,l,c,h);break;default:if(!m)for(S=1,m=new Array(w-1);S<w;S++)m[S-1]=arguments[S];y[v].fn.apply(y[v].context,m)}}return!0},a.prototype.on=function(u,l,c){return o(this,u,l,c,!1)},a.prototype.once=function(u,l,c){return o(this,u,l,c,!0)},a.prototype.removeListener=function(u,l,c,h){var d=e?e+u:u;if(!this._events[d])return this;if(!l)return s(this,d),this;var f=this._events[d];if(f.fn)f.fn!==l||h&&!f.once||c&&f.context!==c||s(this,d);else{for(var p=0,m=[],v=f.length;p<v;p++)(f[p].fn!==l||h&&!f[p].once||c&&f[p].context!==c)&&m.push(f[p]);m.length?this._events[d]=m.length===1?m[0]:m:s(this,d)}return this},a.prototype.removeAllListeners=function(u){var l;return u?(l=e?e+u:u,this._events[l]&&s(this,l)):(this._events=new t,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,i.exports=a})(Wc);var Gc=Wc.exports;const Yn=no(Gc);var Nf=typeof window<"u"&&window.location&&window.location.href.indexOf("xgplayerdebugger=1")>-1,Io={info:"color: #525252; background-color: #90ee90;",error:"color: #525252; background-color: red;",warn:"color: #525252; background-color: yellow; "},Ro="%c[xgplayer]",Re={config:{debug:Nf?3:0},logInfo:function(i){for(var n,e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];this.config.debug>=3&&(n=console).log.apply(n,[Ro,Io.info,i].concat(t))},logWarn:function(i){for(var n,e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];this.config.debug>=1&&(n=console).warn.apply(n,[Ro,Io.warn,i].concat(t))},logError:function(i){var n;if(!(this.config.debug<1)){for(var e=this.config.debug>=2?"trace":"error",t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];(n=console)[e].apply(n,[Ro,Io.error,i].concat(r))}}},Ff=function(){function i(n){fe(this,i),this.bufferedList=n}return pe(i,[{key:"start",value:function(n){return this.bufferedList[n].start}},{key:"end",value:function(n){return this.bufferedList[n].end}},{key:"length",get:function(){return this.bufferedList.length}}]),i}(),g={};function Kc(i){var n=pt(i);return i!==null&&(n==="object"||n==="function")}function Bf(i,n,e){var t,r,o,s,a,u,l=0,c=!1,h=!1,d=!0,f=!n&&n!==0&&typeof window.requestAnimationFrame=="function";if(typeof i!="function")throw new TypeError("Expected a function");function p(C){var E=t,R=r;return t=r=void 0,l=C,s=i.apply(R,E)}function m(C,E){return f?(window.cancelAnimationFrame(a),window.requestAnimationFrame(C)):setTimeout(C,E)}function v(C){var E=C-u;return u===void 0||E>=n||E<0||h&&C-l>=o}function y(){var C=Date.now();if(v(C))return w(C);a=m(y,function(E){var R=E-l,W=n-(E-u);return h?Math.min(W,o-R):W}(C))}function w(C){return a=void 0,d&&t?p(C):(t=r=void 0,s)}function S(){for(var C=Date.now(),E=v(C),R=arguments.length,W=new Array(R),J=0;J<R;J++)W[J]=arguments[J];if(t=W,r=this,u=C,E){if(a===void 0)return function(se){return l=se,a=m(y,n),c?p(se):s}(u);if(h)return a=m(y,n),p(u)}return a===void 0&&(a=m(y,n)),s}return n=+n||0,Kc(e)&&(c=!!e.leading,o=(h="maxWait"in e)?Math.max(+e.maxWait||0,n):o,d="trailing"in e?!!e.trailing:d),S.cancel=function(){a!==void 0&&function(C){if(f)return window.cancelAnimationFrame(C);clearTimeout(C)}(a),l=0,t=u=r=a=void 0},S.flush=function(){return a===void 0?s:w(Date.now())},S.pending=function(){return a!==void 0},S}g.createDom=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"div",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",r=document.createElement(i);return r.className=t,r.innerHTML=n,Object.keys(e).forEach(function(o){var s=o,a=e[o];i==="video"||i==="audio"||i==="live-video"?a&&r.setAttribute(s,a):r.setAttribute(s,a)}),r},g.createDomFromHtml=function(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";try{var t=document.createElement("div");t.innerHTML=i;var r=t.children;return t=null,r.length>0?(r=r[0],e&&g.addClass(r,e),n&&Object.keys(n).forEach(function(o){r.setAttribute(o,n[o])}),r):null}catch(o){return Re.logError("util.createDomFromHtml",o),null}},g.hasClass=function(i,n){if(!i||!n)return!1;try{return Array.prototype.some.call(i.classList,function(t){return t===n})}catch{var e=i.className&&pt(i.className)==="object"?i.getAttribute("class"):i.className;return e&&!!e.match(new RegExp("(\\s|^)"+n+"(\\s|$)"))}},g.addClass=function(i,n){if(i&&n)try{n.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(e){e&&i.classList.add(e)})}catch{g.hasClass(i,n)||(i.className&&pt(i.className)==="object"?i.setAttribute("class",i.getAttribute("class")+" "+n):i.className+=" "+n)}},g.removeClass=function(i,n){if(i&&n)try{n.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(e){e&&i.classList.remove(e)})}catch{g.hasClass(i,n)&&n.split(/\s+/g).forEach(function(t){var r=new RegExp("(\\s|^)"+t+"(\\s|$)");i.className&&pt(i.className)==="object"?i.setAttribute("class",i.getAttribute("class").replace(r," ")):i.className=i.className.replace(r," ")})}},g.toggleClass=function(i,n){i&&n.split(/\s+/g).forEach(function(e){g.hasClass(i,e)?g.removeClass(i,e):g.addClass(i,e)})},g.classNames=function(){for(var i=arguments,n=[],e=function(r){g.typeOf(i[r])==="String"?n.push(i[r]):g.typeOf(i[r])==="Object"&&Object.keys(i[r]).map(function(o){i[r][o]&&n.push(o)})},t=0;t<arguments.length;t++)e(t);return n.join(" ")},g.findDom=function(){var i,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,e=arguments.length>1?arguments[1]:void 0;try{i=n.querySelector(e)}catch(t){Re.logError("util.findDom",t),e.indexOf("#")===0&&(i=n.getElementById(e.slice(1)))}return i},g.getCss=function(i,n){return i.currentStyle?i.currentStyle[n]:document.defaultView.getComputedStyle(i,!1)[n]},g.padStart=function(i,n,e){for(var t=String(e),r=n|0,o=Math.ceil(r/t.length),s=[],a=String(i);o--;)s.push(t);return s.join("").substring(0,r-a.length)+a},g.format=function(i){if(window.isNaN(i))return"";i=Math.round(i);var n=g.padStart(Math.floor(i/3600),2,0),e=g.padStart(Math.floor((i-3600*n)/60),2,0),t=g.padStart(Math.floor(i-3600*n-60*e),2,0);return(n==="00"?[e,t]:[n,e,t]).join(":")},g.event=function(i){if(i.touches){var n=i.touches[0]||i.changedTouches[0];i.clientX=n.clientX||0,i.clientY=n.clientY||0,i.offsetX=n.pageX-n.target.offsetLeft,i.offsetY=n.pageY-n.target.offsetTop}i._target=i.target||i.srcElement},g.typeOf=function(i){return Object.prototype.toString.call(i).match(/([^\s.*]+)(?=]$)/g)[0]},g.deepCopy=function(i,n){if(g.typeOf(n)==="Object"&&g.typeOf(i)==="Object")return Object.keys(n).forEach(function(e){g.typeOf(n[e])!=="Object"||n[e]instanceof Node?g.typeOf(n[e])==="Array"?i[e]=g.typeOf(i[e])==="Array"?i[e].concat(n[e]):n[e]:i[e]=n[e]:i[e]===void 0||i[e]===void 0?i[e]=n[e]:g.deepCopy(i[e],n[e])}),i},g.deepMerge=function(i,n){return Object.keys(n).map(function(e){var t;g.typeOf(n[e])==="Array"&&g.typeOf(i[e])==="Array"?g.typeOf(i[e])==="Array"&&(t=i[e]).push.apply(t,Bt(n[e])):g.typeOf(i[e])!==g.typeOf(n[e])||i[e]===null||g.typeOf(i[e])!=="Object"||n[e]instanceof window.Node?n[e]!==null&&(i[e]=n[e]):g.deepMerge(i[e],n[e])}),i},g.getBgImage=function(i){var n=(i.currentStyle||window.getComputedStyle(i,null)).backgroundImage;if(!n||n==="none")return"";var e=document.createElement("a");return e.href=n.replace(/url\("|"\)/g,""),e.href},g.copyDom=function(i){if(i&&i.nodeType===1){var n=document.createElement(i.tagName);return Array.prototype.forEach.call(i.attributes,function(e){n.setAttribute(e.name,e.value)}),i.innerHTML&&(n.innerHTML=i.innerHTML),n}return""},g.setInterval=function(i,n,e,t){i._interval[n]||(i._interval[n]=window.setInterval(e.bind(i),t))},g.clearInterval=function(i,n){clearInterval(i._interval[n]),i._interval[n]=null},g.setTimeout=function(i,n,e){i._timers||(i._timers=[]);var t=setTimeout(function(){n(),g.clearTimeout(i,t)},e);return i._timers.push(t),t},g.clearTimeout=function(i,n){var e=i._timers;if(g.typeOf(e)==="Array"){for(var t=0;t<e.length;t++)if(e[t]===n){e.splice(t,1),clearTimeout(n);break}}else clearTimeout(n)},g.clearAllTimers=function(i){var n=i._timers;g.typeOf(n)==="Array"&&(n.map(function(e){clearTimeout(e)}),i._timerIds=[])},g.createImgBtn=function(i,n,e,t){var r,o,s,a=g.createDom("xg-".concat(i),"",{},"xgplayer-".concat(i,"-img"));return a.style.backgroundImage='url("'.concat(n,'")'),e&&t&&(["px","rem","em","pt","dp","vw","vh","vm","%"].every(function(u){return!(e.indexOf(u)>-1&&t.indexOf(u)>-1)||(r=parseFloat(e.slice(0,e.indexOf(u)).trim()),o=parseFloat(t.slice(0,t.indexOf(u)).trim()),s=u,!1)}),a.style.width="".concat(r).concat(s),a.style.height="".concat(o).concat(s),a.style.backgroundSize="".concat(r).concat(s," ").concat(o).concat(s),a.style.margin=i==="start"?"-".concat(o/2).concat(s," auto auto -").concat(r/2).concat(s):"auto 5px auto 5px"),a},g.Hex2RGBA=function(i,n){var e=[];if(/^\#[0-9A-F]{3}$/i.test(i)){var t="#";i.replace(/[0-9A-F]/gi,function(r){t+=r+r}),i=t}return/^#[0-9A-F]{6}$/i.test(i)?(i.replace(/[0-9A-F]{2}/gi,function(r){e.push(parseInt(r,16))}),"rgba(".concat(e.join(","),", ").concat(n,")")):"rgba(255, 255, 255, 0.1)"},g.getFullScreenEl=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},g.checkIsFunction=function(i){return i&&typeof i=="function"},g.checkIsObject=function(i){return i!==null&&pt(i)==="object"},g.hide=function(i){i.style.display="none"},g.show=function(i,n){i.style.display=n||"block"},g.isUndefined=function(i){if(i==null)return!0},g.isNotNull=function(i){return i!=null},g.setStyleFromCsstext=function(i,n){n&&(g.typeOf(n)==="String"?n.replace(/\s+/g,"").split(";").map(function(e){if(e){var t=e.split(":");t.length>1&&(i.style[t[0]]=t[1])}}):Object.keys(n).map(function(e){i.style[e]=n[e]}))},g.filterStyleFromText=function(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["width","height","top","left","bottom","right","position","z-index","padding","margin","transform"],e=i.style.cssText;if(!e)return{};var t=e.replace(/\s+/g,"").split(";"),r={},o={};return t.map(function(s){if(s){var a=s.split(":");a.length>1&&(function(u,l){for(var c=0,h=l.length;c<h;c++)if(u.indexOf(l[c])>-1)return!0;return!1}(a[0],n)?r[a[0]]=a[1]:o[a[0]]=a[1])}}),i.setAttribute("style",""),Object.keys(o).map(function(s){i.style[s]=o[s]}),r},g.getStyleFromCsstext=function(i){var n=i.style.cssText;if(!n)return{};var e=n.replace(/\s+/g,"").split(";"),t={};return e.map(function(r){if(r){var o=r.split(":");o.length>1&&(t[o[0]]=o[1])}}),t},g.preloadImg=function(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){},e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){};if(i){var t=new window.Image;t.onload=function(r){t=null,n&&n(r)},t.onerror=function(r){t=null,e&&e(r)},t.src=i}},g.stopPropagation=function(i){i&&i.stopPropagation()},g.scrollTop=function(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},g.scrollLeft=function(){return window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0},g.checkTouchSupport=function(){return"ontouchstart"in window},g.getBuffered2=function(i){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5,e=[],t=0;t<i.length;t++)e.push({start:i.start(t)<.5?0:i.start(t),end:i.end(t)});e.sort(function(u,l){var c=u.start-l.start;return c||l.end-u.end});var r=[];if(n)for(var o=0;o<e.length;o++){var s=r.length;if(s){var a=r[s-1].end;e[o].start-a<n?e[o].end>a&&(r[s-1].end=e[o].end):r.push(e[o])}else r.push(e[o])}else r=e;return new Ff(r)},g.getEventPos=function(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return i.touches&&i.touches.length>0&&(i=i.touches[0]),{x:i.x/n,y:i.y/n,clientX:i.clientX/n,clientY:i.clientY/n,offsetX:i.offsetX/n,offsetY:i.offsetY/n,pageX:i.pageX/n,pageY:i.pageY/n}},g.requestAnimationFrame=function(i){var n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;if(n)return n(i)},g.getHostFromUrl=function(i){if(g.typeOf(i)!=="String")return"";var n=i.split("/"),e="";return n.length>3&&n[2]&&(e=n[2]),e},g.cancelAnimationFrame=function(i){var n=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.cancelRequestAnimationFrame;n&&n(i)},g.isMSE=function(i){return i.media&&(i=i.media),!!(i&&i instanceof HTMLMediaElement)&&(/^blob/.test(i.currentSrc)||/^blob/.test(i.src))},g.isBlob=function(i){return typeof i=="string"&&/^blob/.test(i)},g.generateSessionId=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=new Date().getTime();try{i=parseInt(i)}catch{i=0}return n+=i,window.performance&&typeof window.performance.now=="function"&&(n+=parseInt(window.performance.now())),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),(e==="x"?t:3&t|8).toString(16)})},g.createEvent=function(i){var n;return typeof window.Event=="function"?n=new Event(i):(n=document.createEvent("Event")).initEvent(i,!0,!0),n},g.adjustTimeByDuration=function(i,n,e){return n&&i&&(i>n||e&&i<n)?n:i},g.createPositionBar=function(i,n){var e=g.createDom("xg-bar","",{"data-index":-1},i);return n.appendChild(e),e},g.getTransformStyle=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{x:0,y:0,scale:1,rotate:0},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",e={scale:"".concat(i.scale||1),translate:"".concat(i.x||0,"%, ").concat(i.y||0,"%"),rotate:"".concat(i.rotate||0,"deg")};return Object.keys(e).forEach(function(t){var r=new RegExp("".concat(t,"\\([^\\(]+\\)"),"g"),o="".concat(t,"(").concat(e[t],")");r.test(n)?(r.lastIndex=-1,n=n.replace(r,o)):n+="".concat(o," ")}),n},g.convertDeg=function(i){return Math.abs(i)<=1?360*i:i%360},g.getIndexByTime=function(i,n){var e=n.length,t=-1;if(e<1)return t;if(i<=n[0].end||e<2)t=0;else if(i>n[e-1].end)t=e-1;else for(var r=1;r<e;r++)if(i>n[r-1].end&&i<=n[r].end){t=r;break}return t},g.getOffsetCurrentTime=function(i,n){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,t=-1;if((t=e>=0&&e<n.length?e:g.getIndexByTime(i,n))<0)return-1;var r=n.length,o=n[t],s=o.start,a=o.end,u=o.cTime,l=o.offset;return i<s?u:i>=s&&i<=a?i-l:i>a&&t>=r-1?a:-1},g.getCurrentTimeByOffset=function(i,n){var e=-1;if(!n||n.length<0)return i;for(var t=0;t<n.length;t++)if(i<=n[t].duration){e=t;break}if(e!==-1){var r=n[e].start;return e-1<0?r+i:r+(i-n[e-1].duration)}return i};var Uf=/(Android)\s([\d.]+)/,jf=/(Version)\/([\d.]+)/,Hf=["avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","avc1.42E01E","mp4v.20.8","avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","mp4v.20.8, mp4a.40.2","mp4v.20.240, mp4a.40.2"],Pe={get device(){return Pe.os.isPc?"pc":"mobile"},get browser(){if(typeof navigator>"u")return"";var i=navigator.userAgent.toLowerCase(),n={ie:/rv:([\d.]+)\) like gecko/,firefox:/firefox\/([\d.]+)/,chrome:/chrome\/([\d.]+)/,opera:/opera.([\d.]+)/,safari:/version\/([\d.]+).*safari/};return[].concat(Object.keys(n).filter(function(e){return n[e].test(i)}))[0]},get os(){if(typeof navigator>"u")return{};var i=navigator.userAgent,n=/(?:Windows Phone)/.test(i),e=/(?:SymbianOS)/.test(i)||n,t=/(?:Android)/.test(i),r=/(?:Firefox)/.test(i),o=/(?:iPad|PlayBook)/.test(i)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,s=o||t&&!/(?:Mobile)/.test(i)||r&&/(?:Tablet)/.test(i),a=/(?:iPhone)/.test(i)&&!s;return{isTablet:s,isPhone:a,isIpad:o,isIos:a||o,isAndroid:t,isPc:!(a||t||e||s),isSymbian:e,isWindowsPhone:n,isFireFox:r}},get osVersion(){if(typeof navigator>"u")return 0;var i=navigator.userAgent,n="",e=(n=/(?:iPhone)|(?:iPad|PlayBook)/.test(i)?jf:Uf)?n.exec(i):[];if(e&&e.length>=3){var t=e[2].split(".");return t.length>0?parseInt(t[0]):0}return 0},get isWeixin(){return typeof navigator>"u"?!1:!!/(micromessenger)\/([\d.]+)/.exec(navigator.userAgent.toLocaleLowerCase())},isSupportMP4:function(){var i={isSupport:!1,mime:""};if(typeof document>"u")return i;if(this.supportResult)return this.supportResult;var n=document.createElement("video");return typeof n.canPlayType=="function"&&Hf.map(function(e){n.canPlayType('video/mp4; codecs="'.concat(e,'"'))==="probably"&&(i.isSupport=!0,i.mime+="||".concat(e))}),this.supportResult=i,n=null,i},isMSESupport:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:'video/mp4; codecs="avc1.42E01E,mp4a.40.2"';if(typeof MediaSource>"u"||!MediaSource)return!1;try{return MediaSource.isTypeSupported(i)}catch(n){return this._logger.error(i,n),!1}},isHevcSupported:function(){return!(typeof MediaSource>"u"||!MediaSource.isTypeSupported)&&(MediaSource.isTypeSupported('video/mp4;codecs="hev1.1.6.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.2.4.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.3.E.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.4.10.L120.90"'))},probeConfigSupported:function(i){var n={supported:!1,smooth:!1,powerEfficient:!1};if(!i||typeof navigator>"u")return Promise.resolve(n);if(navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo)return navigator.mediaCapabilities.decodingInfo(i);var e=i.video||{},t=i.audio||{};try{var r=MediaSource.isTypeSupported(e.contentType),o=MediaSource.isTypeSupported(t.contentType);return Promise.resolve({supported:r&&o,smooth:!1,powerEfficient:!1})}catch{return Promise.resolve(n)}}},ds="3.0.17",cu={1:"media",2:"media",3:"media",4:"media",5:"media",6:"media"},hu={1:5101,2:5102,3:5103,4:5104,5:5105,6:5106},nn=pe(function i(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{errorType:"",errorCode:0,errorMessage:"",originError:"",ext:{},mediaError:null};fe(this,i);var t=n&&n.i18n?n.i18n.ERROR_TYPES:null;if(n.media){var r=e.mediaError?e.mediaError:n.media.error||{},o=n.duration,s=n.currentTime,a=n.ended,u=n.src,l=n.currentSrc,c=n.media,h=c.readyState,d=c.networkState,f=e.errorCode||r.code;hu[f]&&(f=hu[f]);var p={playerVersion:ds,currentTime:s,duration:o,ended:a,readyState:h,networkState:d,src:u||l,errorType:e.errorType,errorCode:f,message:e.errorMessage||r.message,mediaError:r,originError:e.originError?e.originError.stack:"",host:g.getHostFromUrl(u||l)};return e.ext&&Object.keys(e.ext).map(function(w){p[w]=e.ext[w]}),p}if(arguments.length>1){for(var m={playerVersion:ds,domain:document.domain},v=["errorType","currentTime","duration","networkState","readyState","src","currentSrc","ended","errd","errorCode","mediaError"],y=0;y<arguments.length;y++)m[v[y]]=arguments[y];return m.ex=t?(t[arguments[0]]||{}).msg:"",m}}),St="play",$s="playing",$n="ended",_i="pause",Qi="error",jn="seeking",un="seeked",xt="timeupdate",Gn="waiting",on="canplay",Pn="durationchange",qc="volumechange",cn="loadeddata",Yc="ratechange",$c="progress",Xs="loadstart",Xn="emptied",Js="focus",Xc="blur",Zs="ready",Jc="urlNull",Hn="autoplay_started",Qs="autoplay_was_prevented",io="complete",Fr="replay",ea="destroy",Vn="urlchange",fs="download_speed_change",Zc="leaveplayer",Qc="enterplayer",eh="loading",Zt="fullscreen_change",Br="cssFullscreen_change",Ur="mini_state_change",ro="definition_change",jr="after_definition_change",Ln="video_resize",ps="pip_change",th="rotate",nh="screenShot",Hr="playnext",ih="shortcut",rh="xglog",Vr="user_action",oo="reset",oh="source_error",sh="source_success",ah=["play","playing","ended","pause","error","seeking","seeked","timeupdate","waiting","canplay","canplaythrough","durationchange","volumechange","loadeddata","loadedmetadata","ratechange","progress","loadstart","emptied","stalled","suspend","abort","lowdecode"],uh={STATS_INFO:"stats_info",STATS_DOWNLOAD:"stats_download",STATS_RESET:"stats_reset"},lh="fps_stuck";const Vf=Object.freeze(Object.defineProperty({__proto__:null,ABORT:"abort",AFTER_DEFINITION_CHANGE:jr,AUTOPLAY_PREVENTED:Qs,AUTOPLAY_STARTED:Hn,BEFORE_DEFINITION_CHANGE:"before_definition_change",BUFFER_CHANGE:"bufferedChange",CANPLAY:on,CANPLAY_THROUGH:"canplaythrough",COMPLETE:io,CSS_FULLSCREEN_CHANGE:Br,DEFINITION_CHANGE:ro,DESTROY:ea,DOWNLOAD_SPEED_CHANGE:fs,DURATION_CHANGE:Pn,EMPTIED:Xn,ENDED:$n,ENTER_PLAYER:Qc,ERROR:Qi,FPS_STUCK:lh,FULLSCREEN_CHANGE:Zt,LEAVE_PLAYER:Zc,LOADED_DATA:cn,LOADED_METADATA:"loadedmetadata",LOADING:eh,LOAD_START:Xs,MINI_STATE_CHANGE:Ur,PAUSE:_i,PIP_CHANGE:ps,PLAY:St,PLAYER_BLUR:Xc,PLAYER_FOCUS:Js,PLAYING:$s,PLAYNEXT:Hr,PROGRESS:$c,RATE_CHANGE:Yc,READY:Zs,REPLAY:Fr,RESET:oo,RETRY:"retry",ROTATE:th,SCREEN_SHOT:nh,SEEKED:un,SEEKING:jn,SEI_PARSED:"SEI_PARSED",SHORTCUT:ih,SOURCE_ERROR:oh,SOURCE_SUCCESS:sh,STALLED:"stalled",STATS_EVENTS:uh,SUSPEND:"suspend",SWITCH_SUBTITLE:"switch_subtitle",TIME_UPDATE:xt,URL_CHANGE:Vn,URL_NULL:Jc,USER_ACTION:Vr,VIDEO_EVENTS:ah,VIDEO_RESIZE:Ln,VOLUME_CHANGE:qc,WAITING:Gn,XGLOG:rh},Symbol.toStringTag,{value:"Module"}));function Ao(i,n){this&&this.emit&&(i==="error"?this.errorHandler(i,n.error):this.emit(i,n))}var zf=function(){ye(n,Yn);var i=_e(n);function n(e){var t;fe(this,n),(t=i.call(this,e))._hasStart=!1,t._currentTime=0,t._duration=0,t._internalOp={},t._lastMuted=!1,t.vtype="MP4",t._rate=-1,t.mediaConfig=Object.assign({},{controls:!1,autoplay:e.autoplay,playsinline:e.playsinline,"x5-playsinline":e.playsinline,"webkit-playsinline":e.playsinline,"x5-video-player-fullscreen":e["x5-video-player-fullscreen"]||e.x5VideoPlayerFullscreen,"x5-video-orientation":e["x5-video-orientation"]||e.x5VideoOrientation,airplay:e.airplay,"webkit-airplay":e.airplay,tabindex:0|e.tabindex,mediaType:e.mediaType||"video","data-index":-1},e.videoConfig,e.videoAttributes);var r=e["x5-video-player-type"]||e.x5VideoPlayerType;return Pe.isWeixin&&Pe.os.isAndroid&&r&&(t.mediaConfig["x5-video-player-type"]=r,delete t.mediaConfig.playsinline,delete t.mediaConfig["webkit-playsinline"],delete t.mediaConfig["x5-playsinline"]),e.loop&&(t.mediaConfig.loop="loop"),e.autoplayMuted&&!Object.prototype.hasOwnProperty.call(t.mediaConfig,"muted")&&(t.mediaConfig.muted=!0),t.media=g.createDom(t.mediaConfig.mediaType,"",t.mediaConfig,""),e.defaultPlaybackRate&&(t.media.defaultPlaybackRate=t.media.playbackRate=e.defaultPlaybackRate),g.typeOf(e.volume)==="Number"&&(t.volume=e.volume),e.autoplayMuted&&(t.media.muted=!0,t._lastMuted=!0),e.autoplay&&(t.media.autoplay=!0),t._interval={},t.mediaEventMiddleware={},t.attachVideoEvents(),t}return pe(n,[{key:"setEventsMiddleware",value:function(e){var t=this;Object.keys(e).map(function(r){t.mediaEventMiddleware[r]=e[r]})}},{key:"removeEventsMiddleware",value:function(e){var t=this;Object.keys(e).map(function(r){delete t.mediaEventMiddleware[r]})}},{key:"attachVideoEvents",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.media;this._evHandlers||(this._evHandlers=ah.map(function(r){var o="on".concat(r.charAt(0).toUpperCase()).concat(r.slice(1));return typeof e[o]=="function"&&e.on(r,e[o]),j({},r,function(s,a){return function(u,l){var c={player:a,eventName:s,originalEvent:u,detail:u.detail||{},timeStamp:u.timeStamp,currentTime:a.currentTime,duration:a.duration,paused:a.paused,ended:a.ended,isInternalOp:!!a._internalOp[u.type],muted:a.muted,volume:a.volume,host:g.getHostFromUrl(a.currentSrc),vtype:a.vtype};if(a.removeInnerOP(u.type),s==="timeupdate"&&(a._currentTime=a.media&&a.media.currentTime),s==="ratechange"){var h=a.media?a.media.playbackRate:0;if(h&&a._rate===h)return;a._rate=a.media&&a.media.playbackRate}if(s==="durationchange"&&(a._duration=a.media.duration),s==="volumechange"&&(c.isMutedChange=a._lastMuted!==a.muted,a._lastMuted=a.muted),s==="error"&&(c.error=l||a.video.error),a.mediaEventMiddleware[s]){var d=Ao.bind(a,s,c);try{a.mediaEventMiddleware[s].call(a,c,d)}catch(f){throw Ao.call(a,s,c),f}}else Ao.call(a,s,c)}}(r,e))})),this._evHandlers.forEach(function(r){var o=Object.keys(r)[0];t.addEventListener(o,r[o],!1)})}},{key:"detachVideoEvents",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.media;this._evHandlers.forEach(function(r){var o=Object.keys(r)[0];t.removeEventListener(o,r[o],!1)}),this._evHandlers.forEach(function(r){var o=Object.keys(r)[0],s="on".concat(o.charAt(0).toUpperCase()).concat(o.slice(1));typeof e[s]=="function"&&e.off(o,e[s])}),this._evHandlers=null}},{key:"_attachSourceEvents",value:function(e,t){var r=this;e.removeAttribute("src"),e.load(),t.forEach(function(l,c){r.media.appendChild(g.createDom("source","",{src:"".concat(l.src),type:"".concat(l.type||""),"data-index":c+1}))});var o=e.children;if(o){this._videoSourceCount=o.length,this._videoSourceIndex=o.length,this._vLoadeddata=function(l){r.emit(sh,{src:l.target.currentSrc,host:g.getHostFromUrl(l.target.currentSrc)})};for(var s=null,a=0;a<this._evHandlers.length;a++)if(Object.keys(this._evHandlers[a])[0]==="error"){s=this._evHandlers[a];break}!this._sourceError&&(this._sourceError=function(l){var c=parseInt(l.target.getAttribute("data-index"),10);if(r._videoSourceIndex--,r._videoSourceIndex===0||c>=r._videoSourceCount){var h={code:4,message:"sources_load_error"};s?s.error(l,h):r.errorHandler("error",h)}var d=cu[4];r.emit(oh,new nn(r,{errorType:d,errorCode:4,errorMessage:"sources_load_error",mediaError:{code:4,message:"sources_load_error"},src:l.target.src}))});for(var u=0;u<o.length;u++)o[u].addEventListener("error",this._sourceError);e.addEventListener("loadeddata",this._vLoadeddata)}}},{key:"_detachSourceEvents",value:function(e){var t=e.children;if(t&&t.length!==0&&this._sourceError){for(var r=0;r<t.length;r++)t[r].removeEventListener("error",this._sourceError);for(;t.length>0;)e.removeChild(t[0]);this._vLoadeddata&&e.removeEventListener("loadeddata",this._vLoadeddata)}}},{key:"errorHandler",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.media&&(this.media.error||t)){var r=this.media.error||t,o=r.code?cu[r.code]:"other";r.message,this.media.currentSrc||(r={code:6,message:"empty_src"}),this.emit(e,new nn(this,{errorType:o,errorCode:r.code,errorMessage:r.message||"",mediaError:r}))}}},{key:"destroy",value:function(){for(var e in this.media&&(this.media.pause&&(this.media.pause(),this.media.muted=!0),this.media.removeAttribute("src"),this.media.load()),this._currentTime=0,this._duration=0,this.mediaConfig=null,this._interval)Object.prototype.hasOwnProperty.call(this._interval,e)&&(clearInterval(this._interval[e]),this._interval[e]=null);this.detachVideoEvents(),this.media=null,this.mediaEventMiddleware={},this.removeAllListeners()}},{key:"video",get:function(){return this.media},set:function(e){this.media=e}},{key:"play",value:function(){return this.media?this.media.play():null}},{key:"pause",value:function(){this.media&&this.media.pause()}},{key:"load",value:function(){this.media&&this.media.load()}},{key:"canPlayType",value:function(e){return!!this.media&&this.media.canPlayType(e)}},{key:"getBufferedRange",value:function(e){var t=[0,0];if(!this.media)return t;e||(e=this.media.buffered);var r=this.media.currentTime;if(e)for(var o=0,s=e.length;o<s&&(t[0]=e.start(o),t[1]=e.end(o),!(t[0]<=r&&r<=t[1]));o++);return t[0]-r<=0&&r-t[1]<=0?t:[0,0]}},{key:"autoplay",get:function(){return!!this.media&&this.media.autoplay},set:function(e){this.media&&(this.media.autoplay=e)}},{key:"buffered",get:function(){return this.media?this.media.buffered:null}},{key:"buffered2",get:function(){return this.media&&this.media.buffered?g.getBuffered2(this.media.buffered):null}},{key:"bufferedPoint",get:function(){var e={start:0,end:0};if(!this.media)return e;var t=this.media.buffered;if(!t||t.length===0)return e;for(var r=0;r<t.length;r++)if((t.start(r)<=this.currentTime||t.start(r)<.1)&&t.end(r)>=this.currentTime)return{start:t.start(r),end:t.end(r)};return e}},{key:"crossOrigin",get:function(){return this.media?this.media.crossOrigin:""},set:function(e){this.media&&(this.media.crossOrigin=e)}},{key:"currentSrc",get:function(){return this.media?this.media.currentSrc:""},set:function(e){this.media&&(this.media.currentSrc=e)}},{key:"currentTime",get:function(){return this.media?this.media.currentTime!==void 0?this.media.currentTime:this._currentTime:0},set:function(e){this.media&&(this.media.currentTime=e)}},{key:"defaultMuted",get:function(){return!!this.media&&this.media.defaultMuted},set:function(e){this.media&&(this.media.defaultMuted=e)}},{key:"duration",get:function(){return this._duration}},{key:"ended",get:function(){return!!this.media&&this.media.ended}},{key:"error",get:function(){return this.media.error}},{key:"errorNote",get:function(){return this.media.error?["MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED"][this.media.error.code-1]:""}},{key:"loop",get:function(){return!!this.media&&this.media.loop},set:function(e){this.media&&(this.media.loop=e)}},{key:"muted",get:function(){return!!this.media&&this.media.muted},set:function(e){this.media&&this.media.muted!==e&&(this._lastMuted=this.media.muted,this.media.muted=e)}},{key:"networkState",get:function(){return this.media.networkState}},{key:"paused",get:function(){return!this.media||this.media.paused}},{key:"playbackRate",get:function(){return this.media?this.media.playbackRate:0},set:function(e){this.media&&e!==1/0&&(this.media.defaultPlaybackRate=e,this.media.playbackRate=e)}},{key:"played",get:function(){return this.media?this.media.played:null}},{key:"preload",get:function(){return!!this.media&&this.media.preload},set:function(e){this.media&&(this.media.preload=e)}},{key:"readyState",get:function(){return this.media.readyState}},{key:"seekable",get:function(){return!!this.media&&this.media.seekable}},{key:"seeking",get:function(){return!!this.media&&this.media.seeking}},{key:"src",get:function(){return this.media?this.media.src:""},set:function(e){this.media&&(this.emit(Vn,e),this.emit(Gn),this._currentTime=0,this._duration=0,g.isMSE(this.media)?this.onWaiting():(this._detachSourceEvents(this.media),g.typeOf(e)==="Array"?this._attachSourceEvents(this.media,e):e?this.media.src=e:this.media.removeAttribute("src"),this.load()))}},{key:"volume",get:function(){return this.media?this.media.volume:0},set:function(e){e!==1/0&&this.media&&(this.media.volume=e)}},{key:"aspectRatio",get:function(){return this.media?this.media.videoWidth/this.media.videoHeight:0}},{key:"addInnerOP",value:function(e){this._internalOp[e]=!0}},{key:"removeInnerOP",value:function(e){delete this._internalOp[e]}},{key:"emit",value:function(e,t){for(var r,o=arguments.length,s=new Array(o>2?o-2:0),a=2;a<o;a++)s[a-2]=arguments[a];(r=Ce(we(n.prototype),"emit",this)).call.apply(r,[this,e,t].concat(s))}},{key:"on",value:function(e,t){for(var r,o=arguments.length,s=new Array(o>2?o-2:0),a=2;a<o;a++)s[a-2]=arguments[a];(r=Ce(we(n.prototype),"on",this)).call.apply(r,[this,e,t].concat(s))}},{key:"once",value:function(e,t){for(var r,o=arguments.length,s=new Array(o>2?o-2:0),a=2;a<o;a++)s[a-2]=arguments[a];(r=Ce(we(n.prototype),"once",this)).call.apply(r,[this,e,t].concat(s))}},{key:"off",value:function(e,t){for(var r,o=arguments.length,s=new Array(o>2?o-2:0),a=2;a<o;a++)s[a-2]=arguments[a];(r=Ce(we(n.prototype),"off",this)).call.apply(r,[this,e,t].concat(s))}},{key:"offAll",value:function(){Ce(we(n.prototype),"removeAllListeners",this).call(this)}}]),n}(),Wf=function(){function i(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{name:"xgplayer",version:1,db:null,ojstore:{name:"xg-m4a",keypath:"vid"}};fe(this,i),this.indexedDB=window.indexedDB||window.webkitindexedDB,this.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange,this.myDB=n}return pe(i,[{key:"openDB",value:function(n){var e=this,t=this,r=this.myDB.version||1,o=t.indexedDB.open(t.myDB.name,r);o.onerror=function(s){},o.onsuccess=function(s){e.myDB.db=s.target.result,n.call(t)},o.onupgradeneeded=function(s){var a=s.target.result;s.target.transaction,a.objectStoreNames.contains(t.myDB.ojstore.name)||a.createObjectStore(t.myDB.ojstore.name,{keyPath:t.myDB.ojstore.keypath})}}},{key:"deletedb",value:function(){this.indexedDB.deleteDatabase(this.myDB.name)}},{key:"closeDB",value:function(){this.myDB.db.close()}},{key:"addData",value:function(n,e){for(var t,r=this.myDB.db.transaction(n,"readwrite").objectStore(n),o=0;o<e.length;o++)(t=r.add(e[o])).onerror=function(){},t.onsuccess=function(){}}},{key:"putData",value:function(n,e){for(var t,r=this.myDB.db.transaction(n,"readwrite").objectStore(n),o=0;o<e.length;o++)(t=r.put(e[o])).onerror=function(){},t.onsuccess=function(){}}},{key:"getDataByKey",value:function(n,e,t){var r=this,o=this.myDB.db.transaction(n,"readwrite").objectStore(n).get(e);o.onerror=function(){t.call(r,null)},o.onsuccess=function(s){var a=s.target.result;t.call(r,a)}}},{key:"deleteData",value:function(n,e){this.myDB.db.transaction(n,"readwrite").objectStore(n).delete(e)}},{key:"clearData",value:function(n){this.myDB.db.transaction(n,"readwrite").objectStore(n).clear()}}]),i}(),du=["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],fu=["requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen"],pu=["exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],Fn="data-xgplayerid";function ur(i,n,e){for(var t=arguments.length,r=new Array(t>3?t-3:0),o=3;o<t;o++)r[o-3]=arguments[o];var s=n.call.apply(n,[i].concat(r));e&&typeof e=="function"&&(s&&s.then?s.then(function(){for(var a=arguments.length,u=new Array(a),l=0;l<a;l++)u[l]=arguments[l];e.call.apply(e,[i].concat(u))}):e.call.apply(e,[i].concat(r)))}function zr(i,n){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{pre:null,next:null};return this.__hooks||(this.__hooks={}),!this.__hooks[i]&&(this.__hooks[i]=null),(function(){var t=arguments,r=this;if(e.pre)try{var o;(o=e.pre).call.apply(o,[this].concat(Array.prototype.slice.call(arguments)))}catch(u){throw u.message="[pluginName: ".concat(this.pluginName,":").concat(i,":pre error] >> ").concat(u.message),u}if(this.__hooks&&this.__hooks[i])try{var s,a=(s=this.__hooks[i]).call.apply(s,[this,this].concat(Array.prototype.slice.call(arguments)));a?a.then?a.then(function(u){u!==!1&&ur.apply(void 0,[r,n,e.next].concat(Bt(t)))}).catch(function(u){throw u}):ur.apply(void 0,[this,n,e.next].concat(Array.prototype.slice.call(arguments))):a===void 0&&ur.apply(void 0,[this,n,e.next].concat(Array.prototype.slice.call(arguments)))}catch(u){throw u.message="[pluginName: ".concat(this.pluginName,":").concat(i,"] >> ").concat(u.message),u}else ur.apply(void 0,[this,n,e.next].concat(Array.prototype.slice.call(arguments)))}).bind(this)}function Wr(i,n){var e=this.__hooks;if(e)return!!e.hasOwnProperty(i)&&(e&&(e[i]=n),!0)}function Gr(i,n){var e=this.__hooks;e&&delete e[i]}function gu(i){if(this.plugins&&this.plugins[i.toLowerCase()]){for(var n=this.plugins[i.toLowerCase()],e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return n.useHooks&&n.useHooks.apply(n,t)}}function mu(i){if(this.plugins&&this.plugins[i.toLowerCase()]){var n=this.plugins[i.toLowerCase()];if(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return n.removeHooks&&n.removeHooks.apply(n,t)}}}function ch(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];i.__hooks={},n&&n.map(function(e){i.__hooks[e]=null}),Object.defineProperty(i,"hooks",{get:function(){return i.__hooks&&Object.keys(i.__hooks).map(function(e){if(i.__hooks[e])return e})}})}function hh(i){i.__hooks=null}function rn(i,n,e){for(var t=arguments.length,r=new Array(t>3?t-3:0),o=3;o<t;o++)r[o-3]=arguments[o];if(!i.__hooks||!i.__hooks[n])return e.call.apply(e,[i,i].concat(r));var s,a=(s=i.__hooks[n]).call.apply(s,[i,i].concat(r));if(a&&a.then)a.then(function(u){return u===!1?null:e.call.apply(e,[i,i].concat(r))}).catch(function(u){});else if(a!==!1)return e.call.apply(e,[i,i].concat(r))}function Do(i,n){Re.logError("[".concat(i,"] event or callback cant be undefined or null when call ").concat(n))}var qt=function(){function i(n){fe(this,i),g.checkIsFunction(this.beforeCreate)&&this.beforeCreate(n),ch(this),this.__args=n,this.__events={},this.__onceEvents={},this.config=n.config||{},this.player=null,this.playerConfig={},this.pluginName="",this.__init(n)}return pe(i,[{key:"beforeCreate",value:function(n){}},{key:"afterCreate",value:function(){}},{key:"beforePlayerInit",value:function(){}},{key:"onPluginsReady",value:function(){}},{key:"afterPlayerInit",value:function(){}},{key:"destroy",value:function(){}},{key:"__init",value:function(n){this.player=n.player,this.playerConfig=n.player&&n.player.config,this.pluginName=n.pluginName?n.pluginName.toLowerCase():this.constructor.pluginName.toLowerCase(),this.logger=n.player&&n.player.logger}},{key:"updateLang",value:function(n){n||(n=this.lang)}},{key:"lang",get:function(){return this.player.lang}},{key:"i18n",get:function(){return this.player.i18n}},{key:"i18nKeys",get:function(){return this.player.i18nKeys}},{key:"domEventType",get:function(){var n=g.checkTouchSupport()?"touch":"mouse";return!this.playerConfig||this.playerConfig.domEventType!=="touch"&&this.playerConfig.domEventType!=="mouse"||(n=this.playerConfig.domEventType),n}},{key:"on",value:function(n,e){var t=this;n&&e&&this.player?typeof n=="string"?(this.__events[n]=e,this.player.on(n,e)):Array.isArray(n)&&n.forEach(function(r){t.__events[r]=e,t.player.on(r,e)}):Do(this.pluginName,"plugin.on(event, callback)")}},{key:"once",value:function(n,e){var t=this;n&&e&&this.player?typeof n=="string"?(this.__onceEvents[n]=e,this.player.once(n,e)):Array.isArray(n)&&n.forEach(function(r){t.__onceEvents[r]=e,t.player.once(n,e)}):Do(this.pluginName,"plugin.once(event, callback)")}},{key:"off",value:function(n,e){var t=this;n&&e&&this.player?typeof n=="string"?(delete this.__events[n],this.player.off(n,e)):Array.isArray(n)&&n.forEach(function(r){delete t.__events[n],t.player.off(r,e)}):Do(this.pluginName,"plugin.off(event, callback)")}},{key:"offAll",value:function(){var n=this;["__events","__onceEvents"].forEach(function(e){Object.keys(n[e]).forEach(function(t){n[e][t]&&n.off(t,n[e][t]),t&&delete n[e][t]})}),this.__events={},this.__onceEvents={}}},{key:"emit",value:function(n){var e;if(this.player){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];(e=this.player).emit.apply(e,[n].concat(r))}}},{key:"emitUserAction",value:function(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.player){var r=Ye(Ye({},t),{},{pluginName:this.pluginName});this.player.emitUserAction(n,e,r)}}},{key:"hook",value:function(n,e){return zr.call.apply(zr,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"useHooks",value:function(n,e){for(var t=arguments.length,r=new Array(t>2?t-2:0),o=2;o<t;o++)r[o-2]=arguments[o];return Wr.call.apply(Wr,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removeHooks",value:function(n,e){for(var t=arguments.length,r=new Array(t>2?t-2:0),o=2;o<t;o++)r[o-2]=arguments[o];return Gr.call.apply(Gr,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"registerPlugin",value:function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(this.player)return t&&(e.pluginName=t),this.player.registerPlugin({plugin:n,options:e})}},{key:"getPlugin",value:function(n){return this.player?this.player.getPlugin(n):null}},{key:"__destroy",value:function(){var n=this,e=this.player,t=this.pluginName;this.offAll(),g.clearAllTimers(this),g.checkIsFunction(this.destroy)&&this.destroy(),["player","playerConfig","pluginName","logger","__args","__hooks"].map(function(r){n[r]=null}),e.unRegisterPlugin(t),hh(this)}}],[{key:"defineGetterOrSetter",value:function(n,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&Object.defineProperty(n,t,e[t])}},{key:"defaultConfig",get:function(){return{}}},{key:"pluginName",get:function(){return"pluginName"}}]),i}();if(typeof Element<"u"&&!Element.prototype.matches){var ei=Element.prototype;ei.matches=ei.matchesSelector||ei.mozMatchesSelector||ei.msMatchesSelector||ei.oMatchesSelector||ei.webkitMatchesSelector}var Gf=function(i,n){for(;i&&i.nodeType!==9;){if(typeof i.matches=="function"&&i.matches(n))return i;i=i.parentNode}};function Mo(i,n,e,t,r){var o=Kf.apply(this,arguments);return i.addEventListener(e,o,r),{destroy:function(){i.removeEventListener(e,o,r)}}}function Kf(i,n,e,t){return function(r){r.delegateTarget=Gf(r.target,n),r.delegateTarget&&t.call(i,r)}}const vu=no(function(i,n,e,t,r){return typeof i.addEventListener=="function"?Mo.apply(null,arguments):typeof e=="function"?Mo.bind(null,document).apply(null,arguments):(typeof i=="string"&&(i=document.querySelectorAll(i)),Array.prototype.map.call(i,function(o){return Mo(o,n,e,t,r)}))});var qf={CONTROLS:"controls",ROOT:"root"},Ve={ROOT:"root",ROOT_LEFT:"rootLeft",ROOT_RIGHT:"rootRight",ROOT_TOP:"rootTop",CONTROLS_LEFT:"controlsLeft",CONTROLS_RIGTH:"controlsRight",CONTROLS_RIGHT:"controlsRight",CONTROLS_CENTER:"controlsCenter",CONTROLS:"controls"},yu="xg-icon-disable";function No(i){return!!i&&i.indexOf&&/^(?:http|data:|\/)/.test(i)}function _u(i,n){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"",o=null;if(i instanceof window.Element)return g.addClass(i,e),Object.keys(t).map(function(s){i.setAttribute(s,t[s])}),i;if(No(i)||No(i.url))return t.src=No(i)?i:i.url||"",o=g.createDom(i.tag||"img","",t,"xg-img ".concat(e));if(typeof i=="function")try{return(o=i())instanceof window.Element?(g.addClass(o,e),Object.keys(t).map(function(s){o.setAttribute(s,t[s])}),o):(Re.logWarn("warn>>icons.".concat(n," in config of plugin named [").concat(r,"] is a function mast return an Element Object")),null)}catch(s){return Re.logError("Plugin named [".concat(r,"]:createIcon"),s),null}return typeof i=="string"?g.createDomFromHtml(i,t,e):(Re.logWarn("warn>>icons.".concat(n," in config of plugin named [").concat(r,"] is invalid")),null)}function Yf(i,n){var e=n.config.icons||n.playerConfig.icons;Object.keys(i).map(function(t){var r=i[t],o=r&&r.class?r.class:"",s=r&&r.attr?r.attr:{},a=null;e&&e[t]&&(o=function(u,l){return pt(u)==="object"&&u.class&&typeof u.class=="string"?"".concat(l," ").concat(u.class):l}(e[t],o),s=function(u,l){return pt(u)==="object"&&u.attr&&pt(u.attr)==="object"&&Object.keys(u.attr).map(function(c){l[c]=u.attr[c]}),l}(e[t],s),a=_u(e[t],t,o,s,n.pluginName)),!a&&r&&(a=_u(r.icon?r.icon:r,s,o,{},n.pluginName)),n.icons[t]=a})}var Me=function(){ye(n,qt);var i=_e(n);function n(){var e,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return fe(this,n),(e=i.call(this,t)).__delegates=[],e}return pe(n,[{key:"__init",value:function(e){if(Ce(we(n.prototype),"__init",this).call(this,e),e.root){var t=e.root,r=null;this.icons={},this.root=null,this.parent=null,Yf(this.registerIcons()||{},this),this.langText={};var o,s,a=this.registerLanguageTexts()||{};o=a,s=this,Object.keys(o).map(function(h){Object.defineProperty(s.langText,h,{get:function(){var d=s.lang,f=s.i18n;return f[h]?f[h]:o[h]&&o[h][d]||""}})});var u="";try{u=this.render()}catch(h){throw Re.logError("Plugin:".concat(this.pluginName,":render"),h),new Error("Plugin:".concat(this.pluginName,":render:").concat(h.message))}if(u)(r=n.insert(u,t,e.index)).setAttribute("data-index",e.index);else{if(!e.tag)return;(r=g.createDom(e.tag,"",e.attr,e.name)).setAttribute("data-index",e.index),t.appendChild(r)}this.root=r,this.parent=t;var l=this.config.attr||{},c=this.config.style||{};this.setAttr(l),this.setStyle(c),this.config.index&&this.root.setAttribute("data-index",this.config.index),this.__registerChildren()}}},{key:"__registerChildren",value:function(){var e=this;if(this.root){this._children=[];var t=this.children();t&&pt(t)==="object"&&Object.keys(t).length>0&&Object.keys(t).map(function(r){var o,s,a=r,u=t[a],l={root:e.root};typeof u=="function"?(o=e.config[a]||{},s=u):pt(u)==="object"&&typeof u.plugin=="function"&&(o=u.options?g.deepCopy(e.config[a]||{},u.options):e.config[a]||{},s=u.plugin),l.config=o,o.index!==void 0&&(l.index=o.index),o.root&&(l.root=o.root),e.registerPlugin(s,l,a)})}}},{key:"updateLang",value:function(e){e||(e=this.lang);var t=this.root,r=this.i18n,o=this.langText;t&&function s(a,u){for(var l=0;l<a.children.length;l++)a.children[l].children.length>0?s(a.children[l],u):u(a.children[l])}(t,function(s){var a=s.getAttribute&&s.getAttribute("lang-key");if(a){var u=r[a.toUpperCase()]||o[a];u&&(s.innerHTML=typeof u=="function"?u(e):u)}})}},{key:"lang",get:function(){return this.player.lang}},{key:"changeLangTextKey",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r=this.i18n||{},o=this.langText;e.setAttribute&&e.setAttribute("lang-key",t);var s=r[t]||o[t]||"";s&&(e.innerHTML=s)}},{key:"plugins",value:function(){return this._children}},{key:"disable",value:function(){this.config.disable=!0,g.addClass(this.find(".xgplayer-icon"),yu)}},{key:"enable",value:function(){this.config.disable=!1,g.removeClass(this.find(".xgplayer-icon"),yu)}},{key:"children",value:function(){return{}}},{key:"registerPlugin",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";t.root=t.root||this.root;var o=Ce(we(n.prototype),"registerPlugin",this).call(this,e,t,r);return this._children.push(o),o}},{key:"registerIcons",value:function(){return{}}},{key:"registerLanguageTexts",value:function(){return{}}},{key:"find",value:function(e){if(this.root)return this.root.querySelector(e)}},{key:"bind",value:function(e,t,r){var o=this;if(arguments.length<3&&typeof t=="function")Array.isArray(e)?e.forEach(function(a){o.bindEL(a,t)}):this.bindEL(e,t);else{var s=n.delegate.call(this,this.root,e,t,r);this.__delegates=this.__delegates.concat(s)}}},{key:"unbind",value:function(e,t){var r=this;if(arguments.length<3&&typeof t=="function")Array.isArray(e)?e.forEach(function(a){r.unbindEL(a,t)}):this.unbindEL(e,t);else for(var o="".concat(e,"_").concat(t),s=0;s<this.__delegates.length;s++)if(this.__delegates[s].key===o){this.__delegates[s].destroy(),this.__delegates.splice(s,1);break}}},{key:"setStyle",value:function(e,t){var r=this;if(this.root)return g.typeOf(e)==="String"?this.root.style[e]=t:void(g.typeOf(e)==="Object"&&Object.keys(e).map(function(o){r.root.style[o]=e[o]}))}},{key:"setAttr",value:function(e,t){var r=this;if(this.root)return g.typeOf(e)==="String"?this.root.setAttribute(e,t):void(g.typeOf(e)==="Object"&&Object.keys(e).map(function(o){r.root.setAttribute(o,e[o])}))}},{key:"setHtml",value:function(e,t){this.root&&(this.root.innerHTML=e,typeof t=="function"&&t())}},{key:"bindEL",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0&&arguments[2];this.root&&"on".concat(e)in this.root&&typeof t=="function"&&this.root.addEventListener(e,t,r)}},{key:"unbindEL",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0&&arguments[2];this.root&&"on".concat(e)in this.root&&typeof t=="function"&&this.root.removeEventListener(e,t,r)}},{key:"show",value:function(e){if(this.root)return this.root.style.display=e!==void 0?e:"block",window.getComputedStyle(this.root,null).getPropertyValue("display")==="none"?this.root.style.display="block":void 0}},{key:"hide",value:function(){this.root&&(this.root.style.display="none")}},{key:"appendChild",value:function(e,t){if(!this.root)return null;if(arguments.length<2&&arguments[0]instanceof window.Element)return this.root.appendChild(arguments[0]);if(!(t&&t instanceof window.Element))return null;try{return typeof e=="string"?this.find(e).appendChild(t):e.appendChild(t)}catch(r){return Re.logError("Plugin:appendChild",r),null}}},{key:"render",value:function(){return""}},{key:"destroy",value:function(){}},{key:"__destroy",value:function(){var e=this,t=this.player;this.__delegates.map(function(r){r.destroy()}),this.__delegates=[],this._children instanceof Array&&(this._children.map(function(r){t.unRegisterPlugin(r.pluginName)}),this._children=null),this.root&&(this.root.hasOwnProperty("remove")?this.root.remove():this.root.parentNode&&this.root.parentNode.removeChild(this.root)),Ce(we(n.prototype),"__destroy",this).call(this),this.icons={},["root","parent"].map(function(r){e[r]=null})}}],[{key:"insert",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=t.children.length,s=Number(r),a=e instanceof window.Node;if(o){for(var u=0,l=null,c="";u<o;u++){l=t.children[u];var h=Number(l.getAttribute("data-index"));if(h>=s){c="beforebegin";break}h<s&&(c="afterend")}return a?c==="afterend"?t.appendChild(e):t.insertBefore(e,l):l.insertAdjacentHTML(c,e),c==="afterend"?t.children[t.children.length-1]:t.children[u]}return a?t.appendChild(e):t.insertAdjacentHTML("beforeend",e),t.children[t.children.length-1]}},{key:"defaultConfig",get:function(){return{}}},{key:"delegate",value:function(e,t,r,o){var s=arguments.length>4&&arguments[4]!==void 0&&arguments[4],a=[];if(e instanceof window.Node&&typeof o=="function")if(Array.isArray(r))r.forEach(function(l){var c=vu(e,t,l,o,s);c.key="".concat(t,"_").concat(l),a.push(c)});else{var u=vu(e,t,r,o,s);u.key="".concat(t,"_").concat(r),a.push(u)}return a}},{key:"ROOT_TYPES",get:function(){return qf}},{key:"POSITIONS",get:function(){return Ve}}]),n}(),$f=function(){function i(){var n=this;if(fe(this,i),j(this,"__trigger",function(e){var t=new Date().getTime();n.timeStamp=t;for(var r=0;r<e.length;r++)n.__runHandler(e[r].target)}),this.__handlers=[],this.timeStamp=0,this.observer=null,window.ResizeObserver)try{this.observer=new window.ResizeObserver(function(e,t,r){var o=!0,s=!0;if(typeof e!="function")throw new TypeError("Expected a function");return Kc(r)&&(o="leading"in r?!!r.leading:o,s="trailing"in r?!!r.trailing:s),Bf(e,t,{leading:o,trailing:s,maxWait:t})}(this.__trigger,100,{trailing:!0})),this.timeStamp=new Date().getTime()}catch{}}return pe(i,[{key:"addObserver",value:function(n,e){if(this.observer){this.observer&&this.observer.observe(n);for(var t=n.getAttribute(Fn),r=this.__handlers,o=-1,s=0;s<r.length;s++)r[s]&&n===r[s].target&&(o=s);o>-1?this.__handlers[o].handler=e:this.__handlers.push({target:n,handler:e,playerId:t})}}},{key:"unObserver",value:function(n){var e=-1;this.__handlers.map(function(t,r){n===t.target&&(e=r)});try{this.observer&&this.observer.unobserve(n)}catch{}this.observer&&this.observer.unobserve(n),e>-1&&this.__handlers.splice(e,1)}},{key:"destroyObserver",value:function(){this.observer&&this.observer.disconnect(),this.observer=null,this.__handlers=null}},{key:"__runHandler",value:function(n){for(var e=this.__handlers,t=0;t<e.length;t++)if(e[t]&&n===e[t].target){try{e[t].handler(n)}catch{}return!0}return!1}}]),i}(),lr=null,tt={pluginGroup:{},init:function(i){var n,e,t=i._pluginInfoId;t||(t=new Date().getTime(),i._pluginInfoId=t),!i.config.closeResizeObserver&&(n=i.root,e=function(){i.resize()},lr||(lr=new $f),lr.addObserver(n,e)),this.pluginGroup[t]={_originalOptions:i.config||{},_plugins:{}}},formatPluginInfo:function(i,n){var e=null,t=null;return i.plugin&&typeof i.plugin=="function"?(e=i.plugin,t=i.options):(e=i,t={}),n&&(t.config=n||{}),{PLUFGIN:e,options:t}},checkPluginIfExits:function(i,n){for(var e=0;e<n.length;e++)if(i.toLowerCase()===n[e].pluginName.toLowerCase())return!0;return!1},getRootByConfig:function(i,n){for(var e=Object.keys(n),t=null,r=0;r<e.length;r++)if(i.toLowerCase()===e[r].toLowerCase()){t=n[e[r]];break}return g.typeOf(t)==="Object"?{root:t.root,position:t.position}:{}},lazyRegister:function(i,n){var e=this,t=n.timeout||1500;return Promise.race([n.loader().then(function(r){var o;o=r&&r.__esModule?r.default:r,e.register(i,o,r.options)}),new Promise(function(r,o){setTimeout(function(){o(new Error("timeout"))},t)})])},register:function(i,n){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(i&&n&&typeof n=="function"&&n.prototype!==void 0){var t=i._pluginInfoId;if(t&&this.pluginGroup[t]){this.pluginGroup[t]._plugins||(this.pluginGroup[t]._plugins={});var r=this.pluginGroup[t]._plugins,o=this.pluginGroup[t]._originalOptions;e.player=i;var s=e.pluginName||n.pluginName;if(!s)throw new Error("The property pluginName is necessary");if(!n.isSupported||n.isSupported(i.config.mediaType,i.config.codecType)){e.config||(e.config={});for(var a=Object.keys(o),u=0;u<a.length;u++)if(s.toLowerCase()===a[u].toLowerCase()){var l=o[a[u]];g.typeOf(l)==="Object"?e.config=Object.assign({},e.config,o[a[u]]):g.typeOf(l)==="Boolean"&&(e.config.disable=!l);break}n.defaultConfig&&Object.keys(n.defaultConfig).forEach(function(h){e.config[h]===void 0&&(e.config[h]=n.defaultConfig[h])}),e.root?typeof e.root=="string"&&(e.root=i[e.root]):e.root=i.root,e.index=e.config.index||0;try{r[s.toLowerCase()]&&this.unRegister(t,s.toLowerCase());var c=new n(e);return r[s.toLowerCase()]=c,r[s.toLowerCase()].func=n,c&&typeof c.afterCreate=="function"&&c.afterCreate(),c}catch(h){throw h}}}}},unRegister:function(i,n){i._pluginInfoId&&(i=i._pluginInfoId),n=n.toLowerCase();try{var e=this.pluginGroup[i]._plugins[n];e&&(e.pluginName&&e.__destroy(),delete this.pluginGroup[i]._plugins[n])}catch{}},deletePlugin:function(i,n){var e=i._pluginInfoId;e&&this.pluginGroup[e]&&this.pluginGroup[e]._plugins&&delete this.pluginGroup[e]._plugins[n]},getPlugins:function(i){var n=i._pluginInfoId;return n&&this.pluginGroup[n]?this.pluginGroup[n]._plugins:{}},findPlugin:function(i,n){var e=i._pluginInfoId;if(!e||!this.pluginGroup[e])return null;var t=n.toLowerCase();return this.pluginGroup[e]._plugins[t]},beforeInit:function(i){var n=this;function e(t){return t&&t.then?t:new Promise(function(r){r()})}return new Promise(function(t){if(n.pluginGroup)return(i._loadingPlugins&&i._loadingPlugins.length?Promise.all(i._loadingPlugins):Promise.resolve()).then(function(){var r=i._pluginInfoId;if(n.pluginGroup[r]){var o=n.pluginGroup[r]._plugins,s=[];Object.keys(o).forEach(function(a){if(o[a]&&o[a].beforePlayerInit)try{var u=o[a].beforePlayerInit();s.push(e(u))}catch(l){throw s.push(e(null)),l}}),Promise.all([].concat(s)).then(function(){t()}).catch(function(a){t()})}else t()})})},afterInit:function(i){var n=i._pluginInfoId;if(n&&this.pluginGroup[n]){var e=this.pluginGroup[n]._plugins;Object.keys(e).forEach(function(t){e[t]&&e[t].afterPlayerInit&&e[t].afterPlayerInit()})}},setLang:function(i,n){var e=n._pluginInfoId;if(e&&this.pluginGroup[e]){var t=this.pluginGroup[e]._plugins;Object.keys(t).forEach(function(r){if(t[r].updateLang)t[r].updateLang(i);else try{t[r].lang=i}catch{}})}},reRender:function(i){var n=this,e=i._pluginInfoId;if(e&&this.pluginGroup[e]){var t=[],r=this.pluginGroup[e]._plugins;Object.keys(r).forEach(function(o){o!=="controls"&&r[o]&&(t.push({plugin:r[o].func,options:r[o].__args}),n.unRegister(e,o))}),t.forEach(function(o){n.register(i,o.plugin,o.options)})}},onPluginsReady:function(i){var n=i._pluginInfoId;if(n&&this.pluginGroup[n]){var e=this.pluginGroup[n]._plugins||{};Object.keys(e).forEach(function(t){e[t].onPluginsReady&&typeof e[t].onPluginsReady=="function"&&e[t].onPluginsReady()})}},destroy:function(i){var n=i._pluginInfoId;if(this.pluginGroup[n]){var e,t;e=i.root,lr.unObserver(e,t);for(var r=this.pluginGroup[n]._plugins,o=0,s=Object.keys(r);o<s.length;o++){var a=s[o];this.unRegister(n,a)}delete this.pluginGroup[n],delete i._pluginInfoId}}},$={DEFAULT:"xgplayer",DEFAULT_SKIN:"xgplayer-skin-default",ENTER:"xgplayer-is-enter",PAUSED:"xgplayer-pause",PLAYING:"xgplayer-playing",ENDED:"xgplayer-ended",CANPLAY:"xgplayer-canplay",LOADING:"xgplayer-isloading",ERROR:"xgplayer-is-error",REPLAY:"xgplayer-replay",NO_START:"xgplayer-nostart",ACTIVE:"xgplayer-active",INACTIVE:"xgplayer-inactive",FULLSCREEN:"xgplayer-is-fullscreen",CSS_FULLSCREEN:"xgplayer-is-cssfullscreen",ROTATE_FULLSCREEN:"xgplayer-rotate-fullscreen",PARENT_ROTATE_FULLSCREEN:"xgplayer-rotate-parent",PARENT_FULLSCREEN:"xgplayer-fullscreen-parent",INNER_FULLSCREEN:"xgplayer-fullscreen-inner",NO_CONTROLS:"no-controls",FLEX_CONTROLS:"flex-controls",CONTROLS_FOLLOW:"controls-follow",CONTROLS_AUTOHIDE:"controls-autohide",TOP_BAR_AUTOHIDE:"top-bar-autohide",NOT_ALLOW_AUTOPLAY:"not-allow-autoplay",SEEKING:"seeking",PC:"xgplayer-pc",MOBILE:"xgplayer-mobile",MINI:"xgplayer-mini"};function bu(){return{id:"",el:null,url:"",domEventType:"default",nullUrlStart:!1,width:600,height:337.5,fluid:!1,fitVideoSize:"fixed",videoFillMode:"auto",volume:.6,autoplay:!1,autoplayMuted:!1,loop:!1,isLive:!1,zoom:1,videoInit:!0,poster:"",isMobileSimulateMode:!1,defaultPlaybackRate:1,execBeforePluginsCall:null,allowSeekAfterEnded:!0,enableContextmenu:!0,closeVideoClick:!1,closeVideoDblclick:!1,closePlayerBlur:!1,closeDelayBlur:!1,leavePlayerTime:3e3,closePlayVideoFocus:!1,closePauseVideoFocus:!1,closeFocusVideoFocus:!0,closeControlsBlur:!0,topBarAutoHide:!0,videoAttributes:{},startTime:0,seekedStatus:"play",miniprogress:!1,disableSwipeHandler:function(){},enableSwipeHandler:function(){},preProcessUrl:null,ignores:[],whitelist:[],inactive:3e3,lang:(i=(document.documentElement.getAttribute("lang")||navigator.language||"zh-cn").toLocaleLowerCase(),i==="zh-cn"&&(i="zh"),i),controls:!0,marginControls:!1,fullscreenTarget:null,screenShot:!1,rotate:!1,pip:!1,download:!1,mini:!1,cssFullscreen:!0,keyShortcut:!0,presets:[],plugins:[],playbackRate:1,definition:{list:[]},playsinline:!0,customDuration:0,timeOffset:0,icons:{},i18n:[],tabindex:0,thumbnail:null,videoConfig:{},isHideTips:!1,minWaitDelay:200,commonStyle:{progressColor:"",playedColor:"",cachedColor:"",sliderBtnStyle:{},volumeColor:""}};var i}var Xf=function(){ye(n,Me);var i=_e(n);function n(){var e;fe(this,n);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return j(O(e=i.call.apply(i,[this].concat(r))),"onMouseEnter",function(s){var a=O(e),u=a.player;a.playerConfig.closeControlsBlur&&u.focus({autoHide:!1})}),j(O(e),"onMouseLeave",function(s){O(e).player.focus()}),e}return pe(n,[{key:"beforeCreate",value:function(e){e.config.mode||Pe.device!=="mobile"||(e.config.mode="flex"),e.player.config.marginControls&&(e.config.autoHide=!1)}},{key:"afterCreate",value:function(){var e=this,t=this.config,r=t.disable,o=t.height,s=t.mode;if(!r){s==="flex"&&this.player.addClass($.FLEX_CONTROLS);var a={height:"".concat(o,"px")};Object.keys(a).map(function(l){e.root.style[l]=a[l]}),this.left=this.find("xg-left-grid"),this.center=this.find("xg-center-grid"),this.right=this.find("xg-right-grid"),this.innerRoot=this.find("xg-inner-controls"),this.on(Ur,function(l){l?g.addClass(e.root,"mini-controls"):g.removeClass(e.root,"mini-controls")});var u=this.playerConfig.isMobileSimulateMode;Pe.device!=="mobile"&&u!=="mobile"&&(this.bind("mouseenter",this.onMouseEnter),this.bind("mouseleave",this.onMouseLeave))}}},{key:"focus",value:function(){this.player.focus({autoHide:!1})}},{key:"focusAwhile",value:function(){this.player.focus({autoHide:!0})}},{key:"blur",value:function(){this.player.blur({ignorePaused:!0})}},{key:"recoverAutoHide",value:function(){this.config.autoHide&&g.addClass(this.root,$.CONTROLS_AUTOHIDE)}},{key:"pauseAutoHide",value:function(){g.removeClass(this.root,$.CONTROLS_AUTOHIDE)}},{key:"show",value:function(e){this.root.style.display="",this.player.focus()}},{key:"hide",value:function(){this.root.style.display="none"}},{key:"mode",get:function(){return this.config.mode}},{key:"registerPlugin",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;if(this.root){var o=e.defaultConfig||{};if(!t.root){switch(t.position?t.position:t.config&&t.config.position?t.config.position:o.position){case Ve.CONTROLS_LEFT:t.root=this.left;break;case Ve.CONTROLS_RIGHT:t.root=this.right;break;case Ve.CONTROLS_CENTER:t.root=this.center;break;case Ve.CONTROLS:t.root=this.root;break;default:t.root=this.left}return Ce(we(n.prototype),"registerPlugin",this).call(this,e,t,r)}}}},{key:"destroy",value:function(){Pe.device!=="mobile"&&(this.unbind("mouseenter",this.onMouseEnter),this.unbind("mouseleave",this.onMouseLeave))}},{key:"render",value:function(){var e=this.config,t=e.mode,r=e.autoHide,o=e.initShow;if(!e.disable){var s=g.classNames({"xgplayer-controls":!0},{"flex-controls":t==="flex"},{"bottom-controls":t==="bottom"},j({},$.CONTROLS_AUTOHIDE,r),{"xgplayer-controls-initshow":o||!r});return'<xg-controls class="'.concat(s,`" unselectable="on">
    <xg-inner-controls class="xg-inner-controls xg-pos">
      <xg-left-grid class="xg-left-grid">
      </xg-left-grid>
      <xg-center-grid class="xg-center-grid"></xg-center-grid>
      <xg-right-grid class="xg-right-grid">
      </xg-right-grid>
    </xg-inner-controls>
    </xg-controls>`)}}}],[{key:"pluginName",get:function(){return"controls"}},{key:"defaultConfig",get:function(){return{disable:!1,autoHide:!0,mode:"",initShow:!1}}}]),n}(),_t={lang:{},langKeys:[],textKeys:[]};function Hi(i,n){return Object.keys(n).forEach(function(e){var t,r=g.typeOf(n[e]),o=g.typeOf(i[e]);r==="Array"?(o!=="Array"&&(i[e]=[]),(t=i[e]).push.apply(t,Bt(n[e]))):r==="Object"?(o!=="Object"&&(i[e]={}),Hi(i[e],n[e])):i[e]=n[e]}),i}function dh(){Object.keys(_t.lang.en).map(function(i){_t.textKeys[i]=i})}function gs(i,n){var e=i.LANG;if(n||(n=_t),n.lang){var t=i.TEXT||{};e==="zh"&&(e="zh-cn"),n.lang[e]?Hi(n.lang[e],t):(n.langKeys.push(e),n.lang[e]=t),dh()}}gs({LANG:"en",TEXT:{ERROR_TYPES:{network:{code:1,msg:"video download error"},mse:{code:2,msg:"stream append error"},parse:{code:3,msg:"parsing error"},format:{code:4,msg:"wrong format"},decoder:{code:5,msg:"decoding error"},runtime:{code:6,msg:"grammatical errors"},timeout:{code:7,msg:"play timeout"},other:{code:8,msg:"other errors"}},HAVE_NOTHING:"There is no information on whether audio/video is ready",HAVE_METADATA:"Audio/video metadata is ready ",HAVE_CURRENT_DATA:"Data about the current play location is available, but there is not enough data to play the next frame/millisecond",HAVE_FUTURE_DATA:"Current and at least one frame of data is available",HAVE_ENOUGH_DATA:"The available data is sufficient to start playing",NETWORK_EMPTY:"Audio/video has not been initialized",NETWORK_IDLE:"Audio/video is active and has been selected for resources, but no network is used",NETWORK_LOADING:"The browser is downloading the data",NETWORK_NO_SOURCE:"No audio/video source was found",MEDIA_ERR_ABORTED:"The fetch process is aborted by the user",MEDIA_ERR_NETWORK:"An error occurred while downloading",MEDIA_ERR_DECODE:"An error occurred while decoding",MEDIA_ERR_SRC_NOT_SUPPORTED:"Audio/video is not supported",REPLAY:"Replay",ERROR:"Network is offline",PLAY_TIPS:"Play",PAUSE_TIPS:"Pause",PLAYNEXT_TIPS:"Play next",DOWNLOAD_TIPS:"Download",ROTATE_TIPS:"Rotate",RELOAD_TIPS:"Reload",FULLSCREEN_TIPS:"Fullscreen",EXITFULLSCREEN_TIPS:"Exit fullscreen",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"Exit cssfullscreen",TEXTTRACK:"Caption",PIP:"PIP",SCREENSHOT:"Screenshot",LIVE:"LIVE",OFF:"Off",OPEN:"Open",MINI_DRAG:"Click and hold to drag",MINISCREEN:"Miniscreen",REFRESH_TIPS:"Please Try",REFRESH:"Refresh",FORWARD:"forward",LIVE_TIP:"Live"}});var Vi={get textKeys(){return _t.textKeys},get langKeys(){return _t.langKeys},get lang(){var i={};return _t.langKeys.map(function(n){i[n]=_t.lang[n]}),_t.lang["zh-cn"]&&(i.zh=_t.lang["zh-cn"]||{}),i},extend:function(i,n){var e=[];if(n||(n=_t),n.lang){e=g.typeOf(i)!=="Array"?Object.keys(i).map(function(r){return{LANG:r==="zh"?"zh-cn":r,TEXT:i[r]}}):i;var t=n.lang;e.map(function(r){r.LANG==="zh"&&(r.LANG="zh-cn"),t[r.LANG]?Hi(t[r.LANG]||{},r.TEXT||{}):gs(r,n)}),dh()}},use:gs,init:function(i){var n,e={lang:{},langKeys:[],textKeys:{},pId:i};return Hi(e.lang,_t.lang),(n=e.langKeys).push.apply(n,Bt(_t.langKeys)),Hi(e.textKeys,_t.textKeys),e}},Jf=1,ms=2,ku=3,si=4,Zf=5,it=6,Fo=7,wu=["ERROR","INITIAL","READY","ATTACHING","ATTACHED","NOTALLOW","RUNNING","ENDED","DESTROYED"],dt={},Bo=null,fh=function(){ye(n,Gc.EventEmitter);var i=_e(n);function n(){return fe(this,n),i.apply(this,arguments)}return pe(n,[{key:"add",value:function(e){e&&(dt[e.playerId]=e,Object.keys(dt).length===1&&this.setActive(e.playerId,!0))}},{key:"remove",value:function(e){e&&(e.isUserActive,delete dt[e.playerId])}},{key:"_iterate",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];for(var r in dt)if(Object.prototype.hasOwnProperty.call(dt,r)){var o=dt[r];if(t){if(e(o))break}else e(o)}}},{key:"forEach",value:function(e){this._iterate(e)}},{key:"find",value:function(e){var t=null;return this._iterate(function(r){var o=e(r);return o&&(t=r),o},!0),t}},{key:"findAll",value:function(e){var t=[];return this._iterate(function(r){e(r)&&t.push(r)}),t}},{key:"setActive",value:function(e){var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(dt[e])return t?this.forEach(function(r){e===r.playerId?(r.isUserActive=!0,r.isInstNext=!1):r.isUserActive=!1}):dt[e].isUserActive=t,e}},{key:"getActiveId",value:function(){for(var e=Object.keys(dt),t=0;t<e.length;t++){var r=dt[e[t]];if(r&&r.isUserActive)return e[t]}return null}},{key:"setNext",value:function(e){var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(dt[e])return t?this.forEach(function(r){e===r.playerId?(r.isUserActive=!1,r.isInstNext=!0):r.isInstNext=!1}):dt[e].isInstNext=t,e}}],[{key:"getInstance",value:function(){return Bo||(Bo=new n),Bo}}]),n}(),Qf=["play","pause","replay","retry"],Tu=0,xu=0,vn=null,wr=function(){ye(n,zf);var i=_e(n);function n(e){var t;fe(this,n);var r,o=g.deepMerge(bu(),e);j(O(t=i.call(this,o)),"canPlayFunc",function(){if(t.config){var d=t.config,f=d.autoplay,p=d.defaultPlaybackRate;Re.logInfo("player","canPlayFunc, startTime",t.__startTime),t.__startTime>0&&t.duration>0&&(t.currentTime=t.__startTime>t.duration?t.duration:t.__startTime,t.__startTime=-1),t.playbackRate=p,(f||t._useAutoplay)&&t.mediaPlay(),t.off(on,t.canPlayFunc),t.removeClass($.ENTER)}}),j(O(t),"onFullscreenChange",function(d,f){var p=function(){g.setTimeout(O(t),function(){t.resize()},100)},m=g.getFullScreenEl();t._fullActionFrom?t._fullActionFrom="":t.emit(Vr,{eventType:"system",action:"switch_fullscreen",pluginName:"player",currentTime:t.currentTime,duration:t.duration,props:[{prop:"fullscreen",from:!0,to:!1}]});var v=function(S,C,E){if(S){var R=S.getAttribute(E);return!(!R||R!==C||S.tagName!=="VIDEO"&&S.tagName!=="AUDIO")}}(m,t.playerId,Fn);if(f||m&&(m===t._fullscreenEl||v))p(),!t.config.closeFocusVideoFocus&&t.media.focus(),t.fullscreen=!0,t.changeFullStyle(t.root,m,$.FULLSCREEN),t.emit(Zt,!0,t._fullScreenOffset),t.cssfullscreen&&t.exitCssFullscreen();else if(t.fullscreen){p();var y=O(t),w=y._fullScreenOffset;y.config.needFullscreenScroll?(window.scrollTo(w.left,w.top),g.setTimeout(O(t),function(){t.fullscreen=!1,t._fullScreenOffset=null},100)):(!t.config.closeFocusVideoFocus&&t.media.focus(),t.fullscreen=!1,t._fullScreenOffset=null),t.cssfullscreen?t.removeClass($.FULLSCREEN):t.recoverFullStyle(t.root,t._fullscreenEl,$.FULLSCREEN),t._fullscreenEl=null,t.emit(Zt,!1)}}),j(O(t),"_onWebkitbeginfullscreen",function(d){t._fullscreenEl=t.media,t.onFullscreenChange(d,!0)}),j(O(t),"_onWebkitendfullscreen",function(d){t.onFullscreenChange(d,!1)}),ch(O(t),Qf),t.config=o,t._pluginInfoId=g.generateSessionId(),(r=O(t)).logInfo=Re.logInfo.bind(r),r.logWarn=Re.logWarn.bind(r),r.logError=Re.logError.bind(r);var s=t.constructor.defaultPreset;if(t.config.presets.length){var a=t.config.presets.indexOf("default");a>=0&&s&&(t.config.presets[a]=s)}else s&&t.config.presets.push(s);if(t.userTimer=null,t.waitTimer=null,t.handleSource=!0,t._state=Jf,t.isError=!1,t._hasStart=!1,t.isSeeking=!1,t.isCanplay=!1,t._useAutoplay=!1,t.__startTime=-1,t.rotateDeg=0,t.isActive=!1,t.fullscreen=!1,t.cssfullscreen=!1,t.isRotateFullscreen=!1,t._fullscreenEl=null,t.timeSegments=[],t._cssfullscreenEl=null,t.curDefinition=null,t._orgCss="",t._fullScreenOffset=null,t._videoHeight=0,t._videoWidth=0,t.videoPos={pi:1,scale:0,rotate:-1,x:0,y:0,h:-1,w:-1,vy:0,vx:0},t.sizeInfo={width:0,height:0,left:0,top:0},t._accPlayed={t:0,acc:0,loopAcc:0},t._offsetInfo={currentTime:-1,duration:0},t.innerContainer=null,t.controls=null,t.topBar=null,t.root=null,t.__i18n=Vi.init(t._pluginInfoId),Pe.os.isAndroid&&Pe.osVersion>0&&Pe.osVersion<6&&(t.config.autoplay=!1),t.database=new Wf,t.isUserActive=!1,t._onceSeekCanplay=null,t._isPauseBeforeSeek=0,t.innerStates={isActiveLocked:!1},t.instManager=vn,!t._initDOM())return Ys(t);var u=t.config,l=u.definition,c=l===void 0?{}:l;if(!u.url&&c.list&&c.list.length>0){var h=c.list.find(function(d){return d.definition&&d.definition===c.defaultDefinition});h||(c.defaultDefinition=c.list[0].definition,h=c.list[0]),t.config.url=h.url,t.curDefinition=h}return t._bindEvents(),t._registerPresets(),t._registerPlugins(),tt.onPluginsReady(O(t)),t.getInitDefinition(),t.setState(ms),g.setTimeout(O(t),function(){t.emit(Zs)},0),t.onReady&&t.onReady(),(t.config.videoInit||t.config.autoplay)&&(!t.hasStart||t.state<si)&&t.start(),t}return pe(n,[{key:"_initDOM",value:function(){var e,t=this;if(this.root=this.config.id?document.getElementById(this.config.id):null,!this.root){var r=this.config.el;if(!r||r.nodeType!==1)return this.emit(Qi,new nn("use",this.config.vid,{line:32,handle:"Constructor",msg:"container id can't be empty"})),!1;this.root=r}var o=function(E){for(var R=Object.keys(dt),W=0;W<R.length;W++){var J=dt[R[W]];if(J.root===E)return J}return null}(this.root);o&&(Re.logWarn("The is an Player instance already exists in this.root, destroy it and reinitialize"),o.destroy()),this.root.setAttribute(Fn,this.playerId),(e=vn)===null||e===void 0||e.add(this),tt.init(this),this._initBaseDoms();var s=this.constructor.XgVideoProxy;if(s&&this.mediaConfig.mediaType===s.mediaType){var a=this.innerContainer||this.root;this.detachVideoEvents(this.media);var u=new s(a,this.config,this.mediaConfig);this.attachVideoEvents(u),this.media=u}if(this.media.setAttribute(Fn,this.playerId),this.config.controls){var l=this.config.controls.root||null,c=tt.register(this,Xf,{root:l});this.controls=c}var h=this.config.isMobileSimulateMode==="mobile"?"mobile":Pe.device;if(this.addClass("".concat($.DEFAULT," ").concat($.INACTIVE," xgplayer-").concat(h," ").concat(this.config.controls?"":$.NO_CONTROLS)),this.config.autoplay?this.addClass($.ENTER):this.addClass($.NO_START),this.config.fluid){var d=this.config,f=d.width,p=d.height;typeof f=="number"&&typeof p=="number"||(f=600,p=337.5);var m={width:"100%",height:"0","max-width":"100%","padding-top":"".concat(100*p/f,"%")};Object.keys(m).forEach(function(E){t.root.style[E]=m[E]})}else["width","height"].forEach(function(E){t.config[E]&&(typeof t.config[E]!="number"?t.root.style[E]=t.config[E]:t.root.style[E]="".concat(t.config[E],"px"))});var v=this.root.getBoundingClientRect(),y=v.width,w=v.height,S=v.left,C=v.top;return this.sizeInfo.width=y,this.sizeInfo.height=w,this.sizeInfo.left=S,this.sizeInfo.top=C,!0}},{key:"_initBaseDoms",value:function(){this.topBar=null,this.leftBar=null,this.rightBar=null,this.config.marginControls&&(this.innerContainer=g.createDom("xg-video-container","",{"data-index":-1},"xg-video-container"),this.root.appendChild(this.innerContainer))}},{key:"_bindEvents",value:function(){var e=this;["focus","blur"].forEach(function(t){e.on(t,e["on"+t.charAt(0).toUpperCase()+t.slice(1)])}),du.forEach(function(t){document&&document.addEventListener(t,e.onFullscreenChange)}),Pe.os.isIos&&(this.media.addEventListener("webkitbeginfullscreen",this._onWebkitbeginfullscreen),this.media.addEventListener("webkitendfullscreen",this._onWebkitendfullscreen)),this.once(cn,this.resize),this.playFunc=function(){e.config.closeFocusVideoFocus||e.media.focus()},this.once(St,this.playFunc)}},{key:"_unbindEvents",value:function(){var e=this;this.root.removeEventListener("mousemove",this.mousemoveFunc),du.forEach(function(t){document.removeEventListener(t,e.onFullscreenChange)}),this.playFunc&&this.off(St,this.playFunc),this.off(on,this.canPlayFunc),this.media.removeEventListener("webkitbeginfullscreen",this._onWebkitbeginfullscreen),this.media.removeEventListener("webkitendfullscreen",this._onWebkitendfullscreen)}},{key:"_clearUserTimer",value:function(){this.userTimer&&(g.clearTimeout(this,this.userTimer),this.userTimer=null)}},{key:"_startInit",value:function(e){var t=this;if(this.media&&(e&&e!==""&&(g.typeOf(e)!=="Array"||e.length!==0)||(e="",this.emit(Jc),Re.logWarn("config.url is null, please get url and run player._startInit(url)"),!this.config.nullUrlStart))){this.handleSource&&(this._detachSourceEvents(this.media),g.typeOf(e)==="Array"&&e.length>0?this._attachSourceEvents(this.media,e):this.media.src&&this.media.src===e?e||this.media.removeAttribute("src"):this.media.src=e),g.typeOf(this.config.volume)==="Number"&&(this.volume=this.config.volume);var r=this.innerContainer?this.innerContainer:this.root;this.media instanceof window.Element&&!r.contains(this.media)&&r.insertBefore(this.media,r.firstChild);var o=this.media.readyState;Re.logInfo("_startInit readyState",o),this.config.autoplay&&(!g.isMSE(this.media)&&this.load(),(Pe.os.isIpad||Pe.os.isPhone)&&this.mediaPlay());var s=this.config.startTime;this.__startTime=s>0?s:-1,this.config.startTime=0,o>=2&&this.duration>0?this.canPlayFunc():this.on(on,this.canPlayFunc),(!this.hasStart||this.state<si)&&tt.afterInit(this),this.hasStart=!0,this.setState(si),g.setTimeout(this,function(){t.emit(io)},0)}}},{key:"_registerPlugins",value:function(){var e=this,t=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];this._loadingPlugins=[];var r=this.config.ignores||[],o=this.config.plugins||[],s=this.config.i18n||[];t&&Vi.extend(s,this.__i18n);var a=r.join("||").toLowerCase().split("||"),u=this.plugins;o.forEach(function(l){try{var c=l.plugin?l.plugin.pluginName:l.pluginName;if(c&&a.indexOf(c.toLowerCase())>-1)return null;if(!t&&u[c.toLowerCase()])return;if(l.lazy&&l.loader){var h=tt.lazyRegister(e,l);return void(l.forceBeforeInit&&(h.then(function(){e._loadingPlugins.splice(e._loadingPlugins.indexOf(h),1)}).catch(function(d){Re.logError("_registerPlugins:loadingPlugin",d),e._loadingPlugins.splice(e._loadingPlugins.indexOf(h),1)}),e._loadingPlugins.push(h)))}return e.registerPlugin(l)}catch(d){Re.logError("_registerPlugins:",d)}})}},{key:"_registerPresets",value:function(){var e=this;this.config.presets.forEach(function(t){(function(r,o){var s,a,u=o.preset&&o.options?new o.preset(o.options,r.config):new o({},r.config),l=u.plugins,c=l===void 0?[]:l,h=u.ignores,d=h===void 0?[]:h,f=u.icons,p=f===void 0?{}:f,m=u.i18n,v=m===void 0?[]:m;r.config.plugins||(r.config.plugins=[]),r.config.ignores||(r.config.ignores=[]),(s=r.config.plugins).push.apply(s,Bt(c)),(a=r.config.ignores).push.apply(a,Bt(d)),Object.keys(p).map(function(w){r.config.icons[w]||(r.config.icons[w]=p[w])});var y=r.config.i18n||[];v.push.apply(v,Bt(y)),r.config.i18n=v})(e,t)})}},{key:"_getRootByPosition",value:function(e){var t=null;switch(e){case Ve.ROOT_RIGHT:this.rightBar||(this.rightBar=g.createPositionBar("xg-right-bar",this.root)),t=this.rightBar;break;case Ve.ROOT_LEFT:this.leftBar||(this.leftBar=g.createPositionBar("xg-left-bar",this.root)),t=this.leftBar;break;case Ve.ROOT_TOP:this.topBar||(this.topBar=g.createPositionBar("xg-top-bar",this.root),this.config.topBarAutoHide&&g.addClass(this.topBar,$.TOP_BAR_AUTOHIDE)),t=this.topBar;break;default:t=this.innerContainer||this.root}return t}},{key:"registerPlugin",value:function(e,t){var r=tt.formatPluginInfo(e,t),o=r.PLUFGIN,s=r.options,a=this.config.plugins;!tt.checkPluginIfExits(o.pluginName,a)&&a.push(o);var u=tt.getRootByConfig(o.pluginName,this.config);u.root&&(s.root=u.root),u.position&&(s.position=u.position);var l=s.position?s.position:s.config&&s.config.position||o.defaultConfig&&o.defaultConfig.position;return!s.root&&typeof l=="string"&&l.indexOf("controls")>-1?this.controls&&this.controls.registerPlugin(o,s,o.pluginName):(s.root||(s.root=this._getRootByPosition(l)),tt.register(this,o,s))}},{key:"deregister",value:function(e){typeof e=="string"?tt.unRegister(this,e):e instanceof qt&&tt.unRegister(this,e.pluginName)}},{key:"unRegisterPlugin",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this.deregister(e),t&&this.removePluginFromConfig(e)}},{key:"removePluginFromConfig",value:function(e){var t;if(typeof e=="string"?t=e:e instanceof qt&&(t=e.pluginName),t){for(var r=this.config.plugins.length-1;r>-1;r--)if(this.config.plugins[r].pluginName.toLowerCase()===t.toLowerCase()){this.config.plugins.splice(r,1);break}}}},{key:"plugins",get:function(){return tt.getPlugins(this)}},{key:"getPlugin",value:function(e){var t=tt.findPlugin(this,e);return t&&t.pluginName?t:null}},{key:"addClass",value:function(e){this.root&&(g.hasClass(this.root,e)||g.addClass(this.root,e))}},{key:"removeClass",value:function(e){this.root&&g.removeClass(this.root,e)}},{key:"hasClass",value:function(e){if(this.root)return g.hasClass(this.root,e)}},{key:"setAttribute",value:function(e,t){this.root&&this.root.setAttribute(e,t)}},{key:"removeAttribute",value:function(e,t){this.root&&this.root.removeAttribute(e,t)}},{key:"start",value:function(e){var t=this;if(!(this.state>ku))return e||this.config.url||this.getInitDefinition(),this.hasStart=!0,this.setState(ku),this._registerPlugins(!1),tt.beforeInit(this).then(function(){if(t.config){e||(e=t.url||t.config.url);var r=t._preProcessUrl(e);return t._startInit(r.url)}}).catch(function(r){throw r.fileName="player",r.lineNumber="236",Re.logError("start:beforeInit:",r),r})}},{key:"switchURL",value:function(e,t){var r=this,o=e;g.typeOf(e)==="Object"&&(o=e.url),o=this._preProcessUrl(o).url;var s=this.currentTime;this.__startTime=s;var a=this.paused&&!this.isError;return this.src=o,new Promise(function(u,l){var c=function(d){r.off("timeupdate",h),r.off("canplay",h),l(d)},h=function(){r.duration>0&&r.__startTime>0&&(r.currentTime=r.__startTime,r.__startTime=-1),a&&r.pause(),r.off("error",c),u(!0)};r.once("error",c),o?(Pe.os.isAndroid?r.once("timeupdate",h):r.once("canplay",h),r.play()):r.errorHandler("error",{code:6,message:"empty_src"})})}},{key:"videoPlay",value:function(){this.mediaPlay()}},{key:"mediaPlay",value:function(){var e=this;if(!this.hasStart&&this.state<si)return this.removeClass($.NO_START),this.addClass($.ENTER),this.start(),void(this._useAutoplay=!0);this.state<it&&(this.removeClass($.NO_START),!this.isCanplay&&this.addClass($.ENTER));var t=Ce(we(n.prototype),"play",this).call(this);return t!==void 0&&t&&t.then?t.then(function(){e.removeClass($.NOT_ALLOW_AUTOPLAY),e.addClass($.PLAYING),e.state<it&&(Re.logInfo(">>>>playPromise.then"),e.setState(it),e.emit(Hn))}).catch(function(r){if(Re.logWarn(">>>>playPromise.catch",r.name),e.media&&e.media.error)return e.onError(),void e.removeClass($.ENTER);r.name==="NotAllowedError"&&(e._errorTimer=g.setTimeout(e,function(){e._errorTimer=null,e.emit(Qs),e.addClass($.NOT_ALLOW_AUTOPLAY),e.removeClass($.ENTER),e.pause(),e.setState(Zf)},0))}):(Re.logWarn("video.play not return promise"),this.state<it&&(this.setState(it),this.removeClass($.NOT_ALLOW_AUTOPLAY),this.removeClass($.NO_START),this.removeClass($.ENTER),this.addClass($.PLAYING),this.emit(Hn))),t}},{key:"mediaPause",value:function(){Ce(we(n.prototype),"pause",this).call(this)}},{key:"videoPause",value:function(){Ce(we(n.prototype),"pause",this).call(this)}},{key:"play",value:function(){var e=this;return this.removeClass($.PAUSED),rn(this,"play",function(){return e.mediaPlay()})}},{key:"pause",value:function(){var e=this;rn(this,"pause",function(){Ce(we(n.prototype),"pause",e).call(e)})}},{key:"seek",value:function(e,t){var r=this;if(this.media&&!Number.isNaN(Number(e))&&this.hasStart){var o=this.config,s=o.isSeekedPlay,a=o.seekedStatus,u=t||(s?"play":a);e=e<0?0:e>this.duration?parseInt(this.duration,10):e,!this._isPauseBeforeSeek&&(this._isPauseBeforeSeek=this.paused?2:1),this._onceSeekCanplay&&this.off(un,this._onceSeekCanplay),this._onceSeekCanplay=function(){switch(r.removeClass($.ENTER),r.isSeeking=!1,u){case"play":r.play();break;case"pause":r.pause();break;default:r._isPauseBeforeSeek>1||r.paused?r.pause():r.play()}r._isPauseBeforeSeek=0,r._onceSeekCanplay=null},this.once(un,this._onceSeekCanplay),this.state<it?(this.removeClass($.NO_START),this.currentTime=e,this.play()):this.currentTime=e}}},{key:"getInitDefinition",value:function(){var e=this,t=this.config,r=t.definition;!t.url&&r&&r.list&&r.list.length>0&&r.defaultDefinition&&r.list.map(function(o){o.definition===r.defaultDefinition&&(e.config.url=o.url,e.curDefinition=o)})}},{key:"changeDefinition",value:function(e,t){var r=this,o=this.config.definition;if(Array.isArray(o==null?void 0:o.list)&&o.list.forEach(function(a){(e==null?void 0:e.definition)===a.definition&&(r.curDefinition=a)}),e!=null&&e.bitrate&&typeof e.bitrate!="number"&&(e.bitrate=parseInt(e.bitrate,10)||0),this.emit(ro,{from:t,to:e}),this.hasStart){var s=this.switchURL(e.url,Ye({seamless:o.seamless!==!1&&typeof MediaSource<"u"&&typeof MediaSource.isTypeSupported=="function"},e));s&&s.then?s.then(function(){r.emit(jr,{from:t,to:e})}):this.emit(jr,{from:t,to:e})}else this.config.url=e.url}},{key:"reload",value:function(){this.load(),this.reloadFunc=function(){this.play()},this.once(cn,this.reloadFunc)}},{key:"resetState",value:function(){var e=this,t=[$.NOT_ALLOW_AUTOPLAY,$.PLAYING,$.NO_START,$.PAUSED,$.REPLAY,$.ENTER,$.ENDED,$.ERROR,$.LOADING];this.hasStart=!1,this.isError=!1,this._useAutoplay=!1,this.mediaPause(),this._accPlayed.acc=0,this._accPlayed.t=0,this._accPlayed.loopAcc=0,t.forEach(function(r){e.removeClass(r)}),this.addClass($.NO_START),this.emit(oo)}},{key:"reset",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0;if(this.resetState(),this.plugins&&(t.map(function(s){e.deregister(s)}),r)){var o=bu();Object.keys(this.config).keys(function(s){e.config[s]==="undefined"||s!=="plugins"&&s!=="presets"&&s!=="el"&&s!=="id"||(e.config[s]=o[s])})}}},{key:"destroy",value:function(){var e,t=this,r=this.innerContainer,o=this.root,s=this.media;if(o&&s){if(this.hasStart=!1,this._useAutoplay=!1,o.removeAttribute(Fn),this.updateAcc("destroy"),this._unbindEvents(),this._detachSourceEvents(this.media),g.clearAllTimers(this),this.emit(ea),(e=vn)===null||e===void 0||e.remove(this),tt.destroy(this),hh(this),Ce(we(n.prototype),"destroy",this).call(this),this.fullscreen&&this._fullscreenEl===this.root&&this.exitFullscreen(),r)for(var a=r.children,u=0;u<a.length;u++)r.removeChild(a[u]);!r&&s instanceof window.Node&&o.contains(s)&&o.removeChild(s),["topBar","leftBar","rightBar","innerContainer"].map(function(c){t[c]&&o.removeChild(t[c]),t[c]=null});var l=o.className.split(" ");l.length>0?o.className=l.filter(function(c){return c.indexOf("xgplayer")<0}).join(" "):o.className="",this.removeAttribute("data-xgfill"),["isSeeking","isCanplay","isActive","cssfullscreen","fullscreen"].forEach(function(c){t[c]=!1})}}},{key:"replay",value:function(){var e=this;this.removeClass($.ENDED),this.currentTime=0,this.isSeeking=!1,rn(this,"replay",function(){e.once(un,function(){var t=e.mediaPlay();t&&t.catch&&t.catch(function(r){})}),e.emit(Fr),e.onPlay()})}},{key:"retry",value:function(){var e=this;this.removeClass($.ERROR),this.addClass($.LOADING),rn(this,"retry",function(){var t=e.currentTime,r=e.config.url,o=g.isMSE(e.media)?{url:r}:e._preProcessUrl(r);e.src=o.url,!e.config.isLive&&(e.currentTime=t),e.once(on,function(){e.mediaPlay()})})}},{key:"changeFullStyle",value:function(e,t,r,o){e&&(o||(o=$.PARENT_FULLSCREEN),this._orgCss||(this._orgCss=g.filterStyleFromText(e)),g.addClass(e,r),t&&t!==e&&!this._orgPCss&&(this._orgPCss=g.filterStyleFromText(t),g.addClass(t,o),t.setAttribute(Fn,this.playerId)))}},{key:"recoverFullStyle",value:function(e,t,r,o){o||(o=$.PARENT_FULLSCREEN),this._orgCss&&(g.setStyleFromCsstext(e,this._orgCss),this._orgCss=""),g.removeClass(e,r),t&&t!==e&&this._orgPCss&&(g.setStyleFromCsstext(t,this._orgPCss),this._orgPCss="",g.removeClass(t,o),t.removeAttribute(Fn))}},{key:"getFullscreen",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.fullscreenTarget,t=this.root,r=this.media;if(e||(e=t),this._fullScreenOffset={top:g.scrollTop(),left:g.scrollLeft()},this._fullscreenEl=e,this._fullActionFrom="get",g.getFullScreenEl()===this._fullscreenEl)return this.onFullscreenChange(),Promise.resolve();try{for(var o=0;o<fu.length;o++){var s=fu[o];if(e[s]){var a=s==="webkitRequestFullscreen"?e.webkitRequestFullscreen(window.Element.ALLOW_KEYBOARD_INPUT):e[s]();return a&&a.then?a:Promise.resolve()}}return r.fullscreenEnabled||r.webkitSupportsFullscreen?(r.webkitEnterFullscreen(),Promise.resolve()):Promise.reject(new Error("call getFullscreen fail"))}catch{return Promise.reject(new Error("call getFullscreen fail"))}}},{key:"exitFullscreen",value:function(e){if(this.isRotateFullscreen&&this.exitRotateFullscreen(),this._fullscreenEl||g.getFullScreenEl()){this.root;var t=this.media;this._fullActionFrom="exit";try{for(var r=0;r<pu.length;r++){var o=pu[r];if(document[o]){var s=document[o]();return s&&s.then?s:Promise.resolve()}}return t&&t.webkitSupportsFullscreen?(t.webkitExitFullScreen(),Promise.resolve()):Promise.reject(new Error("call exitFullscreen fail"))}catch{return Promise.reject(new Error("call exitFullscreen fail"))}}}},{key:"getCssFullscreen",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.fullscreenTarget;this.isRotateFullscreen?this.exitRotateFullscreen():this.fullscreen&&this.exitFullscreen();var t=e?"".concat($.INNER_FULLSCREEN," ").concat($.CSS_FULLSCREEN):$.CSS_FULLSCREEN;this.changeFullStyle(this.root,e,t);var r=this.config.fullscreen,o=r===void 0?{}:r;(o.useCssFullscreen===!0||typeof o.useCssFullscreen=="function"&&o.useCssFullscreen())&&(this.fullscreen=!0,this.emit(Zt,!0)),this._cssfullscreenEl=e,this.cssfullscreen=!0,this.emit(Br,!0)}},{key:"exitCssFullscreen",value:function(){var e=this._cssfullscreenEl?"".concat($.INNER_FULLSCREEN," ").concat($.CSS_FULLSCREEN):$.CSS_FULLSCREEN;if(this.fullscreen){var t=this.config.fullscreen,r=t===void 0?{}:t;r.useCssFullscreen===!0||typeof r.useCssFullscreen=="function"&&r.useCssFullscreen()?(this.recoverFullStyle(this.root,this._cssfullscreenEl,e),this.fullscreen=!1,this.emit(Zt,!1)):this.removeClass(e)}else this.recoverFullStyle(this.root,this._cssfullscreenEl,e);this._cssfullscreenEl=null,this.cssfullscreen=!1,this.emit(Br,!1)}},{key:"getRotateFullscreen",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.fullscreenTarget;this.cssfullscreen&&this.exitCssFullscreen(e);var t=e?"".concat($.INNER_FULLSCREEN," ").concat($.ROTATE_FULLSCREEN):$.ROTATE_FULLSCREEN;this._fullscreenEl=e||this.root,this.changeFullStyle(this.root,e,t,$.PARENT_ROTATE_FULLSCREEN),this.isRotateFullscreen=!0,this.fullscreen=!0,this.setRotateDeg(90),this._rootStyle=this.root.getAttribute("style"),this.root.style.width="".concat(window.innerHeight,"px"),this.emit(Zt,!0)}},{key:"exitRotateFullscreen",value:function(e){var t=this._fullscreenEl!==this.root?"".concat($.INNER_FULLSCREEN," ").concat($.ROTATE_FULLSCREEN):$.ROTATE_FULLSCREEN;this.recoverFullStyle(this.root,this._fullscreenEl,t,$.PARENT_ROTATE_FULLSCREEN),this.isRotateFullscreen=!1,this.fullscreen=!1,this.setRotateDeg(0),this.emit(Zt,!1),this._rootStyle&&(this.root.style.style=this._rootStyle,this._rootStyle=!1)}},{key:"setRotateDeg",value:function(e){window.orientation===90||window.orientation===-90?this.rotateDeg=0:this.rotateDeg=e}},{key:"focus",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{autoHide:!this.config.closeDelayBlur,delay:this.config.inactive};this.isActive?this.onFocus(e):this.emit(Js,Ye({paused:this.paused,ended:this.ended},e))}},{key:"blur",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{ignorePaused:!1};this.isActive?(this._clearUserTimer(),this.emit(Xc,Ye({paused:this.paused,ended:this.ended},e))):this.onBlur(e)}},{key:"onFocus",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{autoHide:!0,delay:3e3},r=this.innerStates;if(this.isActive=!0,this.removeClass($.INACTIVE),this._clearUserTimer(),t.isLock!==void 0&&(r.isActiveLocked=t.isLock),t.autoHide===!1||t.isLock===!0||r.isActiveLocked)this._clearUserTimer();else{var o=t&&t.delay?t.delay:this.config.inactive;this.userTimer=g.setTimeout(this,function(){e.userTimer=null,e.blur()},o)}}},{key:"onBlur",value:function(){var e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).ignorePaused,t=e!==void 0&&e;if(!this.innerStates.isActiveLocked){var r=this.config.closePauseVideoFocus;this.isActive=!1,(t||r||!this.paused&&!this.ended)&&this.addClass($.INACTIVE)}}},{key:"onEmptied",value:function(){this.updateAcc("emptied")}},{key:"onCanplay",value:function(){this.removeClass($.ENTER),this.removeClass($.ERROR),this.removeClass($.LOADING),this.isCanplay=!0,this.waitTimer&&g.clearTimeout(this,this.waitTimer)}},{key:"onDurationchange",value:function(){this.__startTime>0&&this.duration>0&&(this.currentTime=this.__startTime,this.__startTime=-1)}},{key:"onLoadeddata",value:function(){this.isError=!1,this.isSeeking=!1}},{key:"onLoadstart",value:function(){this.removeClass($.ERROR),this.isCanplay=!1}},{key:"onPlay",value:function(){this.state===Fo&&this.setState(it),this.removeClass($.PAUSED),this.ended&&this.removeClass($.ENDED),!this.config.closePlayVideoFocus&&this.focus()}},{key:"onPause",value:function(){this.addClass($.PAUSED),this.updateAcc("pause"),this.config.closePauseVideoFocus||(this._clearUserTimer(),this.focus())}},{key:"onEnded",value:function(){this.updateAcc("ended"),this.addClass($.ENDED),this.setState(Fo)}},{key:"onError",value:function(){this.isError=!0,this.updateAcc("error"),this.removeClass($.NOT_ALLOW_AUTOPLAY),this.removeClass($.NO_START),this.removeClass($.ENTER),this.removeClass($.LOADING),this.addClass($.ERROR)}},{key:"onSeeking",value:function(){this.isSeeking||this.updateAcc("seeking"),this.isSeeking=!0,this.addClass($.SEEKING)}},{key:"onSeeked",value:function(){this.isSeeking=!1,this.waitTimer&&g.clearTimeout(this,this.waitTimer),this.removeClass($.LOADING),this.removeClass($.SEEKING)}},{key:"onWaiting",value:function(){var e=this;this.waitTimer&&g.clearTimeout(this,this.waitTimer),this.updateAcc("waiting"),this.waitTimer=g.setTimeout(this,function(){e.addClass($.LOADING),e.emit(eh),g.clearTimeout(e,e.waitTimer),e.waitTimer=null},this.config.minWaitDelay)}},{key:"onPlaying",value:function(){var e=this;this.isError=!1,[$.NO_START,$.PAUSED,$.ENDED,$.ERROR,$.REPLAY,$.LOADING].forEach(function(t){e.removeClass(t)}),this._accPlayed.t||this.paused||this.ended||(this._accPlayed.t=new Date().getTime())}},{key:"onTimeupdate",value:function(){!this._videoHeight&&this.media.videoHeight&&this.resize(),(this.waitTimer||this.hasClass($.LOADING))&&this.media.readyState>2&&(this.removeClass($.LOADING),g.clearTimeout(this,this.waitTimer),this.waitTimer=null),!this.paused&&this.state<it&&this.duration&&(this.setState(it),this.emit(Hn)),this._accPlayed.t||this.paused||this.ended||(this._accPlayed.t=new Date().getTime())}},{key:"onVolumechange",value:function(){g.typeOf(this.config.volume)==="Number"&&(this.config.volume=this.volume)}},{key:"onRatechange",value:function(){this.config.defaultPlaybackRate=this.playbackRate}},{key:"emitUserAction",value:function(e,t,r){if(this.media&&t&&e){var o=g.typeOf(e)==="String"?e:e.type||"";r.props&&g.typeOf(r.props)!=="Array"&&(r.props=[r.props]),this.emit(Vr,Ye({eventType:o,action:t,currentTime:this.currentTime,duration:this.duration,ended:this.ended,event:e},r))}}},{key:"updateAcc",value:function(e){if(this._accPlayed.t){var t=new Date().getTime()-this._accPlayed.t;this._accPlayed.acc+=t,this._accPlayed.t=0,(e==="ended"||this.ended)&&(this._accPlayed.loopAcc=this._accPlayed.acc)}}},{key:"checkBuffer",value:function(e){var t=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{startDiff:0,endDiff:0})||{},r=t.startDiff,o=r===void 0?0:r,s=t.endDiff,a=s===void 0?0:s,u=this.media.buffered;if(!u||u.length===0||!this.duration)return!0;for(var l=e||this.media.currentTime||.2,c=u.length,h=0;h<c;h++)if(u.start(h)+o<=l&&u.end(h)-a>l)return!0;return!1}},{key:"resizePosition",value:function(){var e=this.videoPos,t=e.vy,r=e.vx,o=e.h,s=e.w,a=this.videoPos.rotate;if(!(a<0&&o<0&&s<0)){var u=this.videoPos._pi;if(!u&&this.media.videoHeight&&(u=this.media.videoWidth/this.media.videoHeight*100),u){this.videoPos.pi=u;var l={rotate:a=a<0?0:a},c=0,h=0,d=1,f=Math.abs(a/90),p=this.root,m=this.innerContainer,v=p.offsetWidth,y=m?m.offsetHeight:p.offsetHeight,w=y,S=v;if(f%2==0)d=o>0?100/o:s>0?100/s:1,l.scale=d,c=t>0?(100-o)/2-t:0,l.y=f===2?0-c:c,h=r>0?(100-s)/2-r:0,l.x=f===2?0-h:h,this.media.style.width="".concat(S,"px"),this.media.style.height="".concat(w,"px");else if(f%2==1){w=v;var C=y-v;h=-C/2/(S=y)*100,l.x=f===3?h+t/2:h-t/2,c=C/2/w*100,l.y=f===3?c+r/2:c-r/2,l.scale=d,this.media.style.width="".concat(S,"px"),this.media.style.height="".concat(w,"px")}var E=g.getTransformStyle(l,this.media.style.transform||this.media.style.webkitTransform);this.media.style.transform=E,this.media.style.webkitTransform=E}}}},{key:"position",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{h:0,y:0,x:0,w:0};if(this.media&&e&&e.h){var t=this.videoPos;t.h=100*e.h||0,t.w=100*e.w||0,t.vx=100*e.x||0,t.vy=100*e.y||0,this.resizePosition()}}},{key:"setConfig",value:function(e){var t=this;e&&Object.keys(e).map(function(r){if(r!=="plugins"){t.config[r]=e[r];var o=t.plugins[r.toLowerCase()];o&&g.typeOf(o.setConfig)==="Function"&&o.setConfig(e[r])}})}},{key:"playNext",value:function(e){var t=this;this.resetState(),this.setConfig(e),this._currentTime=0,this._duration=0,rn(this,"playnext",function(){t.start(),t.emit(Hr,e)})}},{key:"resize",value:function(){var e=this;if(this.media){var t=this.root.getBoundingClientRect();this.sizeInfo.width=t.width,this.sizeInfo.height=t.height,this.sizeInfo.left=t.left,this.sizeInfo.top=t.top;var r=this.media,o=r.videoWidth,s=r.videoHeight,a=this.config,u=a.fitVideoSize,l=a.videoFillMode;if(l!=="fill"&&l!=="cover"&&l!=="contain"||this.setAttribute("data-xgfill",l),s&&o){this._videoHeight=s,this._videoWidth=o;var c=this.controls&&this.innerContainer?this.controls.root.getBoundingClientRect().height:0,h=t.width,d=t.height-c,f=parseInt(o/s*1e3,10),p=parseInt(h/d*1e3,10),m=h,v=d,y={};u==="auto"&&p>f||u==="fixWidth"?(v=h/f*1e3,this.config.fluid?y.paddingTop="".concat(100*v/m,"%"):y.height="".concat(v+c,"px")):(u==="auto"&&p<f||u==="fixHeight")&&(m=f*d/1e3,y.width="".concat(m,"px")),this.fullscreen||this.cssfullscreen||Object.keys(y).forEach(function(S){e.root.style[S]=y[S]}),(l==="fillHeight"&&p<f||l==="fillWidth"&&p>f)&&this.setAttribute("data-xgfill","cover");var w={videoScale:f,vWidth:m,vHeight:v,cWidth:m,cHeight:v+c};this.resizePosition(),this.emit(Ln,w)}}}},{key:"updateObjectPosition",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.media.updateObjectPosition?this.media.updateObjectPosition(e,t):this.media.style.objectPosition="".concat(100*e,"% ").concat(100*t,"%")}},{key:"setState",value:function(e){Re.logInfo("setState","state from:".concat(wu[this.state]," to:").concat(wu[e])),this._state=e}},{key:"_preProcessUrl",value:function(e,t){var r=this.config.preProcessUrl;return g.isBlob(e)||typeof r!="function"?{url:e}:r(e,t)}},{key:"state",get:function(){return this._state}},{key:"isFullscreen",get:function(){return this.fullscreen}},{key:"isCssfullScreen",get:function(){return this.cssfullscreen}},{key:"hasStart",get:function(){return this._hasStart},set:function(e){typeof e=="boolean"&&(this._hasStart=e,e===!1&&this.setState(ms),this.emit("hasstart"))}},{key:"isPlaying",get:function(){return this._state===it||this._state===Fo},set:function(e){e?this.setState(it):this._state>=it&&this.setState(si)}},{key:"definitionList",get:function(){return this.config&&this.config.definition&&this.config.definition.list||[]},set:function(e){var t=this,r=this.config.definition,o=null,s=null;r.list=e,this.emit("resourceReady",e),e.forEach(function(a){var u;((u=t.curDefinition)===null||u===void 0?void 0:u.definition)===a.definition&&(o=a),r.defaultDefinition===a.definition&&(s=a)}),!s&&e.length>0&&(s=e[0]),o?this.changeDefinition(o):s&&this.changeDefinition(s)}},{key:"videoFrameInfo",get:function(){var e={total:0,dropped:0,corrupted:0,droppedRate:0,droppedDuration:0};if(!this.media||!this.media.getVideoPlaybackQuality)return e;var t=this.media.getVideoPlaybackQuality();return e.dropped=t.droppedVideoFrames||0,e.total=t.totalVideoFrames||0,e.corrupted=t.corruptedVideoFrames||0,e.total>0&&(e.droppedRate=e.dropped/e.total*100,e.droppedDuration=parseInt(this.cumulateTime/e.total*e.dropped,0)),e}},{key:"lang",get:function(){return this.config.lang},set:function(e){Vi.langKeys.filter(function(t){return t===e}).length===0&&e!=="zh"||(this.config.lang=e,tt.setLang(e,this))}},{key:"i18n",get:function(){var e=this.config.lang;return e==="zh"&&(e="zh-cn"),this.__i18n.lang[e]||this.__i18n.lang.en}},{key:"i18nKeys",get:function(){return this.__i18n.textKeys||{}}},{key:"version",get:function(){return ds}},{key:"playerId",get:function(){return this._pluginInfoId}},{key:"url",get:function(){return this.__url||this.config.url},set:function(e){this.__url=e}},{key:"poster",get:function(){return this.plugins.poster?this.plugins.poster.config.poster:this.config.poster},set:function(e){this.plugins.poster&&this.plugins.poster.update(e)}},{key:"readyState",get:function(){return Ce(we(n.prototype),"readyState",this)}},{key:"error",get:function(){var e=Ce(we(n.prototype),"error",this);return this.i18n[e]||e}},{key:"networkState",get:function(){return Ce(we(n.prototype),"networkState",this)}},{key:"fullscreenChanging",get:function(){return this._fullScreenOffset!==null}},{key:"cumulateTime",get:function(){var e=this._accPlayed,t=e.acc,r=e.t;return r?new Date().getTime()-r+t:t}},{key:"zoom",get:function(){return this.config.zoom},set:function(e){this.config.zoom=e}},{key:"videoRotateDeg",get:function(){return this.videoPos.rotate},set:function(e){(e=g.convertDeg(e))%90==0&&e!==this.videoPos.rotate&&(this.videoPos.rotate=e,this.resizePosition())}},{key:"avgSpeed",get:function(){return xu},set:function(e){xu=e}},{key:"realTimeSpeed",get:function(){return Tu},set:function(e){Tu=e}},{key:"offsetCurrentTime",get:function(){return this._offsetInfo.currentTime||0},set:function(e){this._offsetInfo.currentTime=e}},{key:"offsetDuration",get:function(){return this._offsetInfo.duration||0},set:function(e){this._offsetInfo.duration=e||0}},{key:"hook",value:function(e,t){return zr.call.apply(zr,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"useHooks",value:function(e,t){return Wr.call.apply(Wr,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removeHooks",value:function(e,t){return Gr.call.apply(Gr,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"usePluginHooks",value:function(e,t,r){for(var o=arguments.length,s=new Array(o>3?o-3:0),a=3;a<o;a++)s[a-3]=arguments[a];return gu.call.apply(gu,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removePluginHooks",value:function(e,t,r){for(var o=arguments.length,s=new Array(o>3?o-3:0),a=3;a<o;a++)s[a-3]=arguments[a];return mu.call.apply(mu,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"setUserActive",value:function(e,t){var r;typeof t=="boolean"&&t!==this.muted&&(this.addInnerOP("volumechange"),g.typeOf(t)===Boolean&&(this.muted=t)),(r=vn)===null||r===void 0||r.setActive(this.playerId,e)}}],[{key:"debugger",get:function(){return Re.config.debug},set:function(e){Re.config.debug=e}},{key:"instManager",get:function(){return vn},set:function(e){vn=e}},{key:"getCurrentUserActivePlayerId",value:function(){var e;return(e=vn)===null||e===void 0?void 0:e.getActiveId()}},{key:"setCurrentUserActive",value:function(e,t){var r;(r=vn)===null||r===void 0||r.setActive(e,t)}},{key:"isHevcSupported",value:function(){return Pe.isHevcSupported()}},{key:"probeConfigSupported",value:function(e){return Pe.probeConfigSupported(e)}},{key:"install",value:function(e,t){n.plugins||(n.plugins={}),n.plugins[e]||(n.plugins[e]=t)}},{key:"use",value:function(e,t){n.plugins||(n.plugins={}),n.plugins[e]=t}}]),n}();function lt(){return new Date().getTime()}j(wr,"defaultPreset",null),j(wr,"XgVideoProxy",null),wr.instManager=fh.getInstance();var ep="loadstart",tp="loadeddata",np="firstFrame",Su="waitingStart",ip="waitingEnd",rp="seekStart",op="seekEnd",sp=function(){ye(n,Me);var i=_e(n);function n(){var e;fe(this,n);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return j(O(e=i.call.apply(i,[this].concat(r))),"_onTimeupdate",function(){e._state.isTimeUpdate=!0,e._state.autoplayStart&&(Re.logInfo("[xgLogger]".concat(e.player.playerId," _onTimeupdate")),e._sendFF("onTimeupdate"))}),j(O(e),"_onAutoplayStart",function(){Re.logInfo("[xgLogger]".concat(e.player.playerId," _onAutoplayStart")),e._state.autoplayStart=!0,e.vt&&e._sendFF("onAutoplayStart")}),j(O(e),"_onReset",function(){e._state={autoplayStart:!1,isFFLoading:!1,isTimeUpdate:!1,isFFSend:!1,isLs:!1},e.vt=0,e.pt=0,e.fvt=0,e.newPointTime=lt(),e.loadedCostTime=0,e.startCostTime=0,e._isSeeking=!1,e.seekingStart=0,e.waitingStart=0,e.fixedWaitingStart=0,e._isWaiting=!1,e._waitTimer&&g.clearTimeout(O(e),e._waitTimer),e._waittTimer&&g.clearTimeout(O(e),e._waittTimer),e._waitTimer=null,e._waittTimer=null,e._waitType=0}),j(O(e),"_onSeeking",function(){e.seekingStart||(e.suspendWaitingStatus("seek"),e.seekingStart=lt(),e.emitLog(rp,{start:lt()}))}),j(O(e),"_onSeeked",function(){e.suspendSeekingStatus("seeked")}),j(O(e),"_onWaitingLoadStart",function(){e._isWaiting||e.vt||(e._isWaiting=!0,e.waitingStart=lt(),e.fixedWaitingStart=lt(),e._waitType=1,e.emitLog(Su,{fixedStart:e.fixedWaitingStart,start:e.waitingStart,type:1,endType:"loadstart"}))}),j(O(e),"_onWaiting",function(){!e._isWaiting&&e.vt&&(e._isWaiting=!0,e.vt?e.seekingStart?e._waitType=2:e._waitType=0:e._waitType=1,e.fixedWaitingStart=lt(),e._waitTimer=g.setTimeout(O(e),function(){e._isWaiting&&(e.waitingStart=lt(),g.clearTimeout(O(e),e._waitTimer),e._waitTimer=null,e._startWaitTimeout(),e.emitLog(Su,{fixedStart:e.fixedWaitingStart,start:e.waitingStart,type:e._waitType,endType:e._waitType===2?"seek":"playing"}))},200))}),j(O(e),"_onError",function(){e.suspendSeekingStatus("error"),e.suspendWaitingStatus("error")}),j(O(e),"_onPlaying",function(){e._isWaiting&&e.suspendWaitingStatus("playing")}),e}return pe(n,[{key:"afterCreate",value:function(){var e=this;this._onReset(),this._waitType="firstFrame",this._initOnceEvents(),this.newPointTime=lt(),this.loadedCostTime=0,this.startCostTime=0,this.on(Xs,function(){var t=e._state,r=t.autoplayStart,o=t.isFFSend;e.startCostTime=lt()-e.newPointTime,Re.logInfo("[xgLogger]".concat(e.player.playerId," LOAD_START"),"autoplayStart:".concat(r," isFFSend:").concat(o," startCostTime:").concat(e.startCostTime," newPointTime").concat(e.newPointTime)),o||(!t.isLs&&e.emitLog(ep,{}),t.isLs=!0,t.isTimeUpdate=!1,t.isFFLoading=!0,e.pt=lt(),e.vt=0,e.fvt=0,e._initOnceEvents(),e._onWaitingLoadStart())}),this.on(cn,function(){e.vt=lt(),e.fvt=e.vt-e.pt,e.loadedCostTime=e.vt-e.newPointTime;var t=e._state,r=t.isTimeUpdate,o=t.isFFSend,s=t.autoplayStart;Re.logInfo("[xgLogger]".concat(e.player.playerId," LOADED_DATA"),"fvt:".concat(e.fvt," isTimeUpdate:").concat(e._state.isTimeUpdate," loadedCostTime:").concat(e.loadedCostTime)),(r||s)&&e._sendFF("loadedData"),o||e.emitLog(tp,{}),e.suspendWaitingStatus("loadeddata")}),this.on(jn,this._onSeeking),this.on(un,this._onSeeked),this.on(ea,function(){e.endState("destroy")}),this.on(Vn,function(){e.endState("urlChange"),Re.logInfo("[xgLogger]".concat(e.player.playerId," URL_CHANGE")),e._state.isFFSend&&e._onReset()}),this.on([$s,on],this._onPlaying),this.on(Gn,this._onWaiting),this.on(Qi,this._onError),this.on(oo,function(){Re.logInfo("[xgLogger]".concat(e.player.playerId," RESET")),e.endState("reset"),e._initOnceEvents(),e._onReset()})}},{key:"_initOnceEvents",value:function(){this.off(Hn,this._onAutoplayStart),this.off(xt,this._onTimeupdate),this.once(Hn,this._onAutoplayStart),this.once(xt,this._onTimeupdate)}},{key:"_sendFF",value:function(e){this.s=lt();var t=this._state,r=t.isFFLoading,o=t.isFFSend;Re.logInfo("[xgLogger]".concat(this.player.playerId," _sendFF"),"".concat(e," fvt:").concat(this.fvt," isFFLoading:").concat(r," !isFFSend:").concat(!o)),this.vt>0&&r&&!o&&(Re.logInfo("[xgLogger]".concat(this.player.playerId," emitLog_firstFrame"),e),this._state.isFFLoading=!1,this._state.isFFSend=!0,this.emitLog(np,{fvt:this.fvt,costTime:this.fvt,vt:this.vt,startCostTime:this.startCostTime,loadedCostTime:this.loadedCostTime}))}},{key:"_startWaitTimeout",value:function(){var e=this;this._waittTimer&&g.clearTimeout(this,this._waittTimer),this._waittTimer=g.setTimeout(this,function(){e.suspendWaitingStatus("timeout"),g.clearTimeout(e,e._waittTimer),e._waittTimer=null},this.config.waitTimeout)}},{key:"endState",value:function(e){this.suspendWaitingStatus(e),this.suspendSeekingStatus(e)}},{key:"suspendSeekingStatus",value:function(e){if(this.seekingStart){var t=lt(),r=t-this.seekingStart;this.seekingStart=0,this.emitLog(op,{end:t,costTime:r,endType:e})}}},{key:"suspendWaitingStatus",value:function(e){if(this._waitTimer&&(g.clearTimeout(this,this._waitTimer),this._waitTimer=null),this._waittTimer&&(g.clearTimeout(this,this._waittTimer),this._waittTimer=null),this._isWaiting=!1,this.waitingStart){var t=lt(),r=t-this.waitingStart,o=t-this.fixedWaitingStart,s=this.config.waitTimeout;this._isWaiting=!1,this.waitingStart=0,this.fixedWaitingStart=0,this.emitLog(ip,{fixedCostTime:o>s?s:o,costTime:r>s?s:r,type:e==="loadeddata"?1:this._waitType,endType:this._waitType===2?"seek":e})}}},{key:"emitLog",value:function(e,t){var r=this.player;this.emit(rh,Ye({t:lt(),host:g.getHostFromUrl(r.currentSrc),vtype:r.vtype,eventType:e,currentTime:this.player.currentTime,readyState:r.video.readyState,networkState:r.video.networkState},t))}}],[{key:"pluginName",get:function(){return"xgLogger"}},{key:"defaultConfig",get:function(){return{waitTimeout:1e4}}}]),n}();function ap(){return new DOMParser().parseFromString(`<svg class="xgplayer-replay-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 78 78" width="78" height="78">
  <path fill="#fff" transform="translate(20, 20)" d="M8.22708362,13.8757234 L11.2677371,12.6472196 C11.7798067,12.4403301 12.3626381,12.6877273 12.5695276,13.1997969 L12.9441342,14.1269807 C13.1510237,14.6390502 12.9036264,15.2218816 12.3915569,15.4287712 L6.8284538,17.6764107 L5.90126995,18.0510173 C5.38920044,18.2579068 4.80636901,18.0105096 4.5994795,17.49844 L1.97723335,11.0081531 C1.77034384,10.4960836 2.0177411,9.91325213 2.52981061,9.70636262 L3.45699446,9.33175602 C3.96906396,9.12486652 4.5518954,9.37226378 4.75878491,9.88433329 L5.67885163,12.1615783 C7.99551726,6.6766934 13.3983951,3 19.5,3 C27.7842712,3 34.5,9.71572875 34.5,18 C34.5,26.2842712 27.7842712,33 19.5,33 C15.4573596,33 11.6658607,31.3912946 8.87004692,28.5831991 C8.28554571,27.9961303 8.28762719,27.0463851 8.87469603,26.4618839 C9.46176488,25.8773827 10.4115101,25.8794641 10.9960113,26.466533 C13.2344327,28.7147875 16.263503,30 19.5,30 C26.127417,30 31.5,24.627417 31.5,18 C31.5,11.372583 26.127417,6 19.5,6 C14.4183772,6 9.94214483,9.18783811 8.22708362,13.8757234 Z"></path>
</svg>
`,"image/svg+xml").firstChild}var up=function(){ye(n,Me);var i=_e(n);function n(){return fe(this,n),i.apply(this,arguments)}return pe(n,[{key:"registerIcons",value:function(){return{replay:ap}}},{key:"afterCreate",value:function(){var e=this;Me.insert(this.icons.replay,this.root,0),this.__handleReplay=this.hook("replayClick",function(){e.player.replay()},{pre:function(t){t.preventDefault(),t.stopPropagation()}}),this.bind(".xgplayer-replay",["click","touchend"],this.__handleReplay),this.on($n,function(){if(e.playerConfig.loop||g.addClass(e.player.root,"replay"),!e.config.disable){e.show();var t=e.root.querySelector("path");if(t){var r=window.getComputedStyle(t).getPropertyValue("transform");if(typeof r=="string"&&r.indexOf("none")>-1)return null;t.setAttribute("transform",r)}}}),this.on(St,function(){e.hide()})}},{key:"handleReplay",value:function(e){e.preventDefault(),e.stopPropagation(),this.player.replay(),g.removeClass(this.player.root,"replay")}},{key:"show",value:function(e){this.config.disable||(this.root.style.display="flex")}},{key:"enable",value:function(){this.config.disable=!1}},{key:"disable",value:function(){this.config.disable=!0,this.hide()}},{key:"destroy",value:function(){this.unbind(".xgplayer-replay",["click","touchend"],this.__handleReplay)}},{key:"render",value:function(){return`<xg-replay class="xgplayer-replay">
      <xg-replay-txt class="xgplayer-replay-txt" lang-key="`.concat(this.i18nKeys.REPLAY,'">').concat(this.i18n.REPLAY,`</xg-replay-txt>
    </xg-replay>`)}}],[{key:"pluginName",get:function(){return"replay"}},{key:"defaultConfig",get:function(){return{disable:!1}}}]),n}(),lp=function(){ye(n,Me);var i=_e(n);function n(){return fe(this,n),i.apply(this,arguments)}return pe(n,[{key:"isEndedShow",get:function(){return this.config.isEndedShow},set:function(e){this.config.isEndedShow=e}},{key:"hide",value:function(){g.addClass(this.root,"hide")}},{key:"show",value:function(e){g.removeClass(this.root,"hide")}},{key:"beforeCreate",value:function(e){typeof e.player.config.poster=="string"&&(e.config.poster=e.player.config.poster)}},{key:"afterCreate",value:function(){var e=this;this.on($n,function(){e.isEndedShow&&g.removeClass(e.root,"hide")}),this.config.hideCanplay?(this.once(xt,function(){e.onTimeUpdate()}),this.on(Vn,function(){g.removeClass(e.root,"hide"),g.addClass(e.root,"xg-showplay"),e.once(xt,function(){e.onTimeUpdate()})})):this.on(St,function(){g.addClass(e.root,"hide")})}},{key:"onTimeUpdate",value:function(){var e=this;this.player.currentTime?g.removeClass(this.root,"xg-showplay"):this.once(xt,function(){e.onTimeUpdate()})}},{key:"update",value:function(e){e&&(this.config.poster=e,this.root.style.backgroundImage="url(".concat(e,")"))}},{key:"getBgSize",value:function(e){var t="";switch(e){case"cover":t="cover";break;case"contain":t="contain";break;case"fixHeight":t="auto 100%";break;default:t=""}return t?"background-size: ".concat(t,";"):""}},{key:"render",value:function(){var e=this.config,t=e.poster,r=e.hideCanplay,o=e.fillMode,s=e.notHidden,a=this.getBgSize(o),u=t?"background-image:url(".concat(t,");").concat(a):a;return'<xg-poster class="xgplayer-poster '.concat(s?"xg-not-hidden":r?"xg-showplay":"",'" style="').concat(u,`">
    </xg-poster>`)}}],[{key:"pluginName",get:function(){return"poster"}},{key:"defaultConfig",get:function(){return{isEndedShow:!0,hideCanplay:!1,notHidden:!1,poster:"",fillMode:"fixWidth"}}}]),n}();function ta(){return new DOMParser().parseFromString(`<svg class="play" xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="3 -4 28 40">
  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M576,363L810,512L576,661zM342,214L576,363L576,661L342,810z"></path>
</svg>
`,"image/svg+xml").firstChild}function na(){return new DOMParser().parseFromString(`<svg class="pause" xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="3 -4 28 40">
  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M598,214h170v596h-170v-596zM256 810v-596h170v596h-170z"></path>
</svg>
`,"image/svg+xml").firstChild}var Vt={};function Cu(i){i?window.clearTimeout(i):Object.keys(Vt).map(function(n){window.clearTimeout(Vt[n].id),delete Vt[n]})}var cp=function(){ye(n,Me);var i=_e(n);function n(e){var t;return fe(this,n),j(O(t=i.call(this,e)),"onPlayerReset",function(){t.autoPlayStart=!1;var r=t.config.mode==="auto"?"auto-hide":"hide";t.setAttr("data-state","play"),g.removeClass(t.root,r),t.show()}),j(O(t),"onAutoplayStart",function(){if(!t.autoPlayStart){var r=t.config.mode==="auto"?"auto-hide":"hide";g.addClass(t.root,r),t.autoPlayStart=!0,t.onPlayPause("play")}}),t.autoPlayStart=!1,t}return pe(n,[{key:"afterCreate",value:function(){var e=this,t=this.player,r=this.playerConfig;this.initIcons(),this.once(Zs,function(){r&&(r.lang&&r.lang==="en"?g.addClass(t.root,"lang-is-en"):r.lang==="jp"&&g.addClass(t.root,"lang-is-jp"))}),this.on(Hn,this.onAutoplayStart),r.autoplay||this.show(),this.on(Qs,function(){var o=e.config.mode==="auto"?"auto-hide":"hide";e.setAttr("data-state","play"),g.removeClass(e.root,o),e.show()}),this.on(St,function(){e.onPlayPause("play")}),this.on(_i,function(){e.onPlayPause("pause")}),this.on(oo,function(){e.onPlayerReset()}),this.clickHandler=this.hook("startClick",this.switchPausePlay,{pre:function(o){o.cancelable&&o.preventDefault(),o.stopPropagation();var s=e.player.paused;e.emitUserAction(o,"switch_play_pause",{props:"paused",from:s,to:!s})}}),this.bind(["click","touchend"],this.clickHandler)}},{key:"registerIcons",value:function(){return{startPlay:{icon:ta,class:"xg-icon-play"},startPause:{icon:na,class:"xg-icon-pause"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild("xg-start-inner",e.startPlay),this.appendChild("xg-start-inner",e.startPause)}},{key:"hide",value:function(){g.addClass(this.root,"hide")}},{key:"show",value:function(e){g.removeClass(this.root,"hide")}},{key:"focusHide",value:function(){g.addClass(this.root,"focus-hide")}},{key:"recover",value:function(){g.removeClass(this.root,"focus-hide")}},{key:"switchStatus",value:function(e){e?this.setAttr("data-state",this.player.paused?"pause":"play"):this.setAttr("data-state",this.player.paused?"play":"pause")}},{key:"animate",value:function(e){var t=this;this._animateId=function(r,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{start:null,end:null};return Vt[r]&&window.clearTimeout(Vt[r].id),Vt[r]={},s.start&&s.start(),Vt[r].id=window.setTimeout(function(){s.end&&s.end(),window.clearTimeout(Vt[r].id),delete Vt[r]},o),Vt[r].id}("pauseplay",400,{start:function(){g.addClass(t.root,"interact"),t.show(),t.switchStatus(!0)},end:function(){g.removeClass(t.root,"interact"),!e&&t.hide(),t._animateId=null}})}},{key:"endAnimate",value:function(){g.removeClass(this.root,"interact"),Cu(this._animateId),this._animateId=null}},{key:"switchPausePlay",value:function(e){var t=this.player;e.cancelable&&e.preventDefault(),e.stopPropagation(),t.state<ms||(this.player.paused||t.state!==it?t.play():t.pause())}},{key:"onPlayPause",value:function(e){var t=this.config,r=this.player;if(r&&!(r.state<it)&&this.autoPlayStart){if(t.mode==="show")return this.switchStatus(),void this.show();if(t.mode!=="auto"){if(t.isShowPause&&r.paused&&!r.ended||t.isShowEnd&&r.ended)return this.switchStatus(),this.show(),void this.endAnimate();if(t.disableAnimate)return this.switchStatus(),void this.hide();if(e==="play")this.autoPlayStart?this.animate():this.hide();else{if(!this.autoPlayStart||r.ended)return;this.animate()}}else this.switchStatus()}}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.clickHandler),Cu(this._animateId)}},{key:"render",value:function(){var e=this.playerConfig.autoplay?this.config.mode==="auto"?"auto-hide":"hide":"";return`
    <xg-start class="xgplayer-start `.concat(e,`">
    <xg-start-inner></xg-start-inner>
    </xg-start>`)}}],[{key:"pluginName",get:function(){return"start"}},{key:"defaultConfig",get:function(){return{isShowPause:!1,isShowEnd:!1,disableAnimate:!1,mode:"hide"}}}]),n}(),hp=function(){ye(n,Me);var i=_e(n);function n(){return fe(this,n),i.apply(this,arguments)}return pe(n,[{key:"render",value:function(){var e=this.config.innerHtml,t=g.createDom("xg-enter","",{},"xgplayer-enter");if(e&&e instanceof window.HTMLElement)t.appendChild(e);else if(e&&typeof e=="string")t.innerHTML=e;else{for(var r="",o=1;o<=12;o++)r+='<div class="xgplayer-enter-bar'.concat(o,'"></div>');t.innerHTML='<div class="xgplayer-enter-spinner">'.concat(r,"</div>")}return t}}],[{key:"pluginName",get:function(){return"enter"}},{key:"defaultConfig",get:function(){return{innerHtml:"",logo:""}}}]),n}();function In(i,n,e){try{return' <div class="xg-tips '.concat(e?"hide":" ",'" lang-key="').concat(i.i18nKeys[n],`">
    `).concat(i.i18n[n],`
    </div>`)}catch{return'<div class="xg-tips hide"></div>'}}var Eu=function(){ye(n,Me);var i=_e(n);function n(){return fe(this,n),i.apply(this,arguments)}return pe(n,[{key:"afterCreate",value:function(){this.getMini=this.getMini.bind(this),this.exitMini=this.exitMini.bind(this),this.bind("click",this.getMini)}},{key:"getMini",value:function(){this.config.onClick&&this.config.onClick()}},{key:"exitMini",value:function(){this.config.onClick&&this.config.onClick()}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.getMini)}},{key:"render",value:function(){var e="MINISCREEN";return`
      <xg-icon class="xgplayer-miniicon">
      <div class="xgplayer-icon btn-text"><span class="icon-text" lang-key="`.concat(this.i18nKeys[e],'">').concat(this.i18n[e],`</span></div>
      </xg-icon>`)}}],[{key:"pluginName",get:function(){return"miniscreenIcon"}},{key:"defaultConfig",get:function(){return{position:Ve.CONTROLS_RIGHT,index:10}}}]),n}();function Pu(i){var n=parseFloat(i);return i.indexOf("%")===-1&&!Number.isNaN(n)&&n}var vs=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],Lu=vs.length;function Ou(i){if(typeof i=="string"&&(i=document.querySelector(i)),i&&pt(i)==="object"&&i.nodeType){var n=function(y){return window.getComputedStyle(y)}(i);if(n.display==="none")return function(){for(var y={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},w=0;w<Lu;w++)y[vs[w]]=0;return y}();var e={};e.width=i.offsetWidth,e.height=i.offsetHeight;for(var t=e.isBorderBox=n.boxSizing==="border-box",r=0;r<Lu;r++){var o=vs[r],s=n[o],a=parseFloat(s);e[o]=Number.isNaN(a)?0:a}var u=e.paddingLeft+e.paddingRight,l=e.paddingTop+e.paddingBottom,c=e.marginLeft+e.marginRight,h=e.marginTop+e.marginBottom,d=e.borderLeftWidth+e.borderRightWidth,f=e.borderTopWidth+e.borderBottomWidth,p=t,m=Pu(n.width);m!==!1&&(e.width=m+(p?0:u+d));var v=Pu(n.height);return v!==!1&&(e.height=v+(p?0:l+f)),e.innerWidth=e.width-(u+d),e.innerHeight=e.height-(l+f),e.outerWidth=e.width+c,e.outerHeight=e.height+h,e}}function Uo(i,n){for(var e=0;e<i.length;e++){var t=i[e];if(t.identifier===n)return t}}var dp="dragStart",fp="dragMove",pp="dragEnded",Iu={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"]},gp=function(){ye(n,Yn);var i=_e(n);function n(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return fe(this,n),(t=i.call(this)).isEnabled=!0,t.isDragging=!1,t.isDown=!1,t.position={},t.downPoint={},t.dragPoint={x:0,y:0},t.startPos={x:0,y:0},t._root=e instanceof Element?e:document.querySelector(e),t._handlerDom=r.handle instanceof Element?r.handle:document.querySelector(r.handle),t._root&&t._handlerDom?(t._bindStartEvent(),t):Ys(t)}return pe(n,[{key:"_bindStartEvent",value:function(){var e=this;"ontouchstart"in window?this._startKey="touchstart":this._startKey="mousedown",this["on".concat(this._startKey)]=this["on".concat(this._startKey)].bind(this),this._handlerDom.addEventListener(this._startKey,this["on".concat(this._startKey)]),Iu[this._startKey].map(function(t){e["on".concat(t)]=e["on".concat(t)].bind(e)})}},{key:"_unbindStartEvent",value:function(){this._handlerDom.removeEventListener(this._startKey,this["on".concat(this._startKey)])}},{key:"_bindPostStartEvents",value:function(e){var t=this;if(e){var r=Iu[this._startKey];r.map(function(o){window.addEventListener(o,t["on".concat(o)])}),this._boundPointerEvents=r}}},{key:"_unbindPostStartEvents",value:function(){var e=this;this._boundPointerEvents&&(this._boundPointerEvents.map(function(t){window.removeEventListener(t,e["on".concat(t)])}),delete this._boundPointerEvents)}},{key:"enable",value:function(){this.isEnabled=!0}},{key:"disable",value:function(){this.isEnabled=!1,this.isDragging&&this.onUp()}},{key:"onDocUp",value:function(e){this.onUp()}},{key:"animate",value:function(){var e=this;this.isDragging&&(this.positionDrag(),window.requestAnimationFrame(function(){e.animate()}))}},{key:"positionDrag",value:function(){var e="translate3d(".concat(this.dragPoint.x,"px, ").concat(this.dragPoint.y,"px, 0)");this._root.style.transform=e,this._root.style.webKitTransform=e}},{key:"setLeftTop",value:function(){this._root.style.left=this.position.x+"px",this._root.style.top=this.position.y+"px"}},{key:"onmousedown",value:function(e){this.dragStart(e,e)}},{key:"onmousemove",value:function(e){this.dragMove(e,e)}},{key:"onmouseup",value:function(e){this.dragEnd(e,e)}},{key:"ontouchstart",value:function(e){var t=e.changedTouches[0];this.dragStart(e,t),this.touchIdentifier=t.pointerId!==void 0?t.pointerId:t.identifier,e.preventDefault()}},{key:"ontouchmove",value:function(e){var t=Uo(e.changedTouches,this.touchIdentifier);t&&this.dragMove(e,t)}},{key:"ontouchend",value:function(e){var t=Uo(e.changedTouches,this.touchIdentifier);t&&this.dragEnd(e,t),e.preventDefault()}},{key:"ontouchcancel",value:function(e){var t=Uo(e.changedTouches,this.touchIdentifier);t&&this.dragCancel(e,t)}},{key:"dragStart",value:function(e,t){if(this._root&&!this.isDown&&this.isEnabled){this.downPoint=t,this.dragPoint.x=0,this.dragPoint.y=0,this._getPosition();var r=Ou(this._root);this.startPos.x=this.position.x,this.startPos.y=this.position.y,this.startPos.maxY=window.innerHeight-r.height,this.startPos.maxX=window.innerWidth-r.width,this.setLeftTop(),this.isDown=!0,this._bindPostStartEvents(e)}}},{key:"dragRealStart",value:function(e,t){this.isDragging=!0,this.animate(),this.emit(dp,this.startPos)}},{key:"dragEnd",value:function(e,t){this._root&&(this._unbindPostStartEvents(),this.isDragging&&(this._root.style.transform="",this.setLeftTop(),this.emit(pp)),this.presetInfo())}},{key:"_dragPointerMove",value:function(e,t){var r={x:t.pageX-this.downPoint.pageX,y:t.pageY-this.downPoint.pageY};return!this.isDragging&&this.hasDragStarted(r)&&this.dragRealStart(e,t),r}},{key:"dragMove",value:function(e,t){if(e=e||window.event,this.isDown){var r=this.startPos,o=r.x,s=r.y,a=this._dragPointerMove(e,t),u=a.x,l=a.y;u=this.checkContain("x",u,o),l=this.checkContain("y",l,s),this.position.x=o+u,this.position.y=s+l,this.dragPoint.x=u,this.dragPoint.y=l,this.emit(fp,this.position)}}},{key:"dragCancel",value:function(e,t){this.dragEnd(e,t)}},{key:"presetInfo",value:function(){this.isDragging=!1,this.startPos={x:0,y:0},this.dragPoint={x:0,y:0},this.isDown=!1}},{key:"destroy",value:function(){this._unbindStartEvent(),this._unbindPostStartEvents(),this.isDragging&&this.dragEnd(),this.removeAllListeners(),this._handlerDom=null}},{key:"hasDragStarted",value:function(e){return Math.abs(e.x)>3||Math.abs(e.y)>3}},{key:"checkContain",value:function(e,t,r){return t+r<0?0-r:e==="x"&&t+r>this.startPos.maxX?this.startPos.maxX-r:e==="y"&&t+r>this.startPos.maxY?this.startPos.maxY-r:t}},{key:"_getPosition",value:function(){var e=window.getComputedStyle(this._root),t=this._getPositionCoord(e.left,"width"),r=this._getPositionCoord(e.top,"height");this.position.x=Number.isNaN(t)?0:t,this.position.y=Number.isNaN(r)?0:r,this._addTransformPosition(e)}},{key:"_addTransformPosition",value:function(e){var t=e.transform;if(t.indexOf("matrix")===0){var r=t.split(","),o=t.indexOf("matrix3d")===0?12:4,s=parseInt(r[o],10),a=parseInt(r[o+1],10);this.position.x+=s,this.position.y+=a}}},{key:"_getPositionCoord",value:function(e,t){if(e.indexOf("%")!==-1){var r=Ou(this._root.parentNode);return r?parseFloat(e)/100*r[t]:0}return parseInt(e,10)}}]),n}(),mp=function(){ye(n,Me);var i=_e(n);function n(e){var t;fe(this,n),j(O(t=i.call(this,e)),"onCancelClick",function(o){t.exitMini(),t.isClose=!0}),j(O(t),"onCenterClick",function(o){var s=O(t).player;s.paused?s.play():s.pause()}),j(O(t),"onScroll",function(o){if(!(!window.scrollY&&window.scrollY!==0||Math.abs(window.scrollY-t.pos.scrollY)<50)){var s=parseInt(g.getCss(t.player.root,"height"));s+=t.config.scrollTop,t.pos.scrollY=window.scrollY,window.scrollY>s+5?!t.isMini&&!t.isClose&&t.getMini():window.scrollY<=s&&(t.isMini&&t.exitMini(),t.isClose=!1)}}),t.isMini=!1,t.isClose=!1;var r=O(t).config;return t.pos={left:r.left<0?window.innerWidth-r.width-20:r.left,top:r.top<0?window.innerHeight-r.height-20:r.top,height:t.config.height,width:t.config.width,scrollY:window.scrollY||0},t.lastStyle=null,t}return pe(n,[{key:"beforeCreate",value:function(e){typeof e.player.config.mini=="boolean"&&(e.config.isShowIcon=e.player.config.mini)}},{key:"afterCreate",value:function(){var e=this;this.initIcons(),this.on(_i,function(){e.setAttr("data-state","pause")}),this.on(St,function(){e.setAttr("data-state","play")})}},{key:"onPluginsReady",value:function(){var e=this,t=this.player;if(!this.config.disable){if(this.config.isShowIcon){var r={config:{onClick:function(){e.getMini()}}};t.controls.registerPlugin(Eu,r,Eu.pluginName)}var o=g.checkTouchSupport()?"touchend":"click";this.bind(".mini-cancel-btn",o,this.onCancelClick),this.bind(".play-icon",o,this.onCenterClick),this.config.disableDrag||(this._draggabilly=new gp(this.player.root,{handle:this.root})),this.config.isScrollSwitch&&window.addEventListener("scroll",this.onScroll)}}},{key:"registerIcons",value:function(){return{play:{icon:ta,class:"xg-icon-play"},pause:{icon:na,class:"xg-icon-pause"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".play-icon",e.play),this.appendChild(".play-icon",e.pause)}},{key:"getMini",value:function(){var e=this;if(!this.isMini){var t=this.player,r=this.playerConfig,o=this.config.target||this.player.root;this.lastStyle={},g.addClass(t.root,"xgplayer-mini"),["width","height","top","left"].map(function(s){e.lastStyle[s]=o.style[s],o.style[s]="".concat(e.pos[s],"px")}),r.fluid&&(o.style["padding-top"]=""),this.emit(Ur,!0),t.isMini=this.isMini=!0}}},{key:"exitMini",value:function(){var e=this;if(!this.isMini)return!1;var t=this.player,r=this.playerConfig,o=this.config.target||this.player.root;g.removeClass(t.root,"xgplayer-mini"),this.lastStyle&&Object.keys(this.lastStyle).map(function(s){o.style[s]=e.lastStyle[s]}),this.lastStyle=null,r.fluid&&(t.root.style.width="100%",t.root.style.height="0",t.root.style["padding-top"]="".concat(100*r.height/r.width,"%")),this.emit(Ur,!1),this.isMini=t.isMini=!1}},{key:"destroy",value:function(){window.removeEventListener("scroll",this.onScroll);var e=g.checkTouchSupport()?"touchend":"click";this.unbind(".mini-cancel-btn",e,this.onCancelClick),this.unbind(".play-icon",e,this.onCenterClick),this._draggabilly&&this._draggabilly.destroy(),this._draggabilly=null,this.exitMini()}},{key:"render",value:function(){if(!this.config.disable)return`
      <xg-mini-layer class="xg-mini-layer">
      <xg-mini-header class="xgplayer-mini-header">
      `.concat(In(this,"MINI_DRAG",this.playerConfig.isHideTips),`
      </xg-mini-header>
      <div class="mini-cancel-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">
          <path fill="#fff" fill-rule="evenodd" d="M3.99 3.49a1 1 0 0 1 1.414 0L10 8.085l4.596-4.595a1 1 0 1 1 1.414 1.414L11.414 9.5l4.596 4.596a1 1 0 0 1 .084 1.32l-.084.094a1 1 0 0 1-1.414 0L10 10.914 5.404 15.51a1 1 0 0 1-1.414-1.414L8.585 9.5 3.99 4.904a1 1 0 0 1-.084-1.32z"></path>
        </svg>
      </div>
      <div class="play-icon">
      </div>
      </xg-mini-layer>`)}}],[{key:"pluginName",get:function(){return"miniscreen"}},{key:"defaultConfig",get:function(){return{index:10,disable:!1,width:320,height:180,left:-1,top:-1,isShowIcon:!1,isScrollSwitch:!1,scrollTop:0,disableDrag:!1}}}]),n}(),cr={mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousemove:"onMouseMove"},jo=["videoClick","videoDbClick"],Ho=function(){ye(n,qt);var i=_e(n);function n(){var e;fe(this,n);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return j(O(e=i.call.apply(i,[this].concat(r))),"onMouseMove",function(s){var a=O(e),u=a.player,l=a.playerConfig;u.isActive||(u.focus({autoHide:!l.closeDelayBlur}),!l.closeFocusVideoFocus&&u.media.focus())}),j(O(e),"onMouseEnter",function(s){var a=O(e),u=a.playerConfig,l=a.player;!u.closeFocusVideoFocus&&l.media.focus(),u.closeDelayBlur?l.focus({autoHide:!1}):l.focus(),e.emit(Qc)}),j(O(e),"onMouseLeave",function(s){var a=e.playerConfig,u=a.closePlayerBlur,l=a.leavePlayerTime,c=a.closeDelayBlur;u||c||(l?e.player.focus({autoHide:!0,delay:l}):e.player.blur({ignorePaused:!0})),e.emit(Zc)}),j(O(e),"onVideoClick",function(s){var a=O(e),u=a.player,l=a.playerConfig;s.target&&l.closeVideoClick||s.target!==u.root&&s.target!==u.media&&s.target!==u.innerContainer&&s.target!==u.media.__canvas||(s.preventDefault(),l.closeVideoStopPropagation||s.stopPropagation(),e._clickCount++,e.clickTimer&&(clearTimeout(e.clickTimer),e.clickTimer=null),e.clickTimer=setTimeout(function(){e._clickCount&&(e._clickCount--,rn(O(e),jo[0],function(c,h){e.switchPlayPause(h.e)},{e:s,paused:u.paused}),clearTimeout(e.clickTimer),e.clickTimer=null)},300))}),j(O(e),"onVideoDblClick",function(s){var a=O(e),u=a.player,l=a.playerConfig;l.closeVideoDblclick||!s.target||s.target!==u.media&&s.target!==u.media.__canvas||(!l.closeVideoClick&&e._clickCount<2?e._clickCount=0:(e._clickCount=0,e.clickTimer&&(clearTimeout(e.clickTimer),e.clickTimer=null),s.preventDefault(),s.stopPropagation(),rn(O(e),jo[1],function(c,h){e.emitUserAction(h.e,"switch_fullscreen",{props:"fullscreen",from:u.fullscreen,to:!u.fullscreen}),u.fullscreen?u.exitFullscreen():u.getFullscreen()},{e:s,fullscreen:u.fullscreen})))}),e}return pe(n,[{key:"afterCreate",value:function(){var e=this;this._clickCount=0,jo.map(function(t){e.__hooks[t]=null}),this.playerConfig.isMobileSimulateMode==="mobile"||Pe.device==="mobile"&&!Pe.os.isIpad||this.initEvents()}},{key:"initEvents",value:function(){var e=this,t=this.player,r=t.media,o=t.root,s=this.playerConfig.enableContextmenu;o&&o.addEventListener("click",this.onVideoClick,!1),o&&o.addEventListener("dblclick",this.onVideoDblClick,!1),Object.keys(cr).map(function(a){o.addEventListener(a,e[cr[a]],!1)}),!s&&r&&r.addEventListener("contextmenu",this.onContextmenu,!1)}},{key:"switchPlayPause",value:function(e){var t=this.player;this.emitUserAction(e,"switch_play_pause",{props:"paused",from:t.paused,to:!t.paused}),t.ended?t.duration!==1/0&&t.duration>0&&t.replay():t.paused?t.play():t.pause()}},{key:"onContextmenu",value:function(e){(e=e||window.event).preventDefault&&e.preventDefault(),e.stopPropagation?e.stopPropagation():(e.returnValue=!1,e.cancelBubble=!0)}},{key:"destroy",value:function(){var e=this,t=this.player,r=t.video,o=t.root;this.clickTimer&&clearTimeout(this.clickTimer),o.removeEventListener("click",this.onVideoClick,!1),o.removeEventListener("dblclick",this.onVideoDblClick,!1),r.removeEventListener("contextmenu",this.onContextmenu,!1),Object.keys(cr).map(function(s){o.removeEventListener(s,e[cr[s]],!1)})}}],[{key:"pluginName",get:function(){return"pc"}},{key:"defaultConfig",get:function(){return{}}}]),n}(),vp="press",Ru="pressend",yp="doubleclick",_p="click",bp="touchmove",kp="touchstart",wp="touchend",Tp={start:"touchstart",end:"touchend",move:"touchmove",cancel:"touchcancel"},xp={start:"mousedown",end:"mouseup",move:"mousemove",cancel:"mouseleave"};function Au(i){return i&&i.length>0?i[i.length-1]:null}var Sp=function(){function i(n){var e=this,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{eventType:"touch"};fe(this,i),j(this,"onTouchStart",function(r){var o=e._pos,s=e.root,a=Au(r.touches);o.x=a?parseInt(a.pageX,10):r.pageX,o.y=a?parseInt(a.pageX,10):r.pageX,o.start=!0,e.__setPress(r),s.addEventListener(e.events.end,e.onTouchEnd),s.addEventListener(e.events.cancel,e.onTouchCancel),s.addEventListener(e.events.move,e.onTouchMove),e.trigger(kp,r)}),j(this,"onTouchCancel",function(r){e.onTouchEnd(r)}),j(this,"onTouchEnd",function(r){var o=e._pos,s=e.root;e.__clearPress(),s.removeEventListener(e.events.cancel,e.onTouchCancel),s.removeEventListener(e.events.end,e.onTouchEnd),s.removeEventListener(e.events.move,e.onTouchMove),r.moving=o.moving,r.press=o.press,o.press&&e.trigger(Ru,r),e.trigger(wp,r),!o.press&&!o.moving&&e.__setDb(r),o.press=!1,o.start=!1,o.moving=!1}),j(this,"onTouchMove",function(r){var o=e._pos,s=e.config,a=Au(r.touches),u=a?parseInt(a.pageX,10):r.pageX,l=a?parseInt(a.pageY,10):r.pageX,c=u-o.x,h=l-o.y;Math.abs(h)<s.miniStep&&Math.abs(c)<s.miniStep||(e.__clearPress(),o.press&&e.trigger(Ru,r),o.press=!1,o.moving=!0,e.trigger(bp,r))}),this._pos={moving:!1,start:!1,x:0,y:0},this.config={pressDelay:600,dbClickDelay:200,disablePress:!1,disableDbClick:!1,miniStep:2,needPreventDefault:!0},Object.keys(t).map(function(r){e.config[r]=t[r]}),this.root=n,this.events=t.eventType==="mouse"?xp:Tp,this.pressIntrvalId=null,this.dbIntrvalId=null,this.__handlers={},this._initEvent()}return pe(i,[{key:"_initEvent",value:function(){this.root.addEventListener(this.events.start,this.onTouchStart)}},{key:"__setPress",value:function(n){var e=this,t=this.config;this.pressIntrvalId&&this.__clearPress(),this.pressIntrvalId=setTimeout(function(){e.trigger(vp,n),e._pos.press=!0,e.__clearPress()},t.pressDelay)}},{key:"__clearPress",value:function(){window.clearTimeout(this.pressIntrvalId),this.pressIntrvalId=null}},{key:"__setDb",value:function(n){var e=this,t=this.config;if(this.dbIntrvalId)return this.__clearDb(),void this.trigger(yp,n);this.dbIntrvalId=setTimeout(function(){e.__clearDb(),e._pos.start||e._pos.press||e._pos.moving||e.trigger(_p,n)},t.dbClickDelay)}},{key:"__clearDb",value:function(){clearTimeout(this.dbIntrvalId),this.dbIntrvalId=null}},{key:"on",value:function(n,e){this.__handlers[n]||(this.__handlers[n]=[]),this.__handlers[n].push(e)}},{key:"off",value:function(n,e){if(this.__handlers[n]){for(var t=this.__handlers[n],r=-1,o=0;o<t.length;o++)if(t[o]===e){r=o;break}r>=0&&this.__handlers[n].splice(r,1)}}},{key:"trigger",value:function(n,e){this.__handlers[n]&&this.__handlers[n].map(function(t){try{t(e)}catch{}})}},{key:"destroy",value:function(){var n=this,e={touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"};Object.keys(e).forEach(function(t){n.root.removeEventListener(t,n[e[t]])})}}]),i}();function Cp(){return new DOMParser().parseFromString(`<svg width="20" height="9" viewBox="0 0 8 9" fill="none" xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink">
  <path opacity="0.54"
    d="M7.5 3.63397C8.16667 4.01887 8.16667 4.98113 7.5 5.36603L1.5 8.83013C0.833334 9.21503 0 8.7339 0 7.9641L0 1.0359C0 0.266098 0.833333 -0.215027 1.5 0.169873L7.5 3.63397Z"
    fill="white" />
  <path transform="translate(5 0)" d="M7.5 3.63397C8.16667 4.01887 8.16667 4.98113 7.5 5.36603L1.5 8.83013C0.833334 9.21503 0 8.7339 0 7.9641L0 1.0359C0 0.266098 0.833333 -0.215027 1.5 0.169873L7.5 3.63397Z" fill="white"/>
</svg>`,"image/svg+xml").firstChild}var hr="auto",Ep="seeking",Pp="playbackrate",Vo=["videoClick","videoDbClick"],Lp=function(){ye(n,Me);var i=_e(n);function n(e){var t;return fe(this,n),j(O(t=i.call(this,e)),"onTouchStart",function(r){var o=O(t),s=o.player,a=o.config,u=o.pos,l=o.playerConfig,c=t.getTouche(r);if(c&&!a.disableGesture&&t.duration>0&&!s.ended){u.isStart=!0,t.timer&&clearTimeout(t.timer),g.checkIsFunction(l.disableSwipeHandler)&&l.disableSwipeHandler(),t.find(".xg-dur").innerHTML=g.format(t.duration);var h=t.root.getBoundingClientRect();s.rotateDeg===90?(u.top=h.left,u.left=h.top,u.width=h.height,u.height=h.width):(u.top=h.top,u.left=h.left,u.width=h.width,u.height=h.height);var d=parseInt(c.pageX-u.left,10),f=parseInt(c.pageY-u.top,10);u.x=s.rotateDeg===90?f:d,u.y=s.rotateDeg===90?d:f,u.scopeL=a.scopeL*u.width,u.scopeR=(1-a.scopeR)*u.width,u.scopeM1=u.width*(1-a.scopeM)/2,u.scopeM2=u.width-u.scopeM1}}),j(O(t),"onTouchMove",function(r){var o=t.getTouche(r),s=O(t),a=s.pos,u=s.config,l=s.player;if(o&&!u.disableGesture&&t.duration&&a.isStart){var c=u.miniMoveStep,h=u.hideControlsActive,d=parseInt(o.pageX-a.left,10),f=parseInt(o.pageY-a.top,10),p=l.rotateDeg===90?f:d,m=l.rotateDeg===90?d:f;if(Math.abs(p-a.x)>c||Math.abs(m-a.y)>c){var v=p-a.x,y=m-a.y,w=a.scope;if(w===-1&&((w=t.checkScope(p,m,v,y,a))===0&&(h?l.blur():l.focus({autoHide:!1}),!a.time&&(a.time=parseInt(1e3*l.currentTime,10)+1e3*t.timeOffset)),a.scope=w),w===-1||w>0&&!u.gestureY||w===0&&!u.gestureX)return;r.cancelable&&r.preventDefault(),t.executeMove(v,y,w,a.width,a.height),a.x=p,a.y=m}}}),j(O(t),"onTouchEnd",function(r){var o=O(t),s=o.player,a=o.pos,u=o.playerConfig;if(setTimeout(function(){s.getPlugin("progress")&&s.getPlugin("progress").resetSeekState()},10),a.isStart){a.scope>-1&&r.cancelable&&r.preventDefault();var l=t.config,c=l.disableGesture,h=l.gestureX;!c&&h?t.endLastMove(a.scope):a.time=0,a.scope=-1,t.resetPos(),g.checkIsFunction(u.enableSwipeHandler)&&u.enableSwipeHandler(),t.changeAction(hr)}}),j(O(t),"onRootTouchMove",function(r){!t.config.disableGesture&&t.config.gestureX&&t.checkIsRootTarget(r)&&(r.stopPropagation(),t.pos.isStart?t.onTouchMove(r):t.onTouchStart(r))}),j(O(t),"onRootTouchEnd",function(r){t.pos.isStart&&t.checkIsRootTarget(r)&&(r.stopPropagation(),t.onTouchEnd(r))}),t.pos={isStart:!1,x:0,y:0,time:0,volume:0,rate:1,light:0,width:0,height:0,scopeL:0,scopeR:0,scopeM1:0,scopeM2:0,scope:-1},t.timer=null,t}return pe(n,[{key:"duration",get:function(){return this.playerConfig.customDuration||this.player.duration}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"registerIcons",value:function(){return{seekTipIcon:{icon:Cp,class:"xg-seek-pre"}}}},{key:"afterCreate",value:function(){var e=this;Vo.map(function(l){e.__hooks[l]=null});var t=this.playerConfig,r=this.config,o=this.player;t.closeVideoDblclick===!0&&(r.closedbClick=!0),this.resetPos(),g.isUndefined(t.disableGesture)||(r.disableGesture=!!t.disableGesture),this.appendChild(".xg-seek-icon",this.icons.seekTipIcon),this.xgMask=g.createDom("xg-mask","",{},"xgmask"),o.root.appendChild(this.xgMask),this.initCustomStyle(),this.registerThumbnail();var s=this.domEventType==="mouse"?"mouse":"touch";this.touch=new Sp(this.root,{eventType:s,needPreventDefault:!this.config.disableGesture}),this.root.addEventListener("contextmenu",function(l){l.preventDefault()}),o.root.addEventListener("touchmove",this.onRootTouchMove,!0),o.root.addEventListener("touchend",this.onRootTouchEnd,!0),this.on(Pn,function(){var l=e.player,c=e.config;1e3*l.duration<c.moveDuration&&(c.moveDuration=1e3*l.duration)}),this.on([on,$n],function(){var l=e.pos,c=l.time;!l.isStart&&c>0&&(e.pos.time=0)});var a={touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",press:"onPress",pressend:"onPressEnd",click:"onClick",doubleclick:"onDbClick"};if(Object.keys(a).map(function(l){e.touch.on(l,function(c){e[a[l]](c)})}),!r.disableActive){var u=o.plugins.progress;u&&(u.addCallBack("dragmove",function(l){e.activeSeekNote(l.currentTime,l.forward)}),["dragend","click"].forEach(function(l){u.addCallBack(l,function(){e.changeAction(hr)})}))}}},{key:"registerThumbnail",value:function(){var e=this.player.plugins.thumbnail;if(e&&e.usable){this.thumbnail=e.createThumbnail(null,"mobile-thumbnail");var t=this.find(".time-preview");t.insertBefore(this.thumbnail,t.children[0])}}},{key:"initCustomStyle",value:function(){var e=(this.playerConfig||{}).commonStyle,t=e.playedColor,r=e.progressColor,o=e.timePreviewStyle,s=e.curTimeColor,a=e.durationColor;if(t&&(this.find(".xg-curbar").style.backgroundColor=t),r&&(this.find(".xg-bar").style.backgroundColor=r),o){var u=this.find(".time-preview");Object.keys(o).forEach(function(h){u.style[h]=o[h]})}var l=s||t,c=a;l&&(this.find(".xg-cur").style.color=l),c&&(this.find(".xg-dur").style.color=c),this.config.disableTimeProgress&&g.addClass(this.find(".xg-timebar"),"hide")}},{key:"resetPos",value:function(){var e=this;this.pos?(this.pos.isStart=!1,this.pos.scope=-1,["x","y","width","height","scopeL","scopeR","scopeM1","scopeM2"].map(function(t){e.pos[t]=0})):this.pos={isStart:!1,x:0,y:0,volume:0,rate:1,light:0,width:0,height:0,scopeL:0,scopeR:0,scopeM1:0,scopeM2:0,scope:-1,time:0}}},{key:"changeAction",value:function(e){var t=this.player;this.root.setAttribute("data-xg-action",e);var r=t.plugins.start;r&&r.recover()}},{key:"getTouche",value:function(e){this.player.rotateDeg;var t=e.touches&&e.touches.length>0?e.touches[e.touches.length-1]:e;return{pageX:t.pageX,pageY:t.pageY}}},{key:"checkScope",value:function(e,t,r,o,s){var a=s.width,u=-1;if(e<0||e>a)return u;var l=Math.abs(o===0?r:r/o);return Math.abs(r)>0&&l>=1.73&&e>s.scopeM1&&e<s.scopeM2?u=0:(Math.abs(r)===0||l<=.57)&&(u=e<s.scopeL?1:e>s.scopeR?2:3),u}},{key:"executeMove",value:function(e,t,r,o,s){switch(r){case 0:this.updateTime(e/o*this.config.scopeM);break;case 1:this.updateBrightness(t/s);break;case 2:Pe.os.isIos||this.updateVolume(t/s)}}},{key:"endLastMove",value:function(e){var t=this,r=this.pos,o=this.player,s=this.config,a=(r.time-this.timeOffset)/1e3;e===0&&(o.seek(Number(a).toFixed(1)),s.hideControlsEnd?o.blur():o.focus(),this.timer=setTimeout(function(){t.pos.time=0},500)),this.changeAction(hr)}},{key:"checkIsRootTarget",value:function(e){var t=this.player.plugins||{};return(!t.progress||!t.progress.root.contains(e.target))&&(t.start&&t.start.root.contains(e.target)||t.controls&&t.controls.root.contains(e.target))}},{key:"sendUseAction",value:function(e){var t=this.player.paused;this.emitUserAction(e,"switch_play_pause",{prop:"paused",from:t,to:!t})}},{key:"clickHandler",value:function(e){var t=this.player,r=this.config,o=this.playerConfig;t.state<it?o.closeVideoClick||(this.sendUseAction(g.createEvent("click")),t.play()):!r.closedbClick||o.closeVideoClick?t.isActive?t.blur():t.focus():o.closeVideoClick||((t.isActive||r.focusVideoClick)&&(this.sendUseAction(g.createEvent("click")),this.switchPlayPause()),t.focus())}},{key:"dbClickHandler",value:function(e){var t=this.config,r=this.player;!t.closedbClick&&r.state>=it&&(this.sendUseAction(g.createEvent("dblclick")),this.switchPlayPause())}},{key:"onClick",value:function(e){var t=this,r=this.player;rn(this,Vo[0],function(o,s){t.clickHandler(s.e)},{e,paused:r.paused})}},{key:"onDbClick",value:function(e){var t=this,r=this.player;rn(this,Vo[1],function(o,s){t.dbClickHandler(s.e)},{e,paused:r.paused})}},{key:"onPress",value:function(e){var t=this.pos,r=this.config,o=this.player;r.disablePress||(t.rate=this.player.playbackRate,this.emitUserAction("press","change_rate",{prop:"playbackRate",from:o.playbackRate,to:r.pressRate}),o.playbackRate=r.pressRate,this.changeAction(Pp))}},{key:"onPressEnd",value:function(e){var t=this.pos,r=this.config,o=this.player;r.disablePress||(this.emitUserAction("pressend","change_rate",{prop:"playbackRate",from:o.playbackRate,to:t.rate}),o.playbackRate=t.rate,t.rate=1,this.changeAction(hr))}},{key:"updateTime",value:function(e){var t=this.player,r=this.config,o=this.player.duration;e=Number(e.toFixed(4));var s=parseInt(e*r.moveDuration,10)+this.timeOffset;s=(s+=this.pos.time)<0?0:s>1e3*o?1e3*o-200:s,t.getPlugin("time")&&t.getPlugin("time").updateTime(s/1e3),t.getPlugin("progress")&&t.getPlugin("progress").updatePercent(s/1e3/this.duration,!0),this.activeSeekNote(s/1e3,e>0),r.isTouchingSeek&&t.seek(Number((s-this.timeOffset)/1e3).toFixed(1)),this.pos.time=s}},{key:"updateVolume",value:function(e){this.player.rotateDeg&&(e=-e);var t=this.player,r=this.pos;if(e=parseInt(100*e,10),r.volume+=e,!(Math.abs(r.volume)<10)){var o=parseInt(10*t.volume,10)-parseInt(r.volume/10,10);o=o>10?10:o<1?0:o,t.volume=o/10,r.volume=0}}},{key:"updateBrightness",value:function(e){this.player.rotateDeg&&(e=-e);var t=this.pos,r=this.config,o=this.xgMask,s=t.light+.8*e;s=s>r.maxDarkness?r.maxDarkness:s<0?0:s,o&&(o.style.backgroundColor="rgba(0,0,0,".concat(s,")")),t.light=s}},{key:"activeSeekNote",value:function(e){var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],r=this.player,o=this.config,s=!(this.duration!==1/0&&this.duration>0);if(e&&typeof e=="number"&&!s&&!o.disableActive){e<0?e=0:e>r.duration&&(e=r.duration-.2),this.changeAction(Ep);var a=r.plugins.start;a&&a.focusHide(),this.find(".xg-dur").innerHTML=g.format(this.duration),this.find(".xg-cur").innerHTML=g.format(e),this.find(".xg-curbar").style.width="".concat(e/this.duration*100,"%"),t?g.removeClass(this.find(".xg-seek-show"),"xg-back"):g.addClass(this.find(".xg-seek-show"),"xg-back"),this.updateThumbnails(e)}}},{key:"updateThumbnails",value:function(e){var t=this.player.plugins.thumbnail;t&&t.usable&&this.thumbnail&&t.update(this.thumbnail,e,160,90)}},{key:"switchPlayPause",value:function(){var e=this.player;if(e.state<si)return!1;e.ended||(e.paused?e.play():e.pause())}},{key:"disableGesture",value:function(){this.config.disableGesture=!1}},{key:"enableGesture",value:function(){this.config.disableGesture=!0}},{key:"destroy",value:function(){var e=this.player;this.timer&&clearTimeout(this.timer),this.thumbnail=null,e.root.removeChild(this.xgMask),this.xgMask=null,this.touch&&this.touch.destroy(),this.touch=null,e.root.removeEventListener("touchmove",this.onRootTouchMove,!0),e.root.removeEventListener("touchend",this.onRootTouchEnd,!0)}},{key:"render",value:function(){var e=this.config.gradient!=="normal"?"gradient ".concat(this.config.gradient):"gradient";return`
     <xg-trigger class="trigger">
     <div class="`.concat(e,`"></div>
        <div class="time-preview">
            <div class="xg-seek-show `).concat(this.config.disableSeekIcon?" hide-seek-icon":"",`">
              <i class="xg-seek-icon"></i>
              <span class="xg-cur">00:00</span>
              <span class="xg-separator">/</span>
              <span class="xg-dur">00:00</span>
            </div>
              <div class="xg-bar xg-timebar">
                <div class="xg-curbar"></div>
              </div>
        </div>
        <div class="xg-playbackrate xg-top-note">
            <span><i>`).concat(this.config.pressRate,"X</i>").concat(this.i18n.FORWARD,`</span>
        </div>
     </xg-trigger>
    `)}}],[{key:"pluginName",get:function(){return"mobile"}},{key:"defaultConfig",get:function(){return{index:0,disableGesture:!1,gestureX:!0,gestureY:!0,gradient:"normal",isTouchingSeek:!1,miniMoveStep:5,miniYPer:5,scopeL:.25,scopeR:.25,scopeM:.9,pressRate:2,darkness:!0,maxDarkness:.8,disableActive:!1,disableTimeProgress:!1,hideControlsActive:!1,hideControlsEnd:!1,moveDuration:36e4,closedbClick:!1,disablePress:!0,disableSeekIcon:!1,focusVideoClick:!1}}}]),n}();function Du(i){var n=i.tagName;return!(n!=="INPUT"&&n!=="TEXTAREA"&&!i.isContentEditable)}var Mu=function(){ye(n,qt);var i=_e(n);function n(){var e;fe(this,n);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return j(O(e=i.call.apply(i,[this].concat(r))),"onBodyKeyDown",function(s){if(e.player){var a=s||window.event,u=a.keyCode,l=O(e),c=l._keyState,h=l.player,d=e.config,f=d.disable,p=d.disableBodyTrigger,m=d.isIgnoreUserActive;f||p||!h.isUserActive&&!m||Du(a.target)||!e.checkIsVisible()||a.metaKey||a.altKey||a.ctrlKey?c.isBodyKeyDown=!1:(s.repeat||c.isKeyDown||((a.target===document.body||e.config.isGlobalTrigger&&!Du(a.target))&&e.checkCode(u,!0)&&(c.isBodyKeyDown=!0),document.addEventListener("keyup",e.onBodyKeyUp)),c.isBodyKeyDown&&e.handleKeyDown(a))}}),j(O(e),"onBodyKeyUp",function(s){e.player&&(document.removeEventListener("keyup",e.onBodyKeyUp),e.handleKeyUp(s))}),j(O(e),"onKeydown",function(s){if(e.player){var a=s||window.event,u=O(e)._keyState;if(!a.repeat){if(e.config.disable||e.config.disableRootTrigger||a.metaKey||a.altKey||a.ctrlKey)return;!a||a.keyCode!==37&&!e.checkCode(a.keyCode)||a.target!==e.player.root&&a.target!==e.player.video&&a.target!==e.player.controls.el||(u.isKeyDown=!0),e.player.root.addEventListener("keyup",e.onKeyup)}u.isKeyDown&&e.handleKeyDown(a)}}),j(O(e),"onKeyup",function(s){e.player&&(e.player.root.removeEventListener("keyup",e.onKeyup),e.handleKeyUp(s))}),e}return pe(n,[{key:"mergekeyCodeMap",value:function(){var e=this,t=this.config.keyCodeMap;t&&Object.keys(t).map(function(r){e.keyCodeMap[r]?["keyCode","action","disable","pressAction","disablePress","isBodyTarget"].map(function(o){t[r][o]&&(e.keyCodeMap[r][o]=t[r][o])}):e.keyCodeMap[r]=t[r]})}},{key:"afterCreate",value:function(){this.config.disable=!this.playerConfig.keyShortcut;var e=typeof this.config.seekStep=="function"?this.config.seekStep(this.player):this.config.seekStep;e&&typeof e=="number"&&(this.seekStep=e),this.keyCodeMap={space:{keyCode:32,action:"playPause",disable:!1,disablePress:!1,noBodyTarget:!1},up:{keyCode:38,action:"upVolume",disable:!1,disablePress:!1,noBodyTarget:!0},down:{keyCode:40,action:"downVolume",disable:!1,disablePress:!1,noBodyTarget:!0},left:{keyCode:37,action:"seekBack",disablePress:!1,disable:!1},right:{keyCode:39,action:"seek",pressAction:"changePlaybackRate",disablePress:!1,disable:!1},esc:{keyCode:27,action:"exitFullscreen",disablePress:!0,disable:!1}},this.mergekeyCodeMap(),this._keyState={isKeyDown:!1,isBodyKeyDown:!1,isPress:!1,tt:0,playbackRate:0},this.player.root.addEventListener("keydown",this.onKeydown),document.addEventListener("keydown",this.onBodyKeyDown)}},{key:"setConfig",value:function(e){var t=this;Object.keys(e).forEach(function(r){t.config[r]=e[r]})}},{key:"checkIsVisible",value:function(){if(!this.config.checkVisible)return!0;var e=this.player.root.getBoundingClientRect(),t=e.height,r=e.top,o=e.bottom,s=window.innerHeight;return!(r<0&&r<0-.9*t||o>0&&o-s>.9*t)}},{key:"checkCode",value:function(e,t){var r=this,o=!1;return Object.keys(this.keyCodeMap).map(function(s){r.keyCodeMap[s]&&e===r.keyCodeMap[s].keyCode&&!r.keyCodeMap[s].disable&&(o=!t||t&&!r.keyCodeMap[s].noBodyTarget)}),o}},{key:"downVolume",value:function(e){var t=this.player;if(!(t.volume<=0)){var r=parseFloat((t.volume-.1).toFixed(1)),o={volume:{from:t.volume,to:r}};this.emitUserAction(e,"change_volume",{props:o}),t.volume=r>=0?r:0}}},{key:"upVolume",value:function(e){var t=this.player;if(!(t.volume>=1)){var r=parseFloat((t.volume+.1).toFixed(1)),o={volume:{from:t.volume,to:r}};this.emitUserAction(e,"change_volume",{props:o}),t.volume=r<=1?r:1}}},{key:"seek",value:function(e){var t=this.player,r=t.currentTime,o=t.offsetCurrentTime,s=t.duration,a=t.offsetDuration,u=t.timeSegments,l=o>-1?o:r,c=a||s,h=e.repeat&&this.seekStep>=4?parseInt(this.seekStep/2,10):this.seekStep;l+h<=c?l+=h:l=c;var d=g.getCurrentTimeByOffset(l,u),f={currentTime:{from:r,to:d}};this.emitUserAction(e,"seek",{props:f}),this.player.currentTime=d}},{key:"seekBack",value:function(e){var t=this.player,r=t.currentTime,o=t.offsetCurrentTime,s=t.timeSegments,a=(o>-1?o:r)-(e.repeat?parseInt(this.seekStep/2,10):this.seekStep);a<0&&(a=0);var u={currentTime:{from:r,to:a=g.getCurrentTimeByOffset(a,s)}};this.emitUserAction(e,"seek",{props:u}),this.player.currentTime=a}},{key:"changePlaybackRate",value:function(e){var t=this._keyState,r=this.config,o=this.player;t.playbackRate===0&&(t.playbackRate=o.playbackRate,o.playbackRate=r.playbackRate)}},{key:"playPause",value:function(e){var t=this.player;t&&(this.emitUserAction(e,"switch_play_pause"),t.paused?t.play():t.pause())}},{key:"exitFullscreen",value:function(e){var t=this.player,r=t.fullscreen,o=t.cssfullscreen;r&&(this.emitUserAction("keyup","switch_fullscreen",{prop:"fullscreen",from:r,to:!r}),t.exitFullscreen()),o&&(this.emitUserAction("keyup","switch_css_fullscreen",{prop:"cssfullscreen",from:o,to:!o}),t.exitCssFullscreen())}},{key:"handleKeyDown",value:function(e){var t=this._keyState;if(e.repeat){t.isPress=!0;var r=Date.now();if(r-t.tt<200)return;t.tt=r}this.handleKeyCode(e.keyCode,e,t.isPress)}},{key:"handleKeyUp",value:function(e){var t=this._keyState;t.playbackRate>0&&(this.player.playbackRate=t.playbackRate,t.playbackRate=0),t.isKeyDown=!1,t.isPress=!1,t.tt=0}},{key:"handleKeyCode",value:function(e,t,r){for(var o,s=Object.keys(this.keyCodeMap),a=0;a<s.length;a++){var u=this.keyCodeMap[s[a]],l=u.action,c=u.keyCode,h=u.disable,d=u.pressAction,f=u.disablePress;if(c===e){if(!(h||r&&f)){var p=r&&d||l;typeof p=="function"?l(t,this.player,r):typeof p=="string"&&typeof this[p]=="function"&&this[p](t,this.player,r),this.emit(ih,Ye({key:s[a],target:t.target,isPress:r},this.keyCodeMap[s[a]]))}(o=t).preventDefault(),o.returnValue=!1,t.stopPropagation();break}}}},{key:"destroy",value:function(){this.player.root.removeEventListener("keydown",this.onKeydown),document.removeEventListener("keydown",this.onBodyKeyDown),this.player.root.removeEventListener("keyup",this.onKeyup),document.removeEventListener("keyup",this.onBodyKeyUp)}},{key:"disable",value:function(){this.config.disable=!0}},{key:"enable",value:function(){this.config.disable=!1}}],[{key:"pluginName",get:function(){return"keyboard"}},{key:"defaultConfig",get:function(){return{seekStep:10,checkVisible:!1,disableBodyTrigger:!1,disableRootTrigger:!1,isGlobalTrigger:!0,keyCodeMap:{},disable:!1,playbackRate:2,isIgnoreUserActive:!0}}}]),n}();function Op(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="-5 -5 110 110">
  <path d="M100,50A50,50,0,1,1,50,0" stroke-width="5" stroke="#ddd" stroke-dasharray="236" fill="none"></path>
</svg>
`,"image/svg+xml").firstChild}var Ip=function(){ye(n,Me);var i=_e(n);function n(){return fe(this,n),i.apply(this,arguments)}return pe(n,[{key:"registerIcons",value:function(){return{loadingIcon:Op}}},{key:"afterCreate",value:function(){this.appendChild("xg-loading-inner",this.icons.loadingIcon)}},{key:"render",value:function(){return`
    <xg-loading class="xgplayer-loading">
      <xg-loading-inner></xg-loading-inner>
    </xg-loading>`}}],[{key:"pluginName",get:function(){return"loading"}},{key:"defaultConfig",get:function(){return{position:Ve.ROOT}}}]),n}(),Rp=[{tag:"xg-cache",className:"xgplayer-progress-cache",styleKey:"cachedColor"},{tag:"xg-played",className:"xgplayer-progress-played",styleKey:"playedColor"}],Ap=function(){function i(n){fe(this,i),this.fragments=n.fragments||[],this.fragments.length===0&&this.fragments.push({percent:1}),this._callBack=n.actionCallback,this.fragConfig={fragFocusClass:n.fragFocusClass||"inner-focus-point",fragAutoFocus:!!n.fragAutoFocus,fragClass:n.fragClass||""},this.style=n.style||{playedColor:"",cachedColor:"",progressColor:""},this.duration=0,this.cachedIndex=0,this.playedIndex=0,this.focusIndex=-1}return pe(i,[{key:"updateDuration",value:function(n){var e=this;this.duration=n;var t=0,r=this.fragments;this.fragments=r.map(function(o){return o.start=parseInt(t,10),o.end=parseInt(t+o.percent*e.duration,10),o.duration=parseInt(o.percent*e.duration,10),t+=o.percent*e.duration,o})}},{key:"updateProgress",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"played",e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{newIndex:0,curIndex:0,millisecond:0},t=this.progressList,r=this.fragments;if(!(t.length<1)){var o=e.newIndex,s=e.curIndex,a=e.millisecond;o!==s&&t.map(function(c,h){h<o?c[n].style.width="100%":h>o&&(c[n].style.width=0)});var u=r[o],l=a===0?0:(a-u.start)/u.duration;t[o][n].style.width=l<0?0:"".concat(100*l,"%")}}},{key:"updateFocus",value:function(n){if(this.fragConfig.fragAutoFocus&&!(this.fragments.length<2)){if(n){var e=this.findIndex(1e3*n.currentTime,this.focusIndex);if(e>=0&&e!==this.focusIndex){this.focusIndex>-1&&this.unHightLight(this.focusIndex),this.setHightLight(e);var t={index:e,preIndex:this.focusIndex,fragment:this.fragments[this.focusIndex]};this.focusIndex=e,this._callBack&&this._callBack(t)}}else if(this.focusIndex>-1){this.unHightLight(this.focusIndex);var r={index:-1,preIndex:this.focusIndex,fragment:null};this._callBack&&this._callBack(r),this.focusIndex=-1}}}},{key:"update",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{cached:0,played:0},e=arguments.length>1?arguments[1]:void 0;if(!this.duration||parseInt(1e3*e,10)!==this.duration){if(!e&&e!==0)return;this.updateDuration(parseInt(1e3*e,10))}var t=this.playedIndex,r=this.cachedIndex;if(g.typeOf(n.played)!=="Undefined"){var o=this.findIndex(1e3*n.played,t);if(o<0)return;this.updateProgress("played",{newIndex:o,curIndex:t,millisecond:parseInt(1e3*n.played,10)}),this.playedIndex=o}if(g.typeOf(n.cached)!=="Undefined"){var s=this.findIndex(1e3*n.cached,r);if(s<0)return;this.updateProgress("cached",{newIndex:s,curIndex:r,millisecond:parseInt(1e3*n.cached,10)}),this.cachedIndex=s}}},{key:"findIndex",value:function(n,e){var t=this.fragments;if(!t||t.length===0)return-1;if(t.length===1)return 0;if(e>-1&&e<t.length&&n>t[e].start&&n<t[e].end)return e;if(n>t[t.length-1].start)return t.length-1;for(var r=0;r<t.length;r++)if(n>t[r].start&&n<=t[r].end){e=r;break}return e}},{key:"findHightLight",value:function(){for(var n=this.root.children,e=0;e<n.length;e++)if(g.hasClass(n[e],this.fragConfig.fragFocusClass))return{dom:n[e],pos:n[e].getBoundingClientRect()}}},{key:"findFragment",value:function(n){var e=this.root.children;return n<0||n>=e.length?null:{dom:e[n],pos:e[n].getBoundingClientRect()}}},{key:"unHightLight",value:function(){for(var n=this.root.children,e=0;e<n.length;e++)g.removeClass(n[e],this.fragConfig.fragFocusClass)}},{key:"setHightLight",value:function(n){var e=this.root.children;if(n<e.length)return g.addClass(e[n],this.fragConfig.fragFocusClass),{dom:e[n],pos:e[n].getBoundingClientRect()}}},{key:"destroy",value:function(){this.progressList=null,this.fragments=null,this.root.innerHTML=""}},{key:"reset",value:function(n){var e=this;if(Object.keys(this.fragConfig).forEach(function(r){n[r]!==void 0&&(e.fragConfig[r]=n[r])}),n.fragments){if(this.fragments=n.fragments.length===0?[{percent:1}]:n.fragments,this.updateDuration(this.duration),this.playedIndex=0,this.cachedIndex=0,this.root)for(var t=this.root.children;t.length>0;)this.root.removeChild(t[0]);this.render()}}},{key:"render",value:function(){var n=this,e=this.style.progressColor;if(this.root||(this.root=g.createDom("xg-inners","",{},"progress-list")),this.fragments){var t=this.fragConfig,r=t.fragClass,o=t.fragFocusClass;this.progressList=this.fragments.map(function(s){var a=g.createDom("xg-inner","",{style:e?"background:".concat(e,"; flex: ").concat(s.percent):"flex: ".concat(s.percent)},"".concat(s.isFocus?o:""," xgplayer-progress-inner ").concat(r));return n.root.appendChild(a),Rp.forEach(function(u){a.appendChild(g.createDom(u.tag,"",{style:u.styleKey?"background: ".concat(n.style[u.styleKey],"; width:0;"):"width:0;"},u.className))}),{cached:a.children[0],played:a.children[1]}})}return this.root}}]),i}(),Nu={POINT:"inner-focus-point",HIGHLIGHT:"inner-focus-highlight"},Dp=function(){ye(n,Me);var i=_e(n);function n(e){var t;return fe(this,n),j(O(t=i.call(this,e)),"onMoveOnly",function(r,o){var s=O(t),a=s.pos,u=s.config,l=s.player,c=o;if(r){g.event(r);var h=g.getEventPos(r,l.zoom),d=l.rotateDeg===90?h.clientY:h.clientX;if(a.moving&&Math.abs(a.x-d)<u.miniMoveStep)return;a.moving=!0,a.x=d,c=t.computeTime(r,d)}t.triggerCallbacks("dragmove",c,r),t._updateInnerFocus(c)}),j(O(t),"onBodyClick",function(r){t.pos.isLocked&&(t.pos.isLocked=!1,r.preventDefault(),r.stopPropagation())}),j(O(t),"_mouseDownHandler",function(r,o){t._state.time=o.currentTime,t.updateWidth(o.currentTime,o.seekTime,o.percent,0),t._updateInnerFocus(o)}),j(O(t),"_mouseUpHandler",function(r,o){O(t).pos.moving&&t.updateWidth(o.currentTime,o.seekTime,o.percent,2)}),j(O(t),"_mouseMoveHandler",function(r,o){var s=O(t),a=s._state,u=s.pos,l=s.config,c=s.player;a.time<o.currentTime?o.forward=!0:o.forward=!1,a.time=o.currentTime,u.isDown&&!u.moving&&(u.moving=!0,l.isPauseMoving&&c.pause(),t.triggerCallbacks("dragstart",o,r),t.emitUserAction("drag","dragstart",o)),t.updateWidth(o.currentTime,o.seekTime,o.percent,1),t.triggerCallbacks("dragmove",o,r),t._updateInnerFocus(o)}),j(O(t),"onMouseDown",function(r){var o=O(t),s=o._state,a=o.player,u=o.pos,l=o.config,c=o.playerConfig,h=g.getEventPos(r,a.zoom),d=a.rotateDeg===90?h.clientY:h.clientX;if(!(a.isMini||l.closeMoveSeek||!c.allowSeekAfterEnded&&a.ended)){if(a.duration||a.isPlaying){r.stopPropagation(),t.focus(),g.checkIsFunction(c.disableSwipeHandler)&&c.disableSwipeHandler(),g.checkIsFunction(l.onMoveStart)&&l.onMoveStart(),g.event(r),u.x=d,u.isDown=!0,u.moving=!1,s.prePlayTime=a.currentTime,a.focus({autoHide:!1}),t.isProgressMoving=!0,g.addClass(t.progressBtn,"active");var f=t.computeTime(r,d);return f.prePlayTime=s.prePlayTime,t._mouseDownHandlerHook(r,f),r.type==="touchstart"?(t.root.addEventListener("touchmove",t.onMouseMove),t.root.addEventListener("touchend",t.onMouseUp),t.root.addEventListener("touchcancel",t.onMouseUp)):(t.unbind("mousemove",t.onMoveOnly),document.addEventListener("mousemove",t.onMouseMove,!1),document.addEventListener("mouseup",t.onMouseUp,!1)),!0}a.play()}}),j(O(t),"onMouseUp",function(r){var o=O(t),s=o.player,a=o.config,u=o.pos,l=o.playerConfig,c=o._state;r.stopPropagation(),r.preventDefault(),g.checkIsFunction(l.enableSwipeHandler)&&l.enableSwipeHandler(),g.checkIsFunction(a.onMoveEnd)&&a.onMoveEnd(),g.event(r),g.removeClass(t.progressBtn,"active");var h=t.computeTime(r,u.x);h.prePlayTime=c.prePlayTime,u.moving?(t.triggerCallbacks("dragend",h,r),t.emitUserAction("drag","dragend",h)):(t.triggerCallbacks("click",h,r),t.emitUserAction("click","click",h)),t._mouseUpHandlerHook(r,h),u.moving=!1,u.isDown=!1,u.x=0,u.y=0,u.isLocked=!0,c.prePlayTime=0,c.time=0;var d=r.type;d==="touchend"||d==="touchcancel"?(t.root.removeEventListener("touchmove",t.onMouseMove),t.root.removeEventListener("touchend",t.onMouseUp),t.root.removeEventListener("touchcancel",t.onMouseUp),t.blur()):(document.removeEventListener("mousemove",t.onMouseMove,!1),document.removeEventListener("mouseup",t.onMouseUp,!1),u.isEnter?l.isMobileSimulateMode!=="mobile"&&t.bind("mousemove",t.onMoveOnly):t.onMouseLeave(r)),g.setTimeout(O(t),function(){t.resetSeekState()},10),s.focus()}),j(O(t),"onMouseMove",function(r){var o=O(t),s=o._state,a=o.pos,u=o.player,l=o.config;g.checkTouchSupport()&&r.preventDefault(),g.event(r);var c=g.getEventPos(r,u.zoom),h=u.rotateDeg===90?c.clientY:c.clientX,d=Math.abs(a.x-h);if(!(a.moving&&d<l.miniMoveStep||!a.moving&&d<l.miniStartStep)){a.x=h;var f=t.computeTime(r,h);f.prePlayTime=s.prePlayTime,t._mouseMoveHandlerHook(r,f)}}),j(O(t),"onMouseOut",function(r){t.triggerCallbacks("mouseout",null,r)}),j(O(t),"onMouseOver",function(r){t.triggerCallbacks("mouseover",null,r)}),j(O(t),"onMouseEnter",function(r){var o=O(t),s=o.player,a=o.pos;if(!(a.isDown||a.isEnter||s.isMini||!s.config.allowSeekAfterEnded&&s.ended)){a.isEnter=!0,t.bind("mousemove",t.onMoveOnly),t.bind("mouseleave",t.onMouseLeave),g.event(r);var u=g.getEventPos(r,s.zoom),l=s.rotateDeg===90?u.clientY:u.clientX,c=t.computeTime(r,l);t.triggerCallbacks("mouseenter",c,r),t.focus()}}),j(O(t),"onMouseLeave",function(r){t.triggerCallbacks("mouseleave",null,r),t.unlock(),t._updateInnerFocus(null)}),j(O(t),"onVideoResize",function(){var r=t.pos,o=r.x,s=r.isDown;if(r.isEnter&&!s){var a=t.computeTime(null,o);t.onMoveOnly(null,a)}}),t.useable=!1,t.isProgressMoving=!1,t.__dragCallBacks=[],t._state={now:-1,direc:0,time:0,prePlayTime:-1},t._disableBlur=!1,t}return pe(n,[{key:"offsetDuration",get:function(){return this.playerConfig.customDuration||this.player.offsetDuration||this.player.duration}},{key:"duration",get:function(){return this.playerConfig.customDuration||this.player.duration}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"currentTime",get:function(){var e=this.player,t=e.offsetCurrentTime,r=e.currentTime;return t>=0?t:r+this.timeOffset}},{key:"changeState",value:function(){var e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];this.useable=e}},{key:"show",value:function(e){this.root&&(this.root.style.display="flex")}},{key:"_initInner",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};t&&t.length!==0||(t=[{percent:1}]);var o=Ye(Ye({fragments:t},r),{},{actionCallback:function(s){e.emitUserAction("fragment_focus","fragment_focus",s)}});this.innerList?this.innerList.reset(o):(this.innerList=new Ap(o),this.outer.insertBefore(this.innerList.render(),this.outer.children[0]),["findHightLight","unHightLight","setHightLight","findFragment"].map(function(s){e[s]=e.innerList[s].bind(e.innerList)}))}},{key:"_updateInnerFocus",value:function(e){this.innerList&&this.innerList.updateFocus(e)}},{key:"afterCreate",value:function(){var e=this;if(!this.config.disable&&!this.playerConfig.isLive){this.pos={x:0,y:0,moving:!1,isDown:!1,isEnter:!1,isLocked:!1},this.outer=this.find("xg-outer");var t=this.config,r=t.fragFocusClass,o=t.fragAutoFocus,s=t.fragClass;this._initInner(this.config.fragments,{fragFocusClass:r,fragAutoFocus:o,fragClass:s,style:this.playerConfig.commonStyle||{}}),Pe.device==="mobile"&&(this.config.isDragingSeek=!1,this.isMobile=!0),this.progressBtn=this.find(".xgplayer-progress-btn"),this.on(Pn,function(){e.onMouseLeave()}),this.on(xt,function(){e.onTimeupdate()}),this.on(un,function(){e.onTimeupdate(),e.onCacheUpdate()}),this.on($c,function(){e.onCacheUpdate()}),this.on($n,function(){e.onCacheUpdate(!0),e.onTimeupdate(!0),e._state.now=0}),this.on(Xn,function(){e.onReset()}),this.on(Ln,function(){e.onVideoResize()}),this.bindDomEvents(),this.initCustomStyle()}}},{key:"setConfig",value:function(e){var t=this,r=null;Object.keys(e).forEach(function(o){t.config[o]=e[o],o==="fragments"&&(r=e[o])}),r&&this._initInner(r,e)}},{key:"initCustomStyle",value:function(){var e=(this.playerConfig||{}).commonStyle.sliderBtnStyle,t=this.progressBtn;e&&(typeof e=="string"?t.style.boxShadow=e:pt(e)==="object"&&Object.keys(e).map(function(r){t.style[r]=e[r]}))}},{key:"triggerCallbacks",value:function(e,t,r){this.__dragCallBacks.length>0&&this.__dragCallBacks.map(function(o){if(o&&o.handler&&o.type===e)try{o.handler(t,r)}catch{}})}},{key:"addCallBack",value:function(e,t){t&&typeof t=="function"&&this.__dragCallBacks.push({type:e,handler:t})}},{key:"removeCallBack",value:function(e,t){var r=this.__dragCallBacks,o=-1;r.map(function(s,a){s&&s.type===e&&s.handler===t&&(o=a)}),o>-1&&r.splice(o,1)}},{key:"unlock",value:function(){var e=this.player,t=this.pos;t.isEnter=!1,t.isLocked=!1,e.isMini||(this.unbind("mousemove",this.onMoveOnly),t.isDown?this.unbind("mouseleave",this.onMouseLeave):this.blur())}},{key:"bindDomEvents",value:function(){var e=this.player,t=e.controls,r=e.config;this._mouseDownHandlerHook=this.hook("dragstart",this._mouseDownHandler),this._mouseUpHandlerHook=this.hook("dragend",this._mouseUpHandler),this._mouseMoveHandlerHook=this.hook("drag",this._mouseMoveHandler),this.domEventType!=="touch"&&this.domEventType!=="compatible"||(this.root.addEventListener("touchstart",this.onMouseDown),t&&(t.root&&t.root.addEventListener("touchmove",g.stopPropagation),t.center&&t.center.addEventListener("touchend",g.stopPropagation))),this.domEventType!=="mouse"&&this.domEventType!=="compatible"||(this.bind("mousedown",this.onMouseDown),r.isMobileSimulateMode!=="mobile"&&this.bind("mouseenter",this.onMouseEnter),this.bind("mouseover",this.onMouseOver),this.bind("mouseout",this.onMouseOut),this.player.root.addEventListener("click",this.onBodyClick,!0))}},{key:"focus",value:function(){this.player.controls.pauseAutoHide(),g.addClass(this.root,"active")}},{key:"blur",value:function(){this._disableBlur||(this.player.controls.recoverAutoHide(),g.removeClass(this.root,"active"))}},{key:"disableBlur",value:function(){this._disableBlur=!0}},{key:"enableBlur",value:function(){this._disableBlur=!1}},{key:"updateWidth",value:function(e,t,r,o){var s=this.config,a=this.player;if(!s.isCloseClickSeek||o!==0){var u=t=t>=a.duration?a.duration-s.endedDiff:Number(t).toFixed(1);this.updatePercent(r),this.updateTime(e),(o!==1||s.isDragingSeek&&a.config.mediaType!=="audio")&&(this._state.now=u,this._state.direc=u>a.currentTime?0:1,a.seek(u))}}},{key:"computeTime",value:function(e,t){var r,o,s=this.player,a=this.root.getBoundingClientRect(),u=a.width,l=a.height,c=a.top,h=a.left,d=t;s.rotateDeg===90?(r=l,o=c):(r=u,o=h);var f=d-o,p=(f=f>r?r:f<0?0:f)/r;p=p<0?0:p>1?1:p;var m=parseInt(p*this.offsetDuration*1e3,10)/1e3;return{percent:p,currentTime:m,seekTime:g.getCurrentTimeByOffset(m,s.timeSegments),offset:f,width:r,left:o,e}}},{key:"updateTime",value:function(e){var t=this.player,r=this.duration;e>r?e=r:e<0&&(e=0);var o=t.plugins.time;o&&o.updateTime(e)}},{key:"resetSeekState",value:function(){this.isProgressMoving=!1;var e=this.player.plugins.time;e&&e.resetActive()}},{key:"updatePercent",value:function(e,t){if(this.isProgressMoving=!0,!this.config.disable){e=e>1?1:e<0?0:e,this.progressBtn.style.left="".concat(100*e,"%"),this.innerList.update({played:e*this.offsetDuration},this.offsetDuration);var r=this.player.plugins.miniprogress;r&&r.update({played:e*this.offsetDuration},this.offsetDuration)}}},{key:"onTimeupdate",value:function(e){var t=this.player,r=this._state,o=this.offsetDuration;if(!(t.isSeeking&&t.media.seeking||this.isProgressMoving)&&t.hasStart){if(r.now>-1){var s=parseInt(1e3*r.now,10)-parseInt(1e3*t.currentTime,10);if(r.direc===0&&s>300||r.direc===1&&s>-300)return void(r.now=-1);r.now=-1}var a=this.currentTime;a=g.adjustTimeByDuration(a,o,e),this.innerList.update({played:a},o),this.progressBtn.style.left="".concat(a/o*100,"%")}}},{key:"onCacheUpdate",value:function(e){var t=this.player,r=this.duration;if(t){var o=t.bufferedPoint.end;o=g.adjustTimeByDuration(o,r,e),this.innerList.update({cached:o},r)}}},{key:"onReset",value:function(){this.innerList.update({played:0,cached:0},0),this.progressBtn.style.left="0%"}},{key:"destroy",value:function(){var e=this.player,t=e.controls;this.thumbnailPlugin=null,this.innerList.destroy(),this.innerList=null;var r=this.domEventType;r!=="touch"&&r!=="compatible"||(this.root.removeEventListener("touchstart",this.onMouseDown),this.root.removeEventListener("touchmove",this.onMouseMove),this.root.removeEventListener("touchend",this.onMouseUp),this.root.removeEventListener("touchcancel",this.onMouseUp),t&&(t.root&&t.root.removeEventListener("touchmove",g.stopPropagation),t.center&&t.center.removeEventListener("touchend",g.stopPropagation))),r!=="mouse"&&r!=="compatible"||(this.unbind("mousedown",this.onMouseDown),this.unbind("mouseenter",this.onMouseEnter),this.unbind("mousemove",this.onMoveOnly),this.unbind("mouseleave",this.onMouseLeave),document.removeEventListener("mousemove",this.onMouseMove,!1),document.removeEventListener("mouseup",this.onMouseUp,!1),e.root.removeEventListener("click",this.onBodyClick,!0))}},{key:"render",value:function(){if(!this.config.disable&&!this.playerConfig.isLive){var e=this.player.controls?this.player.controls.config.mode:"";return`
    <xg-progress class="xgplayer-progress `.concat(e==="bottom"?"xgplayer-progress-bottom":"",`">
      <xg-outer class="xgplayer-progress-outer">
        <xg-progress-btn class="xgplayer-progress-btn"></xg-progress-btn>
      </xg-outer>
    </xg-progress>
    `)}}}],[{key:"pluginName",get:function(){return"progress"}},{key:"defaultConfig",get:function(){return{position:Ve.CONTROLS_CENTER,index:0,disable:!1,isDragingSeek:!0,closeMoveSeek:!1,isPauseMoving:!1,isCloseClickSeek:!1,fragments:[{percent:1}],fragFocusClass:Nu.POINT,fragClass:"",fragAutoFocus:!1,miniMoveStep:5,miniStartStep:2,onMoveStart:function(){},onMoveEnd:function(){},endedDiff:.2}}},{key:"FRAGMENT_FOCUS_CLASS",get:function(){return Nu}}]),n}(),Jn=function(){ye(n,Me);var i=_e(n);function n(){var e;fe(this,n);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return j(O(e=i.call.apply(i,[this].concat(r))),"_onMouseenter",function(s){e.emit("icon_mouseenter",{pluginName:e.pluginName})}),j(O(e),"_onMouseLeave",function(s){e.emit("icon_mouseleave",{pluginName:e.pluginName})}),e}return pe(n,[{key:"afterCreate",value:function(){this.bind("mouseenter",this._onMouseenter),this.bind("mouseleave",this._onMouseLeave),this.config.disable&&this.disable()}},{key:"destroy",value:function(){this.unbind("mouseenter",this._onMouseenter),this.unbind("mouseleave",this._onMouseLeave)}}]),n}(),Mp=function(){ye(n,Jn);var i=_e(n);function n(){return fe(this,n),i.apply(this,arguments)}return pe(n,[{key:"afterCreate",value:function(){var e=this;Ce(we(n.prototype),"afterCreate",this).call(this);var t=this.player;this.config.disable||(this.initIcons(),this.btnClick=this.btnClick.bind(this),this.bind(["touchend","click"],this.btnClick),this.on([_i,Qi,Xn],function(){e.animate(t.paused)}),this.on(St,function(){e.animate(t.paused)}),this.animate(!0))}},{key:"registerIcons",value:function(){return{play:{icon:ta,class:"xg-icon-play"},pause:{icon:na,class:"xg-icon-pause"}}}},{key:"btnClick",value:function(e){e.preventDefault(),e.stopPropagation();var t=this.player;return this.emitUserAction(e,"switch_play_pause",{prop:"paused",from:t.paused,to:!t.paused}),t.ended?t.replay():t.paused?(t.play(),this.animate(!1)):(t.pause(),this.animate(!0)),!1}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.play),this.appendChild(".xgplayer-icon",e.pause)}},{key:"animate",value:function(e){if(this.player){var t=this.i18nKeys,r=this.find(".xg-tips");e?(this.setAttr("data-state","pause"),r&&this.changeLangTextKey(r,t.PLAY_TIPS)):(this.setAttr("data-state","play"),r&&this.changeLangTextKey(r,t.PAUSE_TIPS))}}},{key:"destroy",value:function(){Ce(we(n.prototype),"destroy",this).call(this),this.unbind(["touchend","click"],this.btnClick)}},{key:"render",value:function(){if(!this.config.disable)return`<xg-icon class="xgplayer-play">
    <div class="xgplayer-icon">
    </div>
    `.concat(In(this,"PLAY_TIPS",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"play"}},{key:"defaultConfig",get:function(){return{position:Ve.CONTROLS_LEFT,index:0,disable:!1}}}]),n}();function Np(){return new DOMParser().parseFromString(`<svg width="32px" height="40px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <path d="M11.2374369,14 L17.6187184,7.61871843 C17.9604272,7.27700968 17.9604272,6.72299032 17.6187184,6.38128157 C17.2770097,6.03957281 16.7229903,6.03957281 16.3812816,6.38128157 L9.38128157,13.3812816 C9.03957281,13.7229903 9.03957281,14.2770097 9.38128157,14.6187184 L16.3812816,21.6187184 C16.7229903,21.9604272 17.2770097,21.9604272 17.6187184,21.6187184 C17.9604272,21.2770097 17.9604272,20.7229903 17.6187184,20.3812816 L11.2374369,14 L11.2374369,14 Z" fill="#FFFFFF"></path>
    </g>
</svg>`,"image/svg+xml").firstChild}var Fp=function(){ye(n,Me);var i=_e(n);function n(){return fe(this,n),i.apply(this,arguments)}return pe(n,[{key:"afterCreate",value:function(){var e=this;this.initIcons(),this.onClick=function(t){t.preventDefault(),t.stopPropagation(),e.config.onClick(t)},this.bind(["click","touchend"],this.onClick)}},{key:"registerIcons",value:function(){return{screenBack:{icon:Np,class:"xg-fullscreen-back"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(this.root,e.screenBack)}},{key:"show",value:function(){g.addClass(this.root,"show")}},{key:"hide",value:function(){g.removeClass(this.root,"show")}},{key:"render",value:function(){return`<xg-icon class="xgplayer-back">
    </xg-icon>`}}],[{key:"pluginName",get:function(){return"topbackicon"}},{key:"defaultConfig",get:function(){return{position:Ve.ROOT_TOP,index:0}}}]),n}();function Bp(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="2 -4 28 40">
  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M598 214h212v212h-84v-128h-128v-84zM726 726v-128h84v212h-212v-84h128zM214 426v-212h212v84h-128v128h-84zM298 598v128h128v84h-212v-212h84z"></path>
</svg>
`,"image/svg+xml").firstChild}function Up(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="2 -4 28 40">
  <path fill="#fff" transform="scale(0.0320625 0.0320625)" d="M682 342h128v84h-212v-212h84v128zM598 810v-212h212v84h-128v128h-84zM342 342v-128h84v212h-212v-84h128zM214 682v-84h212v212h-84v-128h-128z"></path>
</svg>
`,"image/svg+xml").firstChild}var jp=function(){ye(n,Jn);var i=_e(n);function n(){var e;fe(this,n);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return j(O(e=i.call.apply(i,[this].concat(r))),"_onOrientationChange",function(s){e.player.fullscreen&&e.config.rotateFullscreen&&(window.orientation===90||window.orientation===-90?e.player.setRotateDeg(0):e.player.setRotateDeg(90))}),e}return pe(n,[{key:"afterCreate",value:function(){var e=this;Ce(we(n.prototype),"afterCreate",this).call(this);var t=this.config,r=this.playerConfig;if(!t.disable){t.target&&(this.playerConfig.fullscreenTarget=this.config.target);var o=g.getFullScreenEl();r.fullscreenTarget===o&&this.player.getFullscreen().catch(function(s){}),this.initIcons(),this.handleFullscreen=this.hook("fullscreenChange",this.toggleFullScreen,{pre:function(s){var a=e.player.fullscreen;e.emitUserAction(s,"switch_fullscreen",{prop:"fullscreen",from:a,to:!a})}}),this.bind(".xgplayer-fullscreen",["touchend","click"],this.handleFullscreen),this.on(Zt,function(s){var a=e.find(".xg-tips");a&&e.changeLangTextKey(a,s?e.i18nKeys.EXITFULLSCREEN_TIPS:e.i18nKeys.FULLSCREEN_TIPS),e.animate(s)}),this.config.needBackIcon&&(this.topBackIcon=this.player.registerPlugin({plugin:Fp,options:{config:{onClick:function(s){e.handleFullscreen(s)}}}})),Pe.device==="mobile"&&window.addEventListener("orientationchange",this._onOrientationChange)}}},{key:"registerIcons",value:function(){return{fullscreen:{icon:Bp,class:"xg-get-fullscreen"},exitFullscreen:{icon:Up,class:"xg-exit-fullscreen"}}}},{key:"destroy",value:function(){Ce(we(n.prototype),"destroy",this).call(this),this.unbind(".xgplayer-icon",Pe.device==="mobile"?"touchend":"click",this.handleFullscreen),Pe.device==="mobile"&&window.removeEventListener("orientationchange",this._onOrientationChange)}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.fullscreen),this.appendChild(".xgplayer-icon",e.exitFullscreen)}},{key:"toggleFullScreen",value:function(e){e&&(e.preventDefault(),e.stopPropagation());var t=this.player,r=this.config;r.useCssFullscreen===!0||typeof r.useCssFullscreen=="function"&&r.useCssFullscreen()?(t.fullscreen?t.exitCssFullscreen():t.getCssFullscreen(),this.animate(t.fullscreen)):r.rotateFullscreen?(t.fullscreen?t.exitRotateFullscreen():t.getRotateFullscreen(),this.animate(t.fullscreen)):r.switchCallback&&typeof r.switchCallback=="function"?r.switchCallback(t.fullscreen):t.fullscreen?(t.exitFullscreen(),r.useScreenOrientation&&this.unlockScreen()):(t.getFullscreen().catch(function(o){}),r.useScreenOrientation&&t.aspectRatio>1&&this.lockScreen(r.lockOrientationType))}},{key:"animate",value:function(e){e?this.setAttr("data-state","full"):this.setAttr("data-state","normal"),this.topBackIcon&&(e?(this.topBackIcon.show(),this.hide()):(this.topBackIcon.hide(),this.show()))}},{key:"render",value:function(){if(!this.config.disable)return`<xg-icon class="xgplayer-fullscreen">
    <div class="xgplayer-icon">
    </div>
    `.concat(In(this,"FULLSCREEN_TIPS",this.playerConfig.isHideTips),`
    </xg-icon>`)}},{key:"lockScreen",value:function(e){try{screen.orientation.lock(e).catch(function(t){})}catch{}}},{key:"unlockScreen",value:function(){try{screen.orientation.unlock().catch(function(e){})}catch{}}}],[{key:"pluginName",get:function(){return"fullscreen"}},{key:"defaultConfig",get:function(){return{position:Ve.CONTROLS_RIGHT,index:0,useCssFullscreen:!1,rotateFullscreen:!1,useScreenOrientation:!1,lockOrientationType:"landscape",switchCallback:null,target:null,disable:!1,needBackIcon:!1}}}]),n}(),Hp=function(){ye(n,Me);var i=_e(n);function n(e){var t;return fe(this,n),(t=i.call(this,e)).isActiving=!1,t}return pe(n,[{key:"duration",get:function(){var e=this.player,t=e.offsetDuration,r=e.duration;return this.playerConfig.customDuration||t||r}},{key:"currentTime",get:function(){var e=this.player,t=e.offsetCurrentTime,r=e.currentTime;return t>=0?t:r}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"afterCreate",value:function(){var e=this,t=this.player.controls.config.mode;this.mode=t==="flex"?"flex":"normal",this.config.disable||(this.mode==="flex"&&(this.createCenterTime(),this.root.style.display="none"),this.durationDom=this.find(".time-duration"),this.timeDom=this.find(".time-current"),this.on([Pn,un,xt],function(r){r.eventName==="durationchange"&&(e.isActiving=!1),e.onTimeUpdate()}),this.on($n,function(){e.onTimeUpdate(!0)}),this.on(Xn,function(){e.onReset()}))}},{key:"show",value:function(e){if(this.mode==="flex")return this.centerCurDom&&(this.centerCurDom.style.display="block"),void(this.centerDurDom&&(this.centerDurDom.style.display="block"));this.root.style.display="block"}},{key:"hide",value:function(){if(this.mode==="flex")return this.centerCurDom&&(this.centerCurDom.style.display="none"),void(this.centerDurDom&&(this.centerDurDom.style.display="none"));this.root.style.display="none"}},{key:"onTimeUpdate",value:function(e){var t=this.player,r=this.config,o=this.duration;if(!r.disable&&!this.isActiving&&t.hasStart){var s=this.currentTime+this.timeOffset;s=g.adjustTimeByDuration(s,o,e),this.mode==="flex"?(this.centerCurDom.innerHTML=this.minWidthTime(g.format(s)),o!==1/0&&o>0&&(this.centerDurDom.innerHTML=g.format(o))):(this.timeDom.innerHTML=this.minWidthTime(g.format(s)),o!==1/0&&o>0&&(this.durationDom.innerHTML=g.format(o)))}}},{key:"onReset",value:function(){this.mode==="flex"?(this.centerCurDom.innerHTML=this.minWidthTime(g.format(0)),this.centerDurDom.innerHTML=g.format(0)):(this.timeDom.innerHTML=this.minWidthTime(g.format(0)),this.durationDom.innerHTML=g.format(0))}},{key:"createCenterTime",value:function(){var e=this.player;if(e.controls&&e.controls.center){var t=e.controls.center;this.centerCurDom=g.createDom("xg-icon","00:00",{},"xgplayer-time xg-time-left"),this.centerDurDom=g.createDom("xg-icon","00:00",{},"xgplayer-time xg-time-right"),t.children.length>0?t.insertBefore(this.centerCurDom,t.children[0]):t.appendChild(this.centerCurDom),t.appendChild(this.centerDurDom)}}},{key:"afterPlayerInit",value:function(){var e=this.config;this.duration===1/0||this.playerConfig.isLive?(g.hide(this.durationDom),g.hide(this.timeDom),g.hide(this.find(".time-separator")),g.show(this.find(".time-live-tag"))):g.hide(this.find(".time-live-tag")),e.hide?this.hide():this.show()}},{key:"changeLiveState",value:function(e){e?(g.hide(this.durationDom),g.hide(this.timeDom),g.hide(this.find(".time-separator")),g.show(this.find(".time-live-tag"))):(g.hide(this.find(".time-live-tag")),g.show(this.find(".time-separator")),g.show(this.durationDom),g.show(this.timeDom))}},{key:"updateTime",value:function(e){this.isActiving=!0,!e&&e!==0||e>this.duration||(this.mode!=="flex"?this.timeDom.innerHTML=this.minWidthTime(g.format(e)):this.centerCurDom.innerHTML=this.minWidthTime(g.format(e)))}},{key:"minWidthTime",value:function(e){return e.split(":").map(function(t){return'<span class="time-min-width">'.concat(t,"</span>")}).join(":")}},{key:"resetActive",value:function(){var e=this,t=this.player,r=function(){e.isActiving=!1};this.off(un,r),t.isSeeking&&t.media.seeking?this.once(un,r):this.isActiving=!1}},{key:"destroy",value:function(){var e=this.player.controls.center;this.centerCurDom&&e.removeChild(this.centerCurDom),this.centerCurDom=null,this.centerDurDom&&e.removeChild(this.centerDurDom),this.centerDurDom=null}},{key:"render",value:function(){if(!this.config.disable)return`<xg-icon class="xgplayer-time">
    <span class="time-current">00:00</span>
    <span class="time-separator">/</span>
    <span class="time-duration">00:00</span>
    <span class="time-live-tag">`.concat(this.i18n.LIVE_TIP,`</span>
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"time"}},{key:"defaultConfig",get:function(){return{position:Ve.CONTROLS_LEFT,index:2,disable:!1}}}]),n}(),Vp=function(){ye(n,qt);var i=_e(n);function n(){var e;fe(this,n);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return j(O(e=i.call.apply(i,[this].concat(r))),"_onDurationChange",function(){e.updateSegments();var s=e.player,a=s.currentTime,u=s.timeSegments;if(e._checkIfEnabled(u)){var l=g.getIndexByTime(a,u),c=g.getOffsetCurrentTime(a,u,l);e.player.offsetCurrentTime=c,e.changeIndex(l,u)}}),j(O(e),"_onLoadedData",function(){var s=e.player.timeSegments;if(e._checkIfEnabled(s)){var a=g.getOffsetCurrentTime(0,s);e.player.offsetCurrentTime=a,e.changeIndex(0,s),e.curPos.start>0&&(e.player.currentTime=e.curPos.start)}}),j(O(e),"_onTimeupdate",function(){var s=e.player,a=s.currentTime,u=s.timeSegments;if(e._checkIfEnabled(u)){var l=u.length;e.lastCurrentTime=a;var c=g.getIndexByTime(a,u);c!==e.curIndex&&e.changeIndex(c,u);var h=g.getOffsetCurrentTime(a,u,c);if(e.player.offsetCurrentTime=h,e.curPos){var d=e.curPos,f=d.start,p=d.end;a<f?e.player.currentTime=f:a>p&&c>=l-1&&e.player.pause()}}}),j(O(e),"_onSeeking",function(){var s=e.player,a=s.currentTime,u=s.timeSegments;if(e._checkIfEnabled(u))if(a<u[0].start)e.player.currentTime=u[0].start;else if(a>u[u.length-1].end)e.player.currentTime=u[u.length-1].end;else{var l=g.getIndexByTime(a,u);if(l>=0){var c=e.getSeekTime(a,e.lastCurrentTime,l,u);c>=0&&(e.player.currentTime=c)}}}),j(O(e),"_onPlay",function(){var s=e.player,a=s.currentTime,u=s.timeSegments;e._checkIfEnabled(u)&&a>=u[u.length-1].end&&(e.player.currentTime=u[0].start)}),e}return pe(n,[{key:"afterCreate",value:function(){this.curIndex=-1,this.curPos=null,this.lastCurrentTime=0,this.updateSegments(),this.on(Pn,this._onDurationChange),this.on(cn,this._onLoadedData),this.on(xt,this._onTimeupdate),this.on(jn,this._onSeeking),this.on(St,this._onPlay)}},{key:"setConfig",value:function(e){var t=this;if(e){var r=Object.keys(e);r.length<1||(r.forEach(function(o){t.config[o]=e[o]}),this.updateSegments())}}},{key:"updateSegments",value:function(){var e=this.config,t=e.disable,r=e.segments,o=this.player;if(t||!r||r.length===0)o.timeSegments=[],o.offsetDuration=0,o.offsetCurrentTime=-1;else{var s=this.formatTimeSegments(r,o.duration);o.timeSegments=s,o.offsetDuration=s.length>0?s[s.length-1].duration:0}}},{key:"formatTimeSegments",value:function(e,t){var r=[];return e?(e.sort(function(o,s){return o.start-s.start}),e.forEach(function(o,s){var a={};if(a.start=o.start<0?0:o.start,a.end=t>0&&o.end>t?t:o.end,!(t>0&&a.start>t)){r.push(a);var u=a.end-a.start;if(s===0)a.offset=o.start,a.cTime=0,a.segDuration=u,a.duration=u;else{var l=r[s-1];a.offset=l.offset+(a.start-l.end),a.cTime=l.duration+l.cTime,a.segDuration=u,a.duration=l.duration+u}}}),r):[]}},{key:"getSeekTime",value:function(e,t,r,o){var s=-1,a=o[r],u=a.start,l=a.end;if(e>=u&&e<=l)return s;var c=e-t;if(c<0&&e<u){var h=t>u?t-u:0;return s=r-1>=0?o[r-1].end+c+h:0}return-1}},{key:"_checkIfEnabled",value:function(e){return!(!e||e.length<1)}},{key:"changeIndex",value:function(e,t){this.curIndex=e,e>=0&&t.length>0?this.curPos=t[e]:this.curPos=null}}],[{key:"pluginName",get:function(){return"TimeSegmentsControls"}},{key:"defaultConfig",get:function(){return{disable:!0,segments:[]}}}]),n}();function zp(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="0 -10 28 40">
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M940.632 837.632l-72.192-72.192c65.114-64.745 105.412-154.386 105.412-253.44s-40.299-188.695-105.396-253.424l-0.016-0.016 72.192-72.192c83.639 83.197 135.401 198.37 135.401 325.632s-51.762 242.434-135.381 325.612l-0.020 0.020zM795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021z"></path>
</svg>
`,"image/svg+xml").firstChild}function Wp(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="0 -10 28 40">
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021zM795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021z"></path>
</svg>
`,"image/svg+xml").firstChild}function Gp(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="0 -10 28 40">
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path fill="#fff" transform="scale(0.0220625 0.0220625)" d="M920.4 439.808l-108.544-109.056-72.704 72.704 109.568 108.544-109.056 108.544 72.704 72.704 108.032-109.568 108.544 109.056 72.704-72.704-109.568-108.032 109.056-108.544-72.704-72.704-108.032 109.568z"></path>
</svg>
`,"image/svg+xml").firstChild}var Kp=function(){ye(n,Me);var i=_e(n);function n(){var e;fe(this,n);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return j(O(e=i.call.apply(i,[this].concat(r))),"onBarMousedown",function(s){var a=O(e).player,u=e.find(".xgplayer-bar");g.event(s);var l=u.getBoundingClientRect(),c=g.getEventPos(s,a.zoom),h=l.height-(c.clientY-l.top);if(c.h=h,c.barH=l.height,e.pos=c,!(h<-2))return e.updateVolumePos(h,s),document.addEventListener("mouseup",e.onBarMouseUp),e._d.isStart=!0,!1}),j(O(e),"onBarMouseMove",function(s){var a=O(e)._d;if(a.isStart){var u=O(e),l=u.pos,c=u.player;s.preventDefault(),s.stopPropagation(),g.event(s);var h=g.getEventPos(s,c.zoom);a.isMoving=!0;var d=l.h-h.clientY+l.clientY;d>l.barH||e.updateVolumePos(d,s)}}),j(O(e),"onBarMouseUp",function(s){g.event(s),document.removeEventListener("mouseup",e.onBarMouseUp);var a=O(e)._d;a.isStart=!1,a.isMoving=!1}),j(O(e),"onMouseenter",function(s){e._d.isActive=!0,e.focus(),e.emit("icon_mouseenter",{pluginName:e.pluginName})}),j(O(e),"onMouseleave",function(s){e._d.isActive=!1,e.unFocus(100,!1,s),e.emit("icon_mouseleave",{pluginName:e.pluginName})}),j(O(e),"onVolumeChange",function(s){if(e.player){var a=e.player,u=a.muted,l=a.volume;e._d.isMoving||(e.find(".xgplayer-drag").style.height=u||l===0?"4px":"".concat(100*l,"%"),e.config.showValueLabel&&e.updateVolumeValue()),e.animate(u,l)}}),e}return pe(n,[{key:"registerIcons",value:function(){return{volumeSmall:{icon:Wp,class:"xg-volume-small"},volumeLarge:{icon:zp,class:"xg-volume"},volumeMuted:{icon:Gp,class:"xg-volume-mute"}}}},{key:"afterCreate",value:function(){var e=this;if(this._timerId=null,this._d={isStart:!1,isMoving:!1,isActive:!1},!this.config.disable){this.initIcons();var t=this.playerConfig,r=t.commonStyle,o=t.volume;r.volumeColor&&(this.find(".xgplayer-drag").style.backgroundColor=r.volumeColor),this.changeMutedHandler=this.hook("mutedChange",function(s){e.changeMuted(s)},{pre:function(s){s.preventDefault(),s.stopPropagation()}}),this._onMouseenterHandler=this.hook("mouseenter",this.onMouseenter),this._onMouseleaveHandler=this.hook("mouseleave",this.onMouseleave),Pe.device!=="mobile"&&this.playerConfig.isMobileSimulateMode!=="mobile"&&(this.bind("mouseenter",this._onMouseenterHandler),this.bind(["blur","mouseleave"],this._onMouseleaveHandler),this.bind(".xgplayer-slider","mousedown",this.onBarMousedown),this.bind(".xgplayer-slider","mousemove",this.onBarMouseMove),this.bind(".xgplayer-slider","mouseup",this.onBarMouseUp)),this.bind(".xgplayer-icon",["touchend","click"],this.changeMutedHandler),this.on(qc,this.onVolumeChange),this.once(cn,this.onVolumeChange),g.typeOf(o)!=="Number"&&(this.player.volume=this.config.default),this.onVolumeChange()}}},{key:"updateVolumePos",value:function(e,t){var r=this.player,o=this.find(".xgplayer-drag"),s=this.find(".xgplayer-bar");if(s&&o){var a=parseInt(e/s.getBoundingClientRect().height*1e3,10);o.style.height="".concat(e,"px");var u=Math.max(Math.min(a/1e3,1),0),l={volume:{from:r.volume,to:u}};r.muted&&(l.muted={from:!0,to:!1}),this.emitUserAction(t,"change_volume",{muted:r.muted,volume:r.volume,props:l}),r.volume=Math.max(Math.min(a/1e3,1),0),r.muted&&(r.muted=!1),this.config.showValueLabel&&this.updateVolumeValue()}}},{key:"updateVolumeValue",value:function(){var e=this.player,t=e.volume,r=e.muted,o=this.find(".xgplayer-value-label"),s=Math.max(Math.min(t,1),0);o.innerText=r?0:Math.ceil(100*s)}},{key:"focus",value:function(){this.player.focus({autoHide:!1}),this._timerId&&(g.clearTimeout(this,this._timerId),this._timerId=null),g.addClass(this.root,"slide-show")}},{key:"unFocus",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],o=arguments.length>2?arguments[2]:void 0,s=this._d,a=this.player;s.isActive||(this._timerId&&(g.clearTimeout(this,this._timerId),this._timerId=null),this._timerId=g.setTimeout(this,function(){s.isActive||(r?a.blur():a.focus(),g.removeClass(e.root,"slide-show"),s.isStart&&e.onBarMouseUp(o)),e._timerId=null},t))}},{key:"changeMuted",value:function(e){e&&e.stopPropagation();var t=this.player;this._d.isStart&&this.onBarMouseUp(e),this.emitUserAction(e,"change_muted",{muted:t.muted,volume:t.volume,props:{muted:{from:t.muted,to:!t.muted}}}),t.volume>0&&(t.muted=!t.muted),t.volume<.01&&(t.volume=this.config.miniVolume)}},{key:"animate",value:function(e,t){e||t===0?this.setAttr("data-state","mute"):t<.5&&this.icons.volumeSmall?this.setAttr("data-state","small"):this.setAttr("data-state","normal")}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.volumeSmall),this.appendChild(".xgplayer-icon",e.volumeLarge),this.appendChild(".xgplayer-icon",e.volumeMuted)}},{key:"destroy",value:function(){this._timerId&&(g.clearTimeout(this,this._timerId),this._timerId=null),this.unbind("mouseenter",this.onMouseenter),this.unbind(["blur","mouseleave"],this.onMouseleave),this.unbind(".xgplayer-slider","mousedown",this.onBarMousedown),this.unbind(".xgplayer-slider","mousemove",this.onBarMouseMove),this.unbind(".xgplayer-slider","mouseup",this.onBarMouseUp),document.removeEventListener("mouseup",this.onBarMouseUp),this.unbind(".xgplayer-icon",Pe.device==="mobile"?"touchend":"click",this.changeMutedHandler)}},{key:"render",value:function(){if(!this.config.disable){var e=this.config.default||this.player.volume,t=this.config.showValueLabel;return`
    <xg-icon class="xgplayer-volume" data-state="normal">
      <div class="xgplayer-icon">
      </div>
      <xg-slider class="xgplayer-slider">
        `.concat(t?'<div class="xgplayer-value-label">'.concat(100*e,"</div>"):"",`
        <div class="xgplayer-bar">
          <xg-drag class="xgplayer-drag" style="height: `).concat(100*e,`%"></xg-drag>
        </div>
      </xg-slider>
    </xg-icon>`)}}}],[{key:"pluginName",get:function(){return"volume"}},{key:"defaultConfig",get:function(){return{position:Ve.CONTROLS_RIGHT,index:1,disable:!1,showValueLabel:!1,default:.6,miniVolume:.2}}}]),n}();function qp(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="-4 -6 40 40" fill="none">
  <g clip-path="url(#clip0)">
    <path transform="scale(1.5 1.5)" d="M11.6665 9.16663H4.1665C2.78579 9.16663 1.6665 10.2859 1.6665 11.6666V15.8333C1.6665 17.214 2.78579 18.3333 4.1665 18.3333H11.6665C13.0472 18.3333 14.1665 17.214 14.1665 15.8333V11.6666C14.1665 10.2859 13.0472 9.16663 11.6665 9.16663Z" fill="white"/>
    <path transform="scale(1.5 1.5)" fill-rule="evenodd" clip-rule="evenodd" d="M3.88148 4.06298C3.75371 4.21005 3.67667 4.40231 3.67749 4.61242C3.67847 4.87253 3.79852 5.10435 3.98581 5.25646L6.99111 8.05895C7.32771 8.37283 7.85502 8.35443 8.16891 8.01782C8.48279 7.68122 8.46437 7.15391 8.12778 6.84003L6.62061 5.43457L9.8198 5.4224C9.82848 5.42239 9.8372 5.42221 9.84591 5.4219C10.9714 5.38233 12.0885 5.6285 13.0931 6.13744C14.0976 6.64635 14.957 7.40148 15.5908 8.33234C16.2246 9.2632 16.6122 10.3394 16.7177 11.4606C16.823 12.5819 16.6427 13.7115 16.1934 14.7442C16.0098 15.1661 16.203 15.6571 16.6251 15.8408C17.0471 16.0243 17.5381 15.8311 17.7216 15.4091C18.2833 14.1183 18.5087 12.7063 18.3771 11.3047C18.2453 9.90318 17.7607 8.55792 16.9684 7.39433C16.1761 6.23073 15.1021 5.28683 13.8463 4.65065C12.5946 4.01651 11.203 3.70872 9.80072 3.75583L6.43415 3.76862L7.96326 2.12885C8.27715 1.79225 8.25872 1.26494 7.92213 0.951061C7.58553 0.63718 7.05822 0.655585 6.74433 0.99219L3.90268 4.0395C3.89545 4.04724 3.88841 4.05509 3.88154 4.06303L3.88148 4.06298Z" fill="white"/>
  </g>
  <defs>
    <clipPath id="clip0">
      <rect width="40" height="40" fill="white"/>
    </clipPath>
  </defs>
</svg>
`,"image/svg+xml").firstChild}var Yp=function(){ye(n,Jn);var i=_e(n);function n(e){var t;return fe(this,n),(t=i.call(this,e)).rotateDeg=t.config.rotateDeg||0,t}return pe(n,[{key:"afterCreate",value:function(){var e=this;if(!this.config.disable){Ce(we(n.prototype),"afterCreate",this).call(this),this.appendChild(".xgplayer-icon",this.icons.rotate),this.onBtnClick=this.onBtnClick.bind(this),this.bind(".xgplayer-icon",["click","touchend"],this.onBtnClick),this.on(Ln,function(){e.rotateDeg&&e.config.innerRotate&&g.setTimeout(e,function(){e.updateRotateDeg(e.rotateDeg,e.config.innerRotate)},100)});var t=this.player.root;this.rootWidth=t.style.width||t.offsetWidth||t.clientWidth,this.rootHeight=t.style.height||t.offsetHeight||t.clientHeight,this.rotateDeg&&this.updateRotateDeg(this.rotateDeg,this.config.innerRotate)}}},{key:"destroy",value:function(){Ce(we(n.prototype),"destroy",this).call(this),this.unbind(".xgplayer-icon",["click","touchend"],this.onBtnClick)}},{key:"onBtnClick",value:function(e){e.preventDefault(),e.stopPropagation(),this.emitUserAction(e,"rotate"),this.rotate(this.config.clockwise,this.config.innerRotate,1)}},{key:"updateRotateDeg",value:function(e,t){if(e||(e=0),t)this.player.videoRotateDeg=e;else{var r=this.player,o=this.rootWidth,s=this.rootHeight,a=r.root,u=r.innerContainer,l=r.media,c=a.offsetWidth,h=u&&t?u.offsetHeight:a.offsetHeight,d=o,f=s,p=0,m=0;e!==.75&&e!==.25||(d="".concat(h,"px"),f="".concat(c,"px"),p=-(h-c)/2,m=-(c-h)/2);var v="translate(".concat(p,"px,").concat(m,"px) rotate(").concat(e,"turn)"),y={transformOrigin:"center center",transform:v,webKitTransform:v,height:f,width:d},w=t?l:a,S=t?r.getPlugin("poster"):null;Object.keys(y).map(function(C){w.style[C]=y[C],S&&S.root&&(S.root.style[C]=y[C])})}}},{key:"rotate",value:function(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,o=this.player;this.rotateDeg||(this.rotateDeg=0);var s=e?1:-1;this.rotateDeg=(this.rotateDeg+1+.25*s*r)%1,this.updateRotateDeg(this.rotateDeg,t),o.emit(th,360*this.rotateDeg)}},{key:"registerIcons",value:function(){return{rotate:qp}}},{key:"render",value:function(){if(!this.config.disable)return`
    <xg-icon class="xgplayer-rotate">
      <div class="xgplayer-icon">
      </div>
      `.concat(In(this,"ROTATE_TIPS",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"rotate"}},{key:"defaultConfig",get:function(){return{position:Ve.CONTROLS_RIGHT,index:6,innerRotate:!0,clockwise:!1,rotateDeg:0,disable:!1}}}]),n}();function $p(){return new DOMParser().parseFromString(`<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd"
    d="M16.5 4.3H3.5C3.38954 4.3 3.3 4.38954 3.3 4.5V15.5C3.3 15.6105 3.38954 15.7 3.5 15.7H8.50005L8.50006 17.5H3.5C2.39543 17.5 1.5 16.6046 1.5 15.5V4.5C1.5 3.39543 2.39543 2.5 3.5 2.5H16.5C17.6046 2.5 18.5 3.39543 18.5 4.5V8.5H16.7V4.5C16.7 4.38954 16.6105 4.3 16.5 4.3ZM12 11.5C11.4477 11.5 11 11.9477 11 12.5L11 16.5C11 17.0523 11.4478 17.5 12 17.5H17.5C18.0523 17.5 18.5 17.0523 18.5 16.5L18.5 12.5C18.5 11.9477 18.0523 11.5 17.5 11.5H12Z"
    fill="white" />
</svg>`,"image/svg+xml").firstChild}function Xp(){return new DOMParser().parseFromString(`<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd"
    d="M16.5 4.3H3.5C3.38954 4.3 3.3 4.38954 3.3 4.5V15.5C3.3 15.6105 3.38954 15.7 3.5 15.7H8.50005L8.50006 17.5H3.5C2.39543 17.5 1.5 16.6046 1.5 15.5V4.5C1.5 3.39543 2.39543 2.5 3.5 2.5H16.5C17.6046 2.5 18.5 3.39543 18.5 4.5V8.5H16.7V4.5C16.7 4.38954 16.6105 4.3 16.5 4.3ZM12 11.5C11.4477 11.5 11 11.9477 11 12.5L11 16.5C11 17.0523 11.4478 17.5 12 17.5H17.5C18.0523 17.5 18.5 17.0523 18.5 16.5L18.5 12.5C18.5 11.9477 18.0523 11.5 17.5 11.5H12Z"
    fill="white" />
  <path fill-rule="evenodd" clip-rule="evenodd"
    d="M9.4998 7.7C9.77595 7.7 9.9998 7.47614 9.9998 7.2V6.5C9.9998 6.22386 9.77595 6 9.4998 6H5.5402L5.52754 6.00016H5.5C5.22386 6.00016 5 6.22401 5 6.50016V10.4598C5 10.7359 5.22386 10.9598 5.5 10.9598H6.2C6.47614 10.9598 6.7 10.7359 6.7 10.4598V8.83005L8.76983 10.9386C8.96327 11.1357 9.27984 11.1386 9.47691 10.9451L9.97645 10.4548C10.1735 10.2613 10.1764 9.94476 9.983 9.7477L7.97289 7.7H9.4998Z"
    fill="white" />
</svg>`,"image/svg+xml").firstChild}var Fu="picture-in-picture",Bu="inline",Uu="fullscreen",Jp=function(){ye(n,Jn);var i=_e(n);function n(){var e;fe(this,n);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return j(O(e=i.call.apply(i,[this].concat(r))),"switchPIP",function(s){if(!e.isPIPAvailable())return!1;s.stopPropagation&&s.stopPropagation(),e.isPip?(e.exitPIP(),e.emitUserAction(s,"change_pip",{props:"pip",from:!0,to:!1}),e.setAttr("data-state","normal")):e.player.media.readyState===4&&(e.requestPIP(),e.emitUserAction(s,"change_pip",{props:"pip",from:!1,to:!0}),e.setAttr("data-state","pip"))}),e}return pe(n,[{key:"beforeCreate",value:function(e){typeof e.player.config.pip=="boolean"&&(e.config.showIcon=e.player.config.pip)}},{key:"afterCreate",value:function(){var e=this;this.isPIPAvailable()&&(Ce(we(n.prototype),"afterCreate",this).call(this),this.pMode=Bu,this.initPipEvents(),this.config.showIcon&&this.initIcons(),this.once(io,function(){e.config.showIcon&&(g.removeClass(e.find(".xgplayer-icon"),"xg-icon-disable"),e.bind("click",e.switchPIP))}))}},{key:"registerIcons",value:function(){return{pipIcon:{icon:$p,class:"xg-get-pip"},pipIconExit:{icon:Xp,class:"xg-exit-pip"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".xgplayer-icon",e.pipIcon),this.appendChild(".xgplayer-icon",e.pipIconExit)}},{key:"initPipEvents",value:function(){var e=this,t=this.player;this.leavePIPCallback=function(){var r=t.paused;g.setTimeout(e,function(){!r&&t.mediaPlay()},0),!r&&t.mediaPlay(),e.setAttr("data-state","normal"),e.pipWindow=null,t.emit(ps,!1)},this.enterPIPCallback=function(r){t.emit(ps,!0),r!=null&&r.pictureInPictureWindow&&(e.pipWindow=r.pictureInPictureWindow),e.setAttr("data-state","pip")},this.onWebkitpresentationmodechanged=function(r){var o=t.media.webkitPresentationMode;e.pMode===Uu&&o!==Uu&&t.onFullscreenChange(null,!1),e.pMode=o,o===Fu?e.enterPIPCallback(r):o===Bu&&e.leavePIPCallback(r)},t.media&&(t.media.addEventListener("enterpictureinpicture",this.enterPIPCallback),t.media.addEventListener("leavepictureinpicture",this.leavePIPCallback),n.checkWebkitSetPresentationMode(t.media)&&t.media.addEventListener("webkitpresentationmodechanged",this.onWebkitpresentationmodechanged))}},{key:"copyStyleIntoPiPWindow",value:function(e){var t=Bt(document.styleSheets).map(function(o){try{return Bt(o.cssRules).map(function(a){return a.cssText}).join("")}catch{var s=document.createElement("link");s.rel="stylesheet",s.type=o.type,s.media=o.media,s.href=o.href,e.document.head.appendChild(s)}return""}).filter(Boolean).join(`
`),r=document.createElement("style");r.textContent=t,e.document.head.appendChild(r)}},{key:"requestPIP",value:function(){var e=this,t=this.player,r=this.playerConfig,o=this.config;if(this.isPIPAvailable()&&!this.isPip)try{var s=r.poster;if(s&&(t.media.poster=g.typeOf(s)==="String"?s:s.poster),o.preferDocument&&this.isDocPIPAvailable()){var a={};if(o.width&&o.height)a.width=o.width,a.height=o.height;else{var u=t.root.getBoundingClientRect();a.width=u.width,a.height=u.height}documentPictureInPicture.requestWindow(a).then(function(l){var c=o.docPiPNode,h=o.docPiPStyle;e.enterPIPCallback();var d=c||t.root,f=d.parentElement,p=d.previousSibling,m=d.nextSibling;e.copyStyleIntoPiPWindow(l);var v=document.createElement("style");if(v.append("body{padding:0; margin:0;}"),h){var y="";typeof h=="string"?y=h:typeof h=="function"&&(y=h.call(o)),y&&v.append(y)}else d===t.root&&v.append(`
              .xgplayer{width: 100%!important; height: 100%!important;}
            `);l.document.head.append(v),l.document.body.append(d),l.addEventListener("pagehide",function(w){f&&(m?f.insertBefore(d,m):p?f.insertBefore(d,p.nextSibling):f.appendChild(d)),e.leavePIPCallback()},{once:!0})})}else n.checkWebkitSetPresentationMode(t.media)?t.media.webkitSetPresentationMode("picture-in-picture"):t.media.requestPictureInPicture();return!0}catch{return!1}}},{key:"exitPIP",value:function(){var e=this.player;try{var t;return this.isPIPAvailable()&&this.isPip&&(this.isDocPIPAvailable()&&(t=documentPictureInPicture)!==null&&t!==void 0&&t.window?documentPictureInPicture.window.close():n.checkWebkitSetPresentationMode(e.media)?e.media.webkitSetPresentationMode("inline"):document.exitPictureInPicture()),!0}catch{return!1}}},{key:"isPip",get:function(){var e,t=this.player;return!(!this.isDocPIPAvailable()||(e=documentPictureInPicture)===null||e===void 0||!e.window)||document.pictureInPictureElement&&document.pictureInPictureElement===t.media||t.media.webkitPresentationMode===Fu}},{key:"isPIPAvailable",value:function(){var e=this.player.media;return(g.typeOf(document.pictureInPictureEnabled)!=="Boolean"||document.pictureInPictureEnabled)&&(g.typeOf(e.disablePictureInPicture)==="Boolean"&&!e.disablePictureInPicture||e.webkitSupportsPresentationMode&&g.typeOf(e.webkitSetPresentationMode)==="Function")||this.isDocPIPAvailable()}},{key:"isDocPIPAvailable",value:function(){return"documentPictureInPicture"in window&&/^(https|file)/.test(location.protocol)}},{key:"destroy",value:function(){Ce(we(n.prototype),"destroy",this).call(this);var e=this.player;e.media.removeEventListener("enterpictureinpicture",this.enterPIPCallback),e.media.removeEventListener("leavepictureinpicture",this.leavePIPCallback),n.checkWebkitSetPresentationMode(e.media)&&e.media.removeEventListener("webkitpresentationmodechanged",this.onWebkitpresentationmodechanged),this.exitPIP(),this.unbind("click",this.btnClick)}},{key:"render",value:function(){if(this.config.showIcon&&this.isPIPAvailable())return`<xg-icon class="xgplayer-pip">
      <div class="xgplayer-icon xg-icon-disable">
      </div>
      `.concat(In(this,"PIP",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"pip"}},{key:"defaultConfig",get:function(){return{position:Ve.CONTROLS_RIGHT,index:6,showIcon:!1,preferDocument:!1,width:void 0,height:void 0,docPiPNode:void 0,docPiPStyle:void 0}}},{key:"checkWebkitSetPresentationMode",value:function(e){return typeof e.webkitSetPresentationMode=="function"}}]),n}();function Zp(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="40" viewBox="10 0 24 40">
  <path transform="scale(0.038 0.028)" d="M800 380v768h-128v-352l-320 320v-704l320 320v-352z"></path>
</svg>
`,"image/svg+xml").firstChild}var Qp=function(){ye(n,Me);var i=_e(n);function n(e){var t;return fe(this,n),j(O(t=i.call(this,e)),"playNext",function(r){var o=O(t).player;r.preventDefault(),r.stopPropagation(),t.idx+1<t.config.urlList.length?(t.idx++,t.nextHandler(t.config.urlList[t.idx],t.idx),o.emit(Hr,t.idx+1)):(t.nextHandler(),o.emit(Hr))}),t.idx=-1,t}return pe(n,[{key:"afterCreate",value:function(){this.config.urlList&&this.config.urlList.length!==0&&(this.appendChild(".xgplayer-icon",this.icons.playNext),this.initEvents())}},{key:"registerIcons",value:function(){return{playNext:Zp}}},{key:"initEvents",value:function(){this.nextHandler=this.hook("nextClick",this.changeSrc);var e=Pe.device==="mobile"?"touchend":"click";this.bind(e,this.playNext),this.show()}},{key:"changeSrc",value:function(e){var t=this.player;e&&(t.pause(),t.currentTime=0,t.switchURL?t.switchURL(e):t.src=e,t.config.url=e,t.play())}},{key:"destroy",value:function(){this.unbind(["touchend","click"],this.playNext)}},{key:"render",value:function(){if(this.config.urlList&&this.config.urlList.length!==0)return`
     <xg-icon class="xgplayer-playnext">
      <div class="xgplayer-icon">
      </div>
      `.concat(In(this,"PLAYNEXT_TIPS",this.playerConfig.isHideTips),`
     </xg-icon>
    `)}}],[{key:"pluginName",get:function(){return"playNext"}},{key:"defaultConfig",get:function(){return{position:Ve.CONTROLS_LEFT,index:1,url:null,urlList:[]}}}]),n}(),ph={exports:{}};ph.exports=function i(n,e,t){var r,o,s=window,a="application/octet-stream",u=t||a,l=n,c=!e&&!t&&l,h=document.createElement("a"),d=function(E){return String(E)},f=s.Blob||s.MozBlob||s.WebKitBlob||d,p=e||"download";if(f=f.call?f.bind(s):Blob,String(this)==="true"&&(u=(l=[l,u])[0],l=l[1]),c&&c.length<2048&&(p=c.split("/").pop().split("?")[0],h.href=c,h.href.indexOf(c)!==-1)){var m=new XMLHttpRequest;return m.open("GET",c,!0),m.responseType="blob",m.onload=function(E){i(E.target.response,p,a)},setTimeout(function(){m.send()},0),m}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(l)){if(!(l.length>2096103424e-3&&f!==d))return navigator.msSaveBlob?navigator.msSaveBlob(S(l),p):C(l);u=(l=S(l)).type||a}else if(/([\x80-\xff])/.test(l)){for(var v=0,y=new Uint8Array(l.length),w=y.length;v<w;++v)y[v]=l.charCodeAt(v);l=new f([y],{type:u})}function S(E){for(var R=E.split(/[:;,]/),W=R[1],J=(R[2]=="base64"?atob:decodeURIComponent)(R.pop()),se=J.length,U=0,ae=new Uint8Array(se);U<se;++U)ae[U]=J.charCodeAt(U);return new f([ae],{type:W})}function C(E,R){if("download"in h)return h.href=E,h.setAttribute("download",p),h.className="download-js-link",h.innerHTML="downloading...",h.style.display="none",document.body.appendChild(h),setTimeout(function(){h.click(),document.body.removeChild(h),R===!0&&setTimeout(function(){s.URL.revokeObjectURL(h.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(E)&&(E="data:"+E.replace(/^data:([\w\/\-\+]+)/,a)),window.open(E)||confirm(`Displaying New Document

Use Save As... to download, then click back to return to this page.`)&&(location.href=E),!0;var W=document.createElement("iframe");document.body.appendChild(W),!R&&/^data:/.test(E)&&(E="data:"+E.replace(/^data:([\w\/\-\+]+)/,a)),W.src=E,setTimeout(function(){document.body.removeChild(W)},333)}if(r=l instanceof f?l:new f([l],{type:u}),navigator.msSaveBlob)return navigator.msSaveBlob(r,p);if(s.URL)C(s.URL.createObjectURL(r),!0);else{if(typeof r=="string"||r.constructor===d)try{return C("data:"+u+";base64,"+s.btoa(r))}catch{return C("data:"+u+","+encodeURIComponent(r))}(o=new FileReader).onload=function(E){C(this.result)},o.readAsDataURL(r)}return!0};const eg=no(ph.exports);function tg(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24">
  <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
    <g transform="translate(-488.000000, -340.000000)" fill="#FFFFFF">
      <g id="Group-2">
        <g id="volme_big-copy" transform="translate(488.000000, 340.000000)">
          <rect id="Rectangle-18" x="11" y="4" width="2" height="12" rx="1"></rect>
          <rect id="Rectangle-2" x="3" y="18" width="18" height="2" rx="1"></rect>
          <rect id="Rectangle-2" transform="translate(4.000000, 17.500000) rotate(90.000000) translate(-4.000000, -17.500000) " x="1.5" y="16.5" width="5" height="2" rx="1"></rect><rect id="Rectangle-2-Copy-3" transform="translate(20.000000, 17.500000) rotate(90.000000) translate(-20.000000, -17.500000) " x="17.5" y="16.5" width="5" height="2" rx="1"></rect>
          <path d="M9.48791171,8.26502656 L9.48791171,14.2650266 C9.48791171,14.8173113 9.04019646,15.2650266 8.48791171,15.2650266 C7.93562696,15.2650266 7.48791171,14.8173113 7.48791171,14.2650266 L7.48791171,7.26502656 C7.48791171,6.71274181 7.93562696,6.26502656 8.48791171,6.26502656 L15.4879117,6.26502656 C16.0401965,6.26502656 16.4879117,6.71274181 16.4879117,7.26502656 C16.4879117,7.81731131 16.0401965,8.26502656 15.4879117,8.26502656 L9.48791171,8.26502656 Z" id="Combined-Shape" transform="translate(11.987912, 10.765027) scale(1, -1) rotate(45.000000) translate(-11.987912, -10.765027) "></path>
        </g>
      </g>
    </g>
  </g>
</svg>
`,"image/svg+xml").firstChild}var ng=function(){ye(n,Jn);var i=_e(n);function n(e){var t;return fe(this,n),j(O(t=i.call(this,e)),"download",function(r){if(!t.isLock){t.emitUserAction(r,"download");var o=t.playerConfig.url,s="";g.typeOf(o)==="String"?s=o:g.typeOf(o)==="Array"&&o.length>0&&(s=o[0].src);var a=t.getAbsoluteURL(s);eg(a),t.isLock=!0,t.timer=window.setTimeout(function(){t.isLock=!1,window.clearTimeout(t.timer),t.timer=null},300)}}),t.timer=null,t.isLock=!1,t}return pe(n,[{key:"afterCreate",value:function(){Ce(we(n.prototype),"afterCreate",this).call(this),this.config.disable||(this.appendChild(".xgplayer-icon",this.icons.download),this._handler=this.hook("click",this.download,{pre:function(e){e.preventDefault(),e.stopPropagation()}}),this.bind(["click","touchend"],this._handler))}},{key:"registerIcons",value:function(){return{download:tg}}},{key:"getAbsoluteURL",value:function(e){if(!e.match(/^https?:\/\//)){var t=document.createElement("div");t.innerHTML='<a href="'.concat(e,'">x</a>'),e=t.firstChild.href}return e}},{key:"destroy",value:function(){Ce(we(n.prototype),"destroy",this).call(this),this.unbind(["click","touchend"],this.download),window.clearTimeout(this.timer),this.timer=null}},{key:"render",value:function(){if(!this.config.disable)return`<xg-icon class="xgplayer-download">
   <div class="xgplayer-icon">
   </div>
   `.concat(In(this,"DOWNLOAD_TIPS",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"download"}},{key:"defaultConfig",get:function(){return{position:Ve.CONTROLS_RIGHT,index:3,disable:!0}}}]),n}(),ig=function(){ye(n,Jn);var i=_e(n);function n(){return fe(this,n),i.apply(this,arguments)}return pe(n,[{key:"beforeCreate",value:function(e){typeof e.player.config.screenShot=="boolean"&&(e.config.disable=!e.player.config.screenShot)}},{key:"afterCreate",value:function(){Ce(we(n.prototype),"afterCreate",this).call(this),this.appendChild(".xgplayer-icon",this.icons.screenshotIcon);var e=this.config;this.initSize=function(t){e.fitVideo&&(e.width=t.vWidth,e.height=t.vHeight)},this.once(Ln,this.initSize)}},{key:"onPluginsReady",value:function(){this.show(),this.onClickBtn=this.onClickBtn.bind(this),this.bind(["click","touchend"],this.onClickBtn)}},{key:"saveScreenShot",value:function(e,t){var r=document.createElement("a");r.href=e,r.download=t;var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),r.dispatchEvent(o)}},{key:"createCanvas",value:function(e,t){var r=document.createElement("canvas"),o=r.getContext("2d");this.canvasCtx=o,this.canvas=r,r.width=e||this.config.width,r.height=t||this.config.height,o.imageSmoothingEnabled=!0,o.imageSmoothingEnabled&&(o.imageSmoothingQuality="high")}},{key:"onClickBtn",value:function(e){var t=this;e.preventDefault(),e.stopPropagation(),this.emitUserAction(e,"shot");var r=this.config;this.shot(r.width,r.height).then(function(o){t.emit(nh,o),r.saveImg&&t.saveScreenShot(o,r.name+r.format)})}},{key:"shot",value:function(e,t){var r=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{quality:.92,type:"image/png"},s=this.config,a=this.player,u=o.quality||s.quality,l=o.type||s.type;return new Promise(function(c,h){var d,f=null;if(a.media.canvas)f=a.media.canvas;else{r.canvas?(r.canvas.width=e||s.width,r.canvas.height=t||s.height):r.createCanvas(e,t),f=r.canvas,d=r.canvasCtx;var p,m,v,y,w=a.media.videoWidth/a.media.videoHeight,S=f.width/f.height,C=a.media.videoWidth,E=a.media.videoHeight;w>S?(v=f.width,y=f.width/w,p=0,m=Math.round((f.height-y)/2)):w===S?(v=f.width,y=f.height,p=0,m=0):w<S&&(v=f.height*w,y=f.height,p=Math.round((f.width-v)/2),m=0),d.drawImage(a.media,0,0,C,E,p,m,v,y)}var R=f.toDataURL(l,u).replace(l,"image/octet-stream");c(R=R.replace(/^data:image\/[^;]+/,"data:application/octet-stream"))})}},{key:"registerIcons",value:function(){return{screenshotIcon:null}}},{key:"destroy",value:function(){Ce(we(n.prototype),"destroy",this).call(this),this.unbind(["click","touchend"],this.onClickBtn),this.off(Ln,this.initSize)}},{key:"render",value:function(){if(!this.config.disable){var e=this.icons.screenshotIcon?"xgplayer-icon":"xgplayer-icon btn-text",t="SCREENSHOT";return`
      <xg-icon class="xgplayer-shot">
      <div class="`.concat(e,`">
      `).concat(this.icons.screenshotIcon?"":'<span lang-key="'.concat(this.i18nKeys[t],'">').concat(this.i18n[t],"</span>"),`
      </div>
    </xg-icon>`)}}}],[{key:"pluginName",get:function(){return"screenShot"}},{key:"defaultConfig",get:function(){return{position:Ve.CONTROLS_RIGHT,index:5,quality:.92,type:"image/png",format:".png",width:600,height:337,saveImg:!0,fitVideo:!0,disable:!1,name:"screenshot"}}}]),n}(),rg=function(){function i(n){fe(this,i),this.config=n.config,this.parent=n.root,this.root=g.createDom("ul","",{},"xg-options-list xg-list-slide-scroll ".concat(this.config.className)),n.root.appendChild(this.root);var e=this.config.maxHeight;e&&this.setStyle({maxHeight:e}),this.onItemClick=this.onItemClick.bind(this),this.renderItemList();var t=Pe.device==="mobile"?"touchend":"click";this._delegates=Me.delegate.call(this,this.root,"li",t,this.onItemClick)}return pe(i,[{key:"renderItemList",value:function(n){var e=this,t=this.config,r=this.root;n?t.data=n:n=t.data,t.style&&Object.keys(t.style).map(function(o){r.style[o]=t[o]}),n.length>0&&(this.attrKeys=Object.keys(n[0])),this.root.innerHTML="",n.map(function(o,s){var a=o.selected?"option-item selected":"option-item";o["data-index"]=s,e.root.appendChild(g.createDom("li","<span>".concat(o.showText,"</span>"),o,a))})}},{key:"onItemClick",value:function(n){n.delegateTarget||(n.delegateTarget=n.target);var e=n.delegateTarget;if(e&&g.hasClass(e,"selected"))return!1;var t=typeof this.config.onItemClick=="function"?this.config.onItemClick:null,r=this.root.querySelector(".selected");g.addClass(e,"selected"),r&&g.removeClass(r,"selected"),t(n,{from:r?this.getAttrObj(r,this.attrKeys):null,to:this.getAttrObj(e,this.attrKeys)})}},{key:"getAttrObj",value:function(n,e){if(!n||!e)return{};var t={};e.map(function(o){t[o]=n.getAttribute(o)});var r=n.getAttribute("data-index");return r&&(t.index=Number(r)),t}},{key:"show",value:function(){g.removeClass(this.root,"hide"),g.addClass(this.root,"active")}},{key:"hide",value:function(){g.removeClass(this.root,"active"),g.addClass(this.root,"hide")}},{key:"setStyle",value:function(n){var e=this;Object.keys(n).forEach(function(t){e.root.style[t]=n[t]})}},{key:"destroy",value:function(){this._delegates&&(this._delegates.map(function(n){n.destroy&&n.destroy()}),this._delegates=null),this.root.innerHTML=null,this.parent.removeChild(this.root),this.root=null}}]),i}(),Nn="side",zo="middle",Ci="click",og="hover",dr=Pe.device==="mobile",Kr=function(){ye(n,Me);var i=_e(n);function n(e){var t;return fe(this,n),j(O(t=i.call(this,e)),"onEnter",function(r){r.stopPropagation(),t.emit("icon_mouseenter",{pluginName:t.pluginName}),t.switchActiveState(r)}),j(O(t),"switchActiveState",function(r){r.stopPropagation(),t.config.toggleMode===Ci?t.toggle(!t.isActive):t.toggle(!0)}),j(O(t),"onLeave",function(r){r.stopPropagation(),t.emit("icon_mouseleave",{pluginName:t.pluginName}),t.config.listType!==Nn&&t.isActive&&t.toggle(!1)}),j(O(t),"onListEnter",function(r){t.enterType=2}),j(O(t),"onListLeave",function(r){t.enterType=0,t.isActive&&t.toggle(!1)}),t.isIcons=!1,t.isActive=!1,t.curValue=null,t.curIndex=0,t}return pe(n,[{key:"updateLang",value:function(e){this.renderItemList(this.config.list,this.curIndex)}},{key:"afterCreate",value:function(){var e=this,t=this.config;this.initIcons(),dr&&t.listType!==zo&&(t.listType=Nn),t.hidePortrait&&g.addClass(this.root,"portrait"),this.on([Ln,Zt],function(){e._resizeList()}),this.once(on,function(){t.list&&t.list.length>0&&(e.renderItemList(t.list),e.show())}),dr&&this.on(Js,function(){e.isActive&&(e.optionsList&&e.optionsList.hide(),e.isActive=!1)}),dr?(t.toggleMode=Ci,this.activeEvent="touchend"):this.activeEvent=t.toggleMode===Ci?"click":"mouseenter",t.toggleMode===Ci?this.bind(this.activeEvent,this.switchActiveState):(this.bind(this.activeEvent,this.onEnter),this.bind("mouseleave",this.onLeave)),this.isIcons&&this.bind("click",this.onIconClick)}},{key:"initIcons",value:function(){var e=this,t=this.icons,r=Object.keys(t),o=!1;r.length>0&&(r.forEach(function(s){e.appendChild(".xgplayer-icon",t[s]),!o&&(o=t[s])}),this.isIcons=o),o||(this.appendChild(".xgplayer-icon",g.createDom("span","",{},"icon-text")),g.addClass(this.find(".xgplayer-icon"),"btn-text"))}},{key:"show",value:function(e){!this.config.list||this.config.list.length<2||g.addClass(this.root,"show")}},{key:"hide",value:function(){g.removeClass(this.root,"show")}},{key:"getTextByLang",value:function(e,t,r){if(e===void 0)return"";var o=this.config.list;!r&&(r=this.player.lang),t=!t||g.isUndefined(e[t])?"text":t,typeof e=="number"&&(e=o[e]);try{return pt(e[t])==="object"?e[t][r]||e[t].en:e[t]}catch{return""}}},{key:"toggle",value:function(e){if(e!==this.isActive){var t=this.player.controls,r=this.config.listType;e?(r===Nn?t.blur():t.focus(),this.optionsList&&this.optionsList.show()):(r===Nn?t.focus():t.focusAwhile(),this.optionsList&&this.optionsList.hide()),this.isActive=e}}},{key:"onItemClick",value:function(e,t){e.stopPropagation();var r=this.config,o=r.listType,s=r.list;this.curIndex=t.to.index,this.curItem=s[this.curIndex],this.changeCurrentText(),(this.config.isItemClickHide||dr||o===Nn)&&this.toggle(!1)}},{key:"onIconClick",value:function(e){}},{key:"changeCurrentText",value:function(){if(!this.isIcons){var e=this.config.list,t=e[this.curIndex<e.length?this.curIndex:0];t&&(this.find(".icon-text").innerHTML=this.getTextByLang(t,"iconText"))}}},{key:"renderItemList",value:function(e,t){var r=this,o=this.config,s=this.optionsList,a=this.player;if(typeof t=="number"&&(this.curIndex=t,this.curItem=o.list[t]),s)return s.renderItemList(e),void this.changeCurrentText();var u,l,c={config:{data:e||[],className:(u=o.listType,l=o.position,u===Nn?l===Ve.CONTROLS_LEFT?"xg-side-list xg-left-side":"xg-side-list xg-right-side":""),onItemClick:function(f,p){r.onItemClick(f,p)}},root:o.listType===Nn?a.innerContainer||a.root:this.root};if(this.config.isShowIcon){var h=this.player.root.getBoundingClientRect().height,d=o.listType===zo?h-50:h;d&&o.heightLimit&&(c.config.maxHeight="".concat(d,"px")),this.optionsList=new rg(c),this.changeCurrentText(),this.show()}this._resizeList()}},{key:"_resizeList",value:function(){if(this.config.heightLimit){var e=this.player.root.getBoundingClientRect().height,t=this.config.listType===zo?e-50:e;this.optionsList&&this.optionsList.setStyle({maxHeight:"".concat(t,"px")})}}},{key:"destroy",value:function(){this.config.toggleMode===Ci?this.unbind(this.activeEvent,this.switchActiveState):(this.unbind(this.activeEvent,this.onEnter),this.unbind("mouseleave",this.onLeave)),this.isIcons&&this.unbind("click",this.onIconClick),this.optionsList&&(this.optionsList.destroy(),this.optionsList=null)}},{key:"render",value:function(){if(this.config.isShowIcon)return'<xg-icon class="xg-options-icon '.concat(this.config.className||"",`">
    <div class="xgplayer-icon">
    </div>
   </xg-icon>`)}}],[{key:"pluginName",get:function(){return"optionsIcon"}},{key:"defaultConfig",get:function(){return{position:Ve.CONTROLS_RIGHT,index:100,list:[],listType:"middle",listStyle:{},hidePortrait:!0,isShowIcon:!1,isItemClickHide:!0,toggleMode:og,heightLimit:!0}}}]),n}(),sg=function(){ye(n,Kr);var i=_e(n);function n(e){var t;return fe(this,n),(t=i.call(this,e)).curTime=0,t.isPaused=!0,t}return pe(n,[{key:"beforeCreate",value:function(e){var t=e.config.list;Array.isArray(t)&&t.length>0&&(e.config.list=t.map(function(r){return!r.text&&r.name&&(r.text=r.name),r.text||(r.text=r.definition),r}))}},{key:"afterCreate",value:function(){var e=this;Ce(we(n.prototype),"afterCreate",this).call(this),this.on("resourceReady",function(t){e.changeDefinitionList(t)}),this.on(ro,function(t){e.renderItemList(e.config.list,t.to)}),this.player.definitionList.length<2&&this.hide()}},{key:"show",value:function(e){!this.config.list||this.config.list.length<2||g.addClass(this.root,"show")}},{key:"initDefinition",value:function(){var e=this.config,t=e.list,r=e.defaultDefinition;if(t.length>0){var o=null;t.map(function(s){s.definition===r&&(o=s)}),o||(o=t[0]),this.changeDefinition(o)}}},{key:"renderItemList",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.list||[],r=arguments.length>1?arguments[1]:void 0,o=r&&r.definition?r.definition:this.config.defaultDefinition;r&&t.forEach(function(u){u.selected=!1});var s=0,a=t.map(function(u,l){var c=Ye(Ye({},u),{},{showText:e.getTextByLang(u)||u.definition,selected:!1});return(u.selected||u.definition&&u.definition==o)&&(c.selected=!0,s=l),c});Ce(we(n.prototype),"renderItemList",this).call(this,a,s)}},{key:"changeDefinitionList",value:function(e){Array.isArray(e)&&(this.config.list=e.map(function(t){return!t.text&&t.name&&(t.text=t.name),t.text||(t.text=t.definition),t}),this.renderItemList(),this.config.list.length<2?this.hide():this.show())}},{key:"changeDefinition",value:function(e,t){this.player.changeDefinition(e,t)}},{key:"onItemClick",value:function(e,t){var r=this.player.definitionList;Ce(we(n.prototype),"onItemClick",this).apply(this,arguments),this.emitUserAction(e,"change_definition",{from:t.from,to:t.to});for(var o=0;o<r.length;o++)t.to&&r[o].definition===t.to.definition&&(t.to.url=r[o].url),t.from&&r[o].definition===t.from.definition&&(t.from.url=r[o].url);this.player.changeDefinition(t.to,t.from)}}],[{key:"pluginName",get:function(){return"definition"}},{key:"defaultConfig",get:function(){return Ye(Ye({},Kr.defaultConfig),{},{position:Ve.CONTROLS_RIGHT,index:3,list:[],defaultDefinition:"",disable:!1,hidePortrait:!1,className:"xgplayer-definition",isShowIcon:!0})}}]),n}(),ag=function(){ye(n,Kr);var i=_e(n);function n(e){var t;return fe(this,n),(t=i.call(this,e)).curRate=1,t}return pe(n,[{key:"beforeCreate",value:function(e){var t=e.player.config.playbackRate,r=t?Array.isArray(t)?t:e.config.list:[];Array.isArray(r)&&(e.config.list=r.map(function(o){return typeof o=="number"?o={rate:o,text:"".concat(o,"x")}:!o.text&&o.rate&&(o.text="".concat(o.rate,"x")),o}))}},{key:"afterCreate",value:function(){var e=this;Ce(we(n.prototype),"afterCreate",this).call(this),this.on(Yc,function(){e.curValue!==e.player.playbackRate&&e.renderItemList()}),this.renderItemList()}},{key:"show",value:function(e){this.config.list&&this.config.list.length!==0&&Ce(we(n.prototype),"show",this).call(this)}},{key:"onItemClick",value:function(e,t){Ce(we(n.prototype),"onItemClick",this).call(this,e,t);var r=e.delegateTarget,o=Number(r.getAttribute("rate"));if(!o||o===this.curValue)return!1;var s={playbackRate:{from:this.player.playbackRate,to:o}};this.emitUserAction(e,"change_rate",{props:s}),this.curValue=o,this.player.playbackRate=o}},{key:"renderItemList",value:function(){var e=this,t=this.player.playbackRate||1;this.curValue=t;var r=-1,o=this.config.list.map(function(s,a){var u={rate:s.rate};return u.rate===t&&(u.selected=!0,r=a),u.showText=e.getTextByLang(s),u});Ce(we(n.prototype),"renderItemList",this).call(this,o,r)}},{key:"changeCurrentText",value:function(){if(!this.isIcons){var e=this.config.list,t=e[this.curIndex<e.length?this.curIndex:0],r="";r=!t||this.curIndex<0?"".concat(this.player.playbackRate,"x"):this.getTextByLang(t,"iconText"),this.find(".icon-text").innerHTML=r}}},{key:"destroy",value:function(){Ce(we(n.prototype),"destroy",this).call(this)}}],[{key:"pluginName",get:function(){return"playbackRate"}},{key:"defaultConfig",get:function(){return Ye(Ye({},Kr.defaultConfig),{},{position:Ve.CONTROLS_RIGHT,index:4,list:[2,1.5,1,.75,.5],className:"xgplayer-playbackrate",isShowIcon:!0,hidePortrait:!1})}}]),n}();function ug(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="31" height="40" viewBox="0 -5 31 40">
  <path fill="#fff" transform="scale(1.3, 1.3)" class='path_full' d="M9,10v1a.9.9,0,0,1-1,1,.9.9,0,0,1-1-1V9A.9.9,0,0,1,8,8h2a.9.9,0,0,1,1,1,.9.9,0,0,1-1,1Zm6,4V13a1,1,0,0,1,2,0v2a.9.9,0,0,1-1,1H14a1,1,0,0,1,0-2Zm3-7H6V17H18Zm2,0V17a2,2,0,0,1-2,2H6a2,2,0,0,1-2-2V7A2,2,0,0,1,6,5H18A2,2,0,0,1,20,7Z"></path>
</svg>
`,"image/svg+xml").firstChild}function lg(){return new DOMParser().parseFromString(`<svg xmlns="http://www.w3.org/2000/svg" width="31" height="40" viewBox="0 -5 31 40">
  <path fill="#fff" transform="scale(1.3, 1.3)" d="M9,10V9a.9.9,0,0,1,1-1,.9.9,0,0,1,1,1v2a.9.9,0,0,1-1,1H8a.9.9,0,0,1-1-1,.9.9,0,0,1,1-1Zm6,4v1a1,1,0,0,1-2,0V13a.9.9,0,0,1,1-1h2a1,1,0,0,1,0,2Zm3-7H6V17H18Zm2,0V17a2,2,0,0,1-2,2H6a2,2,0,0,1-2-2V7A2,2,0,0,1,6,5H18A2,2,0,0,1,20,7Z"></path>
</svg>
`,"image/svg+xml").firstChild}var ju=function(){ye(n,Jn);var i=_e(n);function n(){return fe(this,n),i.apply(this,arguments)}return pe(n,[{key:"beforeCreate",value:function(e){typeof e.player.config.cssFullscreen=="boolean"&&(e.config.disable=!e.player.config.cssFullscreen)}},{key:"afterCreate",value:function(){var e=this;Ce(we(n.prototype),"afterCreate",this).call(this),this.config.disable||(this.config.target&&(this.playerConfig.fullscreenTarget=this.config.target),this.initIcons(),this.on(Br,function(t){e.animate(t)}),this.btnClick=this.btnClick.bind(this),this.handleCssFullscreen=this.hook("cssFullscreen_change",this.btnClick,{pre:function(t){t.preventDefault(),t.stopPropagation()}}),this.bind(["click","touchend"],this.handleCssFullscreen))}},{key:"initIcons",value:function(){var e=this.icons,t=this.find(".xgplayer-icon");t.appendChild(e.cssFullscreen),t.appendChild(e.exitCssFullscreen)}},{key:"btnClick",value:function(e){e.preventDefault(),e.stopPropagation();var t=this.player.isCssfullScreen;this.emitUserAction(e,"switch_cssfullscreen",{cssfullscreen:t}),t?this.player.exitCssFullscreen():this.player.getCssFullscreen()}},{key:"animate",value:function(e){this.root&&(e?this.setAttr("data-state","full"):this.setAttr("data-state","normal"),this.switchTips(e))}},{key:"switchTips",value:function(e){var t=this.i18nKeys,r=this.find(".xg-tips");r&&this.changeLangTextKey(r,e?t.EXITCSSFULLSCREEN_TIPS:t.CSSFULLSCREEN_TIPS)}},{key:"registerIcons",value:function(){return{cssFullscreen:{icon:ug,class:"xg-get-cssfull"},exitCssFullscreen:{icon:lg,class:"xg-exit-cssfull"}}}},{key:"destroy",value:function(){Ce(we(n.prototype),"destroy",this).call(this),this.unbind(["click","touchend"],this.btnClick)}},{key:"render",value:function(){if(!this.config.disable)return`<xg-icon class='xgplayer-cssfullscreen'>
    <div class="xgplayer-icon">
    </div>
    `.concat(In(this,"CSSFULLSCREEN_TIPS",this.playerConfig.isHideTips),`
    </xg-icon>`)}}],[{key:"pluginName",get:function(){return"cssFullscreen"}},{key:"defaultConfig",get:function(){return{position:Ve.CONTROLS_RIGHT,index:1,disable:!1,target:null}}}]),n}(),cg=function(){ye(n,Me);var i=_e(n);function n(){return fe(this,n),i.apply(this,arguments)}return pe(n,[{key:"afterCreate",value:function(){var e=this;this.clickHandler=this.hook("errorRetry",this.errorRetry,{pre:function(t){t.preventDefault(),t.stopPropagation()}}),this.onError=this.hook("showError",this.handleError),this.bind(".xgplayer-error-refresh","click",this.clickHandler),this.on(Qi,function(t){e.onError(t)})}},{key:"errorRetry",value:function(e){this.emitUserAction(e,"error_retry",{}),this.player.retry()}},{key:"handleError",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=this.player,r=e.errorType,o=t.errorNote?this.i18n[t.errorNote]:"";if(!o)switch(r){case"decoder":o=this.i18n.MEDIA_ERR_DECODE;break;case"network":o=this.i18n.MEDIA_ERR_NETWORK;break;default:o=this.i18n.MEDIA_ERR_SRC_NOT_SUPPORTED}this.find(".xgplayer-error-text").innerHTML=o,this.find(".xgplayer-error-tips").innerHTML="".concat(this.i18n.REFRESH_TIPS,'<span class="xgplayer-error-refresh">').concat(this.i18n.REFRESH,"</span>")}},{key:"destroy",value:function(){this.unbind(".xgplayer-error-refresh","click",this.clickHandler)}},{key:"render",value:function(){return`<xg-error class="xgplayer-error">
      <div class="xgplayer-errornote">
       <span class="xgplayer-error-text"></span>
       <span class="xgplayer-error-tips"><em class="xgplayer-error-refresh"></em></span>
      </div>
    </xg-error>`}}],[{key:"pluginName",get:function(){return"error"}}]),n}(),hg=function(){ye(n,Me);var i=_e(n);function n(){return fe(this,n),i.apply(this,arguments)}return pe(n,[{key:"afterCreate",value:function(){var e=this;this.intervalId=0,this.customConfig=null,this.bind(".highlight",["click","touchend"],function(t){(e.config.onClick||e.customOnClick)&&(t.preventDefault(),t.stopPropagation(),e.customOnClick?e.customOnClick(t):e.config.onClick(t))}),this.player.showPrompt=function(){e.showPrompt.apply(e,arguments)},this.player.hidePrompt=function(){e.hide()}}},{key:"setStyle",value:function(e){var t=this;Object.keys(e).map(function(r){t.root.style[r]=e[r]})}},{key:"showPrompt",value:function(e){var t=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){};if(e){this.customOnClick=o;var s=this.config.interval;if(this.intervalId&&(clearTimeout(this.intervalId),this.intervalId=null),g.addClass(this.root,"show"),r.mode==="arrow"&&g.addClass(this.root,"arrow"),this.find(".xgplayer-prompt-detail").innerHTML=typeof e=="string"?e:"".concat(e.text||"")+"".concat(e.highlight?'<i class="highlight">'.concat(e.highlight,"</i>"):""),r.style&&this.setStyle(r.style),typeof r.autoHide=="boolean"?r.autoHide:this.config.autoHide){var a=r.interval||s;this.intervalId=setTimeout(function(){t.hide()},a)}}}},{key:"hide",value:function(){g.removeClass(this.root,"show"),g.removeClass(this.root,"arrow"),this.root.removeAttribute("style"),this.customOnClick=null}},{key:"render",value:function(){return'<xg-prompt class="xgplayer-prompt '.concat($.CONTROLS_FOLLOW,`">
    <span class="xgplayer-prompt-detail"></span>
    </xg-prompt>`)}}],[{key:"pluginName",get:function(){return"prompt"}},{key:"defaultConfig",get:function(){return{interval:3e3,style:{},mode:"arrow",autoHide:!0,detail:{text:"",highlight:""},onClick:function(){}}}}]),n}(),Hu={time:0,text:"",id:1,duration:1,color:"#fff",style:{},width:6,height:6};function gh(i){Object.keys(Hu).map(function(n){i[n]===void 0&&(i[n]=Hu[n])})}var Vu={_updateDotDom:function(i,n){if(n){var e=this.calcuPosition(i.time,i.duration),t=i.style||{};t.left="".concat(e.left,"%"),t.width="".concat(e.width,"%"),n.setAttribute("data-text",i.text),n.setAttribute("data-time",i.time),e.isMini?g.addClass(n,"mini"):g.removeClass(n,"mini"),Object.keys(t).map(function(r){n.style[r]=t[r]})}},initDots:function(){var i=this;this._ispots.map(function(n){i.createDot(n,!1)}),this.ispotsInit=!0},createDot:function(i){var n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],e=this.player.plugins.progress;if(e&&(n&&(gh(i),this._ispots.push(i)),this.ispotsInit||!n)){var t=this.calcuPosition(i.time,i.duration),r=i.style||{};r.left="".concat(t.left,"%"),r.width="".concat(t.width,"%");var o="xgspot_".concat(i.id," xgplayer-spot");t.isMini&&(o+=" mini");var s=i.template?'<div class="xgplayer-spot-pop">'.concat(i.template,"</div>"):"",a=g.createDom("xg-spot",s,{"data-text":i.text,"data-time":i.time,"data-id":i.id},o);Object.keys(r).map(function(u){a.style[u]=r[u]}),e.outer&&e.outer.appendChild(a),this.positionDot(a,i.id)}},findDot:function(i){if(this.player.plugins.progress){var n=this._ispots.filter(function(e,t){return e.id===i});return n.length>0?n[0]:null}},updateDot:function(i){var n=arguments.length>1&&arguments[1]!==void 0&&arguments[1],e=this.player.plugins.progress;if(e){var t=this.findDot(i.id);if(t&&Object.keys(i).map(function(o){t[o]=i[o]}),this.ispotsInit){var r=e.find('xg-spot[data-id="'.concat(i.id,'"]'));r&&(this._updateDotDom(i,r),n&&this.showDot(i.id))}}},deleteDot:function(i){var n=this._ispots,e=this.player.plugins.progress;if(e){for(var t=[],r=0;r<n.length;r++)n[r].id===i&&t.push(r);for(var o=t.length-1;o>=0;o--)if(n.splice(t[o],1),this.ispotsInit){var s=e.find('xg-spot[data-id="'.concat(i,'"]'));s&&s.parentElement.removeChild(s)}}},deleteAllDots:function(){var i=this.player.plugins.progress;if(i)if(this.ispotsInit){for(var n=i.root.getElementsByTagName("xg-spot"),e=n.length-1;e>=0;e--)i.outer.removeChild(n[e]);this._ispots=[]}else this._ispots=[]},updateAllDots:function(){var i=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=this.player.plugins.progress;if(e)if(this.ispotsInit){this._ispots=[];var t=e.root.getElementsByTagName("xg-spot"),r=t.length;if(r>n.length)for(var o=r-1;o>n.length-1;o--)e.outer.removeChild(t[o]);n.forEach(function(s,a){a<r?(t[a].setAttribute("data-id","".concat(s.id)),i._ispots.push(s),i.updateDot(s)):i.createDot(s)})}else this._ispots=n},positionDots:function(){var i=this,n=this._ispots,e=this.playerSize,t=this.player.sizeInfo,r=this.player.plugins.progress;r&&t.width!==e.width&&(e.width=t.width,e.left=t.left,n.forEach(function(o){var s=r.find('xg-spot[data-id="'.concat(o.id,'"]'));s&&i.positionDot(s,o.id)}))},positionDot:function(i,n){var e=g.findDom(i,".xgplayer-spot-pop");if(e){var t=this.playerSize,r=i.getBoundingClientRect(),o=e.getBoundingClientRect(),s=r.left-t.left,a=t.width-s-r.width/2;if(s<o.width/2||t.width<o.width){var u=o.width/2-s;e.style.left="".concat(u,"px")}else if(a<o.width/2){var l=a-o.width/2+r.width/2;e.style.left="".concat(l,"px")}else e.style.left="50%"}},updateDuration:function(){var i=this,n=this.player.plugins.progress;n&&this._ispots.forEach(function(e){var t=n.find('xg-spot[data-id="'.concat(e.id,'"]'));i._updateDotDom(e,t)})},getAllDotsDom:function(){var i=this.player.plugins.progress;return i?i.root.getElementsByTagName("xg-spot"):[]},getDotDom:function(i){var n=this.player.plugins.progress;if(n)return n.find('xg-spot[data-id="'.concat(i,'"]'))}},ti={dragmove:"onProgressMove",dragstart:"onProgressDragStart",dragend:"onProgressDragEnd",click:"onProgressClick",mouseover:"onProgressMouseOver",mouseenter:"onProgressMouseOver"},dg=function(){ye(n,Me);var i=_e(n);function n(e){var t;return fe(this,n),j(O(t=i.call(this,e)),"onMousemove",function(r){t.config.disable||(g.hasClass(r.target,"xg-spot-content")&&t.config.isHideThumbnailHover?t.player.plugins.progress.onMouseLeave(r):(t._state.f||g.hasClass(r.target,"xg-spot-content"))&&(g.event(r),r.stopPropagation()))}),j(O(t),"onMousedown",function(r){t.config.disable||(t._state.f||g.hasClass(r.target,"xg-spot-content"))&&(g.event(r),r.stopPropagation())}),j(O(t),"onMouseup",function(r){if(t.isDrag){var o=t.player.plugins.progress;o&&o.pos&&(o.onMouseUp(r),!o.pos.isEnter&&o.onMouseLeave(r))}}),j(O(t),"onDotMouseLeave",function(r){if(!t.config.disable){t._curDot.removeEventListener("mouseleave",t.onDotMouseLeave),t.blurDot(r.target),t._curDot=null;var o=t.player.plugins.progress;o&&o.enableBlur(),t.show()}}),j(O(t),"onProgressMouseOver",function(r,o){if(!t.config.disable&&g.hasClass(o.target,"xgplayer-spot")&&!t._curDot){t._curDot=o.target,t.focusDot(o.target),t._curDot.children.length>0&&t.hide();var s=t.player.plugins.progress;s&&s.disableBlur(),t._curDot.addEventListener("mouseleave",t.onDotMouseLeave)}}),t._ispots=[],t.videoPreview=null,t.videothumbnail=null,t.thumbnail=null,t.timeStr="",t._state={now:0,f:!1},t}return pe(n,[{key:"beforeCreate",value:function(e){var t=e.player.plugins.progress;t&&(e.root=t.root)}},{key:"afterCreate",value:function(){var e=this;this._curDot=null,this.handlerSpotClick=this.hook("spotClick",function(t,r){r.seekTime&&e.player.seek(r.seekTime)}),this.transformTimeHook=this.hook("transformTime",function(t){e.setTimeContent(g.format(t))}),function(t){var r=t.config,o=t.player;Object.keys(Vu).map(function(a){t[a]=Vu[a].bind(t)});var s=o.config.progressDot||r.ispots||[];t._ispots=s.map(function(a){return gh(a),a}),t.ispotsInit=!1,t.playerSize={left:o.sizeInfo.left,width:o.sizeInfo.width},t.on(Pn,function(){t.ispotsInit?t.updateDuration():t.initDots()}),t.on(Ln,function(){t.positionDots()})}(this),this.on(Pn,function(){e.show()}),this.config.disable&&this.disable(),this.extTextRoot=this.find(".xg-spot-ext-text")}},{key:"setConfig",value:function(e){var t=this;e&&Object.keys(e).map(function(r){t.config[r]=e[r]})}},{key:"onPluginsReady",value:function(){this.player.plugins.progress&&(this.previewLine=this.find(".xg-spot-line"),this.timePoint=this.find(".xgplayer-progress-point"),this.timeText=this.find(".xg-spot-time"),this.tipText=this.find(".spot-inner-text"),this._hasThumnail=!1,this.registerThumbnail(),this.bindEvents())}},{key:"bindEvents",value:function(){var e=this,t=this.player.plugins.progress;if(t&&(Object.keys(ti).map(function(o){e[ti[o]]=e[ti[o]].bind(e),t.addCallBack(o,e[ti[o]])}),Pe.device!=="mobile")){this.bind(".xg-spot-info","mousemove",this.onMousemove),this.bind(".xg-spot-info","mousedown",this.onMousedown),this.bind(".xg-spot-info","mouseup",this.onMouseup);var r=this.hook("previewClick",function(){});this.handlerPreviewClick=function(o){o.stopPropagation(),r(parseInt(1e3*e._state.now,10)/1e3,o)},this.bind(".xg-spot-content","mouseup",this.handlerPreviewClick)}}},{key:"onProgressMove",value:function(e,t){!this.config.disable&&this.player.duration&&this.updatePosition(e.offset,e.width,e.currentTime,e.e)}},{key:"onProgressDragStart",value:function(e){!this.config.disable&&this.player.duration&&(this.isDrag=!0,this.videoPreview&&g.addClass(this.videoPreview,"show"))}},{key:"onProgressDragEnd",value:function(e){!this.config.disable&&this.player.duration&&(this.isDrag=!1,this.videoPreview&&g.removeClass(this.videoPreview,"show"))}},{key:"onProgressClick",value:function(e,t){this.config.disable||g.hasClass(t.target,"xgplayer-spot")&&(t.stopPropagation(),t.preventDefault(),["time","id","text"].map(function(r){e[r]=t.target.getAttribute("data-".concat(r))}),e.time&&(e.time=Number(e.time)),this.handlerSpotClick(t,e))}},{key:"updateLinePos",value:function(e,t){var r=this.root,o=this.previewLine,s=this.player,a=this.config,u=s.controls.mode==="flex",l=r.getBoundingClientRect().width;if(l||!this._hasThumnail){var c,h=e-(l=this._hasThumnail&&l<a.width?a.width:l)/2;h<0&&!u?(h=0,c=e-l/2):h>t-l&&!u?(c=h-(t-l),h=t-l):c=0,c!==void 0&&(o.style.transform="translateX(".concat(c.toFixed(2),"px)")),r.style.transform="translateX(".concat(h.toFixed(2),"px) translateZ(0)")}}},{key:"updateTimeText",value:function(e){var t=this.timeText,r=this.timePoint;t.innerHTML=e,!this.thumbnail&&(r.innerHTML=e)}},{key:"updatePosition",value:function(e,t,r,o){var s=this.root,a=this.config,u=this._state;if(s){u.now=r,this.transformTimeHook(r);var l=this.timeStr;o&&o.target&&g.hasClass(o.target,"xgplayer-spot")?(this.showTips(o.target.getAttribute("data-text"),!1,l),this.focusDot(o.target),u.f=!0,a.isFocusDots&&u.f&&(u.now=parseInt(o.target.getAttribute("data-time"),10))):a.defaultText?(u.f=!1,this.showTips(a.defaultText,!0,l)):(u.f=!1,this.hideTips("")),this.updateTimeText(l),this.updateThumbnails(u.now),this.updateLinePos(e,t)}}},{key:"setTimeContent",value:function(e){this.timeStr=e}},{key:"updateThumbnails",value:function(e){var t=this.player,r=this.videoPreview,o=this.config,s=t.plugins.thumbnail;if(s&&s.usable){this.thumbnail&&s.update(this.thumbnail,e,o.width,o.height);var a=r&&r.getBoundingClientRect();this.videothumbnail&&s.update(this.videothumbnail,e,a.width,a.height)}}},{key:"registerThumbnail",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Pe.device!=="mobile"){var t=this.player,r=this.config,o=t.getPlugin("thumbnail");if(o&&o.setConfig(e),o&&o.usable&&r.isShowThumbnail){g.removeClass(this.root,"short-line no-thumbnail"),r.mode==="short"&&g.addClass(this.root,"short-line"),this._hasThumnail=!0;var s=this.find(".xg-spot-thumbnail");this.thumbnail=o.createThumbnail(s,"progress-thumbnail"),r.isShowCoverPreview&&(this.videoPreview=g.createDom("xg-video-preview","",{},"xgvideo-preview"),t.root.appendChild(this.videoPreview),this.videothumbnail=o.createThumbnail(this.videoPreview,"xgvideo-thumbnail")),this.updateThumbnails(0)}else g.addClass(this.root,"short-line no-thumbnail")}}},{key:"calcuPosition",value:function(e,t){var r=this.player.plugins.progress,o=this.player,s=r.root.getBoundingClientRect().width,a=o.duration/s*6;return e+t>o.duration&&(t=o.duration-e),o.duration,o.duration,{left:e/o.duration*100,width:t/o.duration*100,isMini:t<a}}},{key:"showDot",value:function(e){var t=this.findDot(e);if(t){var r=this.root.getBoundingClientRect().width,o=t.time/this.player.duration*r;this.updatePosition(o,r,t.time)}}},{key:"focusDot",value:function(e,t){e&&(t||(t=e.getAttribute("data-id")),g.addClass(e,"active"),this._activeDotId=t)}},{key:"blurDot",value:function(e){if(!e){var t=this._activeDotId;e=this.getDotDom(t)}e&&(g.removeClass(e,"active"),this._activeDotId=null)}},{key:"showTips",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";g.addClass(this.root,"no-timepoint"),e&&(g.addClass(this.find(".xg-spot-content"),"show-text"),t&&this.config.mode==="production"?(g.addClass(this.root,"product"),this.tipText.textContent=e):(g.removeClass(this.root,"product"),this.tipText.textContent=this._hasThumnail?e:"".concat(r," ").concat(e)))}},{key:"hideTips",value:function(){g.removeClass(this.root,"no-timepoint"),this.tipText.textContent="",g.removeClass(this.find(".xg-spot-content"),"show-text"),g.removeClass(this.root,"product")}},{key:"hide",value:function(){g.addClass(this.root,"hide")}},{key:"show",value:function(e){g.removeClass(this.root,"hide")}},{key:"enable",value:function(){var e=this.config,t=this.playerConfig;this.config.disable=!1,this.show(),!this.thumbnail&&e.isShowThumbnail&&this.registerThumbnail(t.thumbnail||{})}},{key:"disable",value:function(){this.config.disable=!0,this.hide()}},{key:"destroy",value:function(){var e=this,t=this.player.plugins.progress;t&&Object.keys(ti).map(function(r){t.removeCallBack(r,e[ti[r]])}),this.videothumbnail=null,this.thumbnail=null,this.videoPreview&&this.player.root.removeChild(this.videoPreview),this.unbind(".xg-spot-info","mousemove",this.onMousemove),this.unbind(".xg-spot-info","mousedown",this.onMousedown),this.unbind(".xg-spot-info","mouseup",this.onMouseup),this.unbind(".xg-spot-content","mouseup",this.handlerPreviewClick)}},{key:"render",value:function(){return Pe.device==="mobile"||this.playerConfig.isMobileSimulateMode==="mobile"?"":'<div class="xg-spot-info hide '.concat(this.config.mode==="short"?"short-line":"",`">
      <div class="xg-spot-content">
        <div class="xg-spot-thumbnail">
          <span class="xg-spot-time"></span>
        </div>
        <div class="xg-spot-text"><span class="spot-inner-text"></span></div>
      </div>
      <div class="xgplayer-progress-point">00:00</div>
      <div class="xg-spot-ext-text"></div>
      <div class="xg-spot-line"></div>
    </div>`)}}],[{key:"pluginName",get:function(){return"progresspreview"}},{key:"defaultConfig",get:function(){return{index:1,miniWidth:6,ispots:[],defaultText:"",isFocusDots:!0,isHideThumbnailHover:!0,isShowThumbnail:!0,isShowCoverPreview:!1,mode:"",disable:!1,width:160,height:90}}}]),n}(),fg=function(){ye(n,Me);var i=_e(n);function n(e){var t;return fe(this,n),(t=i.call(this,e)).ratio=1,t.interval=null,t._preloadMark={},t}return pe(n,[{key:"afterCreate",value:function(){var e=this;this.usable&&this.initThumbnail(),this.on([Pn],function(){var t=e.config,r=t.pic_num,o=t.interval;e.usable&&(e.interval=o>0?o:Math.round(1e3*e.player.duration/r)/1e3)})}},{key:"setConfig",value:function(e){var t=this;if(e){var r=Object.keys(e);r.length<1||(r.forEach(function(o){t.config[o]=e[o]}),this.usable&&this.initThumbnail())}}},{key:"usable",get:function(){var e=this.config,t=e.urls,r=e.pic_num;return t&&t.length>0&&r>0}},{key:"initThumbnail",value:function(){var e=this.config,t=e.width,r=e.height,o=e.pic_num,s=e.interval;this.ratio=t/r*100,this.interval=s||Math.round(this.player.duration/o),this._preloadMark={}}},{key:"getUrlByIndex",value:function(e){return e>=0&&e<this.config.urls.length?this.config.urls[e]:""}},{key:"preload",value:function(e){var t=this;if(!this._preloadMark[e]){var r=this.config.urls,o=r.length,s=[];e>0&&s.push(e-1),s.push(e),e>0&&e<o-1&&s.push(e+1),s.map(function(a){!t._preloadMark[a]&&a>=0&&a<o&&(t._preloadMark[a]=1,g.preloadImg(r[a],function(){t._preloadMark[a]=2}))})}}},{key:"getPosition",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=this.config,s=o.pic_num,a=o.row,u=o.col,l=o.width,c=o.height;this.interval=Math.round(this.player.duration/s);var h=Math.ceil(e/this.interval),d=(h=h>s?s:h)<a*u?0:Math.ceil(h/(a*u))-1,f=h-d*(u*a),p=f>0?Math.ceil(f/u)-1:0,m=f>0?f-p*u-1:0,v=0,y=0;t&&r?t/r<l/c?v=(y=r)*(l/c):y=(v=t)/(l/c):r?t||(v=(y=r||c)*(l/c)):y=(v=t||l)/(l/c);var w=this.getUrlByIndex(d);return{urlIndex:d,rowIndex:p,colIndex:m,url:w,height:y,width:v,style:{backgroundImage:"url(".concat(w,")"),backgroundSize:"".concat(v*u,"px auto"),backgroundPosition:"-".concat(m*v,"px -").concat(p*y,"px"),width:"".concat(v,"px"),height:"".concat(y,"px")}}}},{key:"update",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"",a=this.config,u=a.pic_num,l=a.urls;if(!(u<=0)&&l&&l.length!==0){var c=this.getPosition(t,r,o);this.preload(c.urlIndex),Object.keys(c.style).map(function(h){e.style[h]=c.style[h]}),Object.keys(s).map(function(h){e.style[h]=s[h]})}}},{key:"changeConfig",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.setConfig(e)}},{key:"createThumbnail",value:function(e,t){var r=g.createDom("xg-thumbnail","",{},"thumbnail ".concat(t));return e&&e.appendChild(r),r}}],[{key:"pluginName",get:function(){return"thumbnail"}},{key:"defaultConfig",get:function(){return{isShow:!1,urls:[],pic_num:0,col:0,row:0,height:90,width:160,scale:1,className:"",hidePortrait:!1}}}]),n}();function Wo(i){return i?"background:".concat(i,";"):""}var pg=function(){ye(n,Me);var i=_e(n);function n(){var e;fe(this,n);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return j(O(e=i.call.apply(i,[this].concat(r))),"onTimeupdate",function(){var s=e.player.ended,a=O(e).offsetDuration,u=e.currentTime;u=g.adjustTimeByDuration(u,a,s),e.update({played:u},a)}),e}return pe(n,[{key:"offsetDuration",get:function(){return this.playerConfig.customDuration||this.player.offsetDuration||this.player.duration}},{key:"currentTime",get:function(){var e=this.player,t=e.offsetCurrentTime,r=e.currentTime;return t>=0?t:r}},{key:"afterCreate",value:function(){var e=this;this.root&&(this.on(xt,this.onTimeupdate),this.on(Xn,function(){e.reset()}))}},{key:"reset",value:function(){this.update({played:0,cached:0},0)}},{key:"update",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{cached:0,played:0},t=arguments.length>1?arguments[1]:void 0;t&&this.root&&(e.cached&&(this.find("xg-mini-progress-cache").style.width="".concat(e.cached/t*100,"%")),e.played&&(this.find("xg-mini-progress-played").style.width="".concat(e.played/t*100,"%")))}},{key:"render",value:function(){var e=this.playerConfig,t=e.commonStyle;if(e.miniprogress){var r=this.config,o=r.mode,s=r.height,a={cached:Wo(t.cachedColor),played:Wo(t.playedColor),progress:Wo(t.progressColor),height:s>0&&s!==2?"height: ".concat(s,"px;"):""};return'<xg-mini-progress class="xg-mini-progress '.concat(o==="show"?"xg-mini-progress-show":"",'" style="').concat(a.progress," ").concat(a.height,`">
    <xg-mini-progress-cache class="xg-mini-progress-cache" style="`).concat(a.cached,`"></xg-mini-progress-cache>
    <xg-mini-progress-played class="xg-mini-progress-played" style="`).concat(a.played,`"></xg-mini-progress-played>
    </xg-mini-progress>`)}}}],[{key:"pluginName",get:function(){return"MiniProgress"}},{key:"defaultConfig",get:function(){return{mode:"auto",height:2}}}]),n}(),zu="realtime",Wu="firstframe",Gu="poster",Go=null,gg=function(){ye(n,Me);var i=_e(n);function n(){var e;fe(this,n);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return j(O(e=i.call.apply(i,[this].concat(r))),"onLoadedData",function(s){e.player&&(e._frameCount=e.config.startFrameCount,e.stop(),e.renderOnTimeupdate(s),e.off(xt,e.renderOnTimeupdate),e.on(xt,e.renderOnTimeupdate))}),j(O(e),"onVisibilitychange",function(s){document.visibilityState==="visible"?e._checkIfCanStart()&&e.start():document.visibilityState==="hidden"&&e.stop()}),j(O(e),"renderOnTimeupdate",function(s){if(e._frameCount>0)e.renderOnce(),e._frameCount--;else{e._isLoaded=!0,e.off(xt,e.renderOnTimeupdate);var a=e.config.startInterval;!e.player.paused&&e._checkIfCanStart()&&e.start(0,a)}}),j(O(e),"start",function(s,a){var u=e.player.video,l=function(){try{return parseInt(window.performance.now(),10)}catch{return new Date().getTime()}}(),c=e.checkVideoIsSupport(u);c&&e.canvasCtx&&(a||(a=e.interval),e.stop(),u.videoWidth&&u.videoHeight&&(e.videoPI=u.videoHeight>0?parseInt(u.videoWidth/u.videoHeight*100,10):0,(e.config.mode===zu||l-e.preTime>=a)&&(u&&u.videoWidth&&e.update(c,e.videoPI),e.preTime=l)),e.frameId=e._loopType==="timer"?g.setTimeout(O(e),e.start,a):g.requestAnimationFrame(e.start))}),j(O(e),"stop",function(){e.frameId&&(e._loopType==="timer"?g.clearTimeout(O(e),e.frameId):g.cancelAnimationFrame(e.frameId),e.frameId=null)}),e}return pe(n,[{key:"afterCreate",value:function(){var e=this;this.playerConfig.dynamicBg===!0&&(this.config.disable=!1),n.isSupport||(this.config.disable=!0);var t=this.config,r=t.disable,o=t.mode,s=t.frameRate;r||(this._pos={width:0,height:0,rwidth:0,rheight:0,x:0,y:0,pi:0},this.isStart=!1,this._isLoaded=!1,this.videoPI=0,this.preTime=0,this.interval=parseInt(1e3/s,10),this.canvas=null,this.canvasCtx=null,this._frameCount=0,this._loopType=this.config.mode!==zu&&this.interval>=1e3?"timer":"animation",this.once(io,function(){e.player&&(e.init(),e.renderByPoster(),e.player.paused||e.start())}),o!==Gu&&(o!==Wu&&(this.on(Xn,function(){e.stop()}),this.on(St,function(){var a=e.config.startInterval;e._checkIfCanStart()&&e.start(0,a)}),this.on(_i,function(){e.stop()})),this.on(cn,this.onLoadedData),this.on(Xs,function(){e._isLoaded=!1,e.stop()}),document.addEventListener("visibilitychange",this.onVisibilitychange)))}},{key:"setConfig",value:function(e){var t=this;Object.keys(e).forEach(function(r){r==="root"&&e[r]!==t.config[r]?t.reRender(e[r]):r==="frameRate"?t.interval=parseInt(1e3/e[r],10):r==="disable"&&e[r]&&t.stop(),t.config[r]=e[r]})}},{key:"init",value:function(e){var t=this.player,r=this.config;this.canvasFilter=n.supportCanvasFilter();try{var o=e||r.root;o||(o=r.isInnerRender&&t.innerContainer||t.root),o.insertAdjacentHTML("afterbegin",'<div class="xgplayer-dynamic-bg" data-index="'.concat(r.index,`"><canvas>
        </canvas><xgmask></xgmask></div>`)),this.root=o.children[0],this.canvas=this.find("canvas"),this.canvasFilter||(this.canvas.style.filter=r.filter,this.canvas.style.webkitFilter=r.filter),this.mask=this.find("xgmask"),r.addMask&&(this.mask.style.background=r.maskBg),this.canvasCtx=this.canvas.getContext("2d")}catch(s){Re.logError("plugin:DynamicBg",s)}}},{key:"reRender",value:function(e){if(this.config.disable||this.root){this.stop();var t=this.root?this.root.parentElement:null;if(t!==e&&t.removeChild(this.root),e){this.init(e),this.renderOnce();var r=this.config.startInterval;this._checkIfCanStart()&&this.start(0,r)}else this.root=null}}},{key:"checkVideoIsSupport",value:function(e){if(!e)return null;var t=e&&e instanceof window.HTMLVideoElement?e:e.canvas?e.canvas:e.flyVideo?e.flyVideo:null;if(t&&(Pe.browser!=="safari"||!g.isMSE(t)))return t;var r=t?t.tagName.toLowerCase():"";return r==="canvas"||r==="img"?t:null}},{key:"renderByPoster",value:function(){var e=this.playerConfig.poster;if(e){var t=g.typeOf(e)==="String"?e:g.typeOf(e.poster)==="String"?e.poster:null;this.updateImg(t)}}},{key:"_checkIfCanStart",value:function(){var e=this.config.mode;return this._isLoaded&&!this.player.paused&&e!==Wu&&e!==Gu}},{key:"renderOnce",value:function(){var e=this.player.video;if(e.videoWidth&&e.videoHeight){this.videoPI=parseInt(e.videoWidth/e.videoHeight*100,10);var t=this.checkVideoIsSupport(e);t&&this.update(t,this.videoPI)}}},{key:"updateImg",value:function(e){var t=this;if(e){var r=this.canvas.getBoundingClientRect(),o=r.width,s=r.height,a=new window.Image;a.onload=function(){if(t.canvas&&!t.frameId&&!t.isStart){t.canvas.height=s,t.canvas.width=o;var u=parseInt(o/s*100,10);t.update(a,u),a=null}},a.src=e}}},{key:"update",value:function(e,t){if(this.canvas&&this.canvasCtx&&t)try{var r=this._pos,o=this.config,s=this.canvas.getBoundingClientRect(),a=s.width,u=s.height;if(a!==r.width||u!==r.height||r.pi!==t){var l=parseInt(a/u*100,10);r.pi=t,r.width!==a&&(r.width=this.canvas.width=a),r.height!==u&&(r.height=this.canvas.height=u);var c=u,h=a;l<t?h=parseInt(u*t/100,10):l>t&&(c=parseInt(100*a/t,10)),r.rwidth=h*o.multiple,r.rheight=c*o.multiple,r.x=(a-r.rwidth)/2,r.y=(u-r.rheight)/2}this.canvasFilter&&(this.canvasCtx.filter=o.filter),this.canvasCtx.drawImage(e,r.x,r.y,r.rwidth,r.rheight)}catch(d){Re.logError("plugin:DynamicBg",d)}}},{key:"destroy",value:function(){this.stop(),document.removeEventListener("visibilitychange",this.onVisibilitychange),this.canvasCtx=null,this.canvas=null}},{key:"render",value:function(){return""}}],[{key:"pluginName",get:function(){return"dynamicBg"}},{key:"defaultConfig",get:function(){return{isInnerRender:!1,disable:!0,index:-1,mode:"framerate",frameRate:10,filter:"blur(50px)",startFrameCount:2,startInterval:0,addMask:!0,multiple:1.2,maskBg:"rgba(0,0,0,0.7)"}}},{key:"isSupport",get:function(){return typeof Go=="boolean"?Go:Go=function(){try{return!!document.createElement("canvas").getContext}catch{return!1}}()}},{key:"supportCanvasFilter",value:function(){return!(Pe.browser==="safari"||Pe.browser==="firefox")}}]),n}(),Ei="info",Ko=uh,mg=function(){ye(n,qt);var i=_e(n);function n(){var e;fe(this,n);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return j(O(e=i.call.apply(i,[this].concat(r))),"_recordUserActions",function(s){var a=e._getTime(),u=Object.assign({},s,{msg:s.msg||s.action});e._stats[Ei].push(Ye(Ye({type:"userAction"},a),{},{payload:u}))}),j(O(e),"_onReset",function(){e.reset()}),j(O(e),"_recordInfo",function(s){e.info(s)}),j(O(e),"_downloadStats",function(){var s=e.getStats(),a=new Blob([JSON.stringify(s)],{type:"application/json"}),u=window.URL.createObjectURL(a),l=document.createElement("a");l.style.display="none",l.href=u,l.download="player.txt",l.disabled=!1,l.click()}),e}return pe(n,[{key:"_getTime",value:function(){return{timestamp:Date.now(),timeFormat:new Date().toISOString()}}},{key:"afterCreate",value:function(){this.reset(),this.on(Vr,this._recordUserActions),this.on(Ko.STATS_INFO,this._recordInfo),this.on(Ko.STATS_DOWNLOAD,this._downloadStats),this.on(Ko.STATS_RESET,this._onReset)}},{key:"destroy",value:function(){this.offAll()}},{key:"downloadStats",value:function(){this._downloadStats()}},{key:"info",value:function(e){e.profile?this._infoProfile(e):this._info(e)}},{key:"_info",value:function(e){var t=this._getTime();this._stats[Ei].push(Ye(Ye({},t),{},{payload:e}))}},{key:"_infoProfile",value:function(e){if(e&&e.startMs){var t=Ye({cat:"function",dur:Date.now()-e.startMs,name:e.name||e.msg,ph:"X",pid:0,tid:0,ts:e.startMs,profile:!0},e);this._info(t)}}},{key:"reset",value:function(){var e;this._stats=(j(e={},Ei,[]),j(e,"media",{}),e)}},{key:"getStats",value:function(){for(var e=this.player.media,t=[],r=0;r<e.buffered.length;r++)t.push({start:e.buffered.start(r),end:e.buffered.end(r)});var o={currentTime:e.currentTime,readyState:e.readyState,buffered:t,paused:e.paused,ended:e.ended};return this._stats.media=o,{raw:this._stats,timestat:this._getTimeStats(),profile:this._getProfile()}}},{key:"_getTimeStats",value:function(){return this._stats[Ei].map(function(e){var t=e.payload.data,r="";try{t instanceof Error?r=t.msg:t!==void 0&&(r=JSON.stringify(t))}catch{}return"[".concat(e.timeFormat,"] : ").concat(e.payload.msg," ").concat(r," ")})}},{key:"_getProfile",value:function(){var e={traceEvents:[]};return this._stats[Ei].forEach(function(t){t.payload.profile&&e.traceEvents.push(t.payload)}),e}}],[{key:"pluginName",get:function(){return"stats"}},{key:"defaultConfig",get:function(){return{}}}]),n}(),mh=function(){ye(n,Me);var i=_e(n);function n(){var e;fe(this,n);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return j(O(e=i.call.apply(i,[this].concat(r))),"onGapJump",function(){var s=O(e),a=s.player,u=s.config;if(a.media.readyState!==HTMLMediaElement.HAVE_NOTHING){if(a.media.seeking){if(!e.seekingEventReceived)return}else e.seekingEventReceived=!1;if(!a.media.paused||a.media.currentTime===0||!e.hasPlayed){var l=a.media.buffered,c=u.smallGapLimit||.5,h=u.gapDetectionThreshold||.3,d=a.media.currentTime,f=e._getIndex(l,d,h);if(f!==null&&f!==0){var p=l.start(f)+.1;if(!(p>a.media.duration)){var m=p-d,v=m<=c;m<n.BROWSER_GAP_TOLERANCE||v&&(u.useGapJump!==!1&&(a.media.currentTime=e.isSafari?p+.1:p),e.player&&e.player.emit("detectGap"),p!==.08&&a&&a.emit("log",{type:"oneevent",end_type:"gap",vid:a.config.vid,ext:{video_postion:Math.floor(1e3*p)}}))}}}}}),e}return pe(n,[{key:"afterCreate",value:function(){var e=this;this.config.useGapJump!==!1&&(this.hasPlayed=!1,this.seekingEventReceived=!1,this.isSafari=/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),this.on(Gn,this.onGapJump),this.on(St,function(){e.hasPlayed=!0}),this.on(jn,function(){e.seekingEventReceived=!0}))}},{key:"_getIndex",value:function(e,t,r){if(!e||!e.length||e.length===1&&e.end(0)-e.start(0)<1e-6)return null;for(var o=this._getBuffered(e),s=null,a=0;a<o.length;a++)if(o[a].start>t&&(a===0||o[a-1].end-t<=r)){s=a;break}return s}},{key:"_getBuffered",value:function(e){if(!e)return[];for(var t=[],r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t}}],[{key:"pluginName",get:function(){return"gapJump"}},{key:"defaultConfig",get:function(){return{useGapJump:!1,smallGapLimit:.5,gapDetectionThreshold:.3}}}]),n}();mh.BROWSER_GAP_TOLERANCE=.001;var vg=function(){ye(n,Me);var i=_e(n);function n(){var e;fe(this,n);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return j(O(e=i.call.apply(i,[this].concat(r))),"onWaiting",function(){var s=O(e).config;e.jumpCnt>s.jumpCntMax||e.timer||s.useWaitingTimeoutJump===!1||(e.timer=setTimeout(e.onJump,1e3*s.waitingTime))}),j(O(e),"onJump",function(){var s=O(e),a=s.player,u=s.config;if(clearTimeout(e.timer),e.timer=null,!(e.jumpCnt>u.jumpCntMax||u.useWaitingTimeoutJump===!1||a.media.paused&&a.media.currentTime!==0&&e.hasPlayed)){e.jumpSize=u.jumpSize*(e.jumpCnt+1),e.jumpCnt===u.jumpSize&&e.jumpSize<6&&(e.jumpSize=6);var l=a.currentTime+e.jumpSize;l>a.media.duration||(e.jumpCnt++,a.currentTime=l)}}),e}return pe(n,[{key:"afterCreate",value:function(){var e=this,t=this.config,r=t.useWaitingTimeoutJump,o=t.jumpSize;r!==!1&&(this.hasPlayed=!1,this.jumpCnt=0,this.timer=null,this.jumpSize=o,this.on(Gn,this.onWaiting),this.on([$s,on],function(){clearTimeout(e.timer),e.timer=null,e.jumpSize=e.config.jumpSize}),this.on(St,function(){e.hasPlayed=!0}))}}],[{key:"pluginName",get:function(){return"waitingTimeoutJump"}},{key:"defaultConfig",get:function(){return{useWaitingTimeoutJump:!1,waitingTime:15,jumpSize:2,jumpCntMax:4}}}]),n}(),ni="cdn",fr=["cdn"],yg=function(){ye(n,Me);var i=_e(n);function n(){var e;fe(this,n);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return j(O(e=i.call.apply(i,[this].concat(r))),"getSpeed",function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ni;if(!e.speedListCache||!e.speedListCache[s]||e.speedListCache[s].length<=0)return 0;var a=0;return e.speedListCache[s].map(function(u){a+=u}),Math.floor(a/e.speedListCache[s].length)}),j(O(e),"startTimer",function(){g.isMSE(e.player.video)||(e.initSpeedList(),e.cnt=0,e.timer=setTimeout(e.testSpeed,e.config.testTimeStep))}),j(O(e),"initSpeedList",function(){e.speedListCache={},fr.forEach(function(s){e.speedListCache[s]=[]})}),j(O(e),"_onRealSpeedChange",function(s){s.speed&&e.appendList(s.speed,s.type||ni)}),j(O(e),"testSpeed",function(){if(clearTimeout(e.timer),e.timer=null,e.player&&e.config.openSpeed){var s=e.config,a=s.url,u=s.loadSize,l=s.testCnt,c=s.testTimeStep,h=a+(a.indexOf("?")<0?"?testst=":"&testst=")+Date.now();if(!(e.cnt>=l)){e.cnt++;try{var d=new Date().getTime(),f=null,p=new XMLHttpRequest;e.xhr=p,p.open("GET",h);var m={},v=Math.floor(10*Math.random());m.Range="bytes="+v+"-"+(u+v),m&&Object.keys(m).forEach(function(y){p.setRequestHeader(y,m[y])}),p.onreadystatechange=function(){if(p.readyState===4){e.xhr=null,f=new Date().getTime();var y=p.getResponseHeader("Content-Length")/1024*8,w=Math.round(1e3*y/(f-d));e.appendList(w),e.timer=setTimeout(e.testSpeed,c)}},p.send()}catch{}}}}),j(O(e),"appendList",function(s){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ni;if(e.speedListCache&&e.speedListCache[a]){var u=e.config.saveSpeedMax;e.speedListCache[a].length>=u&&e.speedListCache[a].shift(),e.speedListCache[a].push(s);var l=O(e).player;l&&(a===ni?l.realTimeSpeed=s:l[e.getSpeedName("realTime",a)]=s),e.updateSpeed(a)}}),j(O(e),"updateSpeed",function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ni,a=e.getSpeed(s),u=O(e).player;if(u)if(s===ni)u.avgSpeed&&a===u.avgSpeed||(u.avgSpeed=a,u.emit(fs,{speed:a,realTimeSpeed:u.realTimeSpeed}));else{var l=e.getSpeedName("avg",s);u[l]&&a===u[l]||(u[l]=a,u.emit(fs,{speed:a,realTimeSpeed:u.realTimeSpeed}))}}),e}return pe(n,[{key:"afterCreate",value:function(){var e=this.config,t=e.openSpeed,r=e.addSpeedTypeList;(r==null?void 0:r.length)>0&&fr.push.apply(fr,Bt(r)),this.initSpeedList(),this.on("real_time_speed",this._onRealSpeedChange),this.timer=null,this.cnt=0,this.xhr=null,t&&this.on([cn,Fr],this.startTimer)}},{key:"getSpeedName",value:function(e,t){return e+"Speed"+t.toUpperCase()}},{key:"openSpeed",get:function(){return this.config.openSpeed},set:function(e){if(this.config.openSpeed=e,!e&&this.timer)return clearTimeout(this.timer),void(this.timer=null);if(this.config.openSpeed){if(this.timer)return;this.timer=setTimeout(this.testSpeed,this.config.testTimeStep)}}},{key:"destroy",value:function(){var e=this;this.off("real_time_speed",this._onRealSpeedChange),this.off([cn,Fr],this.startTimer),fr.forEach(function(t){e.speedListCache&&e.speedListCache[t]&&(e.speedListCache[t]=[])}),this.speedListCache&&(this.speedListCache={}),clearTimeout(this.timer),this.timer=null,this.xhr&&this.xhr.readyState!==4&&(this.xhr.cancel&&this.xhr.cancel(),this.xhr=null)}}],[{key:"pluginName",get:function(){return"testspeed"}},{key:"defaultConfig",get:function(){return{openSpeed:!1,testCnt:3,loadSize:204800,testTimeStep:3e3,url:"",saveSpeedMax:5,addSpeedTypeList:[]}}}]),n}(),_g=function(){ye(n,Me);var i=_e(n);function n(){return fe(this,n),i.apply(this,arguments)}return pe(n,[{key:"afterCreate",value:function(){var e=this,t=this.player,r=this.config,o=t.media||t.video;this.timer=null,this._lastDecodedFrames=0,this._currentStuckCount=0,this._lastCheckPoint=null,this._payload=[],r.disabled||o.getVideoPlaybackQuality&&(this.on(St,function(){e._startTick()}),this.on(_i,function(){e._stopTick()}),this.on($n,function(){e._stopTick()}),this.on(Xn,function(){e._stopTick()}))}},{key:"_startTick",value:function(){var e=this;this._stopTick(),this._timer=setTimeout(function(){e._checkDecodeFPS(),e._startTick()},this.config.tick)}},{key:"_stopTick",value:function(){clearTimeout(this._timer),this._timer=null}},{key:"_checkBuffer",value:function(e,t){for(var r=!1,o=[],s=0;s<t.length;s++){var a=t.start(s),u=t.end(s);if(o.push({start:a,end:u}),a<=e&&e<=u-1){r=!0;break}}return{enoughBuffer:r,buffers:o}}},{key:"_checkStuck",value:function(e,t,r,o){var s=this.player.media||this.player.video,a=document.hidden,u=s.paused,l=s.readyState,c=s.currentTime,h=s.buffered;if(!(a||u||l<4)){var d=this._checkBuffer(c,h),f=d.enoughBuffer,p=d.buffers;f&&(e<=this.config.reportFrame?(this._currentStuckCount++,this._payload.push({currentTime:c,buffers:p,curDecodedFrames:e,totalVideoFrames:t,droppedVideoFrames:r,checkInterval:o}),this._currentStuckCount>=this.config.stuckCount&&(this.emit(lh,this._payload),this._reset())):this._reset())}}},{key:"_reset",value:function(){this._payload=[],this._currentStuckCount=0}},{key:"_checkDecodeFPS",value:function(){var e=this.player.media||this.player.video;if(e){var t=e.getVideoPlaybackQuality(),r=t.totalVideoFrames,o=t.droppedVideoFrames,s=performance.now();if(r&&this._lastCheckPoint){var a=r-this._lastDecodedFrames,u=s-this._lastCheckPoint;this._checkStuck(a,r,o,u)}this._lastDecodedFrames=r,this._lastCheckPoint=s}}},{key:"destroy",value:function(){this._stopTick()}}],[{key:"pluginName",get:function(){return"FpsDetect"}},{key:"defaultConfig",get:function(){return{disabled:!1,tick:1e3,stuckCount:3,reportFrame:0}}}]),n}();Vi.use({LANG:"zh-cn",TEXT:{ERROR_TYPES:{network:{code:1,msg:""},mse:{code:2,msg:""},parse:{code:3,msg:""},format:{code:4,msg:""},decoder:{code:5,msg:""},runtime:{code:6,msg:""},timeout:{code:7,msg:""},other:{code:8,msg:""}},HAVE_NOTHING:"/",HAVE_METADATA:"/",HAVE_CURRENT_DATA:"/",HAVE_FUTURE_DATA:"",HAVE_ENOUGH_DATA:"",NETWORK_EMPTY:"/",NETWORK_IDLE:"/",NETWORK_LOADING:"",NETWORK_NO_SOURCE:"/",MEDIA_ERR_ABORTED:"",MEDIA_ERR_NETWORK:"",MEDIA_ERR_DECODE:"",MEDIA_ERR_SRC_NOT_SUPPORTED:"/",REPLAY:"",ERROR:"",PLAY_TIPS:"",PAUSE_TIPS:"",PLAYNEXT_TIPS:"",DOWNLOAD_TIPS:"",ROTATE_TIPS:"",RELOAD_TIPS:"",FULLSCREEN_TIPS:"",EXITFULLSCREEN_TIPS:"",CSSFULLSCREEN_TIPS:"",EXITCSSFULLSCREEN_TIPS:"",TEXTTRACK:"",PIP:"",SCREENSHOT:"",LIVE:"",OFF:"",OPEN:"",MINI_DRAG:"",MINISCREEN:"",REFRESH_TIPS:"",REFRESH:"",FORWARD:"",LIVE_TIP:""}});var bg=pe(function i(n,e){var t,r,o;fe(this,i);var s=e&&e.isMobileSimulateMode==="mobile",a=e.isLive,u=[].concat(a?[]:[Vp,Dp,pg,dg,Hp],[Mp,jp,Yp,Qp,sg,ag,ng,ig,Kp,Jp]),l=[up,lp,cp,Ip,hp,cg,hg,fg,mp];this.plugins=[mg,sp].concat(Bt(u),l,[mh,vg]);var c=s?"mobile":Pe.device;switch(c){case"pc":(t=this.plugins).push.apply(t,[Mu,Ho,ju,yg,_g]);break;case"mobile":(r=this.plugins).push.apply(r,[Lp]);break;default:(o=this.plugins).push.apply(o,[Mu,Ho,ju])}(Pe.os.isIpad||c==="pc")&&this.plugins.push(gg),Pe.os.isIpad&&this.plugins.push(Ho),this.ignores=[],this.i18n=[]}),Rt=function(){ye(n,wr);var i=_e(n);function n(){return fe(this,n),i.apply(this,arguments)}return pe(n)}();j(Rt,"defaultPreset",bg),j(Rt,"Util",g),j(Rt,"Sniffer",Pe),j(Rt,"Errors",nn),j(Rt,"Events",Vf),j(Rt,"Plugin",Me),j(Rt,"BasePlugin",qt),j(Rt,"I18N",Vi),j(Rt,"STATE_CLASS",$),j(Rt,"InstManager",fh);var pr,ys={};Object.defineProperty(ys,"__esModule",{value:!0}),ys.default=function(i){for(var n=0,e=arguments.length,t=Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];var o=!0,s=!1,a=void 0;try{for(var u,l=t[Symbol.iterator]();!(o=(u=l.next()).done);o=!0)n+=u.value.length}catch(w){s=!0,a=w}finally{try{!o&&l.return&&l.return()}finally{if(s)throw a}}var c=new i(n),h=0,d=!0,f=!1,p=void 0;try{for(var m,v=t[Symbol.iterator]();!(d=(m=v.next()).done);d=!0){var y=m.value;c.set(y,h),h+=y.length}}catch(w){f=!0,p=w}finally{try{!d&&v.return&&v.return()}finally{if(f)throw p}}return c};const kg=no(((pr=ys)&&pr.__esModule?pr:{default:pr}).default);function Lt(i,n){if(!(i instanceof n))throw new TypeError("Cannot call a class as a function")}function Ku(i,n){for(var e=0;e<n.length;e++){var t=n[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(i,yh(t.key),t)}}function Ot(i,n,e){return n&&Ku(i.prototype,n),e&&Ku(i,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function X(i,n,e){return(n=yh(n))in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}function wg(i,n){return function(e){if(Array.isArray(e))return e}(i)||function(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var o,s,a,u,l=[],c=!0,h=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(c=(o=a.call(r)).done)&&(l.push(o.value),l.length!==t);c=!0);}catch(d){h=!0,s=d}finally{try{if(!c&&r.return!=null&&(u=r.return(),Object(u)!==u))return}finally{if(h)throw s}}return l}}(i,n)||vh(i,n)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Et(i){return function(n){if(Array.isArray(n))return _s(n)}(i)||function(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}(i)||vh(i)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function vh(i,n){if(i){if(typeof i=="string")return _s(i,n);var e=Object.prototype.toString.call(i).slice(8,-1);return e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set"?Array.from(i):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_s(i,n):void 0}}function _s(i,n){(n==null||n>i.length)&&(n=i.length);for(var e=0,t=new Array(n);e<n;e++)t[e]=i[e];return t}function yh(i){var n=function(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var o=r.call(e,t||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}(i,"string");return typeof n=="symbol"?n:String(n)}var Tr="video",Tg="audio",xg="metadata",Sg="avc",bs="hevc",qu="aac",Cg="g7110a",Eg="g7110m",Pg=function(){function i(){Lt(this,i),X(this,"id",1),X(this,"type",Tr),X(this,"codecType",Sg),X(this,"pid",-1),X(this,"hvcC",void 0),X(this,"codec",""),X(this,"timescale",0),X(this,"formatTimescale",0),X(this,"sequenceNumber",0),X(this,"baseMediaDecodeTime",0),X(this,"baseDts",0),X(this,"duration",0),X(this,"warnings",[]),X(this,"samples",[]),X(this,"pps",[]),X(this,"sps",[]),X(this,"vps",[]),X(this,"fpsNum",0),X(this,"fpsDen",0),X(this,"sarRatio",[]),X(this,"width",0),X(this,"height",0),X(this,"nalUnitSize",4),X(this,"present",!1),X(this,"isVideoEncryption",!1),X(this,"isAudioEncryption",!1),X(this,"isVideo",!0),X(this,"kid",null),X(this,"pssh",null),X(this,"ext",void 0)}return Ot(i,[{key:"reset",value:function(){this.sequenceNumber=this.width=this.height=this.fpsDen=this.fpsNum=this.duration=this.baseMediaDecodeTime=this.timescale=0,this.codec="",this.present=!1,this.pid=-1,this.pps=[],this.sps=[],this.vps=[],this.sarRatio=[],this.samples=[],this.warnings=[],this.hvcC=null}},{key:"firstDts",get:function(){return this.samples.length?this.samples[0].dts:null}},{key:"firstPts",get:function(){return this.samples.length?this.samples[0].pts:null}},{key:"samplesDuration",get:function(){if(this.samples.length>0){var n=this.samples[0],e=this.samples[this.samples.length-1];return e.dts-n.dts+e.duration}return 0}},{key:"exist",value:function(){return!!(this.pps.length&&this.sps.length&&this.codec)}},{key:"hasSample",value:function(){return!!this.samples.length}},{key:"isEncryption",get:function(){return this.isVideoEncryption}}]),i}(),Lg=function(){function i(){Lt(this,i),X(this,"id",2),X(this,"type",Tg),X(this,"codecType",qu),X(this,"pid",-1),X(this,"codec",""),X(this,"sequenceNumber",0),X(this,"sampleDuration",0),X(this,"timescale",0),X(this,"formatTimescale",0),X(this,"baseMediaDecodeTime",0),X(this,"duration",0),X(this,"warnings",[]),X(this,"samples",[]),X(this,"baseDts",0),X(this,"sampleSize",16),X(this,"sampleRate",0),X(this,"channelCount",0),X(this,"objectType",0),X(this,"sampleRateIndex",0),X(this,"config",[]),X(this,"present",!1),X(this,"isVideoEncryption",!1),X(this,"isAudioEncryption",!1),X(this,"kid",null),X(this,"ext",void 0)}return Ot(i,[{key:"reset",value:function(){this.sequenceNumber=0,this.timescale=0,this.sampleDuration=0,this.sampleRate=0,this.channelCount=0,this.baseMediaDecodeTime=0,this.present=!1,this.pid=-1,this.codec="",this.samples=[],this.config=[],this.warnings=[]}},{key:"exist",value:function(){return!!(this.sampleRate&&this.channelCount&&this.codec&&this.codecType===qu)}},{key:"hasSample",value:function(){return!!this.samples.length}},{key:"isEncryption",get:function(){return this.isAudioEncryption}},{key:"firstDts",get:function(){return this.samples.length?this.samples[0].dts:null}},{key:"firstPts",get:function(){return this.samples.length?this.samples[0].pts:null}},{key:"samplesDuration",get:function(){if(this.samples.length>0){var n=this.samples[0],e=this.samples[this.samples.length-1];return e.dts-n.dts+e.duration}return 0}}]),i}(),Yu=function(){function i(n,e,t){Lt(this,i),X(this,"flag",{}),X(this,"keyframe",!1),X(this,"gopId",0),X(this,"duration",0),X(this,"size",0),X(this,"units",[]),X(this,"chromaFormat",420),this.originPts=this.pts=n,this.originDts=this.dts=e,t&&(this.units=t)}return Ot(i,[{key:"cts",get:function(){return this.pts-this.dts}},{key:"setToKeyframe",value:function(){this.keyframe=!0,this.flag.dependsOn=2,this.flag.isNonSyncSample=0}}]),i}(),$u=Ot(function i(n,e,t,r){Lt(this,i),X(this,"duration",1024),X(this,"flag",{dependsOn:2,isNonSyncSample:0}),X(this,"keyframe",!0),this.originPts=this.pts=this.dts=n,this.data=e,this.size=e.byteLength,this.sampleOffset=r,t&&(this.duration=t)}),Og=function(){function i(){Lt(this,i),X(this,"id",3),X(this,"type",xg),X(this,"timescale",0),X(this,"flvScriptSamples",[]),X(this,"seiSamples",[])}return Ot(i,[{key:"exist",value:function(){return!(!this.flvScriptSamples.length&&!this.seiSamples.length||!this.timescale)}},{key:"reset",value:function(){this.timescale=0,this.flvScriptSamples=[],this.seiSamples=[]}},{key:"hasSample",value:function(){return!(!this.flvScriptSamples.length&&!this.seiSamples.length)}}]),i}(),ia=typeof window<"u",_h=ia&&navigator.userAgent.toLocaleLowerCase(),Ig=ia&&_h.includes("firefox"),Rg=ia&&_h.includes("android"),Ii=function(){function i(){Lt(this,i)}return Ot(i,null,[{key:"getRateIndexByRate",value:function(n){return i.FREQ.indexOf(n)}},{key:"parseADTS",value:function(n,e){for(var t=n.length,r=0;r+2<t&&(n[r]!==255||(246&n[r+1])!=240);)r++;if(!(r>=t)){var o=r,s=[],a=(60&n[r+2])>>>2,u=i.FREQ[a];if(!u)throw new Error("Invalid sampling index: ".concat(a));for(var l,c,h=1+((192&n[r+2])>>>6),d=(1&n[r+2])<<2|(192&n[r+3])>>>6,f=i._getConfig(a,d,h),p=f.config,m=f.codec,v=0,y=i.getFrameDuration(u);r+7<t;)if(n[r]===255&&(246&n[r+1])==240){if(t-r<(c=(3&n[r+3])<<11|n[r+4]<<3|(224&n[r+5])>>5))break;l=2*(1&~n[r+1]),s.push({pts:e+v*y,data:n.subarray(r+7+l,r+c)}),v++,r+=c}else r++;return{skip:o,remaining:r>=t?void 0:n.subarray(r),frames:s,samplingFrequencyIndex:a,sampleRate:u,objectType:h,channelCount:d,codec:m,config:p,originCodec:"mp4a.40.".concat(h)}}}},{key:"parseAudioSpecificConfig",value:function(n){if(n.length){var e=n[0]>>>3,t=(7&n[0])<<1|n[1]>>>7,r=(120&n[1])>>>3,o=i.FREQ[t];if(o){var s=i._getConfig(t,r,e);return{samplingFrequencyIndex:t,sampleRate:o,objectType:e,channelCount:r,config:s.config,codec:s.codec,originCodec:"mp4a.40.".concat(e)}}}}},{key:"getFrameDuration",value:function(n){return 1024*(arguments.length>1&&arguments[1]!==void 0?arguments[1]:9e4)/n}},{key:"_getConfig",value:function(n,e,t){var r,o,s=[];return Ig?n>=6?(r=5,o=n-3):(r=2,o=n):Rg?(r=2,o=n):(r=t===2||t===5?t:5,o=n,n>=6?o=n-3:e===1&&(r=2,o=n)),s[0]=r<<3,s[0]|=(14&n)>>1,s[1]=(1&n)<<7,s[1]|=e<<3,r===5&&(s[1]|=(14&o)>>1,s[2]=(1&o)<<7,s[2]|=8,s[3]=0),{config:s,codec:"mp4a.40.".concat(r)}}},{key:"getSilentFrame",value:function(n,e){if(n==="mp4a.40.2"){if(e===1)return new Uint8Array([0,200,0,128,35,128]);if(e===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(e===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(e===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(e===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(e===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(e===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(e===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(e===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}]),i}();function Jt(){for(var i=arguments.length,n=new Array(i),e=0;e<i;e++)n[e]=arguments[e];n=n.filter(Boolean);var t=new Uint8Array(n.reduce(function(o,s){return o+s.byteLength},0)),r=0;return n.forEach(function(o){t.set(o,r),r+=o.byteLength}),t}X(Ii,"FREQ",[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350]);var Ag=Math.pow(2,32);function je(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(i[n]<<8)+(i[n+1]||0)}function ne(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(i[n]<<24>>>0)+(i[n+1]<<16)+(i[n+2]<<8)+(i[n+3]||0)}function yn(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return ne(i,n)*Ag+ne(i,n+4)}function Xu(i){if(!Array.isArray(i)){for(var n=[],e="",t=0;t<i.length;t++)t%2&&(e=i[t-1]+i[t],n.push(parseInt(e,16)),e="");return n}return i.map(function(r){return parseInt(r,16)})}var Mt=function(){function i(){Lt(this,i)}return Ot(i,null,[{key:"findBox",value:function(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=[];if(!n)return r;for(var o=0,s="",a=0;n.length>7;){if(o=ne(n),s=String.fromCharCode.apply(null,n.subarray(4,8)),a=8,o===1?(o=yn(n,8),a+=8):o||(o=n.length),!e[0]||s===e[0]){var u=n.subarray(0,o);if(!(e.length<2))return i.findBox(u.subarray(a),e.slice(1),t+a);r.push({start:t,size:o,headerSize:a,type:s,data:u})}t+=o,n=n.subarray(o)}return r}},{key:"tfhd",value:function(n){return Te(n,!0,function(e,t){e.trackId=ne(t);var r=4,o=1&e.flags,s=2&e.flags,a=8&e.flags,u=16&e.flags,l=32&e.flags;o&&(r+=4,e.baseDataOffset=ne(t,r),r+=4),s&&(e.sampleDescriptionIndex=ne(t,r),r+=4),a&&(e.defaultSampleDuration=ne(t,r),r+=4),u&&(e.defaultSampleSize=ne(t,r),r+=4),l&&(e.defaultSampleFlags=ne(t,r))})}},{key:"sidx",value:function(n){return Te(n,!0,function(e,t){var r=0;e.reference_ID=ne(t,r),r+=4,e.timescale=ne(t,r),r+=4,e.version===0?(e.earliest_presentation_time=ne(t,r),r+=4,e.first_offset=ne(t,r),r+=4):(e.earliest_presentation_time=yn(t,r),r+=8,e.first_offset=yn(t,r),r+=8),r+=2,e.references=[];var o=je(t,r);r+=2;for(var s=0;s<o;s++){var a={};e.references.push(a);var u=ne(t,r);r+=4,a.reference_type=u>>31&1,a.referenced_size=2147483647&u,a.subsegment_duration=ne(t,r),u=ne(t,r+=4),r+=4,a.starts_with_SAP=u>>31&1,a.SAP_type=u>>28&7,a.SAP_delta_time=268435455&u}})}},{key:"moov",value:function(n){return Te(n,!1,function(e,t,r){e.mvhd=i.mvhd(i.findBox(t,["mvhd"],r)[0]),e.trak=i.findBox(t,["trak"],r).map(function(o){return i.trak(o)}),e.pssh=i.pssh(i.findBox(t,["pssh"],r)[0])})}},{key:"mvhd",value:function(n){return Te(n,!0,function(e,t){var r=0;e.version===1?(e.timescale=ne(t,16),e.duration=yn(t,20),r+=28):(e.timescale=ne(t,8),e.duration=ne(t,12),r+=16),e.nextTrackId=ne(t,r+76)})}},{key:"trak",value:function(n){return Te(n,!1,function(e,t,r){e.tkhd=i.tkhd(i.findBox(t,["tkhd"],r)[0]),e.mdia=i.mdia(i.findBox(t,["mdia"],r)[0])})}},{key:"tkhd",value:function(n){return Te(n,!0,function(e,t){var r=0;e.version===1?(e.trackId=ne(t,16),e.duration=yn(t,24),r+=32):(e.trackId=ne(t,8),e.duration=ne(t,16),r+=20),e.width=ne(t,r+52),e.height=ne(t,r+56)})}},{key:"mdia",value:function(n){return Te(n,!1,function(e,t,r){e.mdhd=i.mdhd(i.findBox(t,["mdhd"],r)[0]),e.hdlr=i.hdlr(i.findBox(t,["hdlr"],r)[0]),e.minf=i.minf(i.findBox(t,["minf"],r)[0])})}},{key:"mdhd",value:function(n){return Te(n,!0,function(e,t){var r=0;e.version===1?(e.timescale=ne(t,16),e.duration=yn(t,20),r+=28):(e.timescale=ne(t,8),e.duration=ne(t,12),r+=16);var o=je(t,r);e.language=String.fromCharCode(96+(o>>10&31),96+(o>>5&31),96+(31&o))})}},{key:"hdlr",value:function(n){return Te(n,!0,function(e,t){e.version===0&&(e.handlerType=String.fromCharCode.apply(null,t.subarray(4,8)))})}},{key:"minf",value:function(n){return Te(n,!1,function(e,t,r){e.vmhd=i.vmhd(i.findBox(t,["vmhd"],r)[0]),e.smhd=i.smhd(i.findBox(t,["smhd"],r)[0]),e.stbl=i.stbl(i.findBox(t,["stbl"],r)[0])})}},{key:"vmhd",value:function(n){return Te(n,!0,function(e,t){e.graphicsmode=je(t),e.opcolor=[je(t,2),je(t,4),je(t,6)]})}},{key:"smhd",value:function(n){return Te(n,!0,function(e,t){e.balance=je(t)})}},{key:"stbl",value:function(n){return Te(n,!1,function(e,t,r){var o,s,a;e.stsd=i.stsd(i.findBox(t,["stsd"],r)[0]),e.stts=i.stts(i.findBox(t,["stts"],r)[0]),e.ctts=i.ctts(i.findBox(t,["ctts"],r)[0]),e.stsc=i.stsc(i.findBox(t,["stsc"],r)[0]),e.stsz=i.stsz(i.findBox(t,["stsz"],r)[0]),e.stco=i.stco(i.findBox(t,["stco"],r)[0]),e.stco||(e.co64=i.co64(i.findBox(t,["co64"],r)[0]),e.stco=e.co64);var u=(o=e.stsd.entries[0])===null||o===void 0||(s=o.sinf)===null||s===void 0||(a=s.schi)===null||a===void 0?void 0:a.tenc.default_IV_size;e.stss=i.stss(i.findBox(t,["stss"],r)[0]),e.senc=i.senc(i.findBox(t,["senc"],r)[0],u)})}},{key:"senc",value:function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;return Te(n,!0,function(t,r){var o=0,s=ne(r,o);o+=4,t.samples=[];for(var a=0;a<s;a++){for(var u={InitializationVector:[]},l=0;l<e;l++)u.InitializationVector[l]=r[o+l];if(o+=e,2&t.flags){u.subsamples=[];var c=je(r,o);o+=2;for(var h=0;h<c;h++){var d={};d.BytesOfClearData=je(r,o),o+=2,d.BytesOfProtectedData=ne(r,o),o+=4,u.subsamples.push(d)}}t.samples.push(u)}})}},{key:"pssh",value:function(n){return Te(n,!0,function(e,t){for(var r=[],o=[],s=0,a=0;a<16;a++)o.push(qo(t[s+a]));if(s+=16,e.version>0){var u=ne(t,s);s+=4;for(var l=0;l<(""+u).length;l++)for(var c=0;c<16;c++){var h=t[s];s+=1,r.push(qo(h))}}var d=ne(t,s);e.data_size=d,s+=4,e.kid=r,e.system_id=o,e.buffer=t})}},{key:"stsd",value:function(n){return Te(n,!0,function(e,t,r){e.entryCount=ne(t),e.entries=i.findBox(t.subarray(4),[],r+4).map(function(o){switch(o.type){case"avc1":case"avc2":case"avc3":case"avc4":return i.avc1(o);case"hvc1":case"hev1":return i.hvc1(o);case"mp4a":return i.mp4a(o);case"alaw":case"ulaw":return i.alaw(o);case"enca":return Te(o,!1,function(s,a,u){s.channelCount=je(a,16),s.samplesize=je(a,18),s.sampleRate=ne(a,24)/65536,a=a.subarray(28),s.sinf=i.sinf(i.findBox(a,["sinf"],u)[0]),s.esds=i.esds(i.findBox(a,["esds"],u)[0])});case"encv":return Te(o,!1,function(s,a,u){s.width=je(a,24),s.height=je(a,26),s.horizresolution=ne(a,28),s.vertresolution=ne(a,32),a=a.subarray(78),s.sinf=i.sinf(i.findBox(a,["sinf"],u)[0]),s.avcC=i.avcC(i.findBox(a,["avcC"],u)[0]),s.hvcC=i.hvcC(i.findBox(a,["hvcC"],u)[0]),s.pasp=i.pasp(i.findBox(a,["pasp"],u)[0])})}}).filter(Boolean)})}},{key:"tenc",value:function(n){return Te(n,!1,function(e,t){var r=6;e.default_IsEncrypted=t[r],r+=1,e.default_IV_size=t[r],r+=1,e.default_KID=[];for(var o=0;o<16;o++)e.default_KID.push(qo(t[r])),r+=1})}},{key:"schi",value:function(n){return Te(n,!1,function(e,t,r){e.tenc=i.tenc(i.findBox(t,["tenc"],r)[0])})}},{key:"sinf",value:function(n){return Te(n,!1,function(e,t,r){e.schi=i.schi(i.findBox(t,["schi"],r)[0]),e.frma=i.frma(i.findBox(t,["frma"],r)[0])})}},{key:"frma",value:function(n){return Te(n,!1,function(e,t){e.data_format="";for(var r=0;r<4;r++)e.data_format+=String.fromCharCode(t[r])})}},{key:"avc1",value:function(n){return Te(n,!1,function(e,t,r){var o=Zu(e,t),s=t.subarray(o);r+=o,e.avcC=i.avcC(i.findBox(s,["avcC"],r)[0]),e.pasp=i.pasp(i.findBox(s,["pasp"],r)[0])})}},{key:"avcC",value:function(n){return Te(n,!1,function(e,t){e.data=n.data,e.configurationVersion=t[0],e.AVCProfileIndication=t[1],e.profileCompatibility=t[2],e.AVCLevelIndication=t[3],e.codec=function(l){for(var c,h="avc1.",d=0;d<3;d++)(c=l[d].toString(16)).length<2&&(c="0".concat(c)),h+=c;return h}([t[1],t[2],t[3]]),e.lengthSizeMinusOne=3&t[4],e.spsLength=31&t[5],e.sps=[];for(var r=6,o=0;o<e.spsLength;o++){var s=je(t,r);r+=2,e.sps.push(t.subarray(r,r+s)),r+=s}e.ppsLength=t[r],r+=1,e.pps=[];for(var a=0;a<e.ppsLength;a++){var u=je(t,r);r+=2,e.pps.push(t.subarray(r,r+=u)),r+=u}})}},{key:"hvc1",value:function(n){return Te(n,!1,function(e,t,r){var o=Zu(e,t),s=t.subarray(o);r+=o,e.hvcC=i.hvcC(i.findBox(s,["hvcC"],r)[0]),e.pasp=i.pasp(i.findBox(s,["pasp"],r)[0])})}},{key:"hvcC",value:function(n){return Te(n,!1,function(e,t){e.data=n.data,e.codec="hev1.1.6.L93.B0",e.configurationVersion=t[0];var r=t[1];e.generalProfileSpace=r>>6,e.generalTierFlag=(32&r)>>5,e.generalProfileIdc=31&r,e.generalProfileCompatibility=ne(t,2),e.generalConstraintIndicatorFlags=t.subarray(6,12),e.generalLevelIdc=t[12],e.avgFrameRate=je(t,19),e.numOfArrays=t[22],e.vps=[],e.sps=[],e.pps=[];for(var o=23,s=0,a=0,u=0,l=0;l<e.numOfArrays;l++){s=63&t[o],a=je(t,o+1),o+=3;for(var c,h=[],d=0;d<a;d++)u=je(t,o),o+=2,h.push(t.subarray(o,o+u)),o+=u;if(s===32)(c=e.vps).push.apply(c,h);else if(s===33){var f;(f=e.sps).push.apply(f,h)}else if(s===34){var p;(p=e.pps).push.apply(p,h)}}})}},{key:"pasp",value:function(n){return Te(n,!1,function(e,t){e.hSpacing=ne(t),e.vSpacing=ne(t,4)})}},{key:"mp4a",value:function(n){return Te(n,!1,function(e,t,r){var o=Qu(e,t);e.esds=i.esds(i.findBox(t.subarray(o),["esds"],r+o)[0])})}},{key:"esds",value:function(n){return Te(n,!0,function(e,t){e.codec="mp4a.";for(var r=0,o=0,s=0,a=0;t.length;){for(a=t[r=0],o=t[r+1],r+=2;128&o;)s=(127&o)<<7,o=t[r],r+=1;if(s+=127&o,a===3)t=t.subarray(r+3);else{if(a!==4){if(a===5){var u=e.config=t.subarray(r,r+s),l=(248&u[0])>>3;return l===31&&u.length>=2&&(l=32+((7&u[0])<<3)+((224&u[1])>>5)),e.objectType=l,e.codec+=l.toString(16),void(e.codec[e.codec.length-1]==="."&&(e.codec=e.codec.substring(0,e.codec.length-1)))}return void(e.codec[e.codec.length-1]==="."&&(e.codec=e.codec.substring(0,e.codec.length-1)))}e.codec+=(t[r].toString(16)+".").padStart(3,"0"),t=t.subarray(r+13)}}})}},{key:"alaw",value:function(n){return Te(n,!1,function(e,t){Qu(e,t)})}},{key:"stts",value:function(n){return Te(n,!0,function(e,t){for(var r=ne(t),o=[],s=4,a=0;a<r;a++)o.push({count:ne(t,s),delta:ne(t,s+4)}),s+=8;e.entryCount=r,e.entries=o})}},{key:"ctts",value:function(n){return Te(n,!0,function(e,t){var r=ne(t),o=[],s=4;if(e.version===1)for(var a=0;a<r;a++)o.push({count:ne(t,s),offset:ne(t,s+4)}),s+=8;else for(var u=0;u<r;u++)o.push({count:ne(t,s),offset:-(1+~ne(t,s+4))}),s+=8;e.entryCount=r,e.entries=o})}},{key:"stsc",value:function(n){return Te(n,!0,function(e,t){for(var r=ne(t),o=[],s=4,a=0;a<r;a++)o.push({firstChunk:ne(t,s),samplesPerChunk:ne(t,s+4),sampleDescriptionIndex:ne(t,s+8)}),s+=12;e.entryCount=r,e.entries=o})}},{key:"stsz",value:function(n){return Te(n,!0,function(e,t){var r=ne(t),o=ne(t,4),s=[];if(!r)for(var a=8,u=0;u<o;u++)s.push(ne(t,a)),a+=4;e.sampleSize=r,e.sampleCount=o,e.entrySizes=s})}},{key:"stco",value:function(n){return Te(n,!0,function(e,t){for(var r=ne(t),o=[],s=4,a=0;a<r;a++)o.push(ne(t,s)),s+=4;e.entryCount=r,e.entries=o})}},{key:"co64",value:function(n){return Te(n,!0,function(e,t){for(var r=ne(t),o=[],s=4,a=0;a<r;a++)o.push(yn(t,s)),s+=8;e.entryCount=r,e.entries=o})}},{key:"stss",value:function(n){return Te(n,!0,function(e,t){for(var r=ne(t),o=[],s=4,a=0;a<r;a++)o.push(ne(t,s)),s+=4;e.entryCount=r,e.entries=o})}},{key:"moof",value:function(n){return Te(n,!1,function(e,t,r){e.mfhd=i.mfhd(i.findBox(t,["mfhd"],r)[0]),e.traf=i.findBox(t,["traf"],r).map(function(o){return i.traf(o)})})}},{key:"mfhd",value:function(n){return Te(n,!0,function(e,t){e.sequenceNumber=ne(t)})}},{key:"traf",value:function(n){return Te(n,!1,function(e,t,r){e.tfhd=i.tfhd(i.findBox(t,["tfhd"],r)[0]),e.tfdt=i.tfdt(i.findBox(t,["tfdt"],r)[0]),e.trun=i.trun(i.findBox(t,["trun"],r)[0])})}},{key:"trun",value:function(n){return Te(n,!0,function(e,t){var r=e.version,o=e.flags,s=t.length,a=e.sampleCount=ne(t),u=4;if(s>u&&1&o&&(e.dataOffset=-(1+~ne(t,u)),u+=4),s>u&&4&o&&(e.firstSampleFlags=ne(t,u),u+=4),e.samples=[],s>u)for(var l,c=0;c<a;c++)l={},256&o&&(l.duration=ne(t,u),u+=4),512&o&&(l.size=ne(t,u),u+=4),1024&o&&(l.flags=ne(t,u),u+=4),2048&o&&(l.cts=r?-(1+~ne(t,u+4)):ne(t,u),u+=4),e.samples.push(l)})}},{key:"tfdt",value:function(n){return Te(n,!0,function(e,t){e.version===1?e.baseMediaDecodeTime=yn(t):e.baseMediaDecodeTime=ne(t)})}},{key:"probe",value:function(n){return!!i.findBox(n,["ftyp"])}},{key:"parseSampleFlags",value:function(n){return{isLeading:(12&n[0])>>>2,dependsOn:3&n[0],isDependedOn:(192&n[1])>>>6,hasRedundancy:(48&n[1])>>>4,paddingValue:(14&n[1])>>>1,isNonSyncSample:1&n[1],degradationPriority:n[2]<<8|n[3]}}},{key:"moovToTrack",value:function(n,e,t){var r,o,s=n.trak;if(s&&s.length){var a=s.find(function(F){var A,K;return((A=F.mdia)===null||A===void 0||(K=A.hdlr)===null||K===void 0?void 0:K.handlerType)==="vide"}),u=s.find(function(F){var A,K;return((A=F.mdia)===null||A===void 0||(K=A.hdlr)===null||K===void 0?void 0:K.handlerType)==="soun"});if(a&&e){var l,c,h,d,f,p,m,v=e,y=(l=a.tkhd)===null||l===void 0?void 0:l.trackId;y!=null&&(v.id=a.tkhd.trackId),v.tkhdDuration=a.tkhd.duration,v.mvhdDurtion=n.mvhd.duration,v.mvhdTimecale=n.mvhd.timescale,v.timescale=v.formatTimescale=a.mdia.mdhd.timescale,v.duration=a.mdia.mdhd.duration||v.mvhdDurtion/v.mvhdTimecale*v.timescale;var w,S,C,E,R,W,J,se,U=a.mdia.minf.stbl.stsd.entries[0];if(v.width=U.width,v.height=U.height,U.pasp&&(v.sarRatio=[U.pasp.hSpacing,U.pasp.vSpacing]),U.hvcC)v.codecType=bs,v.codec=U.hvcC.codec,v.vps=U.hvcC.vps,v.sps=U.hvcC.sps,v.pps=U.hvcC.pps,v.hvcC=U.hvcC.data;else{if(!U.avcC)throw new Error("unknown video stsd entry");v.codec=U.avcC.codec,v.sps=U.avcC.sps,v.pps=U.avcC.pps}v.present=!0,v.ext={},v.ext.stss=(c=a.mdia)===null||c===void 0||(h=c.minf)===null||h===void 0||(d=h.stbl)===null||d===void 0?void 0:d.stss,v.ext.ctts=(f=a.mdia)===null||f===void 0||(p=f.minf)===null||p===void 0||(m=p.stbl)===null||m===void 0?void 0:m.ctts,U&&U.type==="encv"&&(v.isVideoEncryption=!0,U.default_KID=(w=U.sinf)===null||w===void 0||(S=w.schi)===null||S===void 0?void 0:S.tenc.default_KID,U.default_IsEncrypted=(C=U.sinf)===null||C===void 0||(E=C.schi)===null||E===void 0?void 0:E.tenc.default_IsEncrypted,U.default_IV_size=(R=U.sinf)===null||R===void 0||(W=R.schi)===null||W===void 0?void 0:W.tenc.default_IV_size,v.videoSenc=a.mdia.minf.stbl.senc&&a.mdia.minf.stbl.senc.samples,U.data_format=(J=U.sinf)===null||J===void 0||(se=J.frma)===null||se===void 0?void 0:se.data_format,v.useEME=n.useEME,v.kidValue=n.kidValue,v.pssh=n.pssh,v.encv=U)}if(u&&t){var ae,b,k,T,N,P,B,Q,he,H=t,L=(ae=u.tkhd)===null||ae===void 0?void 0:ae.trackId;L!=null&&(H.id=u.tkhd.trackId),H.tkhdDuration=u.tkhd.duration,H.mvhdDurtion=n.mvhd.duration,H.mvhdTimecale=n.mvhd.timescale,H.timescale=H.formatTimescale=u.mdia.mdhd.timescale,H.duration=u.mdia.mdhd.duration||H.mvhdDurtion/H.mvhdTimecale*H.timescale;var M,G,re,Ee,Le,le,ge,ce,ve=u.mdia.minf.stbl.stsd.entries[0];switch(H.sampleSize=ve.sampleSize,H.sampleRate=ve.sampleRate,H.channelCount=ve.channelCount,H.present=!0,ve.type){case"alaw":H.codecType=H.codec=Cg,H.sampleRate=8e3;break;case"ulaw":H.codecType=H.codec=Eg,H.sampleRate=8e3;break;default:H.sampleDuration=Ii.getFrameDuration(H.sampleRate,H.timescale),H.sampleRateIndex=Ii.getRateIndexByRate(H.sampleRate),H.objectType=((r=ve.esds)===null||r===void 0?void 0:r.objectType)||2,ve.esds&&(H.config=Array.from(ve.esds.config)),H.codec=((o=ve.esds)===null||o===void 0?void 0:o.codec)||"mp4a.40.2"}H.sampleDuration=Ii.getFrameDuration(H.sampleRate,H.timescale),H.objectType=((b=ve.esds)===null||b===void 0?void 0:b.objectType)||2,ve.esds&&ve.esds.config&&(H.config=Array.from(ve.esds.config)),H.codec=((k=ve.esds)===null||k===void 0?void 0:k.codec)||"mp4a.40.2",H.sampleRateIndex=Ii.getRateIndexByRate(H.sampleRate),H.ext={},H.ext.stss=(T=u.mdia)===null||T===void 0||(N=T.minf)===null||N===void 0||(P=N.stbl)===null||P===void 0?void 0:P.stss,H.ext.ctts=(B=u.mdia)===null||B===void 0||(Q=B.minf)===null||Q===void 0||(he=Q.stbl)===null||he===void 0?void 0:he.ctts,H.present=!0,ve&&ve.type==="enca"&&(H.isAudioEncryption=!0,ve.data_format=(M=ve.sinf)===null||M===void 0||(G=M.frma)===null||G===void 0?void 0:G.data_format,ve.default_KID=(re=ve.sinf)===null||re===void 0||(Ee=re.schi)===null||Ee===void 0?void 0:Ee.tenc.default_KID,ve.default_IsEncrypted=(Le=ve.sinf)===null||Le===void 0||(le=Le.schi)===null||le===void 0?void 0:le.tenc.default_IsEncrypted,ve.default_IV_size=(ge=ve.sinf)===null||ge===void 0||(ce=ge.schi)===null||ce===void 0?void 0:ce.tenc.default_IV_size,H.audioSenc=u.mdia.minf.stbl.senc&&u.mdia.minf.stbl.senc.samples,H.useEME=n.useEME,H.kidValue=n.kidValue,H.enca=ve)}if(t&&(t.isVideoEncryption=!!e&&e.isVideoEncryption),e&&(e.isAudioEncryption=!!t&&t.isAudioEncryption),e!=null&&e.encv||t!=null&&t.enca){var Oe,_,x=e==null||(Oe=e.encv)===null||Oe===void 0?void 0:Oe.default_KID,I=t==null||(_=t.enca)===null||_===void 0?void 0:_.default_KID,z=x||I?(x||I).join(""):null;e&&(e.kid=z),t&&(t.kid=z)}return e&&(e.flags=3841),t&&(t.flags=1793),{videoTrack:e,audioTrack:t}}}},{key:"evaluateDefaultDuration",value:function(n,e,t){var r,o=e==null||(r=e.samples)===null||r===void 0?void 0:r.length;return o?1024*o/e.timescale*n.timescale/t:1024}},{key:"moofToSamples",value:function(n,e,t){var r={};return n.mfhd&&(e&&(e.sequenceNumber=n.mfhd.sequenceNumber),t&&(t.sequenceNumber=n.mfhd.sequenceNumber)),n.traf.forEach(function(o){var s=o.tfhd,a=o.tfdt,u=o.trun;if(s&&u){a&&(e&&e.id===s.trackId&&(e.baseMediaDecodeTime=a.baseMediaDecodeTime),t&&t.id===s.trackId&&(t.baseMediaDecodeTime=a.baseMediaDecodeTime));var l=s.defaultSampleSize||0,c=s.defaultSampleDuration||i.evaluateDefaultDuration(e,t,u.samples.length||u.sampleCount),h=u.dataOffset||0,d=0,f=-1;if(!u.samples.length&&u.sampleCount){r[s.trackId]=[];for(var p=0;p<u.sampleCount;p++)r[s.trackId].push({offset:h,dts:d,duration:c,size:l}),d+=c,h+=l}else r[s.trackId]=u.samples.map(function(m,v){return(m={offset:h,dts:d,pts:d+(m.cts||0),duration:m.duration||c,size:m.size||l,gopId:f,keyframe:v===0||m.flags!==null&&m.flags!==void 0&&(65536&m.flags)>>>0!=65536}).keyframe&&(f++,m.gopId=f),d+=m.duration,h+=m.size,m})}}),r}},{key:"moovToSamples",value:function(n){var e=n.trak;if(e&&e.length){var t=e.find(function(se){var U,ae;return((U=se.mdia)===null||U===void 0||(ae=U.hdlr)===null||ae===void 0?void 0:ae.handlerType)==="vide"}),r=e.find(function(se){var U,ae;return((U=se.mdia)===null||U===void 0||(ae=U.hdlr)===null||ae===void 0?void 0:ae.handlerType)==="soun"});if(t||r){var o,s;if(t){var a,u,l=(a=t.mdia)===null||a===void 0||(u=a.minf)===null||u===void 0?void 0:u.stbl;if(!l)return;var c=l.stts,h=l.stsc,d=l.stsz,f=l.stco,p=l.stss,m=l.ctts;if(!(c&&h&&d&&f&&p))return;o=Ju(c,h,d,f,m,p)}if(r){var v,y,w,S=(v=r.mdia)===null||v===void 0||(y=v.minf)===null||y===void 0?void 0:y.stbl;if(!S)return;var C=(w=r.mdia.mdhd)===null||w===void 0?void 0:w.timescale,E=S.stts,R=S.stsc,W=S.stsz,J=S.stco;if(!(C&&E&&R&&W&&J))return;s=Ju(E,R,W,J)}return{videoSamples:o,audioSamples:s}}}}}]),i}();function Ju(i,n,e,t,r,o){var s,a,u,l=[],c=r==null?void 0:r.entries,h=n.entries,d=t.entries,f=e.entrySizes,p=o==null?void 0:o.entries;p&&(s={},p.forEach(function(W){s[W-1]=!0})),c&&(a=[],c.forEach(function(W){for(var J=W.count,se=W.offset,U=0;U<J;U++)a.push(se)}));var m=-1,v=0,y=0,w=0,S=0,C=0,E=h[0].samplesPerChunk,R=h[1]?h[1].firstChunk-1:1/0;return i.entries.forEach(function(W){for(var J=W.count,se=W.delta,U=0;U<J;U++)u={dts:v,duration:se,size:f[y]||e.sampleSize,offset:d[w]+C,index:y},p&&(u.keyframe=s[y],u.keyframe&&m++,u.gopId=m),a&&y<a.length&&(u.pts=u.dts+a[y]),l.push(u),v+=se,++y<E?C+=u.size:(w++,C=0,w>=R&&(S++,R=h[S+1]?h[S+1].firstChunk-1:1/0),E+=h[S].samplesPerChunk)}),l}function Zu(i,n){return i.dataReferenceIndex=je(n,6),i.width=je(n,24),i.height=je(n,26),i.horizresolution=ne(n,28),i.vertresolution=ne(n,32),i.frameCount=je(n,40),i.depth=je(n,74),78}function Qu(i,n){return i.dataReferenceIndex=je(n,6),i.channelCount=je(n,16),i.sampleSize=je(n,18),i.sampleRate=ne(n,24)/65536,28}function Te(i,n,e){if(i){if(i.size!==i.data.length)throw new Error("box ".concat(i.type," size !== data.length"));var t={start:i.start,size:i.size,headerSize:i.headerSize,type:i.type};return n&&(t.version=i.data[i.headerSize],t.flags=function(r){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(r[o]<<16)+(r[o+1]<<8)+(r[o+2]||0)}(i.data,i.headerSize+1),t.headerSize+=4),e(t,i.data.subarray(t.headerSize),t.start+t.headerSize),t}}var qo=function(){for(var i=[],n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return e.forEach(function(r){i.push(function(o,s,a){for(var u=String(a),l=0|s,c=Math.ceil(l/u.length),h=[],d=String(o);c--;)h.push(u);return h.join("").substring(0,l-d.length)+d}(Number(r).toString(16),2,0))}),i[0]},nt=function(){function i(){Lt(this,i),this.buffer=new Uint8Array(0)}return Ot(i,[{key:"write",value:function(){for(var n=this,e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach(function(o){o?n.buffer=function(s){for(var a=0,u=arguments.length,l=new Array(u>1?u-1:0),c=1;c<u;c++)l[c-1]=arguments[c];l.forEach(function(f){a+=f.length});var h=new s(a),d=0;return l.forEach(function(f){h.set(f,d),d+=f.length}),h}(Uint8Array,n.buffer,o):window.console.warn(o)})}}],[{key:"writeUint16",value:function(n){return new Uint8Array([n>>8&255,255&n])}},{key:"writeUint32",value:function(n){return new Uint8Array([n>>24,n>>16&255,n>>8&255,255&n])}}]),i}(),el=Math.pow(2,32)-1,xe=function(){function i(){Lt(this,i)}return Ot(i,null,[{key:"box",value:function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];var o=8+(t=t.filter(Boolean)).reduce(function(u,l){return u+l.byteLength},0),s=new Uint8Array(o);s[0]=o>>24&255,s[1]=o>>16&255,s[2]=o>>8&255,s[3]=255&o,s.set(n,4);var a=8;return t.forEach(function(u){s.set(u,a),a+=u.byteLength}),s}},{key:"ftyp",value:function(n){return n.find(function(e){return e.type===Tr&&e.codecType===bs})?i.FTYPHEV1:i.FTYPAVC1}},{key:"initSegment",value:function(n){return Jt(i.ftyp(n),i.moov(n))}},{key:"pssh",value:function(n){var e=new Uint8Array([1,0,0,0].concat([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75],[0,0,0,1],Xu(n.kid),[0,0,0,0]));return i.box(i.types.pssh,e)}},{key:"moov",value:function(n){if(n[0].useEME&&(n[0].encv||n[0].enca)){n[0].pssh||(n[0].pssh={kid:n[0].kid});var e=this.pssh(n[0].pssh);return i.box.apply(i,[i.types.moov,i.mvhd(n[0].mvhdDurtion||n[0].duration,n[0].mvhdTimecale||n[0].timescale),i.mvex(n)].concat(Et(n.map(function(t){return i.trak(t)})),[e]))}return i.box.apply(i,[i.types.moov,i.mvhd(n[0].mvhdDurtion||n[0].duration,n[0].mvhdTimecale||n[0].timescale)].concat(Et(n.map(function(t){return i.trak(t)})),[i.mvex(n)]))}},{key:"mvhd",value:function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:9e4;return i.box(i.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24&255,n>>16&255,n>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))}},{key:"trak",value:function(n){return i.box(i.types.trak,i.tkhd(n.id,n.tkhdDuration||0,n.width,n.height),i.mdia(n))}},{key:"tkhd",value:function(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return i.box(i.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,n>>24&255,n>>16&255,n>>8&255,255&n,0,0,0,0,e>>24&255,e>>16&255,e>>8&255,255&e,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,t>>8&255,255&t,0,0,r>>8&255,255&r,0,0]))}},{key:"mdia",value:function(n){return i.box(i.types.mdia,i.mdhd(n.duration,n.timescale),i.hdlr(n.type),i.minf(n))}},{key:"mdhd",value:function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:9e4;return i.box(i.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24&255,n>>16&255,n>>8&255,255&n,85,196,0,0]))}},{key:"hdlr",value:function(n){return i.box(i.types.hdlr,i.HDLR_TYPES[n])}},{key:"minf",value:function(n){return i.box(i.types.minf,n.type===Tr?i.VMHD:i.SMHD,i.DINF,i.stbl(n))}},{key:"stbl",value:function(n){var e=[];return n&&n.ext&&n.ext.stss&&e.push(i.stss(n.ext.stss.entries)),i.box(i.types.stbl,i.stsd(n),i.STTS,e[0],i.STSC,i.STSZ,i.STCO)}},{key:"stsd",value:function(n){var e;return e=n.type==="audio"?n.useEME&&n.enca?i.enca(n):i.mp4a(n):n.useEME&&n.encv?i.encv(n):i.avc1hev1(n),i.box(i.types.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),e)}},{key:"enca",value:function(n){var e=n.enca.channelCount,t=n.enca.sampleRate,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e,0,16,0,0,0,0,t>>8&255,255&t,0,0]),o=i.esds(n.config),s=i.sinf(n.enca);return i.box(i.types.enca,r,o,s)}},{key:"encv",value:function(n){var e,t,r=n.sps.length>0?n.sps[0]:[],o=n.pps.length>0?n.pps[0]:[],s=n.width,a=n.height,u=n.sarRatio[0],l=n.sarRatio[1],c=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,s>>8&255,255&s,a>>8&255,255&a,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),h=new Uint8Array((e=(t=[1,r[1],r[2],r[3],255,225,r.length>>>8&255,255&r.length]).concat.apply(t,Et(r)).concat([1,o.length>>>8&255,255&o.length])).concat.apply(e,Et(o))),d=new Uint8Array([0,0,88,57,0,15,200,192,0,4,86,72]),f=i.sinf(n.encv),p=new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,l>>24,l>>16&255,l>>8&255,255&l]);return i.box(i.types.encv,c,i.box(i.types.avcC,h),i.box(i.types.btrt,d),f,i.box(i.types.pasp,p))}},{key:"schi",value:function(n){var e=new Uint8Array([]),t=i.tenc(n);return i.box(i.types.schi,e,t)}},{key:"tenc",value:function(n){var e=new Uint8Array([0,0,0,0,0,0,255&n.default_IsEncrypted,255&n.default_IV_size].concat(Xu(n.default_KID)));return i.box(i.types.tenc,e)}},{key:"sinf",value:function(n){var e=new Uint8Array([]),t=new Uint8Array([n.data_format.charCodeAt(0),n.data_format.charCodeAt(1),n.data_format.charCodeAt(2),n.data_format.charCodeAt(3)]),r=new Uint8Array([0,0,0,0,99,101,110,99,0,1,0,0]),o=i.schi(n);return i.box(i.types.sinf,e,i.box(i.types.frma,t),i.box(i.types.schm,r),o)}},{key:"avc1hev1",value:function(n){var e=n.codecType===bs,t=e?i.types.hvc1:i.types.avc1,r=e?i.hvcC(n):i.avcC(n),o=[new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,n.width>>8&255,255&n.width,n.height>>8&255,255&n.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),r];return e?o.push(i.box(i.types.fiel,new Uint8Array([1,0]))):n.sarRatio&&n.sarRatio.length>1&&o.push(i.pasp(n.sarRatio)),i.box.apply(i,[t].concat(o))}},{key:"avcC",value:function(n){var e,t,r,o=[],s=[];return n.sps.forEach(function(a){r=a.byteLength,o.push(r>>>8&255),o.push(255&r),o.push.apply(o,Et(a))}),n.pps.forEach(function(a){r=a.byteLength,s.push(r>>>8&255),s.push(255&r),s.push.apply(s,Et(a))}),i.box(i.types.avcC,new Uint8Array((e=(t=[1,o[3],o[4],o[5],255,224|n.sps.length]).concat.apply(t,o).concat([n.pps.length])).concat.apply(e,s)))}},{key:"hvcC",value:function(n){var e=n.hvcC;if(e instanceof ArrayBuffer||e instanceof Uint8Array)return e;var t,r=n.vps,o=n.sps,s=n.pps;if(e){var a=e.generalProfileCompatibilityFlags,u=e.generalConstraintIndicatorFlags,l=(r.length&&1)+(o.length&&1)+(s.length&&1);t=[1,e.generalProfileSpace<<6|e.generalTierFlag<<5|e.generalProfileIdc,a>>>24,a>>>16,a>>>8,a,u[0],u[1],u[2],u[3],u[4],u[5],e.generalLevelIdc,240,0,252,252|e.chromaFormatIdc,248|e.bitDepthLumaMinus8,248|e.bitDepthChromaMinus8,0,0,e.numTemporalLayers<<3|e.temporalIdNested<<2|3,l];var c=function(h){var d;t.push(h.length>>8,h.length),(d=t).push.apply(d,Et(h))};r.length&&(t.push(160,0,r.length),r.forEach(c)),o.length&&(t.push(161,0,o.length),o.forEach(c)),s.length&&(t.push(162,0,s.length),s.forEach(c))}else t=[1,1,96,0,0,0,144,0,0,0,0,0,93,240,0,252,253,248,248,0,0,15,3,160,0,1,0,24,64,1,12,1,255,255,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,153,152,9,161,0,1,0,45,66,1,1,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,160,2,128,128,45,22,89,153,164,147,43,154,128,128,128,130,0,0,3,0,2,0,0,3,0,50,16,162,0,1,0,7,68,1,193,114,180,98,64];return i.box(i.types.hvcC,new Uint8Array(t))}},{key:"pasp",value:function(n){var e=wg(n,2),t=e[0],r=e[1];return i.box(i.types.pasp,new Uint8Array([t>>24,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r]))}},{key:"mp4a",value:function(n){return i.box(i.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,n.channelCount,0,16,0,0,0,0,n.sampleRate>>8&255,255&n.sampleRate,0,0]),n.config.length?i.esds(n.config):void 0)}},{key:"esds",value:function(n){var e=n.length;return i.box(i.types.esds,new Uint8Array([0,0,0,0,3,23+e,0,0,0,4,15+e,64,21,0,6,0,0,0,218,192,0,0,218,192,5].concat([e]).concat(n).concat([6,1,2])))}},{key:"mvex",value:function(n){return i.box.apply(i,[i.types.mvex].concat(Et(n.map(function(e){return i.trex(e.id)}))))}},{key:"trex",value:function(n){return i.box(i.types.trex,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trex1",value:function(n){return i.box(i.types.trex,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,0,0,0,1,0,0,2,0,0,0,0,0,0,1,0,0]))}},{key:"trex2",value:function(n){return i.box(i.types.trex,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,0,0,0,1,0,0,4,0,0,0,0,0,2,0,0,0]))}},{key:"moof",value:function(n){return i.box.apply(i,[i.types.moof,i.mfhd(n[0].samples?n[0].samples[0].gopId:0)].concat(Et(n.map(function(e){return i.traf(e)}))))}},{key:"mfhd",value:function(n){return i.box(i.types.mfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n]))}},{key:"traf",value:function(n){var e=i.tfhd(n.id),t=i.tfdt(n,n.baseMediaDecodeTime),r=0;if(n.isVideo&&n.videoSenc&&n.videoSenc.forEach(function(W){r+=8,W.subsamples&&W.subsamples.length&&(r+=2,r+=6*W.subsamples.length)}),n.videoSencLength=r,n.useEME&&(n.isVideoEncryption||n.isAudioEncryption)){if(n.isVideoEncryption){if(n.isVideo){var o=i.saiz(n),s=i.saio(n),a=i.trun1(n),u=i.senc(n);return i.box(i.types.traf,e,t,o,s,a,u)}if(n.isAudioEncryption){var l=i.sbgp(),c=i.saiz(n),h=i.saio(n),d=i.senc(n),f=i.trun1(n);return i.box(i.types.traf,e,t,l,c,h,d,f)}var p=i.sbgp(),m=i.trun1(n);return i.box(i.types.traf,e,t,p,m)}if(n.isVideo){var v=i.trun1(n);return i.box(i.types.traf,e,t,v)}var y=i.sbgp(),w=i.saiz(n),S=i.saio(n),C=i.senc(n),E=i.trun1(n);return i.box(i.types.traf,e,t,y,w,S,C,E)}var R=i.sdtp(n);return i.box(i.types.traf,e,t,R,i.trun(n.samples,R.byteLength+76))}},{key:"sdtp",value:function(n){var e=new nt;return n.samples.forEach(function(t){e.write(new Uint8Array(n.isVideo?[t.keyframe?32:16]:[16]))}),i.box(i.types.sdtp,this.extension(0,0),e.buffer)}},{key:"trun1",value:function(n){var e=new nt,t=nt.writeUint32(n.samples.length),r=null;if(n.isVideo){var o=n.videoSencLength;r=nt.writeUint32(16*n.samples.length+o+149),!n.isVideoEncryption&&n.isAudioEncryption&&(r=nt.writeUint32(16*n.samples.length+92))}else{var s=12*n.samples.length+124;n.isAudioEncryption&&(s=12*n.samples.length+8*n.audioSenc.length+177),r=nt.writeUint32(s)}return n.samples.forEach(function(a){e.write(nt.writeUint32(a.duration)),e.write(nt.writeUint32(a.size)),e.write(nt.writeUint32(a.keyframe?33554432:65536)),n.isVideo&&e.write(nt.writeUint32(a.cts?a.cts:0))}),i.box(i.types.trun,this.extension(0,n.flags),t,r,e.buffer)}},{key:"senc",value:function(n){var e=new nt,t=n.samples.length,r=n.isVideo?16:8,o=n.isVideo?2:0,s=[],a=0;return n.isVideo?(s=n.videoSenc,a=n.videoSencLength):s=n.audioSenc,a=a||r*t,e.write(nt.writeUint32(16+a),i.types.senc,this.extension(0,o)),e.write(nt.writeUint32(t)),s.forEach(function(u){for(var l=0;l<u.InitializationVector.length;l++)e.write(new Uint8Array([u.InitializationVector[l]]));u.subsamples&&u.subsamples.length&&(e.write(nt.writeUint16(u.subsamples.length)),u.subsamples.forEach(function(c){e.write(nt.writeUint16(c.BytesOfClearData)),e.write(nt.writeUint32(c.BytesOfProtectedData))}))}),e.buffer}},{key:"saio",value:function(n){var e=12*n.samples.length+141;!n.isVideo&&n.isAudioEncryption&&(e=149);var t=new Uint8Array([1,0,0,0,0,0,0,1,0,0,0,0,e>>24&255,e>>16&255,e>>8&255,255&e]);return i.box(i.types.saio,t)}},{key:"saiz",value:function(n){var e=n.samples.length,t=new Uint8Array([0,0,0,0,16,e>>24&255,e>>16&255,e>>8&255,255&e]);return i.box(i.types.saiz,t)}},{key:"sbgp",value:function(){var n=new Uint8Array([114,111,108,108,0,0,0,1,0,0,1,25,0,0,0,1]);return i.box(i.types.sbgp,this.extension(0,0),n)}},{key:"extension",value:function(n,e){return new Uint8Array([n,e>>16&255,e>>8&255,255&e])}},{key:"tfhd",value:function(n){return i.box(i.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n]))}},{key:"tfdt",value:function(n,e){var t=Math.floor(e/(el+1)),r=Math.floor(e%(el+1));return n.useEME&&(n.isVideoEncryption||n.isAudioEncryption)?i.box(i.types.tfdt,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r])):i.box(i.types.tfdt,new Uint8Array([1,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r]))}},{key:"trun",value:function(n,e){var t=n.length,r=12+16*t;e+=8+r;var o=new Uint8Array(r);o.set([0,0,15,1,t>>>24&255,t>>>16&255,t>>>8&255,255&t,e>>>24&255,e>>>16&255,e>>>8&255,255&e],0);for(var s=0;s<t;s++){var a=n[s],u=a.duration,l=a.size,c=a.flag,h=c===void 0?{}:c,d=a.cts,f=d===void 0?0:d;o.set([u>>>24&255,u>>>16&255,u>>>8&255,255&u,l>>>24&255,l>>>16&255,l>>>8&255,255&l,h.isLeading<<2|(h.dependsOn===null||h.dependsOn===void 0?1:h.dependsOn),h.isDependedOn<<6|h.hasRedundancy<<4|h.paddingValue<<1|(h.isNonSyncSample===null||h.isNonSyncSample===void 0?1:h.isNonSyncSample),61440&h.degradationPriority,15&h.degradationPriority,f>>>24&255,f>>>16&255,f>>>8&255,255&f],12+16*s)}return i.box(i.types.trun,o)}},{key:"moovMP4",value:function(n){return i.box.apply(i,[i.types.moov,i.mvhd(n[0].duration,n[0].timescale)].concat(Et(n.map(function(e){return i.trackMP4(e)}))))}},{key:"trackMP4",value:function(n){return i.box(i.types.trak,i.tkhd(n.id,n.duration,n.width,n.height),i.mdiaMP4(n))}},{key:"mdiaMP4",value:function(n){return i.box(i.types.mdia,i.mdhd(n.duration,n.timescale),i.hdlr(n.type),i.minfMP4(n))}},{key:"minfMP4",value:function(n){return i.box(i.types.minf,n.type===Tr?i.VMHD:i.SMHD,i.DINF,i.stblMP4(n))}},{key:"stblMP4",value:function(n){var e=n.ext,t=[i.stsd(n),i.stts(e.stts),i.stsc(e.stsc),i.stsz(e.stsz),i.stco(e.stco)];return e.stss.length&&t.push(i.stss(e.stss)),e.ctts.length&&t.push(i.ctts(e.ctts)),i.box.apply(i,[i.types.stbl].concat(t))}},{key:"stts",value:function(n){var e=n.length,t=new Uint8Array(8*e),r=0;return n.forEach(function(o){var s=o.value,a=o.count;t.set([a>>24,a>>16&255,a>>8&255,255&a,s>>24,s>>16&255,s>>8&255,255&s],r),r+=8}),i.box(i.types.stts,Jt(new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]),t))}},{key:"stsc",value:function(n){var e=n.length,t=new Uint8Array(12*e),r=0;return n.forEach(function(o){var s=o.firstChunk,a=o.samplesPerChunk,u=o.sampleDescIndex;t.set([s>>24,s>>16&255,s>>8&255,255&s,a>>24,a>>16&255,a>>8&255,255&a,u>>24,u>>16&255,u>>8&255,255&u],r),r+=12}),i.box(i.types.stsc,Jt(new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]),t))}},{key:"stsz",value:function(n){var e=n.length,t=new Uint8Array(4*e),r=0;return n.forEach(function(o){t.set([o>>24,o>>16&255,o>>8&255,255&o],r),r+=4}),i.box(i.types.stsz,Jt(new Uint8Array([0,0,0,0,0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]),t))}},{key:"stco",value:function(n){var e=n.length,t=new Uint8Array(4*e),r=0;return n.forEach(function(o){t.set([o>>24,o>>16&255,o>>8&255,255&o],r),r+=4}),i.box(i.types.stco,Jt(new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]),t))}},{key:"stss",value:function(n){var e=n.length,t=new Uint8Array(4*e),r=0;return n.forEach(function(o){t.set([o>>24,o>>16&255,o>>8&255,255&o],r),r+=4}),i.box(i.types.stss,Jt(new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]),t))}},{key:"ctts",value:function(n){var e=n.length,t=new Uint8Array(8*e),r=0;return n.forEach(function(o){var s=o.value,a=o.count;t.set([a>>24,a>>16&255,a>>8&255,255&a,s>>24,s>>16&255,s>>8&255,255&s],r),r+=8}),i.box(i.types.ctts,Jt(new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]),t))}},{key:"styp",value:function(){return i.box(i.types.styp,new Uint8Array([109,115,100,104,0,0,0,0,109,115,100,104,109,115,105,120]))}},{key:"sidx",value:function(n){var e=n.timescale,t=n.samples[0].duration,r=t*n.samples.length,o=n.samples[0].sampleOffset*t,s=8;n.samples.forEach(function(h){s+=h.size});var a=0;if(n.isVideo){var u,l=0;n.videoSenc&&(u=n.videoSenc),n.isVideo&&u.forEach(function(h){l+=8,h.subsamples&&h.subsamples.length&&(l+=2,l+=6*h.subsamples.length)}),n.videoSencLength=l,a=s+141+16*n.samples.length+l,n.useEME&&n.isAudioEncryption&&!n.isVideoEncryption&&(a=s+16*n.samples.length+84)}else a=s+116+12*n.samples.length,n.useEME&&n.isAudioEncryption&&(a=s+169+12*n.samples.length+8*n.audioSenc.length);var c=new Uint8Array([0,0,0,0,0,0,0,255&n.id,e>>24&255,e>>16&255,e>>8&255,255&e,o>>24&255,o>>16&255,o>>8&255,255&o,0,0,0,0,0,0,0,1,0,a>>16&255,a>>8&255,255&a,r>>24&255,r>>16&255,r>>8&255,255&r,144,0,0,0]);return i.box(i.types.sidx,c)}},{key:"mdat",value:function(n){return i.box(i.types.mdat,n)}}]),i}();X(xe,"types",["avc1","avcC","hvc1","hvcC","dinf","dref","esds","ftyp","hdlr","mdat","mdhd","mdia","mfhd","minf","moof","moov","mp4a","mvex","mvhd","pasp","stbl","stco","stsc","stsd","stsz","stts","tfdt","tfhd","traf","trak","trex","tkhd","vmhd","smhd","ctts","stss","styp","pssh","sidx","sbgp","saiz","saio","senc","trun","encv","enca","sinf","btrt","frma","tenc","schm","schi","mehd","fiel","sdtp"].reduce(function(i,n){return i[n]=[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3)],i},Object.create(null))),X(xe,"HDLR_TYPES",{video:new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),audio:new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0])}),X(xe,"FTYPAVC1",xe.box(xe.types.ftyp,new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]))),X(xe,"FTYPHEV1",xe.box(xe.types.ftyp,new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,104,101,118,49]))),X(xe,"DINF",xe.box(xe.types.dinf,xe.box(xe.types.dref,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1])))),X(xe,"VMHD",xe.box(xe.types.vmhd,new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]))),X(xe,"SMHD",xe.box(xe.types.smhd,new Uint8Array([0,0,0,0,0,0,0,0]))),X(xe,"StblTable",new Uint8Array([0,0,0,0,0,0,0,0])),X(xe,"STTS",xe.box(xe.types.stts,xe.StblTable)),X(xe,"STSC",xe.box(xe.types.stsc,xe.StblTable)),X(xe,"STSZ",xe.box(xe.types.stsz,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]))),X(xe,"STCO",xe.box(xe.types.stco,xe.StblTable));var ra=function(){function i(n,e){Lt(this,i),this.name=n||"",this._prefix="[".concat(this.name,"]"),i.disabled=e}return Ot(i,[{key:"debug",value:function(){var n;if(!i.disabled){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];(n=console).debug.apply(n,[this._prefix].concat(t))}}},{key:"log",value:function(){var n;if(!i.disabled){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];(n=console).log.apply(n,[this._prefix].concat(t))}}},{key:"warn",value:function(){var n;if(!i.disabled){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];(n=console).warn.apply(n,[this._prefix].concat(t))}}},{key:"error",value:function(){var n;if(!i.disabled){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];(n=console).error.apply(n,[this._prefix].concat(t))}}},{key:"table",value:function(){var n;i.disabled||(n=console).table.apply(n,arguments)}}],[{key:"enable",value:function(){i.disabled=!1}},{key:"disable",value:function(){i.disabled=!0}}]),i}();X(ra,"disabled",!0);var Dg=function(){function i(n,e,t){Lt(this,i),this.videoTrack=n,this.audioTrack=e;var r=/Chrome\/([^.]+)/.exec(navigator.userAgent);this.forceFirstIDR=r&&Number(r[1])<50,this.log=new ra("FMP4Remuxer",!t||!t.openLog||!t.openLog)}return Ot(i,[{key:"remux",value:function(){var n,e,t,r,o,s=arguments.length>0&&arguments[0]!==void 0&&arguments[0],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=this.videoTrack,l=this.audioTrack,c=u.exist(),h=l.exist(),d=[];return s&&(a&&a.initMerge?(c&&d.push(this.videoTrack),h&&d.push(this.audioTrack),t=xe.initSegment(d)):(c&&(n=xe.initSegment([this.videoTrack])),h&&(e=xe.initSegment([this.audioTrack])))),c&&u.hasSample()&&(r=this._remuxVideo()),h&&l.hasSample()&&(o=this._remuxAudio()),u.samples=[],l.samples=[],{initSegment:t,videoInitSegment:n,audioInitSegment:e,videoSegment:r,audioSegment:o}}},{key:"_remuxVideo",value:function(){var n=this.videoTrack;this.forceFirstIDR&&(n.samples[0].flag={dependsOn:2,isNonSyncSample:0});var e=n.samples,t=0;e.forEach(function(d){t+=d.units.reduce(function(f,p){return f+p.byteLength},0),t+=4*d.units.length});for(var r,o=new Uint8Array(t),s=new DataView(o.buffer),a=function(d,f){f=e[u];var p=0;f.units.forEach(function(m){s.setUint32(d,m.byteLength),d+=4,o.set(m,d),d+=m.byteLength,p+=4+m.byteLength}),f.size=p,c=d,r=f},u=0,l=e.length,c=0;u<l;u++)a(c,r);var h=xe.mdat(o);return Jt(xe.moof([n]),h)}},{key:"_remuxAudio",value:function(){var n=this.audioTrack,e=new Uint8Array(n.samples.reduce(function(r,o){return r+o.size},0));n.samples.reduce(function(r,o){return e.set(o.data,r),r+o.size},0);var t=xe.mdat(e);return Jt(xe.moof([n]),t)}},{key:"reset",value:function(){this.videoTrack.reset(),this.audioTrack.reset()}}]),i}(),Mg=function(){function i(n,e,t,r){var o=this;Lt(this,i),X(this,"_videoSamples",[]),X(this,"_audioSamples",[]),X(this,"_lastRemainBuffer",[]),X(this,"_lastRemainBufferStartPos",0),this.videoTrack=new Pg,this.audioTrack=new Lg,this.metadataTrack=t||new Og,this.log=new ra("MP4Demuxer",!r||!r.openLog||!r.openLog),n&&n.forEach(function(s){var a;(a=o._videoSamples).push.apply(a,Et(s.frames))}),e&&e.forEach(function(s){var a;(a=o._audioSamples).push.apply(a,Et(s.frames))})}return Ot(i,[{key:"parseSamples",value:function(n){if(!n)throw new Error("moov is required");if(this.videoTrack.codec||this.audioTrack.codec||(Mt.moovToTrack(n,this.videoTrack,this.audioTrack),this.videoSenc=this.videoTrack.videoSenc,this.audioSenc=this.audioTrack.audioSenc),!this._audioSamples.length&&!this._videoSamples.length){var e=Mt.moovToSamples(n);if(!e)throw new Error("cannot parse samples from moov box");this._videoSamples=e.videoSamples||[],this._audioSamples=e.audioSamples||[]}}},{key:"demux",value:function(n,e,t,r,o){this.parseSamples(o);var s,a,u,l=this.videoTrack,c=this.audioTrack;if(l.samples=[],c.samples=[],t){for(var h,d=0,f=t[0],p=t[1];f<=p;f++){if(!(s=this._videoSamples[f]))throw new Error("cannot found video frame #".concat(f));u=s.offset-e,a=n.subarray(u,u+s.size),(h=new Yu(s.pts||s.dts,s.dts)).duration=s.duration,h.gopId=s.gopId,s.keyframe&&h.setToKeyframe();for(var m=0,v=a.length-1;m<v;)d=ne(a,m),m+=4,h.units.push(a.subarray(m,m+d)),m+=d;l.samples.push(h)}l.baseMediaDecodeTime=l.samples[0].dts}if(r){for(var y=r[0],w=r[1];y<=w;y++){if(!(s=this._audioSamples[y]))throw new Error("cannot found video frame #".concat(y));u=s.offset-e,a=n.subarray(u,u+s.size),c.samples.push(new $u(s.dts,a,s.duration))}c.baseMediaDecodeTime=c.samples[0].dts}return{videoTrack:l,audioTrack:c,metadataTrack:this.metadataTrack}}},{key:"demuxPart",value:function(n,e,t,r,o,s,a,u){if(this.parseSamples(o),this.videoTrack.useEME=s,this.audioTrack.useEME=s,this._lastRemainBuffer&&this._lastRemainBuffer.byteLength>0&&e>this._lastRemainBufferStartPos&&e<=this._lastRemainBufferStartPos+this._lastRemainBuffer.byteLength)for(var l=0;l<20;)try{var c=this._lastRemainBuffer.subarray(0,e-this._lastRemainBufferStartPos),h=new Uint8Array(n.byteLength+c.byteLength);h.set(c,0),h.set(new Uint8Array(n),c.byteLength),n=h,e-=c.byteLength,this._lastRemainBuffer=null,this._lastRemainBufferStartPos=0;break}catch(b){if(!(l<20))throw new Error("new Uint8Array error:,"+b.errorMessage);l++}var d,f,p,m=this.videoTrack,v=this.audioTrack;m.samples=[],v.samples=[],m.videoSenc=null,v.audioSenc=null;var y=0,w=0;if(this._videoSamples.length>0&&t.length>0){for(var S,C=n.byteLength+e,E=t[0];E<=t[1];E++){if(!(d=this._videoSamples[E]))throw new Error("cannot found video frame #".concat(E));d.offset>=e&&d.offset+d.size<=C&&(y=(p=d.offset-e)+d.size,f=n.subarray(p,y),(S=new Yu(d.pts||d.dts,d.dts)).duration=d.duration,S.gopId=d.gopId,S.sampleOffset=d.index,d.keyframe&&S.setToKeyframe(),S.data=f,S.size=d.size,m.samples.push(S))}m.samples.length>0&&(m.gopId=m.samples[0].gopId,m.baseMediaDecodeTime=m.samples[0].dts,m.startPts=m.samples[0].pts/m.timescale,m.endPts=m.samples[m.samples.length-1].pts/m.timescale,this.videoSenc&&(m.videoSenc=this.videoSenc.slice(m.samples[0].sampleOffset,m.samples[0].sampleOffset+m.samples.length),m.kidValue=a))}if(this._audioSamples.length>0&&r.length>0){for(var R=r[0];R<=r[1];R++){if(!(d=this._audioSamples[R]))throw new Error("cannot found video frame #".concat(R));d.offset>=e&&d.offset+d.size<=n.byteLength+e&&(w=(p=d.offset-e)+d.size,f=n.subarray(p,w),v.samples.push(new $u(d.dts,f,d.duration,d.index)))}v.samples.length>0&&(v.gopId=v.samples[0].gopId||m.gopId,v.baseMediaDecodeTime=v.samples[0].dts,v.startPts=v.samples[0].pts/v.timescale,v.endPts=v.samples[v.samples.length-1].pts/v.timescale,this.audioSenc&&(v.audioSenc=this.audioSenc.slice(v.samples[0].sampleOffset,v.samples[0].sampleOffset+v.samples.length),v.kidValue=a))}this.decoderData(m,v,u);for(var W=0,J=0;J<m.samples.length;J++)for(var se=0,U=m.samples[J].data,ae=U.length-1;se<ae;)W=ne(U,se),se+=4,m.samples[J].units.push(U.subarray(se,se+W)),se+=W;return this._lastRemainBuffer=n.subarray(Math.max(y,w)),this._lastRemainBuffer.byteLength>0?this._lastRemainBufferStartPos=e+n.byteLength-this._lastRemainBuffer.byteLength:this._lastRemainBufferStartPos=0,{videoTrack:m,audioTrack:v,metadataTrack:this.metadataTrack}}},{key:"reset",value:function(){this._videoSamples=[],this._audioSamples=[],this._lastRemainBuffer=null,this._lastRemainBufferStartPos=0,this.videoTrack.reset(),this.audioTrack.reset(),this.metadataTrack.reset()}},{key:"decoderData",value:function(n,e,t){!n.useEME&&e.useEME}}],[{key:"probe",value:function(n){return Mt.probe(n)}}]),i}(),bh="3.0.0-alpha.34";function tl(i,n){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);n&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),e.push.apply(e,t)}return e}function ks(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?tl(Object(e),!0).forEach(function(t){Z(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):tl(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}function Je(){Je=function(){return i};var i={},n=Object.prototype,e=n.hasOwnProperty,t=Object.defineProperty||function(b,k,T){b[k]=T.value},r=typeof Symbol=="function"?Symbol:{},o=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function u(b,k,T){return Object.defineProperty(b,k,{value:T,enumerable:!0,configurable:!0,writable:!0}),b[k]}try{u({},"")}catch{u=function(k,T,N){return k[T]=N}}function l(b,k,T,N){var P=k&&k.prototype instanceof d?k:d,B=Object.create(P.prototype),Q=new se(N||[]);return t(B,"_invoke",{value:E(b,T,Q)}),B}function c(b,k,T){try{return{type:"normal",arg:b.call(k,T)}}catch(N){return{type:"throw",arg:N}}}i.wrap=l;var h={};function d(){}function f(){}function p(){}var m={};u(m,o,function(){return this});var v=Object.getPrototypeOf,y=v&&v(v(U([])));y&&y!==n&&e.call(y,o)&&(m=y);var w=p.prototype=d.prototype=Object.create(m);function S(b){["next","throw","return"].forEach(function(k){u(b,k,function(T){return this._invoke(k,T)})})}function C(b,k){function T(P,B,Q,he){var H=c(b[P],b,B);if(H.type!=="throw"){var L=H.arg,M=L.value;return M&&typeof M=="object"&&e.call(M,"__await")?k.resolve(M.__await).then(function(G){T("next",G,Q,he)},function(G){T("throw",G,Q,he)}):k.resolve(M).then(function(G){L.value=G,Q(L)},function(G){return T("throw",G,Q,he)})}he(H.arg)}var N;t(this,"_invoke",{value:function(P,B){function Q(){return new k(function(he,H){T(P,B,he,H)})}return N=N?N.then(Q,Q):Q()}})}function E(b,k,T){var N="suspendedStart";return function(P,B){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(P==="throw")throw B;return{value:void 0,done:!0}}for(T.method=P,T.arg=B;;){var Q=T.delegate;if(Q){var he=R(Q,T);if(he){if(he===h)continue;return he}}if(T.method==="next")T.sent=T._sent=T.arg;else if(T.method==="throw"){if(N==="suspendedStart")throw N="completed",T.arg;T.dispatchException(T.arg)}else T.method==="return"&&T.abrupt("return",T.arg);N="executing";var H=c(b,k,T);if(H.type==="normal"){if(N=T.done?"completed":"suspendedYield",H.arg===h)continue;return{value:H.arg,done:T.done}}H.type==="throw"&&(N="completed",T.method="throw",T.arg=H.arg)}}}function R(b,k){var T=k.method,N=b.iterator[T];if(N===void 0)return k.delegate=null,T==="throw"&&b.iterator.return&&(k.method="return",k.arg=void 0,R(b,k),k.method==="throw")||T!=="return"&&(k.method="throw",k.arg=new TypeError("The iterator does not provide a '"+T+"' method")),h;var P=c(N,b.iterator,k.arg);if(P.type==="throw")return k.method="throw",k.arg=P.arg,k.delegate=null,h;var B=P.arg;return B?B.done?(k[b.resultName]=B.value,k.next=b.nextLoc,k.method!=="return"&&(k.method="next",k.arg=void 0),k.delegate=null,h):B:(k.method="throw",k.arg=new TypeError("iterator result is not an object"),k.delegate=null,h)}function W(b){var k={tryLoc:b[0]};1 in b&&(k.catchLoc=b[1]),2 in b&&(k.finallyLoc=b[2],k.afterLoc=b[3]),this.tryEntries.push(k)}function J(b){var k=b.completion||{};k.type="normal",delete k.arg,b.completion=k}function se(b){this.tryEntries=[{tryLoc:"root"}],b.forEach(W,this),this.reset(!0)}function U(b){if(b){var k=b[o];if(k)return k.call(b);if(typeof b.next=="function")return b;if(!isNaN(b.length)){var T=-1,N=function P(){for(;++T<b.length;)if(e.call(b,T))return P.value=b[T],P.done=!1,P;return P.value=void 0,P.done=!0,P};return N.next=N}}return{next:ae}}function ae(){return{value:void 0,done:!0}}return f.prototype=p,t(w,"constructor",{value:p,configurable:!0}),t(p,"constructor",{value:f,configurable:!0}),f.displayName=u(p,a,"GeneratorFunction"),i.isGeneratorFunction=function(b){var k=typeof b=="function"&&b.constructor;return!!k&&(k===f||(k.displayName||k.name)==="GeneratorFunction")},i.mark=function(b){return Object.setPrototypeOf?Object.setPrototypeOf(b,p):(b.__proto__=p,u(b,a,"GeneratorFunction")),b.prototype=Object.create(w),b},i.awrap=function(b){return{__await:b}},S(C.prototype),u(C.prototype,s,function(){return this}),i.AsyncIterator=C,i.async=function(b,k,T,N,P){P===void 0&&(P=Promise);var B=new C(l(b,k,T,N),P);return i.isGeneratorFunction(k)?B:B.next().then(function(Q){return Q.done?Q.value:B.next()})},S(w),u(w,a,"Generator"),u(w,o,function(){return this}),u(w,"toString",function(){return"[object Generator]"}),i.keys=function(b){var k=Object(b),T=[];for(var N in k)T.push(N);return T.reverse(),function P(){for(;T.length;){var B=T.pop();if(B in k)return P.value=B,P.done=!1,P}return P.done=!0,P}},i.values=U,se.prototype={constructor:se,reset:function(b){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(J),!b)for(var k in this)k.charAt(0)==="t"&&e.call(this,k)&&!isNaN(+k.slice(1))&&(this[k]=void 0)},stop:function(){this.done=!0;var b=this.tryEntries[0].completion;if(b.type==="throw")throw b.arg;return this.rval},dispatchException:function(b){if(this.done)throw b;var k=this;function T(H,L){return B.type="throw",B.arg=b,k.next=H,L&&(k.method="next",k.arg=void 0),!!L}for(var N=this.tryEntries.length-1;N>=0;--N){var P=this.tryEntries[N],B=P.completion;if(P.tryLoc==="root")return T("end");if(P.tryLoc<=this.prev){var Q=e.call(P,"catchLoc"),he=e.call(P,"finallyLoc");if(Q&&he){if(this.prev<P.catchLoc)return T(P.catchLoc,!0);if(this.prev<P.finallyLoc)return T(P.finallyLoc)}else if(Q){if(this.prev<P.catchLoc)return T(P.catchLoc,!0)}else{if(!he)throw new Error("try statement without catch or finally");if(this.prev<P.finallyLoc)return T(P.finallyLoc)}}}},abrupt:function(b,k){for(var T=this.tryEntries.length-1;T>=0;--T){var N=this.tryEntries[T];if(N.tryLoc<=this.prev&&e.call(N,"finallyLoc")&&this.prev<N.finallyLoc){var P=N;break}}P&&(b==="break"||b==="continue")&&P.tryLoc<=k&&k<=P.finallyLoc&&(P=null);var B=P?P.completion:{};return B.type=b,B.arg=k,P?(this.method="next",this.next=P.finallyLoc,h):this.complete(B)},complete:function(b,k){if(b.type==="throw")throw b.arg;return b.type==="break"||b.type==="continue"?this.next=b.arg:b.type==="return"?(this.rval=this.arg=b.arg,this.method="return",this.next="end"):b.type==="normal"&&k&&(this.next=k),h},finish:function(b){for(var k=this.tryEntries.length-1;k>=0;--k){var T=this.tryEntries[k];if(T.finallyLoc===b)return this.complete(T.completion,T.afterLoc),J(T),h}},catch:function(b){for(var k=this.tryEntries.length-1;k>=0;--k){var T=this.tryEntries[k];if(T.tryLoc===b){var N=T.completion;if(N.type==="throw"){var P=N.arg;J(T)}return P}}throw new Error("illegal catch attempt")},delegateYield:function(b,k,T){return this.delegate={iterator:U(b),resultName:k,nextLoc:T},this.method==="next"&&(this.arg=void 0),h}},i}function $i(i){return($i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(i)}function nl(i,n,e,t,r,o,s){try{var a=i[o](s),u=a.value}catch(l){return void e(l)}a.done?n(u):Promise.resolve(u).then(t,r)}function ln(i){return function(){var n=this,e=arguments;return new Promise(function(t,r){var o=i.apply(n,e);function s(u){nl(o,t,r,s,a,"next",u)}function a(u){nl(o,t,r,s,a,"throw",u)}s(void 0)})}}function dn(i,n){if(!(i instanceof n))throw new TypeError("Cannot call a class as a function")}function il(i,n){for(var e=0;e<n.length;e++){var t=n[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(i,wh(t.key),t)}}function fn(i,n,e){return n&&il(i.prototype,n),e&&il(i,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function Z(i,n,e){return(n=wh(n))in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}function er(i,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(n&&n.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),n&&so(i,n)}function vi(i){return(vi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)})(i)}function so(i,n){return(so=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(i,n)}function kh(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ws(i,n,e){return ws=kh()?Reflect.construct.bind():function(t,r,o){var s=[null];s.push.apply(s,r);var a=new(Function.bind.apply(t,s));return o&&so(a,o.prototype),a},ws.apply(null,arguments)}function qr(i){var n=typeof Map=="function"?new Map:void 0;return qr=function(e){if(e===null||(t=e,Function.toString.call(t).indexOf("[native code]")===-1))return e;var t;if(typeof e!="function")throw new TypeError("Super expression must either be null or a function");if(n!==void 0){if(n.has(e))return n.get(e);n.set(e,r)}function r(){return ws(e,arguments,vi(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),so(r,e)},qr(i)}function Ng(i,n){if(i==null)return{};var e,t,r=function(s,a){if(s==null)return{};var u,l,c={},h=Object.keys(s);for(l=0;l<h.length;l++)u=h[l],a.indexOf(u)>=0||(c[u]=s[u]);return c}(i,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(i);for(t=0;t<o.length;t++)e=o[t],n.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(i,e)&&(r[e]=i[e])}return r}function me(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function tr(i){var n=kh();return function(){var e,t=vi(i);if(n){var r=vi(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(o,s){if(s&&(typeof s=="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return me(o)}(this,e)}}function Ts(){return Ts=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(i,n,e){var t=function(o,s){for(;!Object.prototype.hasOwnProperty.call(o,s)&&(o=vi(o))!==null;);return o}(i,n);if(t){var r=Object.getOwnPropertyDescriptor(t,n);return r.get?r.get.call(arguments.length<3?i:e):r.value}},Ts.apply(this,arguments)}function rl(i,n){(n==null||n>i.length)&&(n=i.length);for(var e=0,t=new Array(n);e<n;e++)t[e]=i[e];return t}function Fg(i,n){var e=typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(!e){if(Array.isArray(i)||(e=function(u,l){if(u){if(typeof u=="string")return rl(u,l);var c=Object.prototype.toString.call(u).slice(8,-1);return c==="Object"&&u.constructor&&(c=u.constructor.name),c==="Map"||c==="Set"?Array.from(u):c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?rl(u,l):void 0}}(i))||n){e&&(i=e);var t=0,r=function(){};return{s:r,n:function(){return t>=i.length?{done:!0}:{done:!1,value:i[t++]}},e:function(u){throw u},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,s=!0,a=!1;return{s:function(){e=e.call(i)},n:function(){var u=e.next();return s=u.done,u},e:function(u){a=!0,o=u},f:function(){try{s||e.return==null||e.return()}finally{if(a)throw o}}}}function wh(i){var n=function(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var o=r.call(e,t||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}(i,"string");return typeof n=="symbol"?n:String(n)}var gt,Pi=function(){function i(){dn(this,i)}return fn(i,null,[{key:"start",value:function(n){return n&&n.length?n.length===1&&n.end(0)-n.start(0)<1e-6||n.length===1&&n.start(0)<0?0:n.start(0):0}},{key:"end",value:function(n){return n&&n.length?n.length===1&&n.end(0)-n.start(0)<1e-6?0:n.end(n.length-1):0}},{key:"get",value:function(n){if(n)try{return n.buffered}catch{}}},{key:"buffers",value:function(n,e){if(!n||!n.length)return[];for(var t=[],r=0,o=n.length;r<o;r++){var s=t.length;if(s&&e){var a=t[s-1],u=a[1];if(n.start(r)-u<=e){var l=n.end(r);l>u&&(a[1]=l)}else t.push([n.start(r),n.end(r)])}else t.push([n.start(r),n.end(r)])}return t}},{key:"totalLength",value:function(n){return n&&n.length?n.reduce(function(e,t){return e+(t[1]-t[0])},0):0}},{key:"info",value:function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(!n||!n.length)return{start:0,end:0,buffers:[]};for(var r=0,o=0,s=0,a=0,u=0,l=0,c=0,h=i.buffers(n,t),d=0,f=h.length;d<f;d++){var p=h[d];if(e+t>=p[0]&&e<=p[1])r=p[0],o=p[1],s=d;else{if(e+t<p[0]){a=p[0],u=p[1];break}e+t>p[1]&&(l=p[0],c=p[1])}}return{start:r,end:o,index:s,buffers:h,nextStart:a,nextEnd:u,prevStart:l,prevEnd:c,currentTime:e,behind:e-r,remaining:o?o-e:0,length:i.totalLength&&i.totalLength(h)}}}]),i}(),Bg=typeof window<"u",de={MANIFEST:"manifest",NETWORK:"network",NETWORK_TIMEOUT:"network_timeout",NETWORK_FORBIDDEN:"network_forbidden",NETWORK_NOTFOUND:"network_notfound",NETWROK_RANGE_NOT_SATISFIABLE:"network_range_not_satisfiable",DEMUX:"demux",REMUX:"remux",MEDIA:"media",DRM:"drm",OTHER:"other",RUNTIME:"runtime",SUB_TYPES:{FLV:"FLV",HLS:"HLS",MP4:"MP4",FMP4:"FMP4",MSE_ADD_SB:"MSE_ADD_SB",MSE_APPEND_BUFFER:"MSE_APPEND_BUFFER",MSE_OTHER:"MSE_OTHER",MSE_FULL:"MSE_FULL",OPTION:"OPTION",DASH:"DASH",LICENSE:"LICENSE",CUSTOM_LICENSE:"CUSTOM_LICENSE",MSE_HIJACK:"MSE_HIJACK",EME_HIJACK:"EME_HIJACK",SIDX:"SIDX",NO_CANPLAY_ERROR:"NO_CANPLAY_ERROR",BUFFERBREAK_ERROR:"BUFFERBREAK_ERROR",WAITING_TIMEOUT_ERROR:"WAITING_TIMEOUT_ERROR",MEDIA_ERR_ABORTED:"MEDIA_ERR_ABORTED",MEDIA_ERR_NETWORK:"MEDIA_ERR_NETWORK",MEDIA_ERR_DECODE:"MEDIA_ERR_DECODE",MEDIA_ERR_SRC_NOT_SUPPORTED:"MEDIA_ERR_SRC_NOT_SUPPORTED",MEDIA_ERR_CODEC_NOT_SUPPORTED:"MEDIA_ERR_CODEC_NOT_SUPPORTED",MEDIA_ERR_URL_EMPTY:"MEDIA_ERR_URL_EMPTY"}},qe=(Z(gt={},de.MANIFEST,{HLS:1100,DASH:1200}),Z(gt,de.NETWORK,2100),Z(gt,de.NETWORK_TIMEOUT,2101),Z(gt,de.NETWORK_FORBIDDEN,2103),Z(gt,de.NETWORK_NOTFOUND,2104),Z(gt,de.NETWROK_RANGE_NOT_SATISFIABLE,2116),Z(gt,de.DEMUX,{FLV:3100,HLS:3200,MP4:3300,FMP4:3400,SIDX:3410}),Z(gt,de.REMUX,{FMP4:4100,MP4:4200}),Z(gt,de.MEDIA,{MEDIA_ERR_ABORTED:5101,MEDIA_ERR_NETWORK:5102,MEDIA_ERR_DECODE:5103,MEDIA_ERR_SRC_NOT_SUPPORTED:5104,MEDIA_ERR_CODEC_NOT_SUPPORTED:5105,MEDIA_ERR_URL_EMPTY:5106,MSE_ADD_SB:5200,MSE_APPEND_BUFFER:5201,MSE_OTHER:5202,MSE_FULL:5203,MSE_HIJACK:5204,EME_HIJACK:5301}),Z(gt,de.DRM,{LICENSE:7100,CUSTOM_LICENSE:7200}),Z(gt,de.OTHER,8e3),Z(gt,de.RUNTIME,{NO_CANPLAY_ERROR:9001,BUFFERBREAK_ERROR:9002,WAITING_TIMEOUT_ERROR:9003}),gt),gr=function(){er(n,qr(Error));var i=tr(n);function n(e,t,r,o,s){var a;return dn(this,n),(a=i.call(this,s||(r==null?void 0:r.message))).errorType=e===de.NETWORK_TIMEOUT?de.NETWORK:e,a.originError=r,a.ext=o,a.errorCode=qe[e][t]||qe[e],a.errorMessage=a.message,a.errorCode||(a.errorType=de.OTHER,a.errorCode=qe[a.errorType]),a}return fn(n,null,[{key:"create",value:function(e,t,r,o,s){return e instanceof n?e:(e instanceof Error&&(r=e,e=""),e||(e=de.OTHER),new n(e,t,r,o,s))}},{key:"network",value:function(e){var t;return new n(e!=null&&e.isTimeout?de.NETWORK_TIMEOUT:de.NETWORK,null,e instanceof Error?e:null,{url:e==null?void 0:e.url,response:e==null?void 0:e.response,httpCode:e==null||(t=e.response)===null||t===void 0?void 0:t.status})}}]),n}(),mr={DEBUG:1,LOG:2,WARN:3,ERROR:4},Ug=["Boolean","Number","String","Undefined","Null","Date","Object"],yi=function(){function i(n,e){dn(this,i),this.name=n||"",this._prefix="[".concat(this.name,"]"),this.logCacheLevel=(e==null?void 0:e.logCacheLevel)||3,this.logMaxSize=(e==null?void 0:e.logMaxSize)||204800,this.logSize=0,this.logTextArray=[]}return fn(i,[{key:"debug",value:function(){for(var n,e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.logCache.apply(this,[mr.DEBUG].concat(t)),i.disabled||(n=console).debug.apply(n,[this._prefix,Li()].concat(t))}},{key:"log",value:function(){for(var n,e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.logCache.apply(this,[mr.LOG].concat(t)),i.disabled||(n=console).log.apply(n,[this._prefix,Li()].concat(t))}},{key:"warn",value:function(){for(var n,e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.logCache.apply(this,[mr.WARN].concat(t)),i.disabled||(n=console).warn.apply(n,[this._prefix,Li()].concat(t))}},{key:"error",value:function(){for(var n,e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.logCache.apply(this,[mr.ERROR].concat(t)),i.disabled||(n=console).error.apply(n,[this._prefix,Li()].concat(t))}},{key:"logCache",value:function(n){if(!(n<this.logCacheLevel)){var e="";try{for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];var s=r.map(function(u){return Th(u)});e=this._prefix+Li()+JSON.stringify(s)}catch{return}if(n>=this.logCacheLevel&&(this.logSize+=e.length,this.logTextArray.push(e)),this.logSize>this.logMaxSize){var a=this.logTextArray.shift();this.logSize-=a.length}}}},{key:"getLogCache",value:function(){var n=this.logTextArray.join(`
`);return this.reset(),n}},{key:"reset",value:function(){this.logTextArray=[],this.logSize=0}},{key:"table",value:function(){var n;i.disabled||(n=console).table.apply(n,arguments)}},{key:"setLogLevel",value:function(n){this.logCacheLevel=n}}],[{key:"enable",value:function(){i.disabled=!1}},{key:"disable",value:function(){i.disabled=!0}}]),i}();function Li(){return new Date().toLocaleString()}function jg(i){if($i(i)!=="object")return i;var n=Object.prototype.toString.call(i).slice(8,-1);switch(n){case"Array":case"Uint8Array":case"ArrayBuffer":return n+"["+i.length+"]";case"Object":return"{}";default:return n}}function Th(i,n,e){e||(e=1),n||(n=2);var t={};if(!i||$i(i)!=="object")return i;var r=Object.prototype.toString.call(i).slice(8,-1);if(!Ug.includes(r))return r;if(!(e>n)){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e===n?t[o]=jg(i[o]):$i(i[o])==="object"?t[o]=Th(i[o],n,e+1):t[o]=i[o]);return t}}function ai(){var i,n,e=new Promise(function(t,r){i=t,n=r});return e.used=!1,e.resolve=function(){return e.used=!0,i.apply(void 0,arguments)},e.reject=function(){return e.used=!0,n.apply(void 0,arguments)},e}function ii(){try{return parseInt(performance.now(),10)}catch{return new Date().getTime()}}Z(yi,"disabled",!0);var Hg=function(i){try{return JSON.stringify(i)}catch{return""}};function ol(){var i=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];try{return Bg?i&&typeof ManagedMediaSource<"u"?ManagedMediaSource:window.MediaSource:null}catch{}}function Yo(i){return/ManagedMediaSource/gi.test(Object.prototype.toString.call(i))}var Vg="appendBuffer",zg="removeBuffer",sl="updateDuration",At=function(){function i(r,o){var s=this;dn(this,i),Z(this,"media",null),Z(this,"mediaSource",null),Z(this,"_openPromise",ai()),Z(this,"_queue",Object.create(null)),Z(this,"_sourceBuffer",Object.create(null)),Z(this,"_mseFullFlag",{}),Z(this,"_st",0),Z(this,"_opst",0),Z(this,"_logger",null),Z(this,"_config",null),Z(this,"_url",null),Z(this,"_onStartStreaming",function(){s._logger.debug("startstreaming")}),Z(this,"_onEndStreaming",function(){s._logger.debug("endstreaming")}),Z(this,"_onSBUpdateEnd",function(a){var u=s._queue[a];if(u){var l=u[0];if((l==null?void 0:l.opName)!==sl&&u.shift(),l){var c,h=ii()-s._opst;s._logger.debug("UpdateEnd(".concat(a,"/").concat(l.opName,")"),Hg(function(d){var f=[];if(d instanceof TimeRanges)for(var p=0;p<d.length;p++)f.push({start:d.start(p),end:d.end(p)});return f}((c=s._sourceBuffer[a])===null||c===void 0?void 0:c.buffered)),h,l.context),l.promise.resolve({name:l.opName,context:l.context,costtime:h}),s._startQueue(a)}}}),Z(this,"_onSBUpdateError",function(a,u){var l=s._queue[a];if(l){var c=l[0];c&&(s._logger.error("UpdateError",a,c.opName,c.context),c.promise.reject(new gr(de.MEDIA,de.SUB_TYPES.MSE_APPEND_BUFFER,u)))}}),this._config=Object.assign(i.getDefaultConfig(),o),r&&this.bindMedia(r),this._logger=new yi("MSE"),this._config.openLog&&yi.enable()}var n,e,t;return fn(i,[{key:"isOpened",get:function(){var r;return((r=this.mediaSource)===null||r===void 0?void 0:r.readyState)==="open"}},{key:"hasOpTasks",get:function(){var r=this,o=!1;return Object.keys(this._queue).forEach(function(s){var a=r._queue[s];Array.isArray(a)&&(o||(o=a.length>0))}),o}},{key:"url",get:function(){return this._url}},{key:"duration",get:function(){var r;return((r=this.mediaSource)===null||r===void 0?void 0:r.duration)||-1}},{key:"isEnded",get:function(){return!!this.mediaSource&&this.mediaSource.readyState==="ended"}},{key:"streaming",get:function(){return!Yo(this.mediaSource)||this.mediaSource.streaming}},{key:"isFull",value:function(r){return r?this._mseFullFlag[r]:this._mseFullFlag[i.VIDEO]}},{key:"updateDuration",value:function(r){var o=this,s=this.mediaSource&&this.mediaSource.duration>r;if(this.mediaSource&&this.mediaSource.duration>r){var a=0;if(Object.keys(this._sourceBuffer).forEach(function(u){try{a=Math.max(o.bufferEnd(u)||0,a)}catch{}}),r<a)return Promise.resolve()}return this._enqueueBlockingOp(function(){o.isEnded?o._logger.debug("setDuration but ended"):o.mediaSource&&(o.mediaSource.duration=r,o._logger.debug("setDuration",r))},sl,{isReduceDuration:s})}},{key:"open",value:function(){var r=this;if(this._openPromise.used&&!this.isOpened&&this.mediaSource){var o=this.mediaSource;o.addEventListener("sourceopen",function s(){var a=ii()-r._st;r._logger.debug("sourceopen",a),o.removeEventListener("sourceopen",s),r._openPromise.resolve({costtime:a})}),this._openPromise=ai()}return this._openPromise}},{key:"bindMedia",value:(t=ln(Je().mark(function r(o){var s,a,u,l,c=this;return Je().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!this.mediaSource&&!this.media){h.next=3;break}return h.next=3,this.unbindMedia();case 3:if(s=ol(this._config.preferMMS),o&&s){h.next=6;break}throw new Error("Param media or MediaSource does not exist");case 6:return this.media=o,a=this.mediaSource=new s,u=Yo(a),this._st=ii(),l=function d(){var f=ii()-c._st;c._logger.debug("sourceopen"),a.removeEventListener("sourceopen",d),URL.revokeObjectURL(o.src),c._openPromise.resolve({costtime:f})},a.addEventListener("sourceopen",l),u&&(a.addEventListener("startstreaming",this._onStartStreaming),a.addEventListener("endstreaming",this._onEndStreaming)),this._url=URL.createObjectURL(a),o.src=this._url,o.disableRemotePlayback=u,h.abrupt("return",this._openPromise);case 17:case"end":return h.stop()}},r,this)})),function(r){return t.apply(this,arguments)})},{key:"unbindMedia",value:(e=ln(Je().mark(function r(){var o,s,a,u=this;return Je().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this._openPromise.used||this._openPromise.resolve(),o=this.mediaSource){if(Object.keys(this._queue).forEach(function(c){var h=u._queue[c];h&&h.forEach(function(d){var f,p;return(f=d.promise)===null||f===void 0||(p=f.resolve)===null||p===void 0?void 0:p.call(f)})}),s=!!this.media&&this.media.readyState>=1,a=o.readyState==="open",s&&a)try{o.endOfStream()}catch{}Object.keys(this._sourceBuffer).forEach(function(c){try{o.removeSourceBuffer(u._sourceBuffer[c])}catch{}}),Yo(o)&&(o.removeEventListener("startstreaming",this._onStartStreaming),o.removeEventListener("endstreaming",this._onEndStreaming))}if(this.media){this.media.disableRemotePlayback=!1,this.media.removeAttribute("src");try{this.media.load()}catch{}this.media=null}this.mediaSource=null,this._openPromise=ai(),this._queue=Object.create(null),this._sourceBuffer=Object.create(null);case 8:case"end":return l.stop()}},r,this)})),function(){return e.apply(this,arguments)})},{key:"createSource",value:function(r,o){if(!this._sourceBuffer[r]&&this.mediaSource){var s;try{s=this._sourceBuffer[r]=this.mediaSource.addSourceBuffer(o)}catch(a){throw new gr(de.MEDIA,de.SUB_TYPES.MSE_ADD_SB,a)}s.mimeType=o,s.addEventListener("updateend",this._onSBUpdateEnd.bind(this,r)),s.addEventListener("error",this._onSBUpdateError.bind(this,r))}}},{key:"changeType",value:function(r,o){var s=this,a=this._sourceBuffer[r];return this.mediaSource&&a&&a.mimeType!==o?typeof a.changeType!="function"?Promise.reject():this._enqueueOp(r,function(){a.changeType(o),a.mimeType=o,s._onSBUpdateEnd(r)},"changeType",{mimeType:o}):Promise.resolve()}},{key:"createOrChangeSource",value:function(r,o){return this.createSource(r,o),this.changeType(r,o)}},{key:"append",value:function(r,o,s){var a=this;return o&&o.byteLength&&this._sourceBuffer[r]?this._enqueueOp(r,function(){var u;a.mediaSource&&!a.media.error&&(a._logger.debug("MSE APPEND START",s),a._opst=ii(),(u=a._sourceBuffer[r])===null||u===void 0||u.appendBuffer(o))},Vg,s):Promise.resolve()}},{key:"remove",value:function(r,o,s,a){var u=this,l=!1;return this._mseFullFlag[r]&&(l=!0),this._enqueueOp(r,function(){if(u.mediaSource&&!u.media.error){var c=u._sourceBuffer[r];o>=s||!c?u._onSBUpdateEnd(r):(u._opst=ii(),u._logger.debug("MSE REMOVE START",r,o,s,a),c.remove(o,s))}},zg,a,l)}},{key:"clearBuffer",value:function(r,o){var s,a=this;return Object.keys(this._sourceBuffer).forEach(function(u){s=a.remove(u,r,o)}),s||Promise.resolve()}},{key:"clearAllBuffer",value:function(){var r,o=this;return Object.keys(this._sourceBuffer).forEach(function(s){var a=o._sourceBuffer[s];r=o.remove(s,0,Pi.end(Pi.get(a)))}),r}},{key:"clearOpQueues",value:function(r,o){var s;this._logger.debug("MSE clearOpQueue START");var a=this._queue[r];if(o&&a)this._queue[r]=[];else if(a&&a[r]&&!(a.length<5)){var u=[];a.forEach(function(l){l.context&&l.context.isinit&&u.push(l)}),this._queue[r]=a.slice(0,2),u.length>0&&(s=this._queue[r]).push.apply(s,u)}}},{key:"endOfStream",value:function(r){var o=this;return this.mediaSource&&this.mediaSource.readyState==="open"?this._enqueueBlockingOp(function(){var s=o.mediaSource;s&&s.readyState==="open"&&(o._logger.debug("MSE endOfStream START"),r?s.endOfStream(r):s.endOfStream())},"endOfStream"):Promise.resolve()}},{key:"setLiveSeekableRange",value:function(r,o){var s=this.mediaSource;r<0||o<r||s==null||!s.setLiveSeekableRange||s.readyState!=="open"||s.setLiveSeekableRange(r,o)}},{key:"getSourceBuffer",value:function(r){return this._sourceBuffer[r]}},{key:"buffered",value:function(r){return Pi.get(this._sourceBuffer[r])}},{key:"bufferStart",value:function(r){return Pi.start(this.buffered(r))}},{key:"bufferEnd",value:function(r){return Pi.end(this.buffered(r))}},{key:"_enqueueOp",value:function(r,o,s,a,u){var l=this;if(!this.mediaSource)return Promise.resolve();var c=this._queue[r]=this._queue[r]||[],h={exec:o,promise:ai(),opName:s,context:a};return u?(c.splice(0,0,h),this._mseFullFlag[r]=!1,this._startQueue(r)):c.push(h),this.isOpened||this.isEnded?c.length===1&&this._startQueue(r):this._openPromise.then(function(){c.length===1&&l._startQueue(r)}),h.promise}},{key:"_enqueueBlockingOp",value:(n=ln(Je().mark(function r(o,s,a){var u,l,c=this;return Je().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(this.mediaSource){h.next=2;break}return h.abrupt("return",Promise.resolve());case 2:if((u=Object.keys(this._sourceBuffer)).length){h.next=5;break}return h.abrupt("return",o());case 5:return l=[],u.forEach(function(d){var f=c._queue[d],p=ai();l.push(p),f.push({exec:function(){p.resolve()},promise:p,opName:s,context:a}),f.length===1&&c._startQueue(d)}),h.abrupt("return",Promise.all(l).then(function(){try{return o()}finally{u.forEach(function(d){var f=c._queue[d],p=c._sourceBuffer[d];f==null||f.shift(),p&&p.updating||c._startQueue(d)})}}));case 8:case"end":return h.stop()}},r,this)})),function(r,o,s){return n.apply(this,arguments)})},{key:"_startQueue",value:function(r){var o=this._queue[r];if(o){var s=o[0];if(s&&!this._mseFullFlag[r])try{s.exec()}catch(a){a&&a.message&&a.message.indexOf("SourceBuffer is full")>=0?(this._mseFullFlag[r]=!0,this._logger.error("[MSE error],  context,",s.context," ,name,",s.opName,",err,SourceBuffer is full"),s.promise.reject(new gr(de.MEDIA,de.SUB_TYPES.MSE_FULL,a))):(this._logger.error(a),s.promise.reject(new gr(de.MEDIA,de.SUB_TYPES.MSE_OTHER,a)),o.shift(),this._startQueue(r))}}}},{key:"setTimeoffset",value:function(r,o,s){var a=this;return this._enqueueOp(r,function(){o<0&&(o+=.001),a._sourceBuffer[r].timestampOffset=o,a._onSBUpdateEnd(r)},"setTimeoffset",s)}},{key:"abort",value:function(r,o){var s=this;return this.isOpened?this._enqueueOp(r,function(){s._sourceBuffer[r].abort(),s._onSBUpdateEnd(r)},"abort",o):Promise.resolve()}}],[{key:"isSupported",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:'video/mp4; codecs="avc1.42E01E,mp4a.40.2"',o=ol();if(!o)return!1;try{return o.isTypeSupported(r)}catch(s){return this._logger.error(r,s),!1}}},{key:"isMMSOnly",value:function(){return typeof ManagedMediaSource<"u"&&typeof MediaSource>"u"}},{key:"getDefaultConfig",value:function(){return{openLog:!1,preferMMS:!1}}}]),i}();Z(At,"VIDEO","video"),Z(At,"AUDIO","audio");var zi="fetch",al="xhr",ul="arraybuffer",xh="text",Wg="json",Gt=function(){er(n,qr(Error));var i=tr(n);function n(e,t,r,o){var s;return dn(this,n),Z(me(s=i.call(this,o)),"retryCount",0),Z(me(s),"isTimeout",!1),Z(me(s),"loaderType",zi),Z(me(s),"startTime",0),Z(me(s),"endTime",0),Z(me(s),"options",{}),s.url=e,s.request=t,s.response=r,s}return fn(n)}(),Sh=Object.prototype.toString;function ll(i){if(Sh.call(i)!=="[object Object]")return!1;var n=Object.getPrototypeOf(i);return n===null||n===Object.prototype}function Ch(i){if(i&&i[0]!==null&&i[0]!==void 0&&(i[0]!==0||i[1]!==null&&i[1]!==void 0)){var n="bytes="+i[0]+"-";return i[1]&&(n+=i[1]),n}}function cl(i){return encodeURIComponent(i).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Eh(i,n){if(i){if(!n)return i;var e,t=Object.keys(n).map(function(o){if((e=n[o])!=null)return Array.isArray(e)?o+="[]":e=[e],e.map(function(s){var a;return a=s,Sh.call(a)==="[object Date]"?s=s.toISOString():function(u){return u!==null&&$i(u)==="object"}(s)&&(s=JSON.stringify(s)),"".concat(cl(o),"=").concat(cl(s))}).join("&")}).filter(Boolean).join("&");if(t){var r=i.indexOf("#");r!==-1&&(i=i.slice(0,r)),i+=(i.indexOf("?")===-1?"?":"&")+t}return i}}function xs(i,n,e,t,r,o,s,a,u,l,c){return r=r!=null?parseFloat(r):null,t=parseInt(t||"0",10),Number.isNaN(t)&&(t=0),{data:i,done:n,options:{range:u,vid:l,index:a,contentLength:t,age:r,startTime:o,firstByteTime:s,endTime:Date.now(),priOptions:c},response:e}}function Ss(i,n){return Math.round(8*i*1e3/n/1024)}var Kn="real_time_speed",hl=2097152,Cs=function(){er(e,Yn);var i,n=tr(e);function e(){var t;return dn(this,e),Z(me(t=n.call(this)),"_abortController",null),Z(me(t),"_timeoutTimer",null),Z(me(t),"_reader",null),Z(me(t),"_response",null),Z(me(t),"_aborted",!1),Z(me(t),"_index",-1),Z(me(t),"_range",null),Z(me(t),"_receivedLength",0),Z(me(t),"_running",!1),Z(me(t),"_logger",null),Z(me(t),"_vid",""),Z(me(t),"_onProcessMinLen",0),Z(me(t),"_onCancel",null),Z(me(t),"_priOptions",null),t}return fn(e,[{key:"load",value:function(t){var r,o=this,s=t.url,a=t.vid,u=t.timeout,l=t.responseType,c=t.onProgress,h=t.index,d=t.onTimeout,f=t.onCancel,p=t.range,m=t.transformResponse,v=t.request,y=t.params,w=t.logger,S=t.method,C=t.headers,E=t.body,R=t.mode,W=t.credentials,J=t.cache,se=t.redirect,U=t.referrer,ae=t.referrerPolicy,b=t.onProcessMinLen,k=t.priOptions;this._logger=w,this._aborted=!1,this._onProcessMinLen=b,this._onCancel=f,this._abortController=typeof AbortController<"u"&&new AbortController,this._running=!0,this._index=h,this._range=p||[0,0],this._vid=a||s,this._priOptions=k||{};var T={method:S,headers:C,body:E,mode:R,credentials:W,cache:J,redirect:se,referrer:U,referrerPolicy:ae,signal:(r=this._abortController)===null||r===void 0?void 0:r.signal},N=!1;clearTimeout(this._timeoutTimer),s=Eh(s,y);var P=Ch(p);P&&(C=v?v.headers:T.headers=T.headers||(Headers?new Headers:{}),Headers&&C instanceof Headers?C.append("Range",P):C.Range=P),u&&(this._timeoutTimer=setTimeout(function(){if(N=!0,o.cancel(),d){var Q=new Gt(s,T,null,"timeout");Q.isTimeout=!0,d(Q,{index:o._index,range:o._range,vid:o._vid,priOptions:o._priOptions})}},u));var B=Date.now();return this._logger.debug("[fetch load start], index,",h,",range,",p),new Promise(function(Q,he){fetch(v||s,v?void 0:T).then(function(){var H=ln(Je().mark(function L(M){var G,re,Ee,Le;return Je().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:if(clearTimeout(o._timeoutTimer),o._response=M,!o._aborted&&o._running){le.next=4;break}return le.abrupt("return");case 4:if(m&&(M=m(M,s)||M),M.ok){le.next=7;break}throw new Gt(s,T,M,"bad network response");case 7:if(G=Date.now(),l!==xh){le.next=15;break}return le.next=11,M.text();case 11:re=le.sent,o._running=!1,le.next=37;break;case 15:if(l!==Wg){le.next=22;break}return le.next=18,M.json();case 18:re=le.sent,o._running=!1,le.next=37;break;case 22:if(!c){le.next=29;break}return o.resolve=Q,o.reject=he,o._loadChunk(M,c,B,G),le.abrupt("return");case 29:return le.next=31,M.arrayBuffer();case 31:re=le.sent,re=new Uint8Array(re),o._running=!1,Ee=Date.now()-B,Le=Ss(re.byteLength,Ee),o.emit(Kn,{speed:Le,len:re.byteLength,time:Ee,vid:o._vid,index:o._index,range:o._range,priOptions:o._priOptions});case 37:o._logger.debug("[fetch load end], index,",h,",range,",p),Q(xs(re,!0,M,M.headers.get("Content-Length"),M.headers.get("age"),B,G,h,p,o._vid,o._priOptions));case 39:case"end":return le.stop()}},L)}));return function(L){return H.apply(this,arguments)}}()).catch(function(H){var L;clearTimeout(o._timeoutTimer),o._running=!1,o._aborted&&!N||((H=H instanceof Gt?H:new Gt(s,T,null,(L=H)===null||L===void 0?void 0:L.message)).startTime=B,H.endTime=Date.now(),H.isTimeout=N,H.options={index:o._index,range:o._range,vid:o._vid,priOptions:o._priOptions},he(H))})})}},{key:"cancel",value:(i=ln(Je().mark(function t(){return Je().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!this._aborted){r.next=2;break}return r.abrupt("return");case 2:if(this._aborted=!0,this._running=!1,!this._response){r.next=14;break}if(r.prev=5,!this._reader){r.next=9;break}return r.next=9,this._reader.cancel();case 9:r.next=13;break;case 11:r.prev=11,r.t0=r.catch(5);case 13:this._response=this._reader=null;case 14:if(this._abortController){try{this._abortController.abort()}catch{}this._abortController=null}this._onCancel&&this._onCancel({index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions});case 16:case"end":return r.stop()}},t,this,[[5,11]])})),function(){return i.apply(this,arguments)})},{key:"_loadChunk",value:function(t,r,o,s){var a=this;if(!t.body||!t.body.getReader){this._running=!1;var u=new Gt(t.url,"",t,"onProgress of bad response.body.getReader");return u.options={index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions},void this.reject(u)}this._onProcessMinLen>0&&(this._cache=new Uint8Array(hl),this._writeIdx=0);var l,c,h,d=this._reader=t.body.getReader(),f=function(){var p=ln(Je().mark(function m(){var v,y,w,S,C,E,R,W;return Je().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return c=Date.now(),J.prev=1,J.next=4,d.read();case 4:l=J.sent,h=Date.now(),J.next=13;break;case 8:return J.prev=8,J.t0=J.catch(1),h=Date.now(),a._aborted||(a._running=!1,J.t0.options={index:a._index,range:a._range,vid:a._vid,priOptions:a._priOptions},a.reject(J.t0)),J.abrupt("return");case 13:if(y=((v=a._range)===null||v===void 0?void 0:v.length)>0?a._range[0]:0,w=y+a._receivedLength,!a._aborted){J.next=19;break}return a._running=!1,r(void 0,!1,{range:[w,w],vid:a._vid,index:a._index,startTime:c,endTime:h,st:o,firstByteTime:s,priOptions:a._priOptions},t),J.abrupt("return");case 19:S=l.value?l.value.byteLength:0,a._receivedLength+=S,a._logger.debug("fetchLoader,onProgress call,task,",a._range,", start,",w,", end,",y+a._receivedLength,", done,",l.done),a._onProcessMinLen>0?a._writeIdx+S>=a._onProcessMinLen||l.done?((C=new Uint8Array(a._writeIdx+S)).set(a._cache.slice(0,a._writeIdx),0),S>0&&C.set(l.value,a._writeIdx),a._writeIdx=0,a._logger.debug("fetchLoader,onProgress enough,done,",l.done,",len,",C.byteLength,", writeIdx,",a._writeIdx)):S>0&&a._writeIdx+S<hl?(a._cache.set(l.value,a._writeIdx),a._writeIdx+=S,a._logger.debug("fetchLoader,onProgress cache,len,",S,", writeIdx,",a._writeIdx)):S>0&&(E=new Uint8Array(a._writeIdx+S+2048),a._logger.debug("fetchLoader,onProgress extra start,size,",a._writeIdx+S+2048,", datalen,",S,", writeIdx,",a._writeIdx),E.set(a._cache.slice(0,a._writeIdx),0),S>0&&E.set(l.value,a._writeIdx),a._writeIdx+=S,delete a._cache,a._cache=E,a._logger.debug("fetchLoader,onProgress extra end,len,",S,", writeIdx,",a._writeIdx)):C=l.value,(C&&C.byteLength>0||l.done)&&r(C,l.done,{range:[a._range[0]+a._receivedLength-(C?C.byteLength:0),a._range[0]+a._receivedLength],vid:a._vid,index:a._index,startTime:c,endTime:h,st:o,firstByteTime:s,priOptions:a._priOptions},t),l.done?(R=Date.now()-o,W=Ss(a._receivedLength,R),a.emit(Kn,{speed:W,len:a._receivedLength,time:R,vid:a._vid,index:a._index,range:a._range,priOptions:a._priOptions}),a._running=!1,a._logger.debug("[fetchLoader onProgress end],task,",a._range,",done,",l.done),a.resolve(xs(l,!0,t,t.headers.get("Content-Length"),t.headers.get("age"),o,s,a._index,a._range,a._vid,a._priOptions))):f();case 25:case"end":return J.stop()}},m,null,[[1,8]])}));return function(){return p.apply(this,arguments)}}();f()}},{key:"receiveLen",get:function(){return this._receivedLength}},{key:"running",get:function(){return this._running},set:function(t){this._running=t}}],[{key:"isSupported",value:function(){return!(typeof fetch>"u")}}]),e}(),Gg=function(){er(n,Yn);var i=tr(n);function n(){var e;return dn(this,n),Z(me(e=i.call(this)),"_xhr",null),Z(me(e),"_aborted",!1),Z(me(e),"_timeoutTimer",null),Z(me(e),"_range",null),Z(me(e),"_receivedLength",0),Z(me(e),"_url",null),Z(me(e),"_onProgress",null),Z(me(e),"_index",-1),Z(me(e),"_headers",null),Z(me(e),"_currentChunkSizeKB",384),Z(me(e),"_timeout",null),Z(me(e),"_xhr",null),Z(me(e),"_withCredentials",null),Z(me(e),"_startTime",-1),Z(me(e),"_loadCompleteResolve",null),Z(me(e),"_loadCompleteReject",null),Z(me(e),"_runing",!1),Z(me(e),"_logger",!1),Z(me(e),"_vid",""),Z(me(e),"_responseType",void 0),Z(me(e),"_credentials",void 0),Z(me(e),"_method",void 0),Z(me(e),"_transformResponse",void 0),Z(me(e),"_firstRtt",void 0),Z(me(e),"_onCancel",null),Z(me(e),"_priOptions",null),e}return fn(n,[{key:"load",value:function(e){var t=this;clearTimeout(this._timeoutTimer),this._logger=e.logger,this._range=e.range,this._onProgress=e.onProgress,this._index=e.index,this._headers=e.headers,this._withCredentials=e.credentials==="include"||e.credentials==="same-origin",this._body=e.body||null,e.method&&(this._method=e.method),this._timeout=e.timeout||null,this._runing=!0,this._vid=e.vid||e.url,this._responseType=e.responseType,this._firstRtt=-1,this._onTimeout=e.onTimeout,this._onCancel=e.onCancel,this._request=e.request,this._priOptions=e.priOptions||{},this._logger.debug("xhrLoader task, range",this._range),this._url=Eh(e.url,e.params);var r=Date.now();return new Promise(function(o,s){t._loadCompleteResolve=o,t._loadCompleteReject=s,t._startLoad()}).catch(function(o){if(clearTimeout(t._timeoutTimer),t._runing=!1,!t._aborted)throw(o=o instanceof Gt?o:new Gt(t._url,t._request)).startTime=r,o.endTime=Date.now(),o.options={index:t._index,vid:t._vid,priOptions:t._priOptions},o})}},{key:"_startLoad",value:function(){var e=null;if(this._responseType===ul&&this._range&&this._range.length>1)if(this._onProgress){this._firstRtt=-1;var t=1024*this._currentChunkSizeKB,r=this._range[0]+this._receivedLength,o=this._range[1];t<this._range[1]-r&&(o=r+t),e=[r,o],this._logger.debug("[xhr_loader->],tast :",this._range,", SubRange, ",e)}else e=this._range,this._logger.debug("[xhr_loader->],tast :",this._range,", allRange, ",e);this._internalOpen(e)}},{key:"_internalOpen",value:function(e){var t=this;try{this._startTime=Date.now();var r=this._xhr=new XMLHttpRequest;r.open(this._method||"GET",this._url,!0),r.responseType=this._responseType,this._timeout&&(r.timeout=this._timeout),r.withCredentials=this._withCredentials,r.onload=this._onLoad.bind(this),r.onreadystatechange=this._onReadyStatechange.bind(this),r.onerror=function(a){var u,l,c;t._running=!1;var h=new Gt(t._url,t._request,a==null||(u=a.currentTarget)===null||u===void 0?void 0:u.response,"xhr.onerror.status:"+(a==null||(l=a.currentTarget)===null||l===void 0?void 0:l.status)+",statusText,"+(a==null||(c=a.currentTarget)===null||c===void 0?void 0:c.statusText));h.options={index:t._index,range:t._range,vid:t._vid,priOptions:t._priOptions},t._loadCompleteReject(h)},r.ontimeout=function(a){t.cancel();var u=new Gt(t._url,t._request,{status:408},"timeout");t._onTimeout&&(u.isTimeout=!0,t._onTimeout(u,{index:t._index,range:t._range,vid:t._vid,priOptions:t._priOptions})),u.options={index:t._index,range:t._range,vid:t._vid,priOptions:t._priOptions},t._loadCompleteReject(u)};var o=this._headers||{},s=Ch(e);s&&(o.Range=s),o&&Object.keys(o).forEach(function(a){r.setRequestHeader(a,o[a])}),this._logger.debug("[xhr.send->] tast,",this._range,",load sub range, ",e),r.send(this._body)}catch(a){a.options={index:this._index,range:e,vid:this._vid,priOptions:this._priOptions},this._loadCompleteReject(a)}}},{key:"_onReadyStatechange",value:function(e){e.target.readyState===2&&this._firstRtt<0&&(this._firstRtt=Date.now())}},{key:"_onLoad",value:function(e){var t,r=e.target.status;if(r<200||r>299){var o=new Gt(this._url,null,ks(ks({},e.target.response),{},{status:r}),"bad response,status:"+r);return o.options={index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions},this._loadCompleteReject(o)}var s,a=null,u=!1,l=((t=this._range)===null||t===void 0?void 0:t.length)>0?this._range[0]:0;if(this._responseType===ul){var c,h=new Uint8Array(e.target.response);if(s=l+this._receivedLength,h&&h.byteLength>0){this._receivedLength+=h.byteLength;var d=Date.now()-this._startTime,f=Ss(this._receivedLength,d);this.emit(Kn,{speed:f,len:this._receivedLength,time:d,vid:this._vid,index:this._index,range:[s,l+this._receivedLength],priOptions:this._priOptions})}a=h,u=!(((c=this._range)===null||c===void 0?void 0:c.length)>1&&this._range[1]&&this._receivedLength<this._range[1]-this._range[0]),this._logger.debug("[xhr load done->], tast :",this._range,", start",s,"end ",l+this._receivedLength,",dataLen,",h?h.byteLength:0,",receivedLength",this._receivedLength,",index,",this._index,", done,",u)}else u=!0,a=e.target.response;var p={ok:r>=200&&r<300,status:r,statusText:this._xhr.statusText,url:this._xhr.responseURL,headers:this._getHeaders(this._xhr),body:this._xhr.response};this._transformResponse&&(p=this._transformResponse(p,this._url)||p),this._onProgress&&this._onProgress(a,u,{index:this._index,vid:this._vid,range:[s,l+this._receivedLength],startTime:this._startTime,endTime:Date.now(),priOptions:this._priOptions},p),u?(this._runing=!1,this._loadCompleteResolve&&this._loadCompleteResolve(xs(this._onProgress?null:a,u,p,p.headers["content-length"],p.headers.age,this._startTime,this._firstRtt,this._index,this._range,this._vid,this._priOptions))):this._startLoad()}},{key:"cancel",value:function(){if(!this._aborted)return this._aborted=!0,this._runing=!1,Ts(vi(n.prototype),"removeAllListeners",this).call(this),this._onCancel&&this._onCancel({index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions}),this._xhr?this._xhr.abort():void 0}},{key:"receiveLen",get:function(){return this._receivedLength}},{key:"running",get:function(){return this._running},set:function(e){this._running=e}},{key:"_getHeaders",value:function(e){var t,r={},o=Fg(e.getAllResponseHeaders().trim().split(`\r
`));try{for(o.s();!(t=o.n()).done;){var s=t.value.split(": ");r[s[0].toLowerCase()]=s.slice(1).join(": ")}}catch(a){o.e(a)}finally{o.f()}return r}}],[{key:"isSupported",value:function(){return typeof XMLHttpRequest<"u"}}]),n}(),Kg=["retry","retryDelay","onRetryError","transformError"],qg=function(){function i(e,t){dn(this,i),this.promise=ai(),this.alive=!!t.onProgress,!t.logger&&(t.logger=new yi("Loader")),this._loaderType=e,this._loader=e===zi&&typeof fetch<"u"?new Cs:new Gg,this._config=t,this._retryCount=0,this._retryTimer=null,this._canceled=!1,this._retryCheckFunc=t.retryCheckFunc,this._logger=t.logger}var n;return fn(i,[{key:"exec",value:function(){var e=this,t=this._config,r=t.retry,o=t.retryDelay,s=t.onRetryError,a=t.transformError,u=Ng(t,Kg),l=function(){var c=ln(Je().mark(function h(){var d,f,p;return Je().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.prev=0,m.next=3,e._loader.load(u);case 3:d=m.sent,e.promise.resolve(d),m.next=27;break;case 7:if(m.prev=7,m.t0=m.catch(0),e._loader.running=!1,e._logger.debug("[task request catch err]",m.t0),!e._canceled){m.next=13;break}return m.abrupt("return");case 13:if(m.t0.loaderType=e._loaderType,m.t0.retryCount=e._retryCount,f=m.t0,a&&(f=a(f)||f),s&&e._retryCount>0&&s(f,e._retryCount,{index:u.index,vid:u.vid,range:u.range,priOptions:u.priOptions}),e._retryCount++,p=!0,e._retryCheckFunc&&(p=e._retryCheckFunc(m.t0)),!(p&&e._retryCount<=r)){m.next=26;break}return clearTimeout(e._retryTimer),e._logger.debug("[task request setTimeout],retry",e._retryCount,",retry range,",u.range),e._retryTimer=setTimeout(l,o),m.abrupt("return");case 26:e.promise.reject(f);case 27:case"end":return m.stop()}},h,null,[[0,7]])}));return function(){return c.apply(this,arguments)}}();return l(),this.promise}},{key:"cancel",value:(n=ln(Je().mark(function e(){return Je().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return clearTimeout(this._retryTimer),this._canceled=!0,this._loader.running=!1,t.abrupt("return",this._loader.cancel());case 4:case"end":return t.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"running",get:function(){return this._loader&&this._loader.running}},{key:"loader",get:function(){return this._loader}}]),i}();function dl(){for(var i=arguments.length,n=new Array(i),e=0;e<i;e++)n[e]=arguments[e];if((n=n.filter(Boolean)).length<2)return n[0];var t=new Uint8Array(n.reduce(function(o,s){return o+s.byteLength},0)),r=0;return n.forEach(function(o){t.set(o,r),r+=o.byteLength}),t}function Yg(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new Promise(function(n){return setTimeout(n,i)})}var $g=function(){er(e,Yn);var i,n=tr(e);function e(t){var r;return dn(this,e),Z(me(r=n.call(this,t)),"type",zi),Z(me(r),"_queue",[]),Z(me(r),"_alive",[]),Z(me(r),"_currentTask",null),Z(me(r),"_finnalUrl",""),Z(me(r),"_config",void 0),r._config=function(o){return ks({loaderType:zi,retry:0,retryDelay:0,timeout:0,request:null,onTimeout:void 0,onProgress:void 0,onRetryError:void 0,transformRequest:void 0,transformResponse:void 0,transformError:void 0,responseType:xh,range:void 0,url:"",params:void 0,method:"GET",headers:{},body:void 0,mode:void 0,credentials:void 0,cache:void 0,redirect:void 0,referrer:void 0,referrerPolicy:void 0,integrity:void 0,onProcessMinLen:0},o)}(t),r._config.loaderType!==al&&Cs.isSupported()||(r.type=al),r.log=t.logger,r}return fn(e,[{key:"isFetch",value:function(){return this.type===zi}},{key:"load",value:function(t){var r=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};typeof t!="string"&&t?o=t:o.url=t||o.url||this._config.url,(o=Object.assign({},this._config,o)).params&&(o.params=Object.assign({},o.params)),o.headers&&ll(o.headers)&&(o.headers=Object.assign({},o.headers)),o.body&&ll(o.body)&&(o.body=Object.assign({},o.body)),o.transformRequest&&(o=o.transformRequest(o)||o),o.logger=this.log;var s=new qg(this.type,o);return s.loader.on(Kn,function(a){r.emit(Kn,a)}),this._queue.push(s),this._queue.length!==1||this._currentTask&&this._currentTask.running||this._processTask(),s.promise}},{key:"cancel",value:(i=ln(Je().mark(function t(){var r;return Je().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return r=this._queue.map(function(s){return s.cancel()}).concat(this._alive.map(function(s){return s.cancel()})),this._currentTask&&r.push(this._currentTask.cancel()),this._queue=[],this._alive=[],o.next=6,Promise.all(r);case 6:return o.next=8,Yg();case 8:case"end":return o.stop()}},t,this)})),function(){return i.apply(this,arguments)})},{key:"_processTask",value:function(){var t=this;if(this._currentTask=this._queue.shift(),this._currentTask){this._currentTask.alive&&this._alive.push(this._currentTask);var r=this._currentTask.exec().catch(function(o){});r&&typeof r.finally=="function"&&r.finally(function(){var o,s;(o=t._currentTask)!==null&&o!==void 0&&o.alive&&((s=t._alive)===null||s===void 0?void 0:s.length)>0&&(t._alive=t._alive.filter(function(a){return a&&a!==t._currentTask})),t._processTask()})}}}],[{key:"isFetchSupport",value:function(){return Cs.isSupported()}}]),e}();const Dt={416:qe[de.NETWROK_RANGE_NOT_SATISFIABLE],403:qe[de.NETWORK_FORBIDDEN],404:qe[de.NETWORK_NOTFOUND],timeout:qe[de.NETWORK_TIMEOUT],"4xx":`${qe[de.NETWORK]}4XX`,"5xx":`${qe[de.NETWORK]}5XX`,networkError:qe[de.NETWORK],contentError:`${qe[de.NETWORK]}contentError`,mse:qe[de.MEDIA][de.SUB_TYPES.MSE_OTHER],mseOpen:qe[de.MEDIA][de.SUB_TYPES.MSE_ADD_SB],mseAppend:qe[de.MEDIA][de.SUB_TYPES.MSE_APPEND_BUFFER],mse_hijack:qe[de.MEDIA][de.SUB_TYPES.MSE_HIJACK],eme_hijack:qe[de.MEDIA][de.SUB_TYPES.EME_HIJACK],metaError:qe[de.DEMUX][de.SUB_TYPES.MP4],muxError:qe[de.REMUX][de.SUB_TYPES.FMP4],other:qe[de.OTHER],waitTimeout:qe[de.RUNTIME][de.SUB_TYPES.BUFFERBREAK_ERROR],waitTimeoutWithHidden:qe[de.RUNTIME][de.SUB_TYPES.WAITING_TIMEOUT_ERROR],drm:qe[de.DRM][de.SUB_TYPES.LICENSE]},ui=de;class Xg{constructor(n,e,t){let r=0,o=0;t&&t.range&&t.range.length>1&&(r=t.range[0],o=t.range[1]);const s=function(a){return Dt[a]||a}(e);return{errorCode:s,errorType:n,errorMessage:(t==null?void 0:t.httpText)||(t==null?void 0:t.message),url:t==null?void 0:t.url,httpCode:e,version:bh,rangeStart:r,rangeEnd:o,ext:t,mediaError:{code:s,message:(t==null?void 0:t.httpText)||(t==null?void 0:t.message)}}}}class Jg{constructor(n,e,t){return{errorCode:e,errorType:n,version:bh,errorMessage:t.msg,ext:t,mediaError:{code:e,message:t.msg}}}}const Qt={};Qt.nowTime=function(){try{return parseInt(performance.now(),10)}catch{return new Date().getTime()}},Qt.concatData=function(i,n){const e=[];let t=0;i&&e.push(i),n&&e.push(n),e.every(s=>(s&&(t+=s.byteLength),!0));const r=new Uint8Array(t);let o=0;return e.every(s=>(s&&(r.set(s,o),o+=s.byteLength),!0)),r};const Zg="content-range";function fl(i){try{i&&i.src&&(i.removeAttribute("src"),i.load())}catch{}}function pl(i,n){const e=i.media||i.video;i._detachSourceEvents(e),n instanceof Array?i._attachSourceEvents(e,n):n?e.src=n:e.removeAttribute("src")}function gl(i,n){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);n&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),e.push.apply(e,t)}return e}function $o(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?gl(Object(e),!0).forEach(function(t){ft(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):gl(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}function Be(){Be=function(){return i};var i={},n=Object.prototype,e=n.hasOwnProperty,t=Object.defineProperty||function(b,k,T){b[k]=T.value},r=typeof Symbol=="function"?Symbol:{},o=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function u(b,k,T){return Object.defineProperty(b,k,{value:T,enumerable:!0,configurable:!0,writable:!0}),b[k]}try{u({},"")}catch{u=function(k,T,N){return k[T]=N}}function l(b,k,T,N){var P=k&&k.prototype instanceof d?k:d,B=Object.create(P.prototype),Q=new se(N||[]);return t(B,"_invoke",{value:E(b,T,Q)}),B}function c(b,k,T){try{return{type:"normal",arg:b.call(k,T)}}catch(N){return{type:"throw",arg:N}}}i.wrap=l;var h={};function d(){}function f(){}function p(){}var m={};u(m,o,function(){return this});var v=Object.getPrototypeOf,y=v&&v(v(U([])));y&&y!==n&&e.call(y,o)&&(m=y);var w=p.prototype=d.prototype=Object.create(m);function S(b){["next","throw","return"].forEach(function(k){u(b,k,function(T){return this._invoke(k,T)})})}function C(b,k){function T(P,B,Q,he){var H=c(b[P],b,B);if(H.type!=="throw"){var L=H.arg,M=L.value;return M&&typeof M=="object"&&e.call(M,"__await")?k.resolve(M.__await).then(function(G){T("next",G,Q,he)},function(G){T("throw",G,Q,he)}):k.resolve(M).then(function(G){L.value=G,Q(L)},function(G){return T("throw",G,Q,he)})}he(H.arg)}var N;t(this,"_invoke",{value:function(P,B){function Q(){return new k(function(he,H){T(P,B,he,H)})}return N=N?N.then(Q,Q):Q()}})}function E(b,k,T){var N="suspendedStart";return function(P,B){if(N==="executing")throw new Error("Generator is already running");if(N==="completed"){if(P==="throw")throw B;return{value:void 0,done:!0}}for(T.method=P,T.arg=B;;){var Q=T.delegate;if(Q){var he=R(Q,T);if(he){if(he===h)continue;return he}}if(T.method==="next")T.sent=T._sent=T.arg;else if(T.method==="throw"){if(N==="suspendedStart")throw N="completed",T.arg;T.dispatchException(T.arg)}else T.method==="return"&&T.abrupt("return",T.arg);N="executing";var H=c(b,k,T);if(H.type==="normal"){if(N=T.done?"completed":"suspendedYield",H.arg===h)continue;return{value:H.arg,done:T.done}}H.type==="throw"&&(N="completed",T.method="throw",T.arg=H.arg)}}}function R(b,k){var T=k.method,N=b.iterator[T];if(N===void 0)return k.delegate=null,T==="throw"&&b.iterator.return&&(k.method="return",k.arg=void 0,R(b,k),k.method==="throw")||T!=="return"&&(k.method="throw",k.arg=new TypeError("The iterator does not provide a '"+T+"' method")),h;var P=c(N,b.iterator,k.arg);if(P.type==="throw")return k.method="throw",k.arg=P.arg,k.delegate=null,h;var B=P.arg;return B?B.done?(k[b.resultName]=B.value,k.next=b.nextLoc,k.method!=="return"&&(k.method="next",k.arg=void 0),k.delegate=null,h):B:(k.method="throw",k.arg=new TypeError("iterator result is not an object"),k.delegate=null,h)}function W(b){var k={tryLoc:b[0]};1 in b&&(k.catchLoc=b[1]),2 in b&&(k.finallyLoc=b[2],k.afterLoc=b[3]),this.tryEntries.push(k)}function J(b){var k=b.completion||{};k.type="normal",delete k.arg,b.completion=k}function se(b){this.tryEntries=[{tryLoc:"root"}],b.forEach(W,this),this.reset(!0)}function U(b){if(b){var k=b[o];if(k)return k.call(b);if(typeof b.next=="function")return b;if(!isNaN(b.length)){var T=-1,N=function P(){for(;++T<b.length;)if(e.call(b,T))return P.value=b[T],P.done=!1,P;return P.value=void 0,P.done=!0,P};return N.next=N}}return{next:ae}}function ae(){return{value:void 0,done:!0}}return f.prototype=p,t(w,"constructor",{value:p,configurable:!0}),t(p,"constructor",{value:f,configurable:!0}),f.displayName=u(p,a,"GeneratorFunction"),i.isGeneratorFunction=function(b){var k=typeof b=="function"&&b.constructor;return!!k&&(k===f||(k.displayName||k.name)==="GeneratorFunction")},i.mark=function(b){return Object.setPrototypeOf?Object.setPrototypeOf(b,p):(b.__proto__=p,u(b,a,"GeneratorFunction")),b.prototype=Object.create(w),b},i.awrap=function(b){return{__await:b}},S(C.prototype),u(C.prototype,s,function(){return this}),i.AsyncIterator=C,i.async=function(b,k,T,N,P){P===void 0&&(P=Promise);var B=new C(l(b,k,T,N),P);return i.isGeneratorFunction(k)?B:B.next().then(function(Q){return Q.done?Q.value:B.next()})},S(w),u(w,a,"Generator"),u(w,o,function(){return this}),u(w,"toString",function(){return"[object Generator]"}),i.keys=function(b){var k=Object(b),T=[];for(var N in k)T.push(N);return T.reverse(),function P(){for(;T.length;){var B=T.pop();if(B in k)return P.value=B,P.done=!1,P}return P.done=!0,P}},i.values=U,se.prototype={constructor:se,reset:function(b){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(J),!b)for(var k in this)k.charAt(0)==="t"&&e.call(this,k)&&!isNaN(+k.slice(1))&&(this[k]=void 0)},stop:function(){this.done=!0;var b=this.tryEntries[0].completion;if(b.type==="throw")throw b.arg;return this.rval},dispatchException:function(b){if(this.done)throw b;var k=this;function T(H,L){return B.type="throw",B.arg=b,k.next=H,L&&(k.method="next",k.arg=void 0),!!L}for(var N=this.tryEntries.length-1;N>=0;--N){var P=this.tryEntries[N],B=P.completion;if(P.tryLoc==="root")return T("end");if(P.tryLoc<=this.prev){var Q=e.call(P,"catchLoc"),he=e.call(P,"finallyLoc");if(Q&&he){if(this.prev<P.catchLoc)return T(P.catchLoc,!0);if(this.prev<P.finallyLoc)return T(P.finallyLoc)}else if(Q){if(this.prev<P.catchLoc)return T(P.catchLoc,!0)}else{if(!he)throw new Error("try statement without catch or finally");if(this.prev<P.finallyLoc)return T(P.finallyLoc)}}}},abrupt:function(b,k){for(var T=this.tryEntries.length-1;T>=0;--T){var N=this.tryEntries[T];if(N.tryLoc<=this.prev&&e.call(N,"finallyLoc")&&this.prev<N.finallyLoc){var P=N;break}}P&&(b==="break"||b==="continue")&&P.tryLoc<=k&&k<=P.finallyLoc&&(P=null);var B=P?P.completion:{};return B.type=b,B.arg=k,P?(this.method="next",this.next=P.finallyLoc,h):this.complete(B)},complete:function(b,k){if(b.type==="throw")throw b.arg;return b.type==="break"||b.type==="continue"?this.next=b.arg:b.type==="return"?(this.rval=this.arg=b.arg,this.method="return",this.next="end"):b.type==="normal"&&k&&(this.next=k),h},finish:function(b){for(var k=this.tryEntries.length-1;k>=0;--k){var T=this.tryEntries[k];if(T.finallyLoc===b)return this.complete(T.completion,T.afterLoc),J(T),h}},catch:function(b){for(var k=this.tryEntries.length-1;k>=0;--k){var T=this.tryEntries[k];if(T.tryLoc===b){var N=T.completion;if(N.type==="throw"){var P=N.arg;J(T)}return P}}throw new Error("illegal catch attempt")},delegateYield:function(b,k,T){return this.delegate={iterator:U(b),resultName:k,nextLoc:T},this.method==="next"&&(this.arg=void 0),h}},i}function ml(i,n,e,t,r,o,s){try{var a=i[o](s),u=a.value}catch(l){return void e(l)}a.done?n(u):Promise.resolve(u).then(t,r)}function mt(i){return function(){var n=this,e=arguments;return new Promise(function(t,r){var o=i.apply(n,e);function s(u){ml(o,t,r,s,a,"next",u)}function a(u){ml(o,t,r,s,a,"throw",u)}s(void 0)})}}function oa(i,n){if(!(i instanceof n))throw new TypeError("Cannot call a class as a function")}function sa(i,n,e){return n&&function(t,r){for(var o=0;o<r.length;o++){var s=r[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,Oh(s.key),s)}}(i.prototype,n),Object.defineProperty(i,"prototype",{writable:!1}),i}function ft(i,n,e){return(n=Oh(n))in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}function Es(i){return(Es=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)})(i)}function Ph(i,n){return(Ph=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(i,n)}function Qg(i,n){if(i==null)return{};var e,t,r=function(s,a){if(s==null)return{};var u,l,c={},h=Object.keys(s);for(l=0;l<h.length;l++)u=h[l],a.indexOf(u)>=0||(c[u]=s[u]);return c}(i,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(i);for(t=0;t<o.length;t++)e=o[t],n.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(i,e)&&(r[e]=i[e])}return r}function vt(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function em(i){var n=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var e,t=Es(i);if(n){var r=Es(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(o,s){if(s&&(typeof s=="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vt(o)}(this,e)}}function tm(i,n){return function(e){if(Array.isArray(e))return e}(i)||function(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var o,s,a,u,l=[],c=!0,h=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(c=(o=a.call(r)).done)&&(l.push(o.value),l.length!==t);c=!0);}catch(d){h=!0,s=d}finally{try{if(!c&&r.return!=null&&(u=r.return(),Object(u)!==u))return}finally{if(h)throw s}}return l}}(i,n)||Lh(i,n)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function nm(i){return function(n){if(Array.isArray(n))return Ps(n)}(i)||function(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}(i)||Lh(i)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Lh(i,n){if(i){if(typeof i=="string")return Ps(i,n);var e=Object.prototype.toString.call(i).slice(8,-1);return e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set"?Array.from(i):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Ps(i,n):void 0}}function Ps(i,n){(n==null||n>i.length)&&(n=i.length);for(var e=0,t=new Array(n);e<n;e++)t[e]=i[e];return t}function Oh(i){var n=function(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var o=r.call(e,t||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}(i,"string");return typeof n=="symbol"?n:String(n)}var vr=sa(function i(n,e){oa(this,i),this.type="file",this.message=n,this.data=e}),im=function(){function i(){oa(this,i),ft(this,"_data",Object.create(null))}return sa(i,[{key:"set",value:function(n,e){this._data[n]=e}},{key:"get",value:function(n){return this._data[n]}},{key:"clear",value:function(){this._data=Object.create(null)}}]),i}();function Xo(i,n){var e=i.trak;if(e&&e.length){var t=e.find(function(b){var k,T;return((k=b.mdia)===null||k===void 0||(T=k.hdlr)===null||T===void 0?void 0:T.handlerType)==="vide"}),r=e.find(function(b){var k,T;return((k=b.mdia)===null||k===void 0||(T=k.hdlr)===null||T===void 0?void 0:T.handlerType)==="soun"});if(t||r){var o,s=[],a=[];if(t){var u,l,c,h=(u=t.mdia)===null||u===void 0||(l=u.minf)===null||l===void 0?void 0:l.stbl;if(!h)return;var d=(c=t.mdia.mdhd)===null||c===void 0?void 0:c.timescale,f=h.stts,p=h.stsc,m=h.stsz,v=h.stco,y=h.stss,w=h.ctts;if(!(d&&f&&p&&m&&v&&y))return;o=(s=vl(n,d,f,p,m,v,y,w)).map(function(b){return b.duration})}if(r){var S,C,E,R=(S=r.mdia)===null||S===void 0||(C=S.minf)===null||C===void 0?void 0:C.stbl;if(!R)return;var W=(E=r.mdia.mdhd)===null||E===void 0?void 0:E.timescale,J=R.stts,se=R.stsc,U=R.stsz,ae=R.stco;if(!(W&&J&&se&&U&&ae))return;a=vl(n,W,J,se,U,ae,null,null,o)}return{videoSegments:s,audioSegments:a}}}}function vl(i,n,e,t,r,o,s,a,u){var l,c,h,d,f=[],p=[],m=[],v=t.entries,y=o.entries,w=r.entrySizes,S=s==null?void 0:s.entries,C=a==null?void 0:a.entries;C&&(l=[],C.forEach(function(ge){for(var ce=ge.count,ve=ge.offset,Oe=0;Oe<ce;Oe++)l.push(ve)})),S&&(c={},S.forEach(function(ge){c[ge-1]=!0}));var E=0,R=0,W=0,J=0,se=0,U=v[0].samplesPerChunk,ae=v[1]?v[1].firstChunk-1:1/0,b=0,k=-1;e.entries.forEach(function(ge){var ce=ge.count,ve=ge.delta;d=ve;for(var Oe=0;Oe<ce;Oe++)h={dts:b,startTime:E,duration:d,size:w[R]||r.sampleSize,offset:y[W]+se,index:R},S&&(h.keyframe=c[R],h.keyframe?(k++,p.push([h]),m.push(h.duration)):(p[p.length-1].push(h),m[p.length-1]+=h.duration),h.gopId=k),l&&R<l.length&&(h.pts=b+l[R]),R===0&&(h.pts=0),f.push(h),E+=d,b+=ve,++R<U?se+=h.size:(W++,se=0,W>=ae&&(J++,ae=v[J+1]?v[J+1].firstChunk-1:1/0),U+=v[J].samplesPerChunk)});var T=f.length;if(T&&(!s||f[0].keyframe)){var N,P=[],B=[],Q=0,he=0,H=function(ge){var ce;N=B[B.length-1],P.push({index:P.length,startTime:((ce=P[P.length-1])===null||ce===void 0?void 0:ce.endTime)||B[0].startTime/n,endTime:(N.startTime+N.duration)/n,duration:ge,range:[B[0].offset,N.offset+N.size],frames:B}),Q=0,B=[]};if(s)for(var L=i*n,M=0,G=p.length;M<G;M++){var re;Q+=m[M],(re=B).push.apply(re,nm(p[M])),M+1<G?(M===0||Q>L)&&H(Q/n):H(Q/n)}else for(var Ee=(u=u||[])[0]||i,Le=0;Le<T;Le++){B.push(f[Le]);var le=(Q+=f[Le].duration)/n;(Le+1>=T||le+he>=Ee)&&(he+=le-Ee,H(le),Ee=u[P.length]||i)}return P}}function yl(i){var n="",e="",t=0,r=0,o=0,s=0,a=0,u=0,l=0;i.mvhd&&(a=i.mvhd.duration/i.mvhd.timescale);var c=i.trak;if(c){var h,d,f,p,m,v,y,w,S,C,E,R,W,J,se,U,ae,b=c.find(function(N){var P,B;return((P=N.mdia)===null||P===void 0||(B=P.hdlr)===null||B===void 0?void 0:B.handlerType)==="vide"}),k=c.find(function(N){var P,B;return((P=N.mdia)===null||P===void 0||(B=P.hdlr)===null||B===void 0?void 0:B.handlerType)==="soun"}),T=null;return b&&(T=(d=b.mdia)===null||d===void 0||(f=d.minf)===null||f===void 0||(p=f.stbl)===null||p===void 0?void 0:p.stsd.entries[0])&&(t=T.width,r=T.height,u=(m=b.mdia)===null||m===void 0||(v=m.mdhd)===null||v===void 0?void 0:v.timescale,n=(y=T.avcC||T.hvcC)===null||y===void 0?void 0:y.codec,T.type==="encv"&&(h=(w=T.sinf)===null||w===void 0||(S=w.schi)===null||S===void 0?void 0:S.tenc.default_KID)),k&&(T=(C=k.mdia)===null||C===void 0||(E=C.minf)===null||E===void 0||(R=E.stbl)===null||R===void 0?void 0:R.stsd.entries[0])&&(o=T.channelCount,s=T.sampleRate,e=(W=T.esds)===null||W===void 0?void 0:W.codec,l=(J=k.mdia)===null||J===void 0||(se=J.mdhd)===null||se===void 0?void 0:se.timescale,T.type==="enca"&&(h=h||((U=T.sinf)===null||U===void 0||(ae=U.schi)===null||ae===void 0?void 0:ae.tenc.default_KID))),{kid:h?h.join(""):null,videoCodec:n,audioCodec:e,width:t,height:r,videoTimescale:u,audioChannelCount:o,audioSampleRate:s,duration:a,audioTimescale:l,moov:i}}}function _l(i){return typeof i=="number"&&!Number.isNaN(i)}var rm=["vid","cache"],om=function(){(function(f,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(p&&p.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),Object.defineProperty(f,"prototype",{writable:!1}),p&&Ph(f,p)})(d,Yn);var i,n,e,t,r,o,s,a,u,l,c,h=em(d);function d(f){var p;oa(this,d),ft(vt(p=h.call(this)),"vid",""),ft(vt(p),"url",""),ft(vt(p),"meta",{}),ft(vt(p),"downloadInfo",[]),ft(vt(p),"videoSegments",[]),ft(vt(p),"audioSegments",[]),ft(vt(p),"cache",null),ft(vt(p),"_currentSegmentIndex",-1),ft(vt(p),"_currentLoadingSegmentIndex",-1),ft(vt(p),"buffer",void 0),ft(vt(p),"_error",void 0),ft(vt(p),"_transformError",function(S){return S}),p._config=$o({vid:"",moovEnd:8e4,segmentDuration:2,maxDownloadInfoSize:30,responseType:"arraybuffer",cache:null},f);var m=p._config,v=m.vid,y=m.cache,w=Qg(m,rm);return p.cache=y||new im,p.vid=v||w.url,p.url=w.url,w.transformError=p._transformError,p.logger=new yi("MP4Loader_"+p.vid),f.openLog&&yi.enable(),w.logger=p.logger,p._loader=new $g(w),p._loader.on(Kn,function(S){p.emit(Kn,S)}),p}return sa(d,[{key:"isMetaLoaded",get:function(){return this.videoSegments.length||this.audioSegments.length}},{key:"setCurrentSegment",value:function(f){_l(f)&&(this._currentSegmentIndex=f)}},{key:"isLastSegment",value:function(f){var p,m;return!!_l(f)&&f>=(((p=this.videoSegments[this.videoSegments.length-1])===null||p===void 0?void 0:p.index)||((m=this.audioSegments[this.audioSegments.length-1])===null||m===void 0?void 0:m.index)||0)}},{key:"isSegmentLoading",value:function(f){return f===this._currentLoadingSegmentIndex}},{key:"changeUrl",value:(c=mt(Be().mark(function f(p){var m,v,y,w=arguments;return Be().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return m=w.length>1&&w[1]!==void 0?w[1]:p,v=w.length>2?w[2]:void 0,y=w.length>3?w[3]:void 0,S.next=5,this.reset(y);case 5:p&&(this.url=p),m&&(this.vid=m),v&&(this._config.moovEnd=v);case 8:case"end":return S.stop()}},f,this)})),function(f){return c.apply(this,arguments)})},{key:"getOrLoadMeta",value:(l=mt(Be().mark(function f(p){return Be().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(this.isMetaLoaded){m.next=3;break}return m.next=3,this.loadMeta(p);case 3:return m.abrupt("return",this.meta);case 4:case"end":return m.stop()}},f,this)})),function(f){return l.apply(this,arguments)})},{key:"loadMetaProcess",value:(u=mt(Be().mark(function f(p,m,v,y){var w,S,C,E,R=this;return Be().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return w=tm(m,2),S=w[0],C=w[1],this._error=!1,this.logger.debug("[loadMetaProcess start], range,",[S,C]),E=function(){var J=mt(Be().mark(function se(U,ae,b,k){var T,N,P,B,Q,he,H,L;return Be().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(R.meta&&b!=null&&b.range&&b.range.length>0&&b.range[1]>=C&&(ae=!0,R.logger.debug("[loadMetaProcess],data done,setstate true,[",S,C,"]")),ae&&b!=null&&b.range&&b.range.length>0&&b.range[1]<C&&(ae=!1,R.logger.debug("[loadMetaProcess],data not done,setstate false,[",S,C,"]")),R.logger.debug("[loadMetaProcess],task,[",S,C,"], range,",b.range,",dataLen,",U?U.byteLength:void 0,", state,",ae,",err,",R._error),!R._error&&U&&U.byteLength>0&&v(U,ae,b,null,k),!R.meta.moov&&!R._error){M.next=6;break}return M.abrupt("return");case 6:if(!(U&&U.byteLength>0)){M.next=44;break}if(R.buffer=dl(R.buffer,U),T=Mt.findBox(R.buffer,["moov"])[0]){M.next=23;break}if(N=Mt.findBox(R.buffer,["mdat"])[0],!ae){M.next=23;break}if(N){M.next=18;break}return R._error=!0,v(null,ae,b,{err:"cannot find moov or mdat box"},k),M.abrupt("return");case 18:return P=N.start+N.size,M.next=21,R.loadData([P,""],p,y);case 21:(B=M.sent)&&(T=Mt.findBox(B.data,["moov"])[0]);case 23:if(!(T&&ae&&T.size>T.data.length)){M.next=27;break}return R.logger.debug("[loadMetaProcess],moov not all, range,",b.range[1],",dataLen,",R.buffer.byteLength,", state,",ae),M.next=27,R.loadMetaProcess(p,[b.range[1],T.start+T.size-1],v);case 27:if(!(T&&T.size<=T.data.length)||R.meta.moov){M.next=44;break}if(Q=Mt.moov(T)){M.next=33;break}return R._error=!0,v(null,ae,b,{err:"cannot parse moov box"},k),M.abrupt("return");case 33:if(he=Xo(Q,R._config.segmentDuration)){M.next=38;break}return R._error=!0,v(null,ae,b,{err:"cannot parse segments"},k),M.abrupt("return");case 38:R.meta=yl(Q),H=he.videoSegments,L=he.audioSegments,R.videoSegments=H,R.audioSegments=L,R.logger.debug("[loadMetaProcess] moov ok"),v(void 0,ae,{meta:{meta:R.meta,videoSegments:H,audioSegments:L}},null,k);case 44:case"end":return M.stop()}},se)}));return function(se,U,ae,b){return J.apply(this,arguments)}}(),W.next=6,this.loadData([S,C||this._config.moovEnd],p,$o({onProgress:E},y));case 6:case"end":return W.stop()}},f,this)})),function(f,p,m,v){return u.apply(this,arguments)})},{key:"loadMeta",value:(a=mt(Be().mark(function f(p,m,v){var y,w,S,C,E,R,W,J,se;return Be().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return y=[],this.logger.debug("[loadMeta start]"),U.next=4,this.loadData([0,m||this._config.moovEnd],p,v);case 4:if(w=U.sent){U.next=7;break}return U.abrupt("return");case 7:if(y.push(w),S=Mt.findBox(w.data,["moov"])[0]){U.next=23;break}if(C=Mt.findBox(w.data,["mdat"])[0]){U.next=13;break}throw new vr("cannot find moov or mdat box",w.data);case 13:return E=C.start+C.size,U.next=16,this.loadData([E],p,v);case 16:if(w=U.sent){U.next=19;break}return U.abrupt("return");case 19:if(y.push(w),S=Mt.findBox(w.data,["moov"],E)[0]){U.next=23;break}throw new vr("cannot find moov box",w.data);case 23:if(!(S.size>S.data.length)){U.next=31;break}return U.next=26,this.loadData([w.data.length,S.start+S.size-1],p,v);case 26:if(w=U.sent){U.next=29;break}return U.abrupt("return");case 29:y.push(w),S.data=dl(S.data,w.data);case 31:if(R=Mt.moov(S)){U.next=34;break}throw new vr("cannot parse moov box",S.data);case 34:if(W=Xo(R,this._config.segmentDuration)){U.next=37;break}throw new vr("cannot parse segments",S.data);case 37:return this.meta=yl(R),J=W.videoSegments,se=W.audioSegments,this.videoSegments=J,this.audioSegments=se,this.logger.debug("[load moov end!!!!!]"),U.abrupt("return",{meta:this.meta,videoSegments:J,audioSegments:se,responses:y});case 43:case"end":return U.stop()}},f,this)})),function(f,p,m){return a.apply(this,arguments)})},{key:"loadCacheMeta",value:function(f,p){var m=Xo(f.moov,this._config.segmentDuration),v=m.videoSegments,y=m.audioSegments;this.videoSegments=v,this.audioSegments=y,this._currentSegmentIndex=p,this.meta=f}},{key:"getSegmentByTime",value:function(f){var p,m;return this.videoSegments.length?(p=this.videoSegments.find(function(v){return v.startTime<=f&&v.endTime>f}))&&(m=this.audioSegments[p.index]):m=this.audioSegments.find(function(v){return v.startTime<=f&&v.endTime>f}),{video:p,audio:m}}},{key:"loadSegmentByTime",value:(s=mt(Be().mark(function f(p,m){var v,y,w,S,C,E=arguments;return Be().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(v=!(E.length>2&&E[2]!==void 0)||E[2],y=E.length>3&&E[3]!==void 0?E[3]:{},this.isMetaLoaded){R.next=5;break}return R.next=5,this.loadMeta(m);case 5:return w=this.getSegmentByTime(p),S=w.video,C=w.audio,R.abrupt("return",this._loadSegment(S,C,m,v,y));case 7:case"end":return R.stop()}},f,this)})),function(f,p){return s.apply(this,arguments)})},{key:"loadNextSegment",value:(o=mt(Be().mark(function f(p){var m,v,y,w,S=arguments;return Be().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(m=!(S.length>1&&S[1]!==void 0)||S[1],v=S.length>2&&S[2]!==void 0?S[2]:{},this.isMetaLoaded){C.next=5;break}return C.next=5,this.loadMeta();case 5:return y=this.videoSegments[this._currentSegmentIndex+1],w=this.audioSegments[this._currentSegmentIndex+1],C.abrupt("return",this._loadSegment(y,w,p,m,v));case 8:case"end":return C.stop()}},f,this)})),function(f){return o.apply(this,arguments)})},{key:"preload",value:(r=mt(Be().mark(function f(p){var m,v,y,w,S,C,E,R=this;return Be().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(this.isMetaLoaded){W.next=3;break}return W.next=3,this.loadMeta(!0);case 3:if(p&&!(p<0)){W.next=5;break}return W.abrupt("return");case 5:if(m=this.getSegmentByTime(p),v=m.video,y=m.audio,w=Math.max((v==null?void 0:v.index)||0,(y==null?void 0:y.index)||0)){W.next=9;break}return W.abrupt("return");case 9:return S=this.videoSegments.slice(0,w),C=this.audioSegments.slice(0,w),E=function(){var J=mt(Be().mark(function se(U){return Be().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:if(!(U>w)){ae.next=2;break}return ae.abrupt("return");case 2:return ae.next=4,R._loadSegment(S[U],C[U],!0,!1);case 4:return ae.next=6,E(U+1);case 6:case"end":return ae.stop()}},se)}));return function(se){return J.apply(this,arguments)}}(),W.next=14,E(0);case 14:case"end":return W.stop()}},f,this)})),function(f){return r.apply(this,arguments)})},{key:"cancel",value:function(){return this._loader.cancel()}},{key:"reset",value:(t=mt(Be().mark(function f(){var p=arguments;return Be().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(p.length>0&&p[0]!==void 0&&p[0]){m.next=5;break}return this.logger.debug("[MP4loader reset func call loader.cancel]"),m.next=5,this._loader.cancel();case 5:this.vid=this.url="",this.meta={},this.downloadInfo=[],this.videoSegments=[],this.audioSegments=[],this._currentSegmentIndex=-1,this._currentLoadingSegmentIndex=-1;case 12:case"end":return m.stop()}},f,this)})),function(){return t.apply(this,arguments)})},{key:"destroy",value:(e=mt(Be().mark(function f(){return Be().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.reset();case 2:this.cache.clear();case 3:case"end":return p.stop()}},f,this)})),function(){return e.apply(this,arguments)})},{key:"_loadSegment",value:(n=mt(Be().mark(function f(p,m,v,y,w){var S,C;return Be().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(p||m){E.next=2;break}return E.abrupt("return");case 2:return S=(p==null?void 0:p.index)||(m==null?void 0:m.index)||0,this._currentLoadingSegmentIndex=S,E.prev=4,E.next=7,this.loadData([Math.min((p==null?void 0:p.range[0])||1/0,(m==null?void 0:m.range[0])||1/0),Math.max((p==null?void 0:p.range[1])||0,(m==null?void 0:m.range[1])||0)],v,w);case 7:C=E.sent;case 8:return E.prev=8,this._currentLoadingSegmentIndex=-1,E.finish(8);case 11:if(C){E.next=13;break}return E.abrupt("return");case 13:return y&&(this._currentSegmentIndex=S),C.video=p,C.audio=m,E.abrupt("return",C);case 17:case"end":return E.stop()}},f,this,[[4,,8,11]])})),function(f,p,m,v,y){return n.apply(this,arguments)})},{key:"loadData",value:(i=mt(Be().mark(function f(p,m,v){var y,w,S,C;return Be().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return y=this._getCacheKey(p),E.next=3,this.cache.get(y);case 3:if(w=E.sent){E.next=11;break}return C=v&&v.url?v.url:this.url,E.next=8,this._loader.load(C,$o({range:p,vid:this.vid},v));case 8:S=E.sent,E.next=12;break;case 11:S={data:w,state:!0,options:{fromCache:!0,range:p,vid:this.vid}};case 12:if(S){E.next=14;break}return E.abrupt("return");case 14:return w||(S.data&&this.downloadInfo.push({startTime:S.startTime,endTime:S.endTime,size:S.data.byteLength,range:p}),this.downloadInfo&&this.downloadInfo.length>this._config.maxDownloadInfoSize&&(this.downloadInfo=this.downloadInfo.slice(-this._config.maxDownloadInfoSize))),E.abrupt("return",S);case 17:case"end":return E.stop()}},f,this)})),function(f,p,m){return i.apply(this,arguments)})},{key:"_getCacheKey",value:function(f){return(this.vid||this.url)+":"+f}}]),d}();const Ih=function(){try{return typeof localStorage<"u"&&"setItem"in window.localStorage&&!!window.localStorage.setItem}catch{return!1}}()&&!function(){const i="_localstorage_support_test";try{return window.localStorage.setItem(i,!0),window.localStorage.removeItem(i),!1}catch{return!0}}(),sm=xr();function xr(){if(Ih)try{return!!window.localStorage.getItem("playerlog")}catch{return!1}return!1}function Rh(i,...n){}(function(){if(Ih)try{return!!window.localStorage.getItem("playertestlog")}catch{return!1}})();var am=Object.defineProperty,um=(i,n,e)=>(((t,r,o)=>{r in t?am(t,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[r]=o})(i,n+"",e),e);const wn="error",Sr="metaReady",Cr="moov_request_Progress",Ah="update_load_fragmentIdx";class aa extends Yn{constructor(n,e){super(),um(this,"onprogressDataArrive",async(t,r,o)=>{if(t&&t.byteLength>0){const s=this.timeRange[o.index].range;s&&o.range[1]>=s[1]&&!r&&(r=!0),this.log("[mp4.loadFragment onprogressDataArrive ] receive data, >>> index,",o.index,",range,",JSON.stringify(o.range),", dataLen,",t.byteLength),this._mux(t,o.range[0],o.index,r)}r&&(this.timeRange[o.index].downloaded=!0,this.bufferLoadedPos=-1,this.log("[FragLoadDowned],fragmentIdx,",o.index,",rangeEnd,",o.range[1]))}),this.url=n,this.options=aa.getDefaultConfig(),Object.keys(e).map(t=>{e[t]!==void 0&&e[t]!==null&&(this.options[t]=e[t])}),this.timeRange=[],this.CHUNK_SIZE=this.options.chunkSize,this.bufferLoaded=new Uint8Array(0),this.bufferLoadedPos=0,this.meta=null,this.videoTrak=null,this.audioTrak=null,this.canDownload=!0,this._loadSuccessCallBack=null,this._isPending=!1,this._metaLoading=!1,this.MP4Loader=new om({segmentDuration:this.options.segmentDuration,url:n,vid:e.vid,retry:this.options.retryCount,retryDelay:this.options.retryDelay,timeout:this.options.timeout,...e.reqOptions,openLog:xr()}),this.MP4Demuxer=null,this.FMP4Remuxer=null,this._needInitSegment=!0,this._switchBitRate=!1,this.enableWorker=this.options.enableWorker,this.enableWorker||(this.MP4Demuxer=null,this.FMP4Remuxer=null),this.seekTime=-1,this.changeBitRateTime=-1}static getDefaultConfig(){return{segmentDuration:5,onProcessMinLen:1024,chunkSize:8e5,retryCount:3,retryDelay:1e3,timeout:3e3,enableWorker:!1,playerId:"",vid:"",ext:{}}}async changeBitRate(n){this.url=n.url,await this.MP4Loader.changeUrl(this.url,this.options.vid+Date.now(),this.CHUNK_SIZE),this._switchBitRate=!0,this.log("[switchBitrate] changeUrl, bitRate,",this.url)}log(n,...e){const{options:t}=this;Rh(t&&t.vid?`[MP4] ${t.vid} ${n}`:`[MP4] ${n}`,...e)}async errorHandler(n,e,t={}){const{response:r,message:o}=n;this.options&&this.options.vid;let s=null;this._isPending=!0,r?(s=new Xg("network",r.status,{httpText:r.httpText,message:o,url:r.url}),this.emit(wn,s)):(s=n,this.emit(wn,s))}async init(){this.url&&await this.MP4Loader.changeUrl(this.url,this.options.vid+Date.now(),this.CHUNK_SIZE),await this.getMetaInfo()}getTimeRange(){const n=[];let e=null;for(let t=0;this.videoTrak&&t<this.videoTrak.length;t++)e={startTime:this.videoTrak[t].startTime,endTime:this.videoTrak[t].endTime,downloaded:!1,isLoading:!1},n.push(e);if(this.audioTrak&&this.audioTrak.length>n.length)for(let t=n.length;t<this.audioTrak.length;t++)e={startTime:Math.max(this.audioTrak[t].startTime,e?e.endTime:0),endTime:Math.max(this.audioTrak[t].endTime,e?e.endTime:0),downloaded:!1,isLoading:!1},n.push(e);return n}async getMetaInfo(n=!0){try{this._metaLoading=!0,this.log("getMetaInfo start"),this.bufferLoaded=new Uint8Array(0);let e=0;const t=async(r,o,s,a,u)=>{const l=u?Number(function(h){const d=Zg;if(h&&h.get&&h.get(d)){const f=h.get(d).split("/");if((f==null?void 0:f.length)===2)return f[1]}return null}(u.headers)):0;if(u&&Number(function(h){const d="Content-Length";return h&&h.get&&h.get(d)?h.get(d):null}(u.headers)),this.log("getMetaInfo onProgressHandle, dataLen,",r?r.byteLength:-1,", state,",o,",range,",JSON.stringify(s.range)),a)return void this.emit(wn,a);if(r&&s.range[0]===e&&(this.bufferLoaded=kg(Uint8Array,this.bufferLoaded,new Uint8Array(r)),e+=r.byteLength),s.meta&&!this.meta){const h=s.meta;this.videoTrak=h.videoSegments,this.audioTrak=h.audioSegments,this.timeRange=this.getTimeRange(),this.meta={...h.meta,ext:{videoTrak:this.videoTrak,audioTrak:this.audioTrak}},h.bufferLoaded=this.bufferLoaded,this.log("meta reach"),n&&this.emit(Sr,this.meta)}this.meta&&o&&(this.log("[getMetaInfo req end]"),this._metaLoading=!1),this.meta&&(r||o)&&(this.log("emit moov_req_progress"),this.emit(Cr));const c=(s==null?void 0:s.range)||[];l>0&&!this.meta&&c&&c.length>1&&c[1]>=l&&(this.log("getMetaInfo_error_nometa"),this.emit(wn,{message:"getMetaInfo_error_nometa"}))};await this.MP4Loader.loadMetaProcess(this.MP4Loader.cache,[0,this.CHUNK_SIZE],t)}catch(e){this.loadError(e,"getMetaInfo")}}getFragmentIdx(n){let e,t;if(this.videoTrak.length){if(e=this.videoTrak.find(r=>r.startTime<=n&&r.endTime>n),t=this.audioTrak.find(r=>r.startTime<=n&&r.endTime>n),e&&t)return Math.min(e.index,t.index);if(e||t)return e?e.index:t.index;{let r=Number.MAX_VALUE;return this.videoTrak&&this.videoTrak.length>0&&(r=this.videoTrak.length-1),this.audioTrak&&this.audioTrak.length>0&&(r=Math.min(this.audioTrak.length-1,r)),r}}return t=this.audioTrak.find(r=>r.startTime<=n&&r.endTime>n),t?t.index:0}async _checkHasMeta(){this.log(" loadMeta start"),this._metaLoading=!0;try{const n=await this.MP4Loader.loadMeta(this.MP4Loader.cache,Math.round(this.CHUNK_SIZE/2));return this._metaLoading=!1,this.videoTrak=n.videoSegments,this.audioTrak=n.audioSegments,this.meta={...n.meta,ext:{videoTrak:this.videoTrak,audioTrak:this.audioTrak}},this.timeRange=this.getTimeRange(),this.bufferLoaded=new Uint8Array(0),n.bufferLoaded=this.bufferLoaded,!0}catch(n){return this._metaLoading=!1,this.emit(wn,n),!1}}resetFragmentLoadState(n){for(let e=0;e<this.timeRange.length;e++)e<n?(this.timeRange[e].downloaded=!0,this.timeRange[e].isLoading=!0):(this.timeRange[e].downloaded=!1,this.timeRange[e].isLoading=!1)}getFragRange(n){let e=null;this.videoTrak&&(e=n<this.videoTrak.length?this.videoTrak[n]:this.videoTrak[this.videoTrak.length-1]);let t=null;this.audioTrak&&(t=n<this.audioTrak.length?this.audioTrak[n]:this.audioTrak[this.audioTrak.length-1]);let r=0,o=0;this.videoTrak&&n>=this.videoTrak.length-1&&(r=-1),this.audioTrak&&n>=this.audioTrak.length-1&&(o=-1);const s=[Math.min((e==null?void 0:e.range[0])||1/0,(t==null?void 0:t.range[0])||1/0),Math.max((e==null?void 0:e.range[1])+r||0,(t==null?void 0:t.range[1])+o||0)];return n<this.timeRange.length&&(this.timeRange[n].range=s),s}async load(n,e){if(this._loadSuccessCallBack=e,this._switchBitRate&&!this._metaLoading){this.log("[switchBitrate], switch bitRate start load, time,",n>=this.videoTrak.length?this.audioTrak[n].startTime:this.videoTrak[n].startTime,", fragIndex,",n);const r=await this._checkHasMeta();this.changeBitRateTime>0&&(this.timeRange[n].startTime<=this.changeBitRateTime&&this.changeBitRateTime<this.timeRange[n].endTime?this.log("[switchBitrate], not need update load fragIndex",n,",stTime,",this.changeBitRateTime):(n=this.getFragmentIdx(this.changeBitRateTime),this.log("[switchBitrate], need update load fragIndex",n,",stTime,",this.changeBitRateTime,",newBitrateTimeRange,",this.timeRange[n].startTime,"-",this.timeRange[n].endTime),this.emit(Ah,n)),this.seekTime=this.changeBitRateTime,this.changeBitRateTime=-1),this.resetFragmentLoadState(n),this.log("[switchBitrate], reset timerange state,",n),this._needInitSegment=!0,this.resetTansmuxer(),r&&(this._switchBitRate=!1)}if(this._switchBitRate&&this._metaLoading)return;const t=this.getFragRange(n);if(this.log("loadFragment,",n,",range,",JSON.stringify(t)),this.seekTime>0){const r=this.getSubRange(n,this.seekTime,t);this.loadFragment(n,r),this.seekTime=-1}else this.loadFragment(n,t)}getSubRange(n,e,t){var r,o;let s=t[0],a=t[0];if(this.log(">>>>>getSubRange time,",e,JSON.stringify(t)),((r=this.videoTrak)==null?void 0:r.length)>0){const c=n<this.videoTrak.length?this.videoTrak[n]:this.videoTrak[this.videoTrak.length-1],h=c.frames.filter(lm),d=this.meta.videoTimescale;this.log(">>>>>getSubRange video, startTime,",c.startTime,",endTime,",c.endTime);const f=h.find((p,m)=>{const v=p.startTime/d,y=m+1<h.length?h[m+1].startTime/d:c.endTime+.8;if(e>=v&&e<y)return this.log(">>>>>getSubRange video end, startTime,",v,",endTime,",y,",startRange,",s,", keyFrameIndex,",p.index),p});s=(f==null?void 0:f.offset)||s}let u=1;if(((o=this.audioTrak)==null?void 0:o.length)>0){const c=n<this.audioTrak.length?this.audioTrak[n]:this.audioTrak[this.audioTrak.length-1],h=c.frames,d=this.meta.audioTimescale;u=Math.floor((e*d-h[0].startTime)/c.frames[0].duration),u=Math.min(h.length-1,u);let f=u>0?h[u-1].startTime/d:h[0].startTime/d;for(;u>=0;){if(u>0&&f>e){u-=1,f=h[u].startTime/d;continue}const p=(h[u].startTime+h[u].duration)/d;if(f<=e&&e<p&&t[0]<h[u].offset){a=h[u].offset,this.log(">>>>>getSubRange audio end, startTime,",f,",endTime,",p,",startRange,",a,", index,",u);break}f=p,u++}}const l=[Math.min(a,s),t[1]];return this.log(">>>>>getSubRange finalRange ",JSON.stringify(l),",oldRange,",JSON.stringify(t)),l}_mux(n,e,t,r){const o=this.getSamplesRange(t,"video"),s=this.getSamplesRange(t,"audio"),a=[e,e+n.byteLength];try{this.MP4Demuxer||(this.MP4Demuxer=new Mg(this.videoTrak,this.audioTrak,null,{openLog:xr()}));const u=this.MP4Demuxer.demuxPart(n,e,o,s,this.meta.moov,this.useEME,this.kidValue);let l;this.FMP4Remuxer||this.checkCodecH265()&&!this.options.supportHevc||(this.FMP4Remuxer=new Dg(this.MP4Demuxer.videoTrack,this.MP4Demuxer.audioTrack,{openLog:xr()})),this.log("[mux], videoTimeRange,",u.videoTrack?[u.videoTrack.startPts,u.videoTrack.endPts]:null,",audioTimeRange,",u.audioTrack?[u.audioTrack.startPts,u.audioTrack.endPts]:null);const c=Math.min(u.videoTrack.startPts,u.audioTrack.startPts),h=[c,Math.max(u.videoTrack.endPts,u.audioTrack.endPts)];if(this.FMP4Remuxer){const d=this.FMP4Remuxer.remux(this._needInitSegment,{initMerge:!0,range:a});d.initSegment&&(this._needInitSegment=!1),l={buffer:Qt.concatData(d.audioSegment,d.videoSegment),range:a,state:r,context:{range:a,fragIndex:t,timeRange:h},initSeg:d.initSegment}}else l={videoTrack:u.videoTrack,audioTrack:u.audioTrack,buffer:null,range:a,state:r,context:{range:a,fragIndex:t,timeRange:h}};this._loadSuccessCallBack&&this._loadSuccessCallBack(l)}catch(u){const l=new Jg(ui.remux,Dt.muxError,{msg:JSON.stringify(u)});this.errorHandler(l,"mux",{fragIndex:t,range:[e,e+n.byteLength]})}}getSamplesRange(n,e){const t=[];switch(e){case"video":if(this.videoTrak&&n<this.videoTrak.length){const r=this.videoTrak[n].frames;t.push(r[0].index),t.push(r[r.length-1].index)}break;case"audio":if(this.audioTrak&&n<this.audioTrak.length){const r=this.audioTrak[n].frames;t.push(r[0].index),t.push(r[r.length-1].index)}}return t}async loadFragment(n,e){if(!(this._isPending||e.length>0&&e[0]===0&&e[1]===0||this.timeRange[n].isLoading))if(this.log("[MP4.loadFragment] ,fragIndex,",n,",range ",e,",len ,",e[1]-e[0],", bufferLoaded_Len,",this.bufferLoaded.byteLength),e.length>=2&&e[1]&&e[1]>0&&e[1]<=this.bufferLoaded.byteLength){this.timeRange[n].isLoading=!0;const t=Math.max(e[0],this.bufferLoadedPos),r=new Uint8Array(this.bufferLoaded.slice(t,e[1]));this.log("[mp4.loadFragment] has all data: ",t,e[1]),this.timeRange[n].downloaded=!0,this.bufferLoadedPos=-1,this._mux(r,t,n,!0)}else if(e.length>=2&&e[0]&&e[0]<=this.bufferLoaded.byteLength){if(!this.timeRange[n].isLoading){const t=Math.max(e[0],this.bufferLoadedPos),r=new Uint8Array(this.bufferLoaded.slice(t,e[1]));if(r.byteLength>0)return this.bufferLoadedPos=t+r.byteLength,this.log("[mp4.loadFragment] has part data: ",t,t+r.byteLength),void this._mux(r,t,n,e[1]<=this.bufferLoadedPos);this._metaLoading||this.timeRange[n].isLoading||(this.log("[mp4.loadFragment] ready to load part data >>> ",this.bufferLoaded.byteLength,e[1]),this.timeRange[n].isLoading=!0,await this.startLoad([this.bufferLoaded.byteLength,e[1]],n))}}else this._metaLoading&&!(e[0]>=this.CHUNK_SIZE)||this.timeRange[n].isLoading||(this.timeRange[n].isLoading=!0,this.log("[mp4.loadFragment],ready to load all data ,segmentIdx, ",n,",range >>> ",JSON.stringify(e)),await this.startLoad(e,n))}async startLoad(n,e){try{await this.MP4Loader.loadData(n,this.MP4Loader.cache,{index:e,onProgress:this.onprogressDataArrive,onProcessMinLen:this.options.onProcessMinLen,url:this.url})}catch(t){this.timeRange[e].isLoading=!1,this.loadError(t,"startLoad",{range:n,fragIndex:e})}}loadError(n,e,t){var r;!n.response&&(n.response={}),n.isTimeout?n.response.status="timeout":(r=n==null?void 0:n.response)!=null&&r.status||(n.response.status="networkError"),this.errorHandler(n,e,t)}async cancelLoading(){await this.MP4Loader&&this.MP4Loader.cancel()}async update(n){this.url=n,this.MP4Loader&&this.MP4Loader.changeUrl(n),this.MP4Loader&&this.MP4Loader.changeUrl(n)}restart(){this._isPending=!1,this.meta||this.init()}checkCodecH265(){return this.meta&&(this.meta.videoCodec.indexOf("hvc1")>-1||this.meta.videoCodec.indexOf("hev1")>-1)}destroy(){this.hasDestroyed||(this.resetTansmuxer(),this._isPending=!1,this._metaLoading=!1,this.bufferLoadedPos=0,this.bufferLoaded=new Uint8Array(0),this.MP4Loader&&(this.MP4Loader.cancel(),this.MP4Loader.destroy()),this.hasDestroyed=!0)}resetTansmuxer(){this.MP4Demuxer&&this.MP4Demuxer.reset(),this.MP4Demuxer=null,this.FMP4Remuxer&&this.FMP4Remuxer.reset(),this.FMP4Remuxer=null}}function lm(i){if(i.keyframe)return i}class cm{constructor(n){this.onTick_=n,this.cancelPending_=null}tickAfter(n,e=null){this.stop();let t=!0,r=null;return this.cancelPending_=()=>{window.clearTimeout(r),t=!1},r=window.setTimeout(()=>{t&&(this.onTick_(),e&&e())},1e3*n),this}tickEvery(n){this.tickAfter(n,()=>{this.tickEvery(n)})}stop(){this.cancelPending_&&(this.cancelPending_(),this.cancelPending_=null)}}class hm{constructor(){let n,e;const t=new Promise((r,o)=>{n=r,e=o});return t.resolve=function(r){n(r),t.state="fulfilled"},t.reject=function(r){e(r),t.state="rejected",t.isBreak=r==="DESTROYED"},t.state="pending",t}resolve(n){}reject(n){}}var dm=Object.defineProperty,It=(i,n,e)=>(((t,r,o)=>{r in t?dm(t,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[r]=o})(i,typeof n!="symbol"?n+"":n,e),e);let bl=null,Jo=null,Zo=null,kl=null;class fm extends qt{constructor(n){super(n),It(this,"_onMp4DataCallBack",()=>{this._isMseInit&&this._onTimeUpdate()}),It(this,"_onMp4MetaReady",e=>{const{config:t}=this,r=this.mp4.checkCodecH265();try{if(r&&!this.config.supportHevc){const o="browser not support HEVC",s=new nn(this.player,{errorType:"runtime",errorTypeCode:ui.runtime,errorCode:Dt.h265Error,errorMessage:o,vid:t.vid,mediaError:{code:Dt.h265Error,message:o}});this._errorHandler(s)}else this._initMse(e),this._initPromise.resolve()}catch(o){const s=new nn(this.player,{errorType:"runtime",errorTypeCode:ui.runtime,errorCode:Dt.mse,errorMessage:o==null?void 0:o.message,vid:t.vid,mediaError:{code:Dt.other1,message:o==null?void 0:o.message}});return void this._errorHandler(s)}this._loadData()}),It(this,"_onMp4Error",e=>{const{vid:t}=this.playerConfig;this._errorHandler(e)}),It(this,"_loadDataSuccess",e=>{if(!this.isDestroy&&this.mse){this.log("[loadFragment] _loadDataSuccess ",JSON.stringify(e.context.range),",dataLen,",e.buffer?e.buffer.byteLength:0,e.state);try{e.initSeg&&(this._appendInitSeg(e.initSeg),(!e.buffer||e.buffer.byteLength<1)&&(this.log("no data, must load data"),this._onTimeUpdate()));const{buffer:t,state:r,context:o}=e;if(this.mse&&r&&(!t||t.byteLength<=0)&&o.fragIndex===this.mp4.timeRange.length-1){const s=this.player.buffered;s&&s.length>0&&(this.bufferEndTime=s.end(s.length-1)),this._isEnded(),this.log("loaded ended !!!==>>>",JSON.stringify(o.range),", fragIndex,",o.fragIndex,", bufferEndTime,",this.bufferEndTime,",meta_duration,",this.mp4.meta.duration)}if(this.mse&&r&&o.fragIndex===this.mp4.timeRange.length-1&&(!t||t.byteLength<=0)){const s=this.player.buffered;s&&s.length>0&&(this.bufferEndTime=s.end(s.length-1)),this._isEnded(),this.log("load ended !!!==>>>",this.playerConfig.vid,JSON.stringify(o.range),", fragIndex,",o.fragIndex,", bufferEndTime,",this.bufferEndTime,",meta_duration,",this.mp4.meta.duration)}t&&this.mse&&t&&t.byteLength>0&&this._appendBuffer(At.VIDEO,t,o,r)}catch(t){this.log("appendBuffer error",t);const r=new nn(this.player,{errorType:"runtime",errorTypeCode:ui.runtime,errorCode:Dt.mse,vid:this.player.config.vid,errorMessage:t.message,mediaError:{code:Dt.mse,message:t.message}});this._errorHandler(r)}e!=null&&e.state&&this._onTimeUpdate()}}),It(this,"_onWaiting",()=>{const{player:e,config:t}=this;clearTimeout(this._waitInBufferTimer),this._waitInBufferTimer=null;const r=e.currentTime,o=e.bufferedPoint;o.end>0&&o.end-e.currentTime>=2&&this._waitAdjustTimeCnt<t.waitJampBufferMaxCnt&&(this._waitInBufferTimer=setTimeout(()=>{this._waitAdjustTimeCnt++,e.currentTime=e.currentTime+.5,this.log("[waitInBufferTimeout], waitAdjustTimeCnt,",this._waitAdjustTimeCnt,",curtime,",r,Qt.nowTime())},t.waitingInBufferTimeOut))}),It(this,"_onSeeking",async()=>{const{player:e,mp4:t}=this,r=e.currentTime;if(this.log("[seekTime], curTime,",r,",buffer,",e.buffered2.bufferedList),!t||!t.meta)return;this.endofstream=!1,t.bufferLoadedPos=-1,t._metaLoading=!1;const o=e.bufferedPoint;let s=!1,a=0;if(o.end>0){if(s=!0,t.meta.duration-o.end<.5)return this._startProgress(),void this.log("[seeking in buffered range], buffer end,",o.end,", duration,",t.meta.duration);if(a=t.getFragmentIdx(o.end),this._curLoadSegmentIdx===a)return this._startProgress(),void this.log("[seeking in buffered range], seek fragIndex is current load segmentIdx",a);t.seekTime=o.end,a<0&&(a=this._curLoadSegmentIdx),this.log("[seeking in buffered range], seekTime ",r,",bufferRange,",o.start,"-",o.end,", fragIndex,",a)}if(!s){t.seekTime=r,a=t.getFragmentIdx(r),a<0&&(a=this._curLoadSegmentIdx),this.log("[seekTime out buffer range], curTime,",r,", Idx,",a);const{mse:u}=this;if(u&&u.isFull()){const l=e.buffered2.bufferedList,c=l[l.length-1];u.clearOpQueues(At.VIDEO),this._checkRemoveSourceBuffer([c.start,c.end],e.currentTime,!0,!0)}}t.changeBitRateTime>=0&&(t.changeBitRateTime=t.seekTime,this.log("[seekTime set changeBitRateTime ], curTime,",r,", changeBitRateTime,",t.changeBitRateTime)),await t.cancelLoading(),t.resetFragmentLoadState(a),this._curLoadSegmentIdx=a,this._onTimeUpdate(),this._startProgress(),this._isEnded()}),It(this,"changeDefineCanPlay",(e,t,r,o)=>{const{player:s}=this;if(s.ended)return void(s.currentTime=0);this.log("[oldChangeDefinition],this._changeDefState,",this._changeDefState),s.currentTime=this._changeDefState?this._changeDefState.currentTime:e,(this._changeDefState?this._changeDefState.paused:t)?s.pause():s.play(),this._changeDefState=null,s.emit(jr,{from:r,to:o})}),It(this,"changeDefinition",async(e,t)=>{const{player:r,config:o,mp4:s}=this;t||(t=r.curDefinition),this._MSEError=!1;const{definitionList:a}=r;let u=null;for(let f=0;f<a.length;f++){const p=a[f].definition;if(p===e.definition||p===Number(e.definition)){u=a[f];break}}if(!u)return;if(o.witchBitRateWay)return void this.oldChangeDefinition(u,t);if(this.useVideoLoad)return void Zo.call(this.player,u,t);r.emit(ro,{from:t,to:u});const l=r.currentTime;let c=s.getFragmentIdx(l);c<0&&(c=this._curLoadSegmentIdx),this.log("switchBitrate:point,fragIndex,",c,",startTime,",s.timeRange[c].startTime,",currentTime,",r.currentTime),s&&(this.mp4.changeBitRateTime=l,await s.cancelLoading(),s._metaLoading&&(s._metaLoading=!1)),this._removeBuffeEndTime=s.timeRange[c].startTime,this._isChangeDefinition=!0;const h=r.getBufferedRange(r.buffered);h[1]>0&&h[1]-r.currentTime>5&&(this.mse.clearOpQueues(At.VIDEO),this.mse.remove(At.VIDEO,r.currentTime+5,h[1])),this.log("switchBitrate: resetFragmentLoadState,",c),s.resetFragmentLoadState(c),this._curLoadSegmentIdx=c,this._handlerUrl(u.url),r.config.url=u.url;const d={...u,url:this.config._mainURL};await this.mp4.changeBitRate(d),this._onTimeUpdate(),r.emit("RESOLUTION_UPDATE",d)}),It(this,"_replayHook",()=>{var e;return(e=this.player)==null||e.play(),!1}),It(this,"_retryHook",()=>(this.beforePlayerInit(),!1)),It(this,"_errorMiddleware",(e,t)=>{const{error:r}=e||{},{video:o}=this.player||{};r&&r.message&&r.message.indexOf("CHUNK_DEMUXER_ERROR_APPEND_FAILED")>-1||o&&!this.useVideoLoad&&function(s){return s.media&&(s=s.media),!!(s&&s instanceof HTMLMediaElement)&&(/^blob/.test(s.currentSrc)||/^blob/.test(s.src))}(o)?this._errorHandler(r):t(e.eventName,e==null?void 0:e.error)}),this.compatibleConfig(this.playerConfig),this.mp4=null,this.mse=null,this._waitAdjustTimeCnt=0,this._lastCheckTime=Qt.nowTime(),this._removeBuffeEndTime=0,this._pendingPromises=[]}static get pluginName(){return"mp4Plugin"}static get defaultConfig(){return{maxBufferLength:40,minBufferLength:5,disableBufferBreakCheck:!1,waitingTimeOut:15e3,waitingInBufferTimeOut:5e3,waitJampBufferMaxCnt:3,tickInSeconds:.1,reqOptions:null,closeDowngrade:!1}}static get version(){return"3.0.0-alpha.34"}compatibleConfig(n){const e=Object.keys(n);let t=null;for(let s=0;s<e.length;s++){const a=e[s].toLowerCase();if(a==="mp4player"||a==="m4aplayer"){t=n[e[s]];break}}t&&(this.config={...this.config,...t});let{reqOptions:r,headers:o}=this.config;!o||r&&r.headers||(this.config.reqOptions={...r,headers:o})}afterCreate(){window.__mp4player=this;try{qt.defineGetterOrSetter(this.player,{__url:{get:()=>{try{return this.mse?this.mse.url:this.config.url}catch{return null}}}})}catch{}this._proxyPlayer()}attachEvents(){this.off(jn,this._onSeeking),this.on(jn,this._onSeeking),this.on(Gn,this._onWaiting),this.off(Vn,this.switchURL),this.on(Vn,this.switchURL)}detachEvents(){this.off(jn,this._onSeeking),this.off(Gn,this._onWaiting),this.off(Vn,this.switchURL)}_proxyPlayer(){typeof this.player.playNext=="function"&&(bl=this.player.playNext),this.player.playNext=(...n)=>{this.playNext(...n)},Jo=this.player._startInit,kl=this.player.switchURL,Zo=this.player.changeDefinition,this.player._startInit=this._playerStartInit.bind(this),this.player.switchURL=this.switchURL.bind(this),this.player.changeDefinition=this.changeDefinition.bind(this),this.player.useHooks("replay",this._replayHook),this.player.useHooks("retry",this._retryHook),this.player.setEventsMiddleware({error:this._errorMiddleware})}_playerStartInit(n){var e;const{config:t,playerConfig:r}=this;t.supportHevc===void 0&&((e=Pe)!=null&&e.isHevcSupported)&&Pe.isHevcSupported()&&(t.supportHevc=!0),this._handlerUrl(r.url);const o=this.initMp4();this._initPromise=o,this._addPendingPromise(this._initPromise),this.mse&&g.typeOf(n)==="String"&&/^blob/.test(n)&&n!==this.mse.url&&(n=r.url),o.then(()=>{this.mse&&(n=this.mse.url),this.attachEvents(),this._startProgress()}).catch(s=>{const a=!!this._initPromise&&this._initPromise.isBreak;if(this.isDestroy||a)return;let u=s;u.errorCode||(u=new nn(this.player,{errorType:ui.RUNTIME,errorCode:(s==null?void 0:s.errorCode)||Dt.other,vid:this.playerConfig.vid,errorMessage:(s==null?void 0:s.errorMessage)||(s==null?void 0:s.message),mediaError:{code:(s==null?void 0:s.httpCode)||Dt.other,message:(s==null?void 0:s.errorMessage)||(s==null?void 0:s.message),errorType:s==null?void 0:s.errorType}}),u.url=n),this.useVideoLoad=!0,this.player.vtype="MP4_1",this.player.emit("playCatch",this.player.vtype,u)}).finally(()=>{if(!this._initPromise)return;const{isBreak:s}=this._initPromise;s||(this._initPromise&&this._removePendingPromise(this._initPromise),this._initPromise=null,!this.isDestroy&&!s&&Jo.call(this.player,n))})}initMp4(){const{player:n,config:e}=this;n.config.vid||(n.config.vid=Date.now());const t=new hm;this.mp4&&(this.mp4.off(Sr,this._onMp4MetaReady),this.mp4.off(wn,this._onMp4Error),this.mp4.off(Cr,this._onMp4DataCallBack),this.mp4.destroy(),this.mp4=null);const r=e._mainURL;return this.mp4=new aa(r,{...this.config,vid:n.config.vid}),this.mp4.on(Sr,this._onMp4MetaReady),this.mp4.on(wn,this._onMp4Error),this.mp4.on(Cr,this._onMp4DataCallBack),this.mp4.on(Ah,o=>{this._curLoadSegmentIdx=o,this.log("[update curLoadSegmentIdx]",o)}),this.mp4.init(),t}_handlerUrl(n){const{config:e,playerConfig:t}=this;let r;const o=[];if(g.typeOf(n)==="String")r=n,t.backupURL&&o.push(t.backupURL);else if(g.typeOf(n)==="Array"&&n.length>0&&(r=n[0].src,n.length>1))for(let s=1;s<n.length;s++)o.push(n[s].src);if(!r&&o.length===0)return!1;e._mainURL=r,e._backupURL=o}setConfig(n){this.config=Object.assign(this.config,n)}playNext(n){const{player:e}=this;this._defInited=!1,e.resetState(),e._currentTime=0,e._duration=0,e.isPlaying=!1,this._MSEError=!1,e.pause(),this._reset(),e.setConfig(n),this.log("[Index] playNext",n),e.play(),this.emit("playnext")}checkDegrade(n){const{closeDowngrade:e}=this.config;return!e||n.httpCode==="networkError"}_errorHandler(n){var e;const{player:t,config:r,playerConfig:o}=this;if(!t||this.useVideoLoad)return;const{_backupURL:s}=r;if(s&&s.length>0){const u=s[0];return this.mp4.update(u),this.mp4.restart(),void s.splice(0,1)}!n.url&&((e=this.mp4)!=null&&e.url)&&(n.url=this.mp4.url);const a=t.paused;if(this.player.vtype="MP4_2",this.player.emit("playCatch",this.player.vtype,n),this.checkDegrade(n)){this._initPromise&&this._removeAndRejectInitPromise(n),this._reset();const u=this.mp4?this.mp4.url:o.url;this._startDegradedPlayback(n,a,u)}else{this.player.pause(),this._reset();const{currentTime:u}=t;this.destroyMSE(),t.currentTime=u,this.emit("error",n)}}_startDegradedPlayback(n,e,t){const{player:r,playerConfig:o}=this;this.useVideoLoad=!0,this.destroyMSE(),this._currentTime=r._currentTime,this.__onmetadataHandle=()=>{this._currentTime&&(r.currentTime=this._currentTime),e?this.player.pause():this.player.play(),(r.media||r.video).removeEventListener("loadedmetadata",this.__onmetadataHandle),this.__onmetadataHandle=null};const s=r.media||r.video;s.addEventListener("loadedmetadata",this.__onmetadataHandle),fl(s),o.url=t,pl(r,t)}_addPendingPromise(n){this._pendingPromises.push(n)}_removePendingPromise(n){const e=this._pendingPromises.indexOf(n);e>-1&&this._pendingPromises.splice(e,1)}_cancelPendingPromises(){this._pendingPromises.length>0&&this._pendingPromises.forEach(n=>{n.reject("DESTROYED")}),this._pendingPromises=[]}_removeAndRejectInitPromise(n){this._initPromise&&(this._removePendingPromise(this._initPromise),this._initPromise.reject(n))}async _initMse(n){this.mse&&(await this.mse.unbindMedia(),this.mse=null);const e=this.mp4&&this.mp4.checkCodecH265(),t=!!n.videoCodec,r=!!n.audioCodec;let o;o=t&&r?e?'video/mp4; codecs="hev1.1.6.L93.B0, mp4a.40.5"':'video/mp4; codecs="avc1.64001E, mp4a.40.5"':t?e?'video/mp4; codecs="hev1.1.6.L93.B0"':'video/mp4; codecs="avc1.64001E"':'video/mp4; codecs="mp4a.40.5"';const s={[At.VIDEO]:{mimeType:"video/mp4",codec:o}};this.mse=new At,this.mse.bindMedia(this.player.video).then(()=>{const a=Object.keys(s);try{for(let u=0;u<a.length;u++){const l=a[u];this.mse.createSource(l,s[l].codec)}}catch(u){this._errorHandler(u)}this._isMseInit=!0,this._onTimeUpdate()})}async destroyMSE(){var n;await((n=this.mse)==null?void 0:n.unbindMedia()),this.mse=null}_onTimeUpdate(){const{mse:n,mp4:e,player:t,config:r}=this;if(!e)return;const o=e.timeRange,s=t.getBufferedRange(t.buffered2);if(n&&e&&e.canDownload){Qt.nowTime()-this._lastCheckTime>1e3&&(this._lastCheckTime=Qt.nowTime(),this._loadStuckCheck(),this._checkRemoveSourceBuffer(s,t.currentTime));const a=t.paused?t.currentTime+r.minBufferLength:t.currentTime+r.maxBufferLength;s[1]-a<0&&o.every((u,l)=>!!u.downloaded||(!this._isChangeDefinition&&u.endTime-u.startTime>1&&this._isInBuffer(u)?(u.downloaded=!0,u.isLoading=!0,this.log(`onTimeUpdate, ${l} download segment, has buffer`,u.startTime,u.endTime),!0):void(u.startTime-t.currentTime<r.maxBufferLength&&(this._curLoadSegmentIdx=l,this.log("[onTimeUpdate],load index==>>>, ",l,",IdxTimeRange, ",u.startTime,"-",u.endTime,",buffEnd, ",s[1],",playCurTime,",t.currentTime,", bufferLen,",s[1]-t.currentTime,",bufferRangeList,",this.player.buffered2?this.player.buffered2.bufferedList:null),this._loadData())))),this._isEnded()}this.checkRemoveOldBitrateBuffer()}checkRemoveOldBitrateBuffer(){const{mse:n,player:e}=this;n&&this._removeBuffeEndTime>0&&e.currentTime>this._removeBuffeEndTime+1&&(this.log("remove old bitrate buffer",this._removeBuffeEndTime),n.remove(At.VIDEO,0,this._removeBuffeEndTime-1),this._removeBuffeEndTime=0)}_isInBuffer(n,e=0){let t=!1;const r=this.player.video.buffered;for(let o=0;o<r.length;o++){const s=r.start(o)-e,a=r.end(o)+e;if(s<=n.startTime&&n.endTime<=a){t=!0;break}}return t}async _loadData(){if(this.mp4&&this._isMseInit)try{await this.mp4.load(this._curLoadSegmentIdx,this._loadDataSuccess)}catch(n){this._errorHandler(n)}else this.log("loadData, player.mp4 null",this._isMseInit)}_appendInitSeg(n){this.mp4&&this.mse&&this.mse.append(At.VIDEO,n,{vid:this.playerConfig.vid,range:null,dataLen:n.byteLength,isinit:!0}).then(e=>{this.log("appendInitSeg end ==>>>",e.context?e.context:null,", costTime,",e.costtime)})}_appendBuffer(n,e,t={},r){const{mse:o,config:s}=this;o.append(n,e,{vid:s.vid,fragIndex:t.fragIndex,range:t.range,dataLen:e.byteLength,state:r}).then(a=>{if(a&&(this.log("player appendBuffer end ==>>>",a.context?a.context:null,", costTime,",a.costtime,", opt,",a.name,",bufferRange,",this.player.getBufferedRange()),this.mse&&t.state&&t.fragIndex===this.mp4.timeRange.length-1)){const u=this.player.buffered;u&&u.length>0&&(this.bufferEndTime=u.end(u.length-1)),this._isEnded(),this.log("loaded ended !!!==>>>",t.range,", fragIndex,",t.fragIndex,", bufferEndTime,",this.bufferEndTime,",meta_duration,",this.mp4.meta.duration)}}).catch(a=>{if(a&&(o!=null&&o.isFull())){const u=this.player.getBufferedRange(this.player.buffered2);this._checkRemoveSourceBuffer(u,this.player.currentTime,!0)}})}_checkRemoveSourceBuffer(n,e,t){const{mse:r,mp4:o,player:s}=this;if(r&&o&&s&&(t&&(clearTimeout(this._removeBufferTimer),this._removeBufferTimer=null),n||(n=s.getBufferedRange(s.buffered2)),e||(e=s.currentTime),!(!t&&Qt.nowTime()-this._checkRemoveBufferLastTime<=this.config.removeBufferLen||this.endofstream)&&(this._checkRemoveBufferLastTime=Qt.nowTime(),n&&n[0]>=0&&(e-n[0]>this.config.removeBufferLen||r.isFull())))){const a=n[1],u=o.getFragmentIdx(a);if(u>=0&&o.timeRange[u].startTime<e){const l=Math.floor(Math.min(o.timeRange[u].startTime,n[1]));n[0]<l?(this.log("[checkremoveSourceBuffer], remove range==>>>",n[0],l),r.remove(At.VIDEO,n[0],l)):r.isFull()&&!this._removeBufferTimer&&(this._removeBufferTimer=setTimeout(()=>{this._checkRemoveSourceBuffer(null,null,!0)},1e4))}}}_isEnded(){const{player:n,mp4:e}=this,t=n.bufferedPoint,r=t?t.end:0;return!this.endofstream&&this.mse&&e.meta.duration-n.currentTime<.5&&(this.log("[check player isEnded],deal mse.endOfStream, currentTime,",n.currentTime,", bufferend,",r,", duration,",e.meta.duration),this.endofstream=!0,this.mse.endOfStream()),!!(e&&e.meta&&e.meta.duration-n.currentTime<.5)&&(this._stopProgress(),this.log("[check player isEnded],stopProgress and endOfStream,currentTime, ",n.currentTime,", bufferend,",r,", duration,",e.meta.duration),this.mse&&this.mse.endOfStream(),!0)}switchURL(n){if(this.useVideoLoad){const{player:e}=this,{currentTime:t}=e;pl(e,n),e.once("canplay",()=>{e.currentTime=t}),e.play()}else this.changeDefinition(n)}oldChangeDefinition(n,e){const{config:t,player:r}=this;this.log("[oldChangeDefinition],currentTime,",r.currentTime,",from,",e,",to,",n);const{currentTime:o,paused:s}=r;this._changeDefState||(this._changeDefState={currentTime:o,paused:s},this.log("[oldChangeDefinition],currentTime,",r.currentTime,",pause,",s)),r.config.url=n.url,t.focusUserDefinition=!0,r.currentTime=0,r.pause(),this._reset(),this._isMseInit=!1,this._changeDefineCanPlay&&r.off("canplay",this._changeDefineCanPlay),this._changeDefineCanPlay=()=>{this.changeDefineCanPlay(o,s,e,n),this._changeDefineCanPlay=null},r.once("canplay",this._changeDefineCanPlay),this.player.video.load(),this.initMp4()}_loadStuckCheck(){const{config:n,player:e,playerConfig:t}=this;n.disableBufferBreakCheck||(e.currentTime-(this._lastCurrentTime||0)>.1||e.paused?this._bufferBreakFlag!==1&&this._bufferBreakFlag!==2||(this.log(","),this._bufferBreakFlag=0,clearTimeout(this._bufferBreakTimer),this._bufferBreakFlag=null):this._bufferBreakFlag||(this._bufferBreakFlag=1,this.log(`! ${n.waitingTimeOut}`),this._bufferBreakTimer=setTimeout(()=>{this.isDestroy||(this._bufferBreakFlag===1&&(this._bufferBreakFlag=2,this.log("!!!"),this._errorHandler(new nn(this.player,{errorType:"runtime",errorTypeCode:ui.runtime,errorCode:Dt.waitTimeout,errorMessage:"wait_timeout",vid:t.vid}))),this._bufferBreakTimer=null)},n.waitingTimeOut)),this._lastCurrentTime=e.currentTime)}get isDestroy(){return!this.player}_stopProgress(){this._hasStartProgress=!1,this._requestTimer&&(this._requestTimer.stop(),this._requestTimer=null),this._bufferBreakTimer&&(clearTimeout(this._bufferBreakTimer),this._bufferBreakTimer=null,this._bufferBreakFlag=void 0)}_startProgress(){this._hasStartProgress||(this._stopProgress(),this._requestTimer=new cm(()=>{this._requestTimer&&this._onTimeUpdate()}),this._requestTimer.tickEvery(this.config.tickInSeconds),this._hasStartProgress=!0)}log(n,...e){const{playerConfig:t}=this;Rh(t&&t.vid?`[Index]${t.vid} ${n}`:`[Index] ${n}`,...e)}_reset(){this._isMseInit=!1,this.endofstream=!1,this._curLoadSegmentIdx=0,this._removeBuffeEndTime=0,this._isChangeDefinition=!1,this._stopProgress(),this.mp4&&(this.mp4.off(Sr,this._onMp4MetaReady),this.mp4.off(wn,this._onMp4Error),this.mp4.off(Cr,this._onMp4DataCallBack),this.mp4.destroy(),this.mp4=null),this.mse&&(this.mse.unbindMedia(),this.mse=null),fl(this.player.video)}destroy(){const{player:n}=this;n.removeHooks("replay",this._replayHook),n.removeHooks("retry",this._retryHook),n.removeEventsMiddleware({error:this._errorMiddleware}),this.detachEvents(),this._reset(),this.player.playNext=bl,this.player._startInit=Jo,this.player.changeDefinition=Zo,this.player.switchURL=kl,this._bufferBreakTimer&&clearInterval(this._bufferBreakTimer),this._removeBufferTimer&&(clearTimeout(this._removeBufferTimer),this._removeBufferTimer=null),this._waitInBufferTimer&&(clearTimeout(this._waitInBufferTimer),this._waitInBufferTimer=null)}}const pm={class:"context"},gm={class:"list",ref:"list"},mm=["onClick"],vm=["src"],ym={class:"title"},_m={class:"player-block",ref:"playerBlock"},bm={class:"download"},km={href:"https://t.me/blastboombs",target:"_blank"},wm={__name:"home",setup(i){let n=null,e=Xi({list:[]});const t=st||kt,r=Pr(!1),o=Pr(!1);function s(){t.refs.playerBlock.classList.remove("show-player"),t.refs.list.classList.remove("brightness-low"),a({url:"",poster:""})}function a({url:l,poster:c}){n=new Rt({id:"vs",url:l,poster:c,preload:"auto",videoInit:!1,playbackRate:!1,leavePlayerTime:100,playsinline:!0,lang:"en",plugins:[fm],commonStyles:{progressColor:"#fff",playedColor:"#fff",volumeColor:"#fff"}}),n.on("ready",()=>{}),n.on("play",()=>{t.refs.list.classList.add("brightness-low")}),n.on("pause",()=>{t.refs.list.classList.remove("brightness-low")}),n.on("error",h=>{})}function u(){o.value=!o.value}return uc(()=>{window.addEventListener("contextmenu",l=>{l.preventDefault()},!1),fetch("/api/list").then(l=>l.json()).then(l=>{e.list=l.files,a({url:"/video/stream?name="+e.list[0].replace(".png",""),poster:""})})}),(l,c)=>(Bn(),wi("div",pm,[ht("div",gm,[(Bn(!0),wi(zt,null,Sd(xn(e).list,h=>(Bn(),wi("div",{class:"item",onClick:d=>{return a({url:"/video/stream?name="+(f=(f=h).replace(".png","")),poster:encodeURI("http://localhost:9000/images/"+f+".png")}),t.refs.list.classList.remove("brightness-low"),t.refs.playerBlock.classList.add("show-player"),void(r.value=window.innerWidth<560);var f}},[ht("img",{src:"http://localhost:9000/images/"+h,alt:""},null,8,vm),ht("div",ym,Ol(h.replace(".png","")),1)],8,mm))),256))],512),ht("div",_m,[r.value?(Bn(),wi("div",{key:0,class:"close",onClick:s},c[0]||(c[0]=[ht("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[ht("path",{d:"M6 6L18 18",stroke:"white","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),ht("path",{d:"M18 6L6 18",stroke:"white","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]))):Vd("",!0),c[2]||(c[2]=ht("div",{class:"video-player",id:"vs"},null,-1)),ht("div",bm,[hd(ht("a",km,"telegram",512),[[$d,o.value]]),(Bn(),wi("svg",{onClick:u,viewBox:"0 0 24 24","aria-hidden":"true",class:"r-4qtqp9 r-yyyyoo r-1xvli5t r-dnmrzs r-bnwqim r-lrvibr r-m6rgpd r-1nao33i r-1q142lx"},c[1]||(c[1]=[ht("g",null,[ht("path",{d:"M11.99 16l-5.7-5.7L7.7 8.88l3.29 3.3V2.59h2v9.59l3.3-3.3 1.41 1.42-5.71 5.7zM21 15l-.02 3.51c0 1.38-1.12 2.49-2.5 2.49H5.5C4.11 21 3 19.88 3 18.5V15h2v3.5c0 .28.22.5.5.5h12.98c.28 0 .5-.22.5-.5L19 15h2z"})],-1)])))])],512)]))}},Tm=Hc(wm,[["__scopeId","data-v-e0079219"]]),xm=function(i){const n=Ef(i.routes,i),e=i.parseQuery||Of,t=i.stringifyQuery||tu,r=i.history,o=Si(),s=Si(),a=Si(),u=Xl(mn,!0);let l=mn;oi&&i.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const c=xo.bind(null,L=>""+L),h=xo.bind(null,ff),d=xo.bind(null,Yi);function f(L,M){if(M=Fe({},M||u.value),typeof L=="string"){const ce=Co(e,L,M.path),ve=n.resolve({path:ce.path},M),Oe=r.createHref(ce.fullPath);return Fe(ce,ve,{params:d(ve.params),hash:Yi(ce.hash),redirectedFrom:void 0,href:Oe})}let G;if(L.path!=null)G=Fe({},L,{path:Co(e,L.path,M.path).path});else{const ce=Fe({},L.params);for(const ve in ce)ce[ve]==null&&delete ce[ve];G=Fe({},L,{params:h(ce)}),M.params=h(M.params)}const re=n.resolve(G,M),Ee=L.hash||"";re.params=c(d(re.params));const Le=function(ce,ve){const Oe=ve.query?ce(ve.query):"";return ve.path+(Oe&&"?")+Oe+(ve.hash||"")}(t,Fe({},L,{hash:(le=Ee,Ks(le).replace(Ac,"{").replace(Dc,"}").replace(Rc,"^")),path:re.path}));var le;const ge=r.createHref(Le);return Fe({fullPath:Le,hash:Ee,query:t===tu?If(L.query):L.query||{}},re,{redirectedFrom:void 0,href:ge})}function p(L){return typeof L=="string"?Co(e,L,u.value.path):Fe({},L)}function m(L,M){if(l!==L)return mi(8,{from:M,to:L})}function v(L){return w(L)}function y(L){const M=L.matched[L.matched.length-1];if(M&&M.redirect){const{redirect:G}=M;let re=typeof G=="function"?G(L):G;return typeof re=="string"&&(re=re.includes("?")||re.includes("#")?re=p(re):{path:re},re.params={}),Fe({query:L.query,hash:L.hash,params:re.path!=null?{}:L.params},re)}}function w(L,M){const G=l=f(L),re=u.value,Ee=L.state,Le=L.force,le=L.replace===!0,ge=y(G);if(ge)return w(Fe(p(ge),{state:typeof ge=="object"?Fe({},Ee,ge.state):Ee,force:Le,replace:le}),M||G);const ce=G;let ve;return ce.redirectedFrom=M,!Le&&function(Oe,_,x){const I=_.matched.length-1,z=x.matched.length-1;return I>-1&&I===z&&pi(_.matched[I],x.matched[z])&&Mc(_.params,x.params)&&Oe(_.query)===Oe(x.query)&&_.hash===x.hash}(t,re,G)&&(ve=mi(16,{to:ce,from:re}),N(re,re,!0,!1)),(ve?Promise.resolve(ve):E(ce,re)).catch(Oe=>$t(Oe)?$t(Oe,2)?Oe:T(Oe):k(Oe,ce,re)).then(Oe=>{if(Oe){if($t(Oe,2))return w(Fe({replace:le},p(Oe.to),{state:typeof Oe.to=="object"?Fe({},Ee,Oe.to.state):Ee,force:Le}),M||ce)}else Oe=W(ce,re,!0,le,Ee);return R(ce,re,Oe),Oe})}function S(L,M){const G=m(L,M);return G?Promise.reject(G):Promise.resolve()}function C(L){const M=Q.values().next().value;return M&&typeof M.runWithContext=="function"?M.runWithContext(L):L()}function E(L,M){let G;const[re,Ee,Le]=function(ge,ce){const ve=[],Oe=[],_=[],x=Math.max(ce.matched.length,ge.matched.length);for(let I=0;I<x;I++){const z=ce.matched[I];z&&(ge.matched.find(A=>pi(A,z))?Oe.push(z):ve.push(z));const F=ge.matched[I];F&&(ce.matched.find(A=>pi(A,F))||_.push(F))}return[ve,Oe,_]}(L,M);G=Lo(re.reverse(),"beforeRouteLeave",L,M);for(const ge of re)ge.leaveGuards.forEach(ce=>{G.push(kn(ce,L,M))});const le=S.bind(null,L,M);return G.push(le),H(G).then(()=>{G=[];for(const ge of o.list())G.push(kn(ge,L,M));return G.push(le),H(G)}).then(()=>{G=Lo(Ee,"beforeRouteUpdate",L,M);for(const ge of Ee)ge.updateGuards.forEach(ce=>{G.push(kn(ce,L,M))});return G.push(le),H(G)}).then(()=>{G=[];for(const ge of Le)if(ge.beforeEnter)if(Ut(ge.beforeEnter))for(const ce of ge.beforeEnter)G.push(kn(ce,L,M));else G.push(kn(ge.beforeEnter,L,M));return G.push(le),H(G)}).then(()=>(L.matched.forEach(ge=>ge.enterCallbacks={}),G=Lo(Le,"beforeRouteEnter",L,M,C),G.push(le),H(G))).then(()=>{G=[];for(const ge of s.list())G.push(kn(ge,L,M));return G.push(le),H(G)}).catch(ge=>$t(ge,8)?ge:Promise.reject(ge))}function R(L,M,G){a.list().forEach(re=>C(()=>re(L,M,G)))}function W(L,M,G,re,Ee){const Le=m(L,M);if(Le)return Le;const le=M===mn,ge=oi?history.state:{};G&&(re||le?r.replace(L.fullPath,Fe({scroll:le&&ge&&ge.scroll},Ee)):r.push(L.fullPath,Ee)),u.value=L,N(L,M,G,le),T()}let J;function se(){J||(J=r.listen((L,M,G)=>{if(!he.listening)return;const re=f(L),Ee=y(re);if(Ee)return void w(Fe(Ee,{replace:!0}),re).catch(Bi);l=re;const Le=u.value;var le,ge;oi&&(le=Wa(Le.fullPath,G.delta),ge=Nr(),Po.set(le,ge)),E(re,Le).catch(ce=>$t(ce,12)?ce:$t(ce,2)?(w(ce.to,re).then(ve=>{$t(ve,20)&&!G.delta&&G.type===Ui.pop&&r.go(-1,!1)}).catch(Bi),Promise.reject()):(G.delta&&r.go(-G.delta,!1),k(ce,re,Le))).then(ce=>{(ce=ce||W(re,Le,!1))&&(G.delta&&!$t(ce,8)?r.go(-G.delta,!1):G.type===Ui.pop&&$t(ce,20)&&r.go(-1,!1)),R(re,Le,ce)}).catch(Bi)}))}let U,ae=Si(),b=Si();function k(L,M,G){T(L);const re=b.list();return re.length&&re.forEach(Ee=>Ee(L,M,G)),Promise.reject(L)}function T(L){return U||(U=!L,se(),ae.list().forEach(([M,G])=>L?G(L):M()),ae.reset()),L}function N(L,M,G,re){const{scrollBehavior:Ee}=i;if(!oi||!Ee)return Promise.resolve();const Le=!G&&function(le){const ge=Po.get(le);return Po.delete(le),ge}(Wa(L.fullPath,0))||(re||!G)&&history.state&&history.state.scroll||null;return Ql().then(()=>Ee(L,M,Le)).then(le=>le&&_f(le)).catch(le=>k(le,L,M))}const P=L=>r.go(L);let B;const Q=new Set,he={currentRoute:u,listening:!0,addRoute:function(L,M){let G,re;return Fc(L)?(G=n.getRecordMatcher(L),re=M):re=L,n.addRoute(re,G)},removeRoute:function(L){const M=n.getRecordMatcher(L);M&&n.removeRoute(M)},clearRoutes:n.clearRoutes,hasRoute:function(L){return!!n.getRecordMatcher(L)},getRoutes:function(){return n.getRoutes().map(L=>L.record)},resolve:f,options:i,push:v,replace:function(L){return v(Fe(p(L),{replace:!0}))},go:P,back:()=>P(-1),forward:()=>P(1),beforeEach:o.add,beforeResolve:s.add,afterEach:a.add,onError:b.add,isReady:function(){return U&&u.value!==mn?Promise.resolve():new Promise((L,M)=>{ae.add([L,M])})},install(L){L.component("RouterLink",Af),L.component("RouterView",jc),L.config.globalProperties.$router=this,Object.defineProperty(L.config.globalProperties,"$route",{enumerable:!0,get:()=>xn(u)}),oi&&!B&&u.value===mn&&(B=!0,v(r.location).catch(re=>{}));const M={};for(const re in mn)Object.defineProperty(M,re,{get:()=>u.value[re],enumerable:!0});L.provide(qs,this),L.provide(Uc,ql(M)),L.provide(hs,u);const G=L.unmount;Q.add(L),L.unmount=function(){Q.delete(L),Q.size<1&&(l=mn,J&&J(),J=null,u.value=mn,B=!1,U=!1),G()}}};function H(L){return L.reduce((M,G)=>M.then(()=>C(G)),Promise.resolve())}return he}({history:function(i){const n=bf(i=mf(i)),e=function(r,o,s,a){let u=[],l=[],c=null;const h=({state:f})=>{const p=Nc(r,location),m=s.value,v=o.value;let y=0;if(f){if(s.value=p,o.value=f,c&&c===m)return void(c=null);y=v?f.position-v.position:0}else a(p);u.forEach(w=>{w(s.value,m,{delta:y,type:Ui.pop,direction:y?y>0?ji.forward:ji.back:ji.unknown})})};function d(){const{history:f}=window;f.state&&f.replaceState(Fe({},f.state,{scroll:Nr()}),"")}return window.addEventListener("popstate",h),window.addEventListener("beforeunload",d,{passive:!0}),{pauseListeners:function(){c=s.value},listen:function(f){u.push(f);const p=()=>{const m=u.indexOf(f);m>-1&&u.splice(m,1)};return l.push(p),p},destroy:function(){for(const f of l)f();l=[],window.removeEventListener("popstate",h),window.removeEventListener("beforeunload",d)}}}(i,n.state,n.location,n.replace),t=Fe({location:"",base:i,go:function(r,o=!0){o||e.pauseListeners(),history.go(r)},createHref:yf.bind(null,i)},n,e);return Object.defineProperty(t,"location",{enumerable:!0,get:()=>n.location.value}),Object.defineProperty(t,"state",{enumerable:!0,get:()=>n.state.value}),t}("/"),routes:[{path:"/",name:"home",component:Tm},{path:"/traces/:id",name:"traces",component:()=>function(i,n){let e=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),o=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));e=Promise.allSettled(n.map(s=>{if((s=function(c){return"/"+c}(s))in au)return;au[s]=!0;const a=s.endsWith(".css"),u=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${u}`))return;const l=document.createElement("link");return l.rel=a?"stylesheet":"modulepreload",a||(l.as="script"),l.crossOrigin="",l.href=s,o&&l.setAttribute("nonce",o),document.head.appendChild(l),a?new Promise((c,h)=>{l.addEventListener("load",c),l.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${s}`)))}):void 0}))}function t(r){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=r,window.dispatchEvent(o),!o.defaultPrevented)throw r}return e.then(r=>{for(const o of r||[])o.status==="rejected"&&t(o.reason);return i().catch(t)})}(()=>import("./traces-DJCymNes.js"),__vite__mapDeps([0,1]))}]}),Qo=((...i)=>{const n=(Ba||(Ba=Ad(tf))).createApp(...i),{mount:e}=n;return n.mount=t=>{const r=function(a){return Xe(a)?document.querySelector(a):a}(t);if(!r)return;const o=n._component;Se(o)||o.render||o.template||(o.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const s=e(r,!1,function(a){if(a instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&a instanceof MathMLElement)return"mathml"}(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),s},n})(Mf);Qo.use(function(){const i=new Rl(!0),n=i.run(()=>Pr({}));let e=[],t=[];const r=$l({install(o){r._a=o,o.provide(nf,r),o.config.globalProperties.$pinia=r,t.forEach(s=>e.push(s)),t=[]},use(o){return this._a?e.push(o):t.push(o),this},_p:e,_a:null,_e:i,_s:new Map,state:n});return r}()),Qo.use(xm),Qo.mount("#app");export{Hc as _,ht as a,wi as c,Bn as o};
